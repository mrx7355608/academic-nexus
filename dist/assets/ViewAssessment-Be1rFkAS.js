const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BIqdkLuE-3SvCF4Ss.js","assets/url-Dkx9cvHv-D4UJOJBe.js","assets/index--WTcuLUy.js","assets/index-BX-6IKtz.css","assets/chunk-NTCQBYKE-DppzSCO-.js","assets/DownloadModal-CqqUZl8B.js","assets/chunk-4FCEGNGT-CXTrS8zI.js","assets/chunk-ROURZMX4-Cb0dCQiP.js","assets/PageHeading-E7uGofSo.js","assets/chunk-W7WUSNWJ-CeHpZ36T.js","assets/useFetch-Cc7htHJd.js","assets/assessment.services-CeXVm2XV.js","assets/index-DFn6bF3J-LEdMKbxg.js"])))=>i.map(i=>d[i]);
var B2=Object.defineProperty;var _k=n=>{throw TypeError(n)};var W2=(n,t,e)=>t in n?B2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Pt=(n,t,e)=>W2(n,typeof t!="symbol"?t+"":t,e),lA=(n,t,e)=>t.has(n)||_k("Cannot "+e);var d=(n,t,e)=>(lA(n,t,"read from private field"),e?e.call(n):t.get(n)),P=(n,t,e)=>t.has(n)?_k("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),S=(n,t,e,i)=>(lA(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),k=(n,t,e)=>(lA(n,t,"access private method"),e);var hs=(n,t,e,i)=>({set _(s){S(n,t,s,e)},get _(){return d(n,t,i)}});import{_ as _o,E as H2,r as U,j as N,G as AS,q as _S,J as hA,B as $c,T as ec,v as od,F as gv,S as mv,K as $2,M as Sh,N as U2,z as z2,C as V2,H as Ek,y as xk}from"./index--WTcuLUy.js";import{V as Sk}from"./chunk-NTCQBYKE-DppzSCO-.js";import{D as G2}from"./DownloadModal-CqqUZl8B.js";import{P as q2}from"./PageHeading-E7uGofSo.js";import{u as X2}from"./useFetch-Cc7htHJd.js";import{u as Y2,d as K2}from"./assessment.services-CeXVm2XV.js";import{D as Q2}from"./chunk-W7WUSNWJ-CeHpZ36T.js";var Z2="Invariant failed";function ae(n,t){if(!n)throw new Error(Z2)}var hp={};hp.d=(n,t)=>{for(var e in t)hp.o(t,e)&&!hp.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})};hp.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Et=globalThis.pdfjsLib={};hp.d(Et,{AbortException:()=>Bh,AnnotationEditorLayer:()=>g_,AnnotationEditorParamsType:()=>kt,AnnotationEditorType:()=>Wt,AnnotationEditorUIManager:()=>Ch,AnnotationLayer:()=>KF,AnnotationMode:()=>$a,CMapCompressionType:()=>o1,ColorPicker:()=>Zb,DOMSVGFactory:()=>SS,DrawLayer:()=>y_,FeatureTest:()=>ns,GlobalWorkerOptions:()=>ha,ImageKind:()=>vv,InvalidPDFException:()=>zT,MissingPDFException:()=>jh,OPS:()=>Qs,Outliner:()=>K1,PDFDataRangeTransport:()=>BR,PDFDateString:()=>QT,PDFWorker:()=>hd,PasswordResponses:()=>iD,PermissionFlag:()=>eD,PixelsPerInch:()=>ko,RenderingCancelledException:()=>kS,TextLayer:()=>Kb,UnexpectedResponseException:()=>Aw,Util:()=>pt,VerbosityLevel:()=>bw,XfaLayer:()=>HR,build:()=>PF,createValidAbsoluteUrl:()=>aD,fetchData:()=>kw,getDocument:()=>AF,getFilenameFromUrl:()=>mD,getPdfFilenameFromUrl:()=>vD,getXfaPageViewport:()=>bD,isDataScheme:()=>CS,isPdfFile:()=>TS,noContextMenu:()=>as,normalizeUnicode:()=>uD,renderTextLayer:()=>uF,setLayerDimensions:()=>kh,shadow:()=>$t,updateTextLayer:()=>fF,version:()=>RF});const Ii=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),UT=[1,0,0,1,0,0],a1=[.001,0,0,.001,0,0],J2=1e7,cA=1.35,js={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},$a={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},tD="pdfjs_internal_editor_",Wt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},kt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},eD={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},mi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},vv={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},De={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Lu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},bw={ERRORS:0,WARNINGS:1,INFOS:5},o1={NONE:0,BINARY:1},Qs={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},iD={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let yw=bw.WARNINGS;function sD(n){Number.isInteger(n)&&(yw=n)}function nD(){return yw}function ww(n){yw>=bw.INFOS&&console.log(`Info: ${n}`)}function Dt(n){yw>=bw.WARNINGS&&console.log(`Warning: ${n}`)}function te(n){throw new Error(n)}function $e(n,t){n||te(t)}function rD(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function aD(n,t=null,e=null){if(!n)return null;try{if(e&&typeof n=="string"){if(e.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(e.tryConvertEncoding)try{n=dD(n)}catch{}}const i=t?new URL(n,t):new URL(n);if(rD(i))return i}catch{}return null}function $t(n,t,e,i=!1){return Object.defineProperty(n,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const Po=function(){function t(e,i){this.constructor===t&&te("Cannot initialize BaseException."),this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class l1 extends Po{constructor(t,e){super(t,"PasswordException"),this.code=e}}class h1 extends Po{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class zT extends Po{constructor(t){super(t,"InvalidPDFException")}}class jh extends Po{constructor(t){super(t,"MissingPDFException")}}class Aw extends Po{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class oD extends Po{constructor(t){super(t,"FormatError")}}class Bh extends Po{constructor(t){super(t,"AbortException")}}function VT(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&te("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<t;s+=e){const r=Math.min(s+e,t),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function _w(n){typeof n!="string"&&te("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=n.charCodeAt(i)&255;return e}function lD(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function ES(n){const t=Object.create(null);for(const[e,i]of n)t[e]=i;return t}function hD(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function cD(){try{return new Function(""),!0}catch{return!1}}class ns{static get isLittleEndian(){return $t(this,"isLittleEndian",hD())}static get isEvalSupported(){return $t(this,"isEvalSupported",cD())}static get isOffscreenCanvasSupported(){return $t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?$t(this,"platform",{isMac:navigator.platform.includes("Mac")}):$t(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var t,e;return $t(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const dA=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var ua,bv,c1;class pt{static makeHexColor(t,e,i){return`#${dA[t]}${dA[e]}${dA[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],s=t[0]*e[1]+t[1]*e[3]+e[5];return[i,s]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],s=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,r=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[s,r]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),r=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],s[0],r[0],a[0]),Math.min(i[1],s[1],r[1],a[1]),Math.max(i[0],s[0],r[0],a[0]),Math.max(i[1],s[1],r[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],s=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-r*s))/2,c=o+l||1,h=o-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[i,r,s,a]}static bezierBoundingBox(t,e,i,s,r,a,o,l,c){return c?(c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,l),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,l)):c=[Math.min(t,o),Math.min(e,l),Math.max(t,o),Math.max(e,l)],k(this,ua,c1).call(this,t,i,r,o,e,s,a,l,3*(-t+3*(i-r)+o),6*(t-2*i+r),3*(i-t),c),k(this,ua,c1).call(this,t,i,r,o,e,s,a,l,3*(-e+3*(s-a)+l),6*(e-2*s+a),3*(s-e),c),c}}ua=new WeakSet,bv=function(t,e,i,s,r,a,o,l,c,h){if(c<=0||c>=1)return;const f=1-c,p=c*c,g=p*c,m=f*(f*(f*t+3*c*e)+3*p*i)+g*s,b=f*(f*(f*r+3*c*a)+3*p*o)+g*l;h[0]=Math.min(h[0],m),h[1]=Math.min(h[1],b),h[2]=Math.max(h[2],m),h[3]=Math.max(h[3],b)},c1=function(t,e,i,s,r,a,o,l,c,h,f,p){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&k(this,ua,bv).call(this,t,e,i,s,r,a,o,l,-f/h,p);return}const g=h**2-4*f*c;if(g<0)return;const m=Math.sqrt(g),b=2*c;k(this,ua,bv).call(this,t,e,i,s,r,a,o,l,(-h+m)/b,p),k(this,ua,bv).call(this,t,e,i,s,r,a,o,l,(-h-m)/b,p)},P(pt,ua);function dD(n){return decodeURIComponent(escape(n))}let uA=null,kk=null;function uD(n){return uA||(uA=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,kk=new Map([["ﬅ","ſt"]])),n.replaceAll(uA,(t,e,i)=>e?e.normalize("NFKC"):kk.get(i))}function fD(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const n=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(n);else for(let t=0;t<32;t++)n[t]=Math.floor(Math.random()*255);return VT(n)}const GT="pdfjs_internal_id_",nr={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};class Ew{constructor(){this.constructor===Ew&&te("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,r){return"none"}destroy(t=!1){}}var zp;const bk=class bk{constructor({enableHWA:t=!1}={}){P(this,zp,!1);this.constructor===bk&&te("Cannot initialize BaseCanvasFactory."),S(this,zp,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!d(this,zp)})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){te("Abstract method `_createCanvas` called.")}};zp=new WeakMap;let Gb=bk;class xw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.constructor===xw&&te("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?o1.BINARY:o1.NONE;return this._fetchData(e,i).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}_fetchData(t,e){te("Abstract method `_fetchData` called.")}}class Sw{constructor({baseUrl:t=null}){this.constructor===Sw&&te("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetchData(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}_fetchData(t){te("Abstract method `_fetchData` called.")}}class xS{constructor(){this.constructor===xS&&te("Cannot initialize BaseSVGFactory.")}create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){te("Abstract method `_createSVG` called.")}}const lr="http://www.w3.org/2000/svg",ml=class ml{};Pt(ml,"CSS",96),Pt(ml,"PDF",72),Pt(ml,"PDF_TO_CSS_UNITS",ml.CSS/ml.PDF);let ko=ml;var Tl,Mn,Lr,Ki,Jy,Rl,ut,vi,ic,sc,yv,qT,d1,nc,Yu,Ku,u1,Qu;class pD extends Ew{constructor({docId:e,ownerDocument:i=globalThis.document}={}){super();P(this,ut);P(this,Tl);P(this,Mn);P(this,Lr);P(this,Ki);P(this,Jy);P(this,Rl,0);S(this,Lr,e),S(this,Ki,i)}addFilter(e){if(!e)return"none";let i=d(this,ut,vi).get(e);if(i)return i;const[s,r,a]=k(this,ut,yv).call(this,e),o=e.length===1?s:`${s}${r}${a}`;if(i=d(this,ut,vi).get(o),i)return d(this,ut,vi).set(e,i),i;const l=`g_${d(this,Lr)}_transfer_map_${hs(this,Rl)._++}`,c=`url(#${l})`;d(this,ut,vi).set(e,c),d(this,ut,vi).set(o,c);const h=k(this,ut,nc).call(this,l);return k(this,ut,Ku).call(this,s,r,a,h),c}addHCMFilter(e,i){var m;const s=`${e}-${i}`,r="base";let a=d(this,ut,ic).get(r);if((a==null?void 0:a.key)===s||(a?((m=a.filter)==null||m.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},d(this,ut,ic).set(r,a)),!e||!i))return a.url;const o=k(this,ut,Qu).call(this,e);e=pt.makeHexColor(...o);const l=k(this,ut,Qu).call(this,i);if(i=pt.makeHexColor(...l),d(this,ut,sc).style.color="",e==="#000000"&&i==="#ffffff"||e===i)return a.url;const c=new Array(256);for(let b=0;b<=255;b++){const y=b/255;c[b]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const h=c.join(","),f=`g_${d(this,Lr)}_hcm_filter`,p=a.filter=k(this,ut,nc).call(this,f);k(this,ut,Ku).call(this,h,h,h,p),k(this,ut,d1).call(this,p);const g=(b,y)=>{const w=o[b]/255,x=l[b]/255,R=new Array(y+1);for(let I=0;I<=y;I++)R[I]=w+I/y*(x-w);return R.join(",")};return k(this,ut,Ku).call(this,g(0,5),g(1,5),g(2,5),p),a.url=`url(#${f})`,a.url}addAlphaFilter(e){let i=d(this,ut,vi).get(e);if(i)return i;const[s]=k(this,ut,yv).call(this,[e]),r=`alpha_${s}`;if(i=d(this,ut,vi).get(r),i)return d(this,ut,vi).set(e,i),i;const a=`g_${d(this,Lr)}_alpha_map_${hs(this,Rl)._++}`,o=`url(#${a})`;d(this,ut,vi).set(e,o),d(this,ut,vi).set(r,o);const l=k(this,ut,nc).call(this,a);return k(this,ut,u1).call(this,s,l),o}addLuminosityFilter(e){let i=d(this,ut,vi).get(e||"luminosity");if(i)return i;let s,r;if(e?([s]=k(this,ut,yv).call(this,[e]),r=`luminosity_${s}`):r="luminosity",i=d(this,ut,vi).get(r),i)return d(this,ut,vi).set(e,i),i;const a=`g_${d(this,Lr)}_luminosity_map_${hs(this,Rl)._++}`,o=`url(#${a})`;d(this,ut,vi).set(e,o),d(this,ut,vi).set(r,o);const l=k(this,ut,nc).call(this,a);return k(this,ut,qT).call(this,l),e&&k(this,ut,u1).call(this,s,l),o}addHighlightHCMFilter(e,i,s,r,a){var x;const o=`${i}-${s}-${r}-${a}`;let l=d(this,ut,ic).get(e);if((l==null?void 0:l.key)===o||(l?((x=l.filter)==null||x.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},d(this,ut,ic).set(e,l)),!i||!s))return l.url;const[c,h]=[i,s].map(k(this,ut,Qu).bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,m]=[r,a].map(k(this,ut,Qu).bind(this));p<f&&([f,p,g,m]=[p,f,m,g]),d(this,ut,sc).style.color="";const b=(R,I,D)=>{const F=new Array(256),O=(p-f)/D,L=R/255,M=(I-R)/(255*D);let W=0;for(let j=0;j<=D;j++){const V=Math.round(f+j*O),z=L+j*M;for(let Y=W;Y<=V;Y++)F[Y]=z;W=V+1}for(let j=W;j<256;j++)F[j]=F[W-1];return F.join(",")},y=`g_${d(this,Lr)}_hcm_${e}_filter`,w=l.filter=k(this,ut,nc).call(this,y);return k(this,ut,d1).call(this,w),k(this,ut,Ku).call(this,b(g[0],m[0],5),b(g[1],m[1],5),b(g[2],m[2],5),w),l.url=`url(#${y})`,l.url}destroy(e=!1){e&&d(this,ut,ic).size!==0||(d(this,Mn)&&(d(this,Mn).parentNode.parentNode.remove(),S(this,Mn,null)),d(this,Tl)&&(d(this,Tl).clear(),S(this,Tl,null)),S(this,Rl,0))}}Tl=new WeakMap,Mn=new WeakMap,Lr=new WeakMap,Ki=new WeakMap,Jy=new WeakMap,Rl=new WeakMap,ut=new WeakSet,vi=function(){return d(this,Tl)||S(this,Tl,new Map)},ic=function(){return d(this,Jy)||S(this,Jy,new Map)},sc=function(){if(!d(this,Mn)){const e=d(this,Ki).createElement("div"),{style:i}=e;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=d(this,Ki).createElementNS(lr,"svg");s.setAttribute("width",0),s.setAttribute("height",0),S(this,Mn,d(this,Ki).createElementNS(lr,"defs")),e.append(s),s.append(d(this,Mn)),d(this,Ki).body.append(e)}return d(this,Mn)},yv=function(e){if(e.length===1){const c=e[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=c[p]/255;const f=h.join(",");return[f,f,f]}const[i,s,r]=e,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=s[c]/255,l[c]=r[c]/255;return[a.join(","),o.join(","),l.join(",")]},qT=function(e){const i=d(this,Ki).createElementNS(lr,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(i)},d1=function(e){const i=d(this,Ki).createElementNS(lr,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(i)},nc=function(e){const i=d(this,Ki).createElementNS(lr,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",e),d(this,ut,sc).append(i),i},Yu=function(e,i,s){const r=d(this,Ki).createElementNS(lr,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),e.append(r)},Ku=function(e,i,s,r){const a=d(this,Ki).createElementNS(lr,"feComponentTransfer");r.append(a),k(this,ut,Yu).call(this,a,"feFuncR",e),k(this,ut,Yu).call(this,a,"feFuncG",i),k(this,ut,Yu).call(this,a,"feFuncB",s)},u1=function(e,i){const s=d(this,Ki).createElementNS(lr,"feComponentTransfer");i.append(s),k(this,ut,Yu).call(this,s,"feFuncA",e)},Qu=function(e){return d(this,ut,sc).style.color=e,RS(getComputedStyle(d(this,ut,sc)).getPropertyValue("color"))};class gD extends Gb{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}={}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}async function kw(n,t="text"){if(Zu(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class XT extends xw{_fetchData(t,e){return kw(t,this.isCompressed?"arraybuffer":"text").then(i=>({cMapData:i instanceof ArrayBuffer?new Uint8Array(i):_w(i),compressionType:e}))}}class YT extends Sw{_fetchData(t){return kw(t,"arraybuffer").then(e=>new Uint8Array(e))}}class SS extends xS{_createSVG(t){return document.createElementNS(lr,t)}}class _m{constructor({viewBox:t,scale:e,rotation:i,offsetX:s=0,offsetY:r=0,dontFlip:a=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=s,this.offsetY=r;const o=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,h,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,h=0,f=0,p=1;break;case 90:c=0,h=1,f=1,p=0;break;case 270:c=0,h=-1,f=-1,p=0;break;case 0:c=1,h=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,p=-p);let g,m,b,y;c===0?(g=Math.abs(l-t[1])*e+s,m=Math.abs(o-t[0])*e+r,b=(t[3]-t[1])*e,y=(t[2]-t[0])*e):(g=Math.abs(o-t[0])*e+s,m=Math.abs(l-t[1])*e+r,b=(t[2]-t[0])*e,y=(t[3]-t[1])*e),this.transform=[c*e,h*e,f*e,p*e,g-c*e*o-f*e*l,m-h*e*o-p*e*l],this.width=b,this.height=y}get rawDims(){const{viewBox:t}=this;return $t(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new _m({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(t,e){return pt.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=pt.applyTransform([t[0],t[1]],this.transform),i=pt.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return pt.applyInverseTransform([t,e],this.transform)}}class kS extends Po{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function CS(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function TS(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function mD(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function vD(n,t="document.pdf"){if(typeof n!="string")return t;if(CS(n))return Dt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=e.exec(n);let r=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=i.exec(decodeURIComponent(r))[0]}catch{}return r||t}class Ck{constructor(){Pt(this,"started",Object.create(null));Pt(this,"times",[])}time(t){t in this.started&&Dt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Dt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:r}of this.times)t.push(`${i.padEnd(e)} ${r-s}ms
`);return t.join("")}}function Zu(n,t){try{const{protocol:e}=t?new URL(n,t):new URL(n);return e==="http:"||e==="https:"}catch{return!1}}function as(n){n.preventDefault()}function KT(n){console.log("Deprecated API usage: "+n)}let Tk;class QT{static toDateObject(t){if(!t||typeof t!="string")return null;Tk||(Tk=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=Tk.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(e[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(a+=h,o+=f):c==="+"&&(a-=h,o-=f),new Date(Date.UTC(i,s,r,a,o,l))}}function bD(n,{scale:t=1,rotation:e=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new _m({viewBox:r,scale:t,rotation:e})}function RS(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Dt(`Not a valid color format: "${n}"`),[0,0,0])}function yD(n){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of n.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;n.set(e,RS(i))}t.remove()}function ye(n){const{a:t,b:e,c:i,d:s,e:r,f:a}=n.getTransform();return[t,e,i,s,r,a]}function rr(n){const{a:t,b:e,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[t,e,i,s,r,a]}function kh(n,t,e=!1,i=!0){if(t instanceof _m){const{pageWidth:s,pageHeight:r}=t.rawDims,{style:a}=n,o=ns.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${r}px`,h=o?`round(${l}, 1px)`:`calc(${l})`,f=o?`round(${c}, 1px)`:`calc(${c})`;!e||t.rotation%180===0?(a.width=h,a.height=f):(a.width=f,a.height=h)}i&&n.setAttribute("data-main-rotation",t.rotation)}var Pl,Ll,gs,Ml,tw,ZT,Ui,JT,tR,wv,eR,p1;const ew=class ew{constructor(t){P(this,Ui);P(this,Pl,null);P(this,Ll,null);P(this,gs);P(this,Ml,null);S(this,gs,t)}render(){const t=S(this,Pl,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar");const e=d(this,gs)._uiManager._signal;t.addEventListener("contextmenu",as,{signal:e}),t.addEventListener("pointerdown",k(ew,tw,ZT),{signal:e});const i=S(this,Ml,document.createElement("div"));i.className="buttons",t.append(i);const s=d(this,gs).toolbarPosition;if(s){const{style:r}=t,a=d(this,gs)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return k(this,Ui,eR).call(this),t}hide(){var t;d(this,Pl).classList.add("hidden"),(t=d(this,Ll))==null||t.hideDropdown()}show(){d(this,Pl).classList.remove("hidden")}addAltTextButton(t){k(this,Ui,wv).call(this,t),d(this,Ml).prepend(t,d(this,Ui,p1))}addColorPicker(t){S(this,Ll,t);const e=t.renderButton();k(this,Ui,wv).call(this,e),d(this,Ml).prepend(e,d(this,Ui,p1))}remove(){var t;d(this,Pl).remove(),(t=d(this,Ll))==null||t.destroy(),S(this,Ll,null)}};Pl=new WeakMap,Ll=new WeakMap,gs=new WeakMap,Ml=new WeakMap,tw=new WeakSet,ZT=function(t){t.stopPropagation()},Ui=new WeakSet,JT=function(t){d(this,gs)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},tR=function(t){d(this,gs)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},wv=function(t){const e=d(this,gs)._uiManager._signal;t.addEventListener("focusin",k(this,Ui,JT).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",k(this,Ui,tR).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",as,{signal:e})},eR=function(){const t=document.createElement("button");t.className="delete",t.tabIndex=0,t.setAttribute("data-l10n-id",`pdfjs-editor-remove-${d(this,gs).editorType}-button`),k(this,Ui,wv).call(this,t),t.addEventListener("click",e=>{d(this,gs)._uiManager.delete()},{signal:d(this,gs)._uiManager._signal}),d(this,Ml).append(t)},p1=function(){const t=document.createElement("div");return t.className="divider",t},P(ew,tw);let f1=ew;var Vp,Il,Dl,To,iR,sR,nR;class wD{constructor(t){P(this,To);P(this,Vp,null);P(this,Il,null);P(this,Dl);S(this,Dl,t)}show(t,e,i){const[s,r]=k(this,To,sR).call(this,e,i),{style:a}=d(this,Il)||S(this,Il,k(this,To,iR).call(this));t.append(d(this,Il)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){d(this,Il).remove()}}Vp=new WeakMap,Il=new WeakMap,Dl=new WeakMap,To=new WeakSet,iR=function(){const t=S(this,Il,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",as,{signal:d(this,Dl)._signal});const e=S(this,Vp,document.createElement("div"));return e.className="buttons",t.append(e),k(this,To,nR).call(this),t},sR=function(t,e){let i=0,s=0;for(const r of t){const a=r.y+r.height;if(a<i)continue;const o=r.x+(e?r.width:0);if(a>i){s=o,i=a;continue}e?o>s&&(s=o):o<s&&(s=o)}return[e?1-s:s,i]},nR=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=d(this,Dl)._signal;t.addEventListener("contextmenu",as,{signal:i}),t.addEventListener("click",()=>{d(this,Dl).highlightSelection("floating_button")},{signal:i}),d(this,Vp).append(t)};function qb(n,t,e){for(const i of e)t.addEventListener(i,n[i].bind(n))}function AD(n){return Math.round(Math.min(255,Math.max(1,255*n))).toString(16).padStart(2,"0")}var iw;class _D{constructor(){P(this,iw,0)}get id(){return`${tD}${hs(this,iw)._++}`}}iw=new WeakMap;var Gp,sw,Ds,qp,m1;const yk=class yk{constructor(){P(this,qp);P(this,Gp,fD());P(this,sw,0);P(this,Ds,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return $t(this,"_isSVGFittingCanvas",r)}async getFromFile(t){const{lastModified:e,name:i,size:s,type:r}=t;return k(this,qp,m1).call(this,`${e}_${i}_${s}_${r}`,t)}async getFromUrl(t){return k(this,qp,m1).call(this,t,t)}async getFromId(t){d(this,Ds)||S(this,Ds,new Map);const e=d(this,Ds).get(t);return e?e.bitmap?(e.refCounter+=1,e):e.file?this.getFromFile(e.file):this.getFromUrl(e.url):null}getSvgUrl(t){const e=d(this,Ds).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){d(this,Ds)||S(this,Ds,new Map);const e=d(this,Ds).get(t);e&&(e.refCounter-=1,e.refCounter===0&&(e.bitmap=null))}isValidId(t){return t.startsWith(`image_${d(this,Gp)}_`)}};Gp=new WeakMap,sw=new WeakMap,Ds=new WeakMap,qp=new WeakSet,m1=async function(t,e){d(this,Ds)||S(this,Ds,new Map);let i=d(this,Ds).get(t);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${d(this,Gp)}_${hs(this,sw)._++}`,refCounter:0,isSvg:!1});let s;if(typeof e=="string"?(i.url=e,s=await kw(e,"blob")):s=i.file=e,s.type==="image/svg+xml"){const r=yk._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const f=i.svgUrl=a.result;o.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=h});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){console.error(s),i=null}return d(this,Ds).set(t,i),i&&d(this,Ds).set(i.id,i),i};let g1=yk;var Ye,to,Xp,Ke;class ED{constructor(t=128){P(this,Ye,[]);P(this,to,!1);P(this,Xp);P(this,Ke,-1);S(this,Xp,t)}add({cmd:t,undo:e,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&t(),d(this,to))return;const l={cmd:t,undo:e,post:i,type:r};if(d(this,Ke)===-1){d(this,Ye).length>0&&(d(this,Ye).length=0),S(this,Ke,0),d(this,Ye).push(l);return}if(a&&d(this,Ye)[d(this,Ke)].type===r){o&&(l.undo=d(this,Ye)[d(this,Ke)].undo),d(this,Ye)[d(this,Ke)]=l;return}const c=d(this,Ke)+1;c===d(this,Xp)?d(this,Ye).splice(0,1):(S(this,Ke,c),c<d(this,Ye).length&&d(this,Ye).splice(c)),d(this,Ye).push(l)}undo(){if(d(this,Ke)===-1)return;S(this,to,!0);const{undo:t,post:e}=d(this,Ye)[d(this,Ke)];t(),e==null||e(),S(this,to,!1),S(this,Ke,d(this,Ke)-1)}redo(){if(d(this,Ke)<d(this,Ye).length-1){S(this,Ke,d(this,Ke)+1),S(this,to,!0);const{cmd:t,post:e}=d(this,Ye)[d(this,Ke)];t(),e==null||e(),S(this,to,!1)}}hasSomethingToUndo(){return d(this,Ke)!==-1}hasSomethingToRedo(){return d(this,Ke)<d(this,Ye).length-1}destroy(){S(this,Ye,null)}}Ye=new WeakMap,to=new WeakMap,Xp=new WeakMap,Ke=new WeakMap;var nw,rR;class Em{constructor(t){P(this,nw);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ns.platform;for(const[i,s,r={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(k(this,nw,rR).call(this,e));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(s.bind(t,...a,e)(),r||(e.stopPropagation(),e.preventDefault()))}}nw=new WeakSet,rR=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const rw=class rw{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return yD(t),$t(this,"_colors",t)}convert(t){const e=RS(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((r,a)=>r===e[a]))return rw._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?pt.makeHexColor(...e):t}};Pt(rw,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let v1=rw;var Sd,ms,Ne,hi,kd,Mr,Cd,tn,Td,Fl,In,en,Ol,Yp,Kp,Dn,Rd,eo,Fn,aw,io,Qp,Nl,Zp,Pd,ci,Kt,Ir,jl,Jp,tg,eg,ig,sg,ng,rg,ag,og,lg,hg,cg,dg,so,On,Dr,ug,at,Av,aR,oR,_v,lR,hR,cR,b1,dR,y1,w1,uR,Oi,Aa,fR,pR,A1,gR,Ju,_1;const ad=class ad{constructor(t,e,i,s,r,a,o,l,c){P(this,at);P(this,Sd,new AbortController);P(this,ms,null);P(this,Ne,new Map);P(this,hi,new Map);P(this,kd,null);P(this,Mr,null);P(this,Cd,null);P(this,tn,new ED);P(this,Td,0);P(this,Fl,new Set);P(this,In,null);P(this,en,null);P(this,Ol,new Set);P(this,Yp,!1);P(this,Kp,null);P(this,Dn,null);P(this,Rd,null);P(this,eo,!1);P(this,Fn,null);P(this,aw,new _D);P(this,io,!1);P(this,Qp,!1);P(this,Nl,null);P(this,Zp,null);P(this,Pd,null);P(this,ci,Wt.NONE);P(this,Kt,new Set);P(this,Ir,null);P(this,jl,null);P(this,Jp,null);P(this,tg,this.blur.bind(this));P(this,eg,this.focus.bind(this));P(this,ig,this.copy.bind(this));P(this,sg,this.cut.bind(this));P(this,ng,this.paste.bind(this));P(this,rg,this.keydown.bind(this));P(this,ag,this.keyup.bind(this));P(this,og,this.onEditingAction.bind(this));P(this,lg,this.onPageChanging.bind(this));P(this,hg,this.onScaleChanging.bind(this));P(this,cg,this.onRotationChanging.bind(this));P(this,dg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});P(this,so,[0,0]);P(this,On,null);P(this,Dr,null);P(this,ug,null);this._signal=d(this,Sd).signal,S(this,Dr,t),S(this,ug,e),S(this,kd,i),this._eventBus=s,this._eventBus._on("editingaction",d(this,og)),this._eventBus._on("pagechanging",d(this,lg)),this._eventBus._on("scalechanging",d(this,hg)),this._eventBus._on("rotationchanging",d(this,cg)),k(this,at,lR).call(this),k(this,at,uR).call(this),k(this,at,b1).call(this),S(this,Mr,r.annotationStorage),S(this,Kp,r.filterFactory),S(this,jl,a),S(this,Rd,o||null),S(this,Yp,l),S(this,Pd,c||null),this.viewParameters={realScale:ko.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=ad.prototype,e=a=>d(a,Dr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return $t(this,"_keyboardManager",new Em([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&d(a,Dr).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&d(a,Dr).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}destroy(){var t,e,i;(t=d(this,Sd))==null||t.abort(),S(this,Sd,null),this._signal=null,this._eventBus._off("editingaction",d(this,og)),this._eventBus._off("pagechanging",d(this,lg)),this._eventBus._off("scalechanging",d(this,hg)),this._eventBus._off("rotationchanging",d(this,cg));for(const s of d(this,hi).values())s.destroy();d(this,hi).clear(),d(this,Ne).clear(),d(this,Ol).clear(),S(this,ms,null),d(this,Kt).clear(),d(this,tn).destroy(),(e=d(this,kd))==null||e.destroy(),(i=d(this,Fn))==null||i.hide(),S(this,Fn,null),d(this,Dn)&&(clearTimeout(d(this,Dn)),S(this,Dn,null)),d(this,On)&&(clearTimeout(d(this,On)),S(this,On,null))}async mlGuess(t){var e;return((e=d(this,Pd))==null?void 0:e.guess(t))||null}get hasMLManager(){return!!d(this,Pd)}get hcmFilter(){return $t(this,"hcmFilter",d(this,jl)?d(this,Kp).addHCMFilter(d(this,jl).foreground,d(this,jl).background):"none")}get direction(){return $t(this,"direction",getComputedStyle(d(this,Dr)).direction)}get highlightColors(){return $t(this,"highlightColors",d(this,Rd)?new Map(d(this,Rd).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return $t(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){S(this,Zp,t)}editAltText(t){var e;(e=d(this,kd))==null||e.editAltText(this,t)}onPageChanging({pageNumber:t}){S(this,Td,t-1)}focusMainContainer(){d(this,Dr).focus()}findParent(t,e){for(const i of d(this,hi).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(t>=s&&t<=s+a&&e>=r&&e<=r+o)return i}return null}disableUserSelect(t=!1){d(this,ug).classList.toggle("noUserSelect",t)}addShouldRescale(t){d(this,Ol).add(t)}removeShouldRescale(t){d(this,Ol).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ko.PDF_TO_CSS_UNITS;for(const e of d(this,Ol))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a}=e,o=e.toString(),c=k(this,at,Av).call(this,e).closest(".textLayer"),h=this.getSelectionBoxes(c);if(h){e.empty(),d(this,ci)===Wt.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:Wt.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const f of d(this,hi).values())if(f.hasTextLayer(c)){f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a,text:o});break}}}addToAnnotationStorage(t){!t.isEmpty()&&d(this,Mr)&&!d(this,Mr).has(t.id)&&d(this,Mr).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,d(this,eo)&&(S(this,eo,!1),k(this,at,_v).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of d(this,Kt))if(e.div.contains(t)){S(this,Nl,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!d(this,Nl))return;const[t,e]=d(this,Nl);S(this,Nl,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){k(this,at,b1).call(this),k(this,at,y1).call(this)}removeEditListeners(){k(this,at,dR).call(this),k(this,at,w1).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of d(this,en))if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of d(this,en))if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var i;if(t.preventDefault(),(i=d(this,ms))==null||i.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of d(this,Kt)){const r=s.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const a of d(this,en))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){Dt(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const c=s.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)k(this,at,A1).call(this,l);k(this,at,_1).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){Dt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),d(this,ci)!==Wt.NONE&&!this.isEditorHandlingKeyboard&&ad._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,d(this,eo)&&(S(this,eo,!1),k(this,at,_v).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(k(this,at,hR).call(this),k(this,at,y1).call(this),k(this,at,Oi).call(this,{isEditing:d(this,ci)!==Wt.NONE,isEmpty:k(this,at,Ju).call(this),hasSomethingToUndo:d(this,tn).hasSomethingToUndo(),hasSomethingToRedo:d(this,tn).hasSomethingToRedo(),hasSelectedEditor:!1})):(k(this,at,cR).call(this),k(this,at,w1).call(this),k(this,at,Oi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!d(this,en)){S(this,en,t);for(const e of d(this,en))k(this,at,Aa).call(this,e.defaultPropertiesToUpdate)}}getId(){return d(this,aw).id}get currentLayer(){return d(this,hi).get(d(this,Td))}getLayer(t){return d(this,hi).get(t)}get currentPageIndex(){return d(this,Td)}addLayer(t){d(this,hi).set(t.pageIndex,t),d(this,io)?t.enable():t.disable()}removeLayer(t){d(this,hi).delete(t.pageIndex)}updateMode(t,e=null,i=!1){if(d(this,ci)!==t){if(S(this,ci,t),t===Wt.NONE){this.setEditingState(!1),k(this,at,pR).call(this);return}this.setEditingState(!0),k(this,at,fR).call(this),this.unselectAll();for(const s of d(this,hi).values())s.updateMode(t);if(!e&&i){this.addNewEditorFromKeyboard();return}if(e){for(const s of d(this,Ne).values())if(s.annotationElementId===e){this.setSelected(s),s.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==d(this,ci)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var i;if(d(this,en)){switch(t){case kt.CREATE:this.currentLayer.addNewEditor();return;case kt.HIGHLIGHT_DEFAULT_COLOR:(i=d(this,Zp))==null||i.updateColor(e);break;case kt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(d(this,Jp)||S(this,Jp,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const s of d(this,Kt))s.updateParams(t,e);for(const s of d(this,en))s.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){var r;for(const a of d(this,Ne).values())a.editorType===t&&a.show(e);(((r=d(this,Jp))==null?void 0:r.get(kt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&k(this,at,Aa).call(this,[[kt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(d(this,Qp)!==t){S(this,Qp,t);for(const e of d(this,hi).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of d(this,Ne).values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return d(this,Ne).get(t)}addEditor(t){d(this,Ne).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(d(this,Dn)&&clearTimeout(d(this,Dn)),S(this,Dn,setTimeout(()=>{this.focusMainContainer(),S(this,Dn,null)},0))),d(this,Ne).delete(t.id),this.unselect(t),(!t.annotationElementId||!d(this,Fl).has(t.annotationElementId))&&((e=d(this,Mr))==null||e.remove(t.id))}addDeletedAnnotationElement(t){d(this,Fl).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return d(this,Fl).has(t)}removeDeletedAnnotationElement(t){d(this,Fl).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){d(this,ms)!==t&&(S(this,ms,t),t&&k(this,at,Aa).call(this,t.propertiesToUpdate))}updateUI(t){d(this,at,gR)===t&&k(this,at,Aa).call(this,t.propertiesToUpdate)}toggleSelected(t){if(d(this,Kt).has(t)){d(this,Kt).delete(t),t.unselect(),k(this,at,Oi).call(this,{hasSelectedEditor:this.hasSelection});return}d(this,Kt).add(t),t.select(),k(this,at,Aa).call(this,t.propertiesToUpdate),k(this,at,Oi).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of d(this,Kt))e!==t&&e.unselect();d(this,Kt).clear(),d(this,Kt).add(t),t.select(),k(this,at,Aa).call(this,t.propertiesToUpdate),k(this,at,Oi).call(this,{hasSelectedEditor:!0})}isSelected(t){return d(this,Kt).has(t)}get firstSelectedEditor(){return d(this,Kt).values().next().value}unselect(t){t.unselect(),d(this,Kt).delete(t),k(this,at,Oi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return d(this,Kt).size!==0}get isEnterHandled(){return d(this,Kt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){d(this,tn).undo(),k(this,at,Oi).call(this,{hasSomethingToUndo:d(this,tn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:k(this,at,Ju).call(this)})}redo(){d(this,tn).redo(),k(this,at,Oi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:d(this,tn).hasSomethingToRedo(),isEmpty:k(this,at,Ju).call(this)})}addCommands(t){d(this,tn).add(t),k(this,at,Oi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:k(this,at,Ju).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...d(this,Kt)],e=()=>{for(const s of t)s.remove()},i=()=>{for(const s of t)k(this,at,A1).call(this,s)};this.addCommands({cmd:e,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=d(this,ms))==null||t.commitOrRemove()}hasSomethingToControl(){return d(this,ms)||this.hasSelection}selectAll(){for(const t of d(this,Kt))t.commit();k(this,at,_1).call(this,d(this,Ne).values())}unselectAll(){if(!(d(this,ms)&&(d(this,ms).commitOrRemove(),d(this,ci)!==Wt.NONE))&&this.hasSelection){for(const t of d(this,Kt))t.unselect();d(this,Kt).clear(),k(this,at,Oi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;d(this,so)[0]+=t,d(this,so)[1]+=e;const[s,r]=d(this,so),a=[...d(this,Kt)],o=1e3;d(this,On)&&clearTimeout(d(this,On)),S(this,On,setTimeout(()=>{S(this,On,null),d(this,so)[0]=d(this,so)[1]=0,this.addCommands({cmd:()=>{for(const l of a)d(this,Ne).has(l.id)&&l.translateInPage(s,r)},undo:()=>{for(const l of a)d(this,Ne).has(l.id)&&l.translateInPage(-s,-r)},mustExec:!1})},o));for(const l of a)l.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),S(this,In,new Map);for(const t of d(this,Kt))d(this,In).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!d(this,In))return!1;this.disableUserSelect(!1);const t=d(this,In);S(this,In,null);let e=!1;for(const[{x:s,y:r,pageIndex:a},o]of t)o.newX=s,o.newY=r,o.newPageIndex=a,e||(e=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!e)return!1;const i=(s,r,a,o)=>{if(d(this,Ne).has(s.id)){const l=d(this,hi).get(o);l?s._setParentAndPosition(l,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of t)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of t)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(d(this,In))for(const i of d(this,In).keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||d(this,Kt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return d(this,ms)===t}getActive(){return d(this,ms)}getMode(){return d(this,ci)}get imageManager(){return $t(this,"imageManager",new g1)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,h=e.rangeCount;c<h;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,h,f,p)=>({x:(h-s)/a,y:1-(c+f-i)/r,width:p/a,height:f/r});break;case"180":o=(c,h,f,p)=>({x:1-(c+f-i)/r,y:1-(h+p-s)/a,width:f/r,height:p/a});break;case"270":o=(c,h,f,p)=>({x:1-(h+p-s)/a,y:(c-i)/r,width:p/a,height:f/r});break;default:o=(c,h,f,p)=>({x:(c-i)/r,y:(h-s)/a,width:f/r,height:p/a});break}const l=[];for(let c=0,h=e.rangeCount;c<h;c++){const f=e.getRangeAt(c);if(!f.collapsed)for(const{x:p,y:g,width:m,height:b}of f.getClientRects())m===0||b===0||l.push(o(p,g,m,b))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(d(this,Cd)||S(this,Cd,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=d(this,Cd))==null||e.delete(t)}renderAnnotationElement(t){var s;const e=(s=d(this,Cd))==null?void 0:s.get(t.data.id);if(!e)return;const i=d(this,Mr).getRawValue(e);i&&(d(this,ci)===Wt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}};Sd=new WeakMap,ms=new WeakMap,Ne=new WeakMap,hi=new WeakMap,kd=new WeakMap,Mr=new WeakMap,Cd=new WeakMap,tn=new WeakMap,Td=new WeakMap,Fl=new WeakMap,In=new WeakMap,en=new WeakMap,Ol=new WeakMap,Yp=new WeakMap,Kp=new WeakMap,Dn=new WeakMap,Rd=new WeakMap,eo=new WeakMap,Fn=new WeakMap,aw=new WeakMap,io=new WeakMap,Qp=new WeakMap,Nl=new WeakMap,Zp=new WeakMap,Pd=new WeakMap,ci=new WeakMap,Kt=new WeakMap,Ir=new WeakMap,jl=new WeakMap,Jp=new WeakMap,tg=new WeakMap,eg=new WeakMap,ig=new WeakMap,sg=new WeakMap,ng=new WeakMap,rg=new WeakMap,ag=new WeakMap,og=new WeakMap,lg=new WeakMap,hg=new WeakMap,cg=new WeakMap,dg=new WeakMap,so=new WeakMap,On=new WeakMap,Dr=new WeakMap,ug=new WeakMap,at=new WeakSet,Av=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},aR=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=k(this,at,Av).call(this,t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(d(this,Fn)||S(this,Fn,new wD(this)),d(this,Fn).show(i,s,this.direction==="ltr"))},oR=function(){var r,a,o;const t=document.getSelection();if(!t||t.isCollapsed){d(this,Ir)&&((r=d(this,Fn))==null||r.hide(),S(this,Ir,null),k(this,at,Oi).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===d(this,Ir))return;if(!k(this,at,Av).call(this,t).closest(".textLayer")){d(this,Ir)&&((a=d(this,Fn))==null||a.hide(),S(this,Ir,null),k(this,at,Oi).call(this,{hasSelectedText:!1}));return}if((o=d(this,Fn))==null||o.hide(),S(this,Ir,e),k(this,at,Oi).call(this,{hasSelectedText:!0}),!(d(this,ci)!==Wt.HIGHLIGHT&&d(this,ci)!==Wt.NONE)&&(d(this,ci)===Wt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),S(this,eo,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=this._signal,c=h=>{h.type==="pointerup"&&h.button!==0||(window.removeEventListener("pointerup",c),window.removeEventListener("blur",c),h.type==="pointerup"&&k(this,at,_v).call(this,"main_toolbar"))};window.addEventListener("pointerup",c,{signal:l}),window.addEventListener("blur",c,{signal:l})}},_v=function(t=""){d(this,ci)===Wt.HIGHLIGHT?this.highlightSelection(t):d(this,Yp)&&k(this,at,aR).call(this)},lR=function(){document.addEventListener("selectionchange",k(this,at,oR).bind(this),{signal:this._signal})},hR=function(){const t=this._signal;window.addEventListener("focus",d(this,eg),{signal:t}),window.addEventListener("blur",d(this,tg),{signal:t})},cR=function(){window.removeEventListener("focus",d(this,eg)),window.removeEventListener("blur",d(this,tg))},b1=function(){const t=this._signal;window.addEventListener("keydown",d(this,rg),{signal:t}),window.addEventListener("keyup",d(this,ag),{signal:t})},dR=function(){window.removeEventListener("keydown",d(this,rg)),window.removeEventListener("keyup",d(this,ag))},y1=function(){const t=this._signal;document.addEventListener("copy",d(this,ig),{signal:t}),document.addEventListener("cut",d(this,sg),{signal:t}),document.addEventListener("paste",d(this,ng),{signal:t})},w1=function(){document.removeEventListener("copy",d(this,ig)),document.removeEventListener("cut",d(this,sg)),document.removeEventListener("paste",d(this,ng))},uR=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Oi=function(t){Object.entries(t).some(([i,s])=>d(this,dg)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(d(this,dg),t)}),d(this,ci)===Wt.HIGHLIGHT&&t.hasSelectedEditor===!1&&k(this,at,Aa).call(this,[[kt.HIGHLIGHT_FREE,!0]]))},Aa=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},fR=function(){if(!d(this,io)){S(this,io,!0);for(const t of d(this,hi).values())t.enable();for(const t of d(this,Ne).values())t.enable()}},pR=function(){if(this.unselectAll(),d(this,io)){S(this,io,!1);for(const t of d(this,hi).values())t.disable();for(const t of d(this,Ne).values())t.disable()}},A1=function(t){const e=d(this,hi).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},gR=function(){let t=null;for(t of d(this,Kt));return t},Ju=function(){if(d(this,Ne).size===0)return!0;if(d(this,Ne).size===1)for(const t of d(this,Ne).values())return t.isEmpty();return!1},_1=function(t){for(const e of d(this,Kt))e.unselect();d(this,Kt).clear();for(const e of t)e.isEmpty()||(d(this,Kt).add(e),e.select());k(this,at,Oi).call(this,{hasSelectedEditor:this.hasSelection})},Pt(ad,"TRANSLATE_SMALL",1),Pt(ad,"TRANSLATE_BIG",10);let Ch=ad;var Fr,Or,sn,Nr,vs,Ld,nn,fg,E1;const kr=class kr{constructor(t){P(this,fg);P(this,Fr,"");P(this,Or,!1);P(this,sn,null);P(this,Nr,null);P(this,vs,null);P(this,Ld,!1);P(this,nn,null);S(this,nn,t)}static initialize(t){kr._l10nPromise||(kr._l10nPromise=t)}async render(){const t=S(this,sn,document.createElement("button"));t.className="altText";const e=await kr._l10nPromise.get("pdfjs-editor-alt-text-button-label");t.textContent=e,t.setAttribute("aria-label",e),t.tabIndex="0";const i=d(this,nn)._uiManager._signal;t.addEventListener("contextmenu",as,{signal:i}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),d(this,nn)._uiManager.editAltText(d(this,nn))};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(S(this,Ld,!0),s(r))},{signal:i}),await k(this,fg,E1).call(this),t}finish(){d(this,sn)&&(d(this,sn).focus({focusVisible:d(this,Ld)}),S(this,Ld,!1))}isEmpty(){return!d(this,Fr)&&!d(this,Or)}get data(){return{altText:d(this,Fr),decorative:d(this,Or)}}set data({altText:t,decorative:e}){d(this,Fr)===t&&d(this,Or)===e||(S(this,Fr,t),S(this,Or,e),k(this,fg,E1).call(this))}toggle(t=!1){d(this,sn)&&(!t&&d(this,vs)&&(clearTimeout(d(this,vs)),S(this,vs,null)),d(this,sn).disabled=!t)}destroy(){var t;(t=d(this,sn))==null||t.remove(),S(this,sn,null),S(this,Nr,null)}};Fr=new WeakMap,Or=new WeakMap,sn=new WeakMap,Nr=new WeakMap,vs=new WeakMap,Ld=new WeakMap,nn=new WeakMap,fg=new WeakSet,E1=async function(){var s;const t=d(this,sn);if(!t)return;if(!d(this,Fr)&&!d(this,Or)){t.classList.remove("done"),(s=d(this,Nr))==null||s.remove();return}t.classList.add("done"),kr._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(r=>{t.setAttribute("aria-label",r)});let e=d(this,Nr);if(!e){S(this,Nr,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip");const r=e.id=`alt-text-tooltip-${d(this,nn).id}`;t.setAttribute("aria-describedby",r);const a=100,o=d(this,nn)._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(d(this,vs)),S(this,vs,null)},{once:!0}),t.addEventListener("mouseenter",()=>{S(this,vs,setTimeout(()=>{S(this,vs,null),d(this,Nr).classList.add("show"),d(this,nn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:o}),t.addEventListener("mouseleave",()=>{var l;d(this,vs)&&(clearTimeout(d(this,vs)),S(this,vs,null)),(l=d(this,Nr))==null||l.classList.remove("show")},{signal:o})}e.innerText=d(this,Or)?await kr._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):d(this,Fr),e.parentNode||t.append(e);const i=d(this,nn).getImageForAltText();i==null||i.setAttribute("aria-describedby",e.id)},Pt(kr,"_l10nPromise",null);let Xb=kr;var Bl,rn,Ei,Md,Wl,di,Hl,Id,Dd,xi,pg,$l,no,gg,Ul,jr,Nn,Fd,Od,Fs,mg,ow,Ot,x1,vg,S1,k1,mR,vR,C1,T1,R1,bR,yR,wR,AR,P1,tf;const ne=class ne{constructor(t){P(this,Ot);P(this,Bl,null);P(this,rn,null);P(this,Ei,null);P(this,Md,!1);P(this,Wl,!1);P(this,di,null);P(this,Hl,null);P(this,Id,this.focusin.bind(this));P(this,Dd,this.focusout.bind(this));P(this,xi,null);P(this,pg,"");P(this,$l,!1);P(this,no,null);P(this,gg,!1);P(this,Ul,!1);P(this,jr,!1);P(this,Nn,null);P(this,Fd,0);P(this,Od,0);P(this,Fs,null);Pt(this,"_initialOptions",Object.create(null));Pt(this,"_isVisible",!0);Pt(this,"_uiManager",null);Pt(this,"_focusEventsAllowed",!0);Pt(this,"_l10nPromise",null);P(this,mg,!1);P(this,ow,ne._zIndex++);this.constructor===ne&&te("Cannot initialize AnnotationEditor."),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=ne.prototype._resizeWithKeyboard,e=Ch.TRANSLATE_SMALL,i=Ch.TRANSLATE_BIG;return $t(this,"_resizerKeyboardManager",new Em([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],ne.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return $t(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new xD({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e,i){if(ne._l10nPromise||(ne._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(r=>[r,t.get(r.replaceAll(/([A-Z])/g,a=>`-${a.toLowerCase()}`))]))),i!=null&&i.strings)for(const r of i.strings)ne._l10nPromise.set(r,t.get(r));if(ne._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ne._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){te("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return d(this,mg)}set _isDraggable(t){var e;S(this,mg,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=d(this,ow)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):k(this,Ot,tf).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(d(this,$l)?S(this,$l,!1):this.parent.setSelected(this))}focusout(t){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/r,this.y=(e+s)/a,this.fixAndSetPosition()}translate(t,e){k(this,Ot,x1).call(this,this.parentDimensions,t,e)}translateInPage(t,e){d(this,no)||S(this,no,[this.x,this.y]),k(this,Ot,x1).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){d(this,no)||S(this,no,[this.x,this.y]);const[i,s]=this.parentDimensions;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:a}=this;const[o,l]=this.getBaseTranslation();r+=o,a+=l,this.div.style.left=`${(100*r).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!d(this,no)&&(d(this,no)[0]!==this.x||d(this,no)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=ne,s=i/t,r=i/e;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:s,y:r,width:a,height:o}=this;if(a*=e,o*=i,s*=e,r*=i,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(e-a,s)),r=Math.max(0,Math.min(i-o,r));break;case 90:s=Math.max(0,Math.min(e-o,s)),r=Math.min(i,Math.max(a,r));break;case 180:s=Math.min(e,Math.max(a,s)),r=Math.min(i,Math.max(o,r));break;case 270:s=Math.min(e,Math.max(o,s)),r=Math.max(0,Math.min(i-a,r));break}this.x=s/=e,this.y=r/=i;const[l,c]=this.getBaseTranslation();s+=l,r+=c;const{style:h}=this.div;h.left=`${(100*s).toFixed(2)}%`,h.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return k(i=ne,vg,S1).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return k(i=ne,vg,S1).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this,s=e*t,r=i*t;return ns.isCSSRoundSupported?[Math.round(s),Math.round(r)]:[s,r]}setDims(t,e){const[i,s]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,d(this,Wl)||(this.div.style.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),r=!d(this,Wl)&&e.endsWith("%");if(s&&r)return;const[a,o]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!d(this,Wl)&&!r&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=d(this,Ei))==null||t.finish()}async addEditToolbar(){return d(this,xi)||d(this,Ul)?d(this,xi):(S(this,xi,new f1(this)),this.div.append(d(this,xi).render()),d(this,Ei)&&d(this,xi).addAltTextButton(await d(this,Ei).render()),d(this,xi))}removeEditToolbar(){var t;d(this,xi)&&(d(this,xi).remove(),S(this,xi,null),(t=d(this,Ei))==null||t.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){d(this,Ei)||(Xb.initialize(ne._l10nPromise),S(this,Ei,new Xb(this)),d(this,Bl)&&(d(this,Ei).data=d(this,Bl),S(this,Bl,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=d(this,Ei))==null?void 0:t.data}set altTextData(t){d(this,Ei)&&(d(this,Ei).data=t)}hasAltText(){var t;return!((t=d(this,Ei))!=null&&t.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=d(this,Md)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground();const t=this._uiManager._signal;this.div.addEventListener("focusin",d(this,Id),{signal:t}),this.div.addEventListener("focusout",d(this,Dd),{signal:t});const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*i/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),qb(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=ns.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(S(this,$l,!0),this._isDraggable){k(this,Ot,bR).call(this,t);return}k(this,Ot,R1).call(this,t)}moveInDOM(){d(this,Nn)&&clearTimeout(d(this,Nn)),S(this,Nn,setTimeout(()=>{var t;S(this,Nn,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=t/s,h=e/s,f=this.x*r,p=this.y*a,g=this.width*r,m=this.height*a;switch(i){case 0:return[f+c+o,a-p-h-m+l,f+c+g+o,a-p-h+l];case 90:return[f+h+o,a-p+c+l,f+h+m+o,a-p+c+g+l];case 180:return[f-c-g+o,a-p+h+l,f-c+o,a-p+h+m+l];case 270:return[f-h-m+o,a-p-c-g+l,f-h+o,a-p-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,r,a]=t,o=r-i,l=a-s;switch(this.rotation){case 0:return[i,e-a,o,l];case 90:return[i,e-s,l,o];case 180:return[r,e-s,o,l];case 270:return[r,e-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){S(this,Ul,!0)}disableEditMode(){S(this,Ul,!1)}isInEditMode(){return d(this,Ul)}shouldGetKeyboardEvents(){return d(this,jr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var e,i;const t=this._uiManager._signal;(e=this.div)==null||e.addEventListener("focusin",d(this,Id),{signal:t}),(i=this.div)==null||i.addEventListener("focusout",d(this,Dd),{signal:t})}rotate(t){}serialize(t=!1,e=null){te("An editor must be serializable")}static deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});s.rotation=t.rotation,S(s,Bl,t.accessibilityData);const[r,a]=s.pageDimensions,[o,l,c,h]=s.getRectInCurrentCoords(t.rect,a);return s.x=o/r,s.y=l/a,s.width=c/r,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",d(this,Id)),this.div.removeEventListener("focusout",d(this,Dd)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),d(this,Nn)&&(clearTimeout(d(this,Nn)),S(this,Nn,null)),k(this,Ot,tf).call(this),this.removeEditToolbar(),d(this,Fs)){for(const t of d(this,Fs).values())clearTimeout(t);S(this,Fs,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(k(this,Ot,mR).call(this),d(this,di).classList.remove("hidden"),qb(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),S(this,Hl,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=d(this,di).children;if(!d(this,rn)){S(this,rn,Array.from(e));const a=k(this,Ot,yR).bind(this),o=k(this,Ot,wR).bind(this),l=this._uiManager._signal;for(const c of d(this,rn)){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",k(this,Ot,AR).bind(this,h),{signal:l}),ne._l10nPromise.get(`pdfjs-editor-resizer-label-${h}`).then(f=>c.setAttribute("aria-label",f))}}const i=d(this,rn)[0];let s=0;for(const a of e){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(d(this,rn).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)d(this,di).append(d(this,di).firstChild);else if(r>s)for(let o=0;o<r-s;o++)d(this,di).firstChild.before(d(this,di).lastChild);let a=0;for(const o of e){const c=d(this,rn)[a++].getAttribute("data-resizer-name");ne._l10nPromise.get(`pdfjs-editor-resizer-label-${c}`).then(h=>o.setAttribute("aria-label",h))}}k(this,Ot,P1).call(this,0),S(this,jr,!0),d(this,di).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){d(this,jr)&&k(this,Ot,T1).call(this,d(this,pg),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){k(this,Ot,tf).call(this),this.div.focus()}select(){var t,e;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!d(this,xi)){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=d(this,xi))==null||s.show())});return}(e=d(this,xi))==null||e.show()}unselect(){var t,e,i,s;(t=d(this,di))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=d(this,xi))==null||s.hide()}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return d(this,gg)}set isEditing(t){S(this,gg,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){S(this,Wl,!0);const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){d(this,Fs)||S(this,Fs,new Map);const{action:i}=t;let s=d(this,Fs).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),d(this,Fs).delete(i),d(this,Fs).size===0&&S(this,Fs,null)},ne._telemetryTimeout),d(this,Fs).set(i,s);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),S(this,Md,!1)}disable(){this.div&&(this.div.tabIndex=-1),S(this,Md,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Bl=new WeakMap,rn=new WeakMap,Ei=new WeakMap,Md=new WeakMap,Wl=new WeakMap,di=new WeakMap,Hl=new WeakMap,Id=new WeakMap,Dd=new WeakMap,xi=new WeakMap,pg=new WeakMap,$l=new WeakMap,no=new WeakMap,gg=new WeakMap,Ul=new WeakMap,jr=new WeakMap,Nn=new WeakMap,Fd=new WeakMap,Od=new WeakMap,Fs=new WeakMap,mg=new WeakMap,ow=new WeakMap,Ot=new WeakSet,x1=function([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this.fixAndSetPosition()},vg=new WeakSet,S1=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},k1=function(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}},mR=function(){if(d(this,di))return;S(this,di,document.createElement("div")),d(this,di).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");d(this,di).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",k(this,Ot,vR).bind(this,i),{signal:e}),s.addEventListener("contextmenu",as,{signal:e}),s.tabIndex=-1}this.div.prepend(d(this,di))},vR=function(t,e){var b;e.preventDefault();const{isMac:i}=ns.platform;if(e.button!==0||e.ctrlKey&&i)return;(b=d(this,Ei))==null||b.toggle(!1);const s=k(this,Ot,T1).bind(this,t),r=this._isDraggable;this._isDraggable=!1;const a=this._uiManager._signal,o={passive:!0,capture:!0,signal:a};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",s,o),window.addEventListener("contextmenu",as,{signal:a});const l=this.x,c=this.y,h=this.width,f=this.height,p=this.parent.div.style.cursor,g=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const m=()=>{var y;this.parent.togglePointerEvents(!0),(y=d(this,Ei))==null||y.toggle(!0),this._isDraggable=r,window.removeEventListener("pointerup",m),window.removeEventListener("blur",m),window.removeEventListener("pointermove",s,o),window.removeEventListener("contextmenu",as),this.parent.div.style.cursor=p,this.div.style.cursor=g,k(this,Ot,C1).call(this,l,c,h,f)};window.addEventListener("pointerup",m,{signal:a}),window.addEventListener("blur",m,{signal:a})},C1=function(t,e,i,s){const r=this.x,a=this.y,o=this.width,l=this.height;r===t&&a===e&&o===i&&l===s||this.addCommands({cmd:()=>{this.width=o,this.height=l,this.x=r,this.y=a;const[c,h]=this.parentDimensions;this.setDims(c*o,h*l),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=s,this.x=t,this.y=e;const[c,h]=this.parentDimensions;this.setDims(c*i,h*s),this.fixAndSetPosition()},mustExec:!0})},T1=function(t,e){const[i,s]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,c=ne.MIN_SIZE/i,h=ne.MIN_SIZE/s,f=H=>Math.round(H*1e4)/1e4,p=k(this,Ot,k1).call(this,this.rotation),g=(H,Q)=>[p[0]*H+p[2]*Q,p[1]*H+p[3]*Q],m=k(this,Ot,k1).call(this,360-this.rotation),b=(H,Q)=>[m[0]*H+m[2]*Q,m[1]*H+m[3]*Q];let y,w,x=!1,R=!1;switch(t){case"topLeft":x=!0,y=(H,Q)=>[0,0],w=(H,Q)=>[H,Q];break;case"topMiddle":y=(H,Q)=>[H/2,0],w=(H,Q)=>[H/2,Q];break;case"topRight":x=!0,y=(H,Q)=>[H,0],w=(H,Q)=>[0,Q];break;case"middleRight":R=!0,y=(H,Q)=>[H,Q/2],w=(H,Q)=>[0,Q/2];break;case"bottomRight":x=!0,y=(H,Q)=>[H,Q],w=(H,Q)=>[0,0];break;case"bottomMiddle":y=(H,Q)=>[H/2,Q],w=(H,Q)=>[H/2,0];break;case"bottomLeft":x=!0,y=(H,Q)=>[0,Q],w=(H,Q)=>[H,0];break;case"middleLeft":R=!0,y=(H,Q)=>[0,Q/2],w=(H,Q)=>[H,Q/2];break}const I=y(o,l),D=w(o,l);let F=g(...D);const O=f(r+F[0]),L=f(a+F[1]);let M=1,W=1,[j,V]=this.screenToPageTranslation(e.movementX,e.movementY);if([j,V]=b(j/i,V/s),x){const H=Math.hypot(o,l);M=W=Math.max(Math.min(Math.hypot(D[0]-I[0]-j,D[1]-I[1]-V)/H,1/o,1/l),c/o,h/l)}else R?M=Math.max(c,Math.min(1,Math.abs(D[0]-I[0]-j)))/o:W=Math.max(h,Math.min(1,Math.abs(D[1]-I[1]-V)))/l;const z=f(o*M),Y=f(l*W);F=g(...w(z,Y));const K=O-F[0],G=L-F[1];this.width=z,this.height=Y,this.x=K,this.y=G,this.setDims(i*z,s*Y),this.fixAndSetPosition()},R1=function(t){const{isMac:e}=ns.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},bR=function(t){const e=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let i,s;const r=this._uiManager._signal;e&&(this.div.classList.add("moving"),i={passive:!0,capture:!0,signal:r},S(this,Fd,t.clientX),S(this,Od,t.clientY),s=o=>{const{clientX:l,clientY:c}=o,[h,f]=this.screenToPageTranslation(l-d(this,Fd),c-d(this,Od));S(this,Fd,l),S(this,Od,c),this._uiManager.dragSelectedEditors(h,f)},window.addEventListener("pointermove",s,i));const a=()=>{window.removeEventListener("pointerup",a),window.removeEventListener("blur",a),e&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",s,i)),S(this,$l,!1),this._uiManager.endDragSession()||k(this,Ot,R1).call(this,t)};window.addEventListener("pointerup",a,{signal:r}),window.addEventListener("blur",a,{signal:r})},yR=function(t){ne._resizerKeyboardManager.exec(this,t)},wR=function(t){var e;d(this,jr)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==d(this,di)&&k(this,Ot,tf).call(this)},AR=function(t){S(this,pg,d(this,jr)?t:"")},P1=function(t){if(d(this,rn))for(const e of d(this,rn))e.tabIndex=t},tf=function(){if(S(this,jr,!1),k(this,Ot,P1).call(this,-1),d(this,Hl)){const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=d(this,Hl);k(this,Ot,C1).call(this,t,e,i,s),S(this,Hl,null)}},P(ne,vg),Pt(ne,"_borderLineWidth",-1),Pt(ne,"_colorManager",new v1),Pt(ne,"_zIndex",1),Pt(ne,"_telemetryTimeout",1e3);let Qt=ne;class xD extends Qt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const Rk=3285377520,ks=4294901760,mn=65535;class _R{constructor(t){this.h1=t?t&4294967295:Rk,this.h2=t?t&4294967295:Rk}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let b=0,y=t.length;b<y;b++){const w=t.charCodeAt(b);w<=255?e[i++]=w:(e[i++]=w>>>8,e[i++]=w&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(e.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const f=3432918353,p=461845907,g=f&mn,m=p&mn;for(let b=0;b<s;b++)b&1?(o=a[b],o=o*f&ks|o*g&mn,o=o<<15|o>>>17,o=o*p&ks|o*m&mn,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[b],l=l*f&ks|l*g&mn,l=l<<15|l>>>17,l=l*p&ks|l*m&mn,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=e[s*4+2]<<16;case 2:o^=e[s*4+1]<<8;case 1:o^=e[s*4],o=o*f&ks|o*g&mn,o=o<<15|o>>>17,o=o*p&ks|o*m&mn,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&ks|t*36045&mn,e=e*4283543511&ks|((e<<16|t>>>16)*2950163797&ks)>>>16,t^=e>>>1,t=t*444984403&ks|t*60499&mn,e=e*3301882366&ks|((e<<16|t>>>16)*3120437893&ks)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const L1=Object.freeze({map:null,hash:"",transfer:void 0});var zl,ui,lw,ER;class PS{constructor(){P(this,lw);P(this,zl,!1);P(this,ui,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=d(this,ui).get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return d(this,ui).get(t)}remove(t){if(d(this,ui).delete(t),d(this,ui).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of d(this,ui).values())if(e instanceof Qt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=d(this,ui).get(t);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(e))i[r]!==a&&(s=!0,i[r]=a);else s=!0,d(this,ui).set(t,e);s&&k(this,lw,ER).call(this),e instanceof Qt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return d(this,ui).has(t)}getAll(){return d(this,ui).size>0?ES(d(this,ui)):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return d(this,ui).size}resetModified(){d(this,zl)&&(S(this,zl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new xR(this)}get serializable(){if(d(this,ui).size===0)return L1;const t=new Map,e=new _R,i=[],s=Object.create(null);let r=!1;for(const[a,o]of d(this,ui)){const l=o instanceof Qt?o.serialize(!1,s):o;l&&(t.set(a,l),e.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:L1}get editorStats(){let t=null;const e=new Map;for(const i of d(this,ui).values()){if(!(i instanceof Qt))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;e.has(r)||e.set(r,Object.getPrototypeOf(i).constructor),t||(t=Object.create(null));const a=t[r]||(t[r]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[i,s]of e)t[i]=s.computeTelemetryFinalData(t[i]);return t}}zl=new WeakMap,ui=new WeakMap,lw=new WeakSet,ER=function(){d(this,zl)||(S(this,zl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var bg;class xR extends PS{constructor(e){super();P(this,bg);const{map:i,hash:s,transfer:r}=e.serializable,a=structuredClone(i,r?{transfer:r}:null);S(this,bg,{map:a,hash:s,transfer:r})}get print(){te("Should not call PrintAnnotationStorage.print")}get serializable(){return d(this,bg)}}bg=new WeakMap;var Nd;class SD{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){P(this,Nd,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),d(this,Nd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||d(this,Nd).has(t.loadedName))){if($e(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:r}=t,a=new FontFace(i,s,r);this.addNativeFontFace(a);try{await a.load(),d(this,Nd).add(i),e==null||e(t)}catch{Dt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}te("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw Dt(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return $t(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Ii||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),$t(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for($e(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return $t(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(I,D){return I.charCodeAt(D)<<24|I.charCodeAt(D+1)<<16|I.charCodeAt(D+2)<<8|I.charCodeAt(D+3)&255}function s(I,D,F,O){const L=I.substring(0,D),M=I.substring(D+F);return L+O+M}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(I,D){if(++c>30){Dt("Load test font never loaded."),D();return}if(l.font="30px "+I,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(h.bind(null,I,D))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=s(p,976,f.length,f);const m=16,b=1482184792;let y=i(p,m);for(r=0,a=f.length-3;r<a;r+=4)y=y-b+i(f,r)|0;r<f.length&&(y=y-b+i(f+"XXX",r)|0),p=s(p,m,4,lD(y));const w=`url(data:font/opentype;base64,${btoa(p)});`,x=`@font-face {font-family:"${f}";src:${w}}`;this.insertRule(x);const R=this._document.createElement("div");R.style.visibility="hidden",R.style.width=R.style.height="10px",R.style.position="absolute",R.style.top=R.style.left="0px";for(const I of[t.loadedName,f]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=I,R.append(D)}this._document.body.append(R),h(f,()=>{R.remove(),e.complete()})}}Nd=new WeakMap;class kD{constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=e===!0,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const t=VT(this.data),e=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),i}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(r){Dt(`getPathGenerator - ignoring character: "${r}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[e]=function(r,a){};const s=[];for(let r=0,a=i.length;r<a;)switch(i[r++]){case nr.BEZIER_CURVE_TO:{const[o,l,c,h,f,p]=i.slice(r,r+6);s.push(g=>g.bezierCurveTo(o,l,c,h,f,p)),r+=6}break;case nr.MOVE_TO:{const[o,l]=i.slice(r,r+2);s.push(c=>c.moveTo(o,l)),r+=2}break;case nr.LINE_TO:{const[o,l]=i.slice(r,r+2);s.push(c=>c.lineTo(o,l)),r+=2}break;case nr.QUADRATIC_CURVE_TO:{const[o,l,c,h]=i.slice(r,r+4);s.push(f=>f.quadraticCurveTo(o,l,c,h)),r+=4}break;case nr.RESTORE:s.push(o=>o.restore());break;case nr.SAVE:s.push(o=>o.save());break;case nr.SCALE:$e(s.length===2,"Scale command is only valid at the third position.");break;case nr.TRANSFORM:{const[o,l,c,h,f,p]=i.slice(r,r+6);s.push(g=>g.transform(o,l,c,h,f,p)),r+=6}break;case nr.TRANSLATE:{const[o,l]=i.slice(r,r+2);s.push(c=>c.translate(o,l)),r+=2}break}return this.compiledGlyphs[e]=function(a,o){s[0](a),s[1](a),a.scale(o,-o);for(let l=2,c=s.length;l<c;l++)s[l](a)}}}if(Ii){var M1=Promise.withResolvers(),cp=null;(async()=>{const t=await _o(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),e=await _o(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await _o(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),s=await _o(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);let r,a;return new Map(Object.entries({fs:t,http:e,https:i,url:s,canvas:r,path2d:a}))})().then(t=>{cp=t,M1.resolve()},t=>{Dt(`loadPackages: ${t}`),cp=new Map,M1.resolve()})}class tr{static get promise(){return M1.promise}static get(t){return cp==null?void 0:cp.get(t)}}const SR=function(n){return tr.get("fs").promises.readFile(n).then(e=>new Uint8Array(e))};class CD extends Ew{}class TD extends Gb{_createCanvas(t,e){return tr.get("canvas").createCanvas(t,e)}}class RD extends xw{_fetchData(t,e){return SR(t).then(i=>({cMapData:i,compressionType:e}))}}class PD extends Sw{_fetchData(t){return SR(t)}}const Hi={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function I1(n,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),n.clip(s)}class xm{constructor(){this.constructor===xm&&te("Cannot initialize BaseShadingPattern.")}getPattern(){te("Abstract method `getPattern` called.")}}class LD extends xm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let r;if(s===Hi.STROKE||s===Hi.FILL){const a=e.current.getClippedPathBoundingBox(s,ye(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,l,!0),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=pt.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),I1(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=t.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(i);r.setTransform(f)}else I1(t,this._bbox),r=this._createGradient(t);return r}}function fA(n,t,e,i,s,r,a,o){const l=t.coords,c=t.colors,h=n.data,f=n.width*4;let p;l[e+1]>l[i+1]&&(p=e,e=i,i=p,p=r,r=a,a=p),l[i+1]>l[s+1]&&(p=i,i=s,s=p,p=a,a=o,o=p),l[e+1]>l[i+1]&&(p=e,e=i,i=p,p=r,r=a,a=p);const g=(l[e]+t.offsetX)*t.scaleX,m=(l[e+1]+t.offsetY)*t.scaleY,b=(l[i]+t.offsetX)*t.scaleX,y=(l[i+1]+t.offsetY)*t.scaleY,w=(l[s]+t.offsetX)*t.scaleX,x=(l[s+1]+t.offsetY)*t.scaleY;if(m>=x)return;const R=c[r],I=c[r+1],D=c[r+2],F=c[a],O=c[a+1],L=c[a+2],M=c[o],W=c[o+1],j=c[o+2],V=Math.round(m),z=Math.round(x);let Y,K,G,H,Q,Z,yt,bt;for(let X=V;X<=z;X++){if(X<y){const st=X<m?0:(m-X)/(m-y);Y=g-(g-b)*st,K=R-(R-F)*st,G=I-(I-O)*st,H=D-(D-L)*st}else{let st;X>x?st=1:y===x?st=0:st=(y-X)/(y-x),Y=b-(b-w)*st,K=F-(F-M)*st,G=O-(O-W)*st,H=L-(L-j)*st}let nt;X<m?nt=0:X>x?nt=1:nt=(m-X)/(m-x),Q=g-(g-w)*nt,Z=R-(R-M)*nt,yt=I-(I-W)*nt,bt=D-(D-j)*nt;const ht=Math.round(Math.min(Y,Q)),lt=Math.round(Math.max(Y,Q));let ct=f*X+ht*4;for(let st=ht;st<=lt;st++)nt=(Y-st)/(Y-Q),nt<0?nt=0:nt>1&&(nt=1),h[ct++]=K-(K-Z)*nt|0,h[ct++]=G-(G-yt)*nt|0,h[ct++]=H-(H-bt)*nt|0,h[ct++]=255}}function MD(n,t,e){const i=t.coords,s=t.colors;let r,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let h=r*o;for(let f=0;f<c;f++,h++)fA(n,e,i[h],i[h+1],i[h+o],s[h],s[h+1],s[h+o]),fA(n,e,i[h+o+1],i[h+1],i[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)fA(n,e,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class ID extends xm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*t[1]*1.1)),3e3),g=c/f,m=h/p,b={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/g,scaleY:1/m},y=f+2*2,w=p+2*2,x=i.getCanvas("mesh",y,w,!1),R=x.context,I=R.createImageData(f,p);if(e){const F=I.data;for(let O=0,L=F.length;O<L;O+=4)F[O]=e[0],F[O+1]=e[1],F[O+2]=e[2],F[O+3]=255}for(const F of this._figures)MD(I,F,b);return R.putImageData(I,2,2),{canvas:x.canvas,offsetX:o-2*g,offsetY:l-2*m,scaleX:g,scaleY:m}}getPattern(t,e,i,s){I1(t,this._bbox);let r;if(s===Hi.SHADING)r=pt.singularValueDecompose2dScale(ye(t));else if(r=pt.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=pt.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,s===Hi.SHADING?null:this._background,e.cachedCanvases);return s!==Hi.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class DD extends xm{getPattern(){return"hotpink"}}function FD(n){switch(n[0]){case"RadialAxial":return new LD(n);case"Mesh":return new ID(n);case"Dummy":return new DD}throw new Error(`Unknown IR type: ${n[0]}`)}const Pk={COLORED:1,UNCOLORED:2},hw=class hw{constructor(t,e,i,s,r){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t){const e=this.operatorList,i=this.bbox,s=this.xstep,r=this.ystep,a=this.paintType,o=this.tilingType,l=this.color,c=this.canvasGraphicsFactory;ww("TilingType: "+o);const h=i[0],f=i[1],p=i[2],g=i[3],m=pt.singularValueDecompose2dScale(this.matrix),b=pt.singularValueDecompose2dScale(this.baseTransform),y=[m[0]*b[0],m[1]*b[1]],w=this.getSizeAndScale(s,this.ctx.canvas.width,y[0]),x=this.getSizeAndScale(r,this.ctx.canvas.height,y[1]),R=t.cachedCanvases.getCanvas("pattern",w.size,x.size,!0),I=R.context,D=c.createCanvasGraphics(I);D.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(D,a,l);let F=h,O=f,L=p,M=g;return h<0&&(F=0,L+=Math.abs(h)),f<0&&(O=0,M+=Math.abs(f)),I.translate(-(w.scale*F),-(x.scale*O)),D.transform(w.scale,0,0,x.scale,0,0),I.save(),this.clipBbox(D,F,O,L,M),D.baseTransform=ye(D.ctx),D.executeOperatorList(e),D.endDrawing(),{canvas:R.canvas,scaleX:w.scale,scaleY:x.scale,offsetX:F,offsetY:O}}getSizeAndScale(t,e,i){t=Math.abs(t);const s=Math.max(hw.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*i);return r>=s?r=s:i=r/t,{scale:i,size:r}}clipBbox(t,e,i,s,r){const a=s-e,o=r-i;t.ctx.rect(e,i,a,o),t.current.updateRectMinMax(ye(t.ctx),[e,i,s,r]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,r=t.current;switch(e){case Pk.COLORED:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Pk.UNCOLORED:const o=pt.makeHexColor(i[0],i[1],i[2]);s.fillStyle=o,s.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new oD(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,s){let r=i;s!==Hi.SHADING&&(r=pt.transform(r,e.baseTransform),this.matrix&&(r=pt.transform(r,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Pt(hw,"MAX_PATTERN_SIZE",3e3);let D1=hw;function OD({src:n,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=ns.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,f=i&7,p=n.length;e=new Uint32Array(e.buffer);let g=0;for(let m=0;m<s;m++){for(const y=t+h;t<y;t++){const w=t<p?n[t]:255;e[g++]=w&128?c:l,e[g++]=w&64?c:l,e[g++]=w&32?c:l,e[g++]=w&16?c:l,e[g++]=w&8?c:l,e[g++]=w&4?c:l,e[g++]=w&2?c:l,e[g++]=w&1?c:l}if(f===0)continue;const b=t<p?n[t++]:255;for(let y=0;y<f;y++)e[g++]=b&1<<7-y?c:l}return{srcPos:t,destPos:g}}const Lk=16,Mk=100,ND=15,Ik=10,Dk=1e3,Ji=16;function jD(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},n.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},n.transform=function(i,s,r,a,o,l){t.transform(i,s,r,a,o,l),this.__originalTransform(i,s,r,a,o,l)},n.setTransform=function(i,s,r,a,o,l){t.setTransform(i,s,r,a,o,l),this.__originalSetTransform(i,s,r,a,o,l)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){t.rotate(i),this.__originalRotate(i)},n.clip=function(i){t.clip(i),this.__originalClip(i)},n.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},n.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},n.bezierCurveTo=function(e,i,s,r,a,o){t.bezierCurveTo(e,i,s,r,a,o),this.__originalBezierCurveTo(e,i,s,r,a,o)},n.rect=function(e,i,s,r){t.rect(e,i,s,r),this.__originalRect(e,i,s,r)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class BD{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Fm(n,t,e,i,s,r,a,o,l,c){const[h,f,p,g,m,b]=ye(n);if(f===0&&p===0){const x=a*h+m,R=Math.round(x),I=o*g+b,D=Math.round(I),F=(a+l)*h+m,O=Math.abs(Math.round(F)-R)||1,L=(o+c)*g+b,M=Math.abs(Math.round(L)-D)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(g),R,D),n.drawImage(t,e,i,s,r,0,0,O,M),n.setTransform(h,f,p,g,m,b),[O,M]}if(h===0&&g===0){const x=o*p+m,R=Math.round(x),I=a*f+b,D=Math.round(I),F=(o+c)*p+m,O=Math.abs(Math.round(F)-R)||1,L=(a+l)*f+b,M=Math.abs(Math.round(L)-D)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,R,D),n.drawImage(t,e,i,s,r,0,0,M,O),n.setTransform(h,f,p,g,m,b),[M,O]}n.drawImage(t,e,i,s,r,a,o,l,c);const y=Math.hypot(h,f),w=Math.hypot(p,g);return[y*l,w*c]}function WD(n){const{width:t,height:e}=n;if(t>Dk||e>Dk)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=t+1;let a=new Uint8Array(r*(e+1)),o,l,c;const h=t+7&-8;let f=new Uint8Array(h*e),p=0;for(const w of n.data){let x=128;for(;x>0;)f[p++]=w&x?0:255,x>>=1}let g=0;for(p=0,f[p]!==0&&(a[0]=1,++g),l=1;l<t;l++)f[p]!==f[p+1]&&(a[l]=f[p]?2:1,++g),p++;for(f[p]!==0&&(a[l]=2,++g),o=1;o<e;o++){p=o*h,c=o*r,f[p-h]!==f[p]&&(a[c]=f[p]?1:8,++g);let w=(f[p]?4:0)+(f[p-h]?8:0);for(l=1;l<t;l++)w=(w>>2)+(f[p+1]?4:0)+(f[p-h+1]?8:0),s[w]&&(a[c+l]=s[w],++g),p++;if(f[p-h]!==f[p]&&(a[c+l]=f[p]?2:4,++g),g>i)return null}for(p=h*(e-1),c=o*r,f[p]!==0&&(a[c]=8,++g),l=1;l<t;l++)f[p]!==f[p+1]&&(a[c+l]=f[p]?4:8,++g),p++;if(f[p]!==0&&(a[c+l]=4,++g),g>i)return null;const m=new Int32Array([0,r,-1,0,-r,0,0,0,1]),b=new Path2D;for(o=0;g&&o<=e;o++){let w=o*r;const x=w+t;for(;w<x&&!a[w];)w++;if(w===x)continue;b.moveTo(w%r,o);const R=w;let I=a[w];do{const D=m[I];do w+=D;while(!a[w]);const F=a[w];F!==5&&F!==10?(I=F,a[w]=0):(I=F&51*I>>4,a[w]&=I>>2|I<<2),b.lineTo(w%r,w/r|0),a[w]||--g}while(R!==w);--o}return f=null,a=null,function(w){w.save(),w.scale(1/t,-1/e),w.translate(0,-e),w.fill(b),w.beginPath(),w.restore()}}class Fk{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=UT,this.textMatrixScale=1,this.fontMatrix=a1,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=mi.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=pt.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=pt.applyTransform(e,t),s=pt.applyTransform(e.slice(2),t),r=pt.applyTransform([e[0],e[3]],t),a=pt.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],s[0],r[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],r[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],r[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],r[1],a[1])}updateScalingPathMinMax(t,e){pt.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,s,r,a,o,l,c,h){const f=pt.bezierBoundingBox(e,i,s,r,a,o,l,c,h);h||this.updateRectMinMax(t,f)}getPathBoundingBox(t=Hi.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===Hi.STROKE){e||te("Stroke bounding box must include transform.");const s=pt.singularValueDecompose2dScale(e),r=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=r,i[1]-=a,i[2]+=r,i[3]+=a}return i}updateClipFromPath(){const t=pt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Hi.FILL,e=null){return pt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Ok(n,t){if(typeof ImageData<"u"&&t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%Ji,r=(e-s)/Ji,a=s===0?r:r+1,o=n.createImageData(i,Ji);let l=0,c;const h=t.data,f=o.data;let p,g,m,b;if(t.kind===vv.GRAYSCALE_1BPP){const y=h.byteLength,w=new Uint32Array(f.buffer,0,f.byteLength>>2),x=w.length,R=i+7>>3,I=4294967295,D=ns.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(m=p<r?Ji:s,c=0,g=0;g<m;g++){const F=y-l;let O=0;const L=F>R?i:F*8-7,M=L&-8;let W=0,j=0;for(;O<M;O+=8)j=h[l++],w[c++]=j&128?I:D,w[c++]=j&64?I:D,w[c++]=j&32?I:D,w[c++]=j&16?I:D,w[c++]=j&8?I:D,w[c++]=j&4?I:D,w[c++]=j&2?I:D,w[c++]=j&1?I:D;for(;O<L;O++)W===0&&(j=h[l++],W=128),w[c++]=j&W?I:D,W>>=1}for(;c<x;)w[c++]=0;n.putImageData(o,0,p*Ji)}}else if(t.kind===vv.RGBA_32BPP){for(g=0,b=i*Ji*4,p=0;p<r;p++)f.set(h.subarray(l,l+b)),l+=b,n.putImageData(o,0,g),g+=Ji;p<a&&(b=i*s*4,f.set(h.subarray(l,l+b)),n.putImageData(o,0,g))}else if(t.kind===vv.RGB_24BPP)for(m=Ji,b=i*m,p=0;p<a;p++){for(p>=r&&(m=s,b=i*m),c=0,g=b;g--;)f[c++]=h[l++],f[c++]=h[l++],f[c++]=h[l++],f[c++]=255;n.putImageData(o,0,p*Ji)}else throw new Error(`bad image kind: ${t.kind}`)}function Nk(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%Ji,r=(e-s)/Ji,a=s===0?r:r+1,o=n.createImageData(i,Ji);let l=0;const c=t.data,h=o.data;for(let f=0;f<a;f++){const p=f<r?Ji:s;({srcPos:l}=OD({src:c,srcPos:l,dest:h,width:i,height:p,nonBlackColor:0})),n.putImageData(o,0,f*Ji)}}function Mu(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)n[i]!==void 0&&(t[i]=n[i]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function Om(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Ii){const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}}function jk(n,t){if(t)return!0;const e=pt.singularValueDecompose2dScale(n);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*ko.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const HD=["butt","round","square"],$D=["miter","round","bevel"],UD={},Bk={};var Ro,F1,O1;const wk=class wk{constructor(t,e,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},l,c){P(this,Ro);this.ctx=t,this.current=new Fk(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new BD(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...ye(this.compositeCtx))}this.ctx.save(),Om(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ye(this.ctx)}executeOperatorList(t,e,i,s){const r=t.argsArray,a=t.fnArray;let o=e||0;const l=r.length;if(l===o)return o;const c=l-o>Ik&&typeof i=="function",h=c?Date.now()+ND:0;let f=0;const p=this.commonObjs,g=this.objs;let m;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(m=a[o],m!==Qs.dependency)this[m].apply(this,r[o]);else for(const b of r[o]){const y=b.startsWith("g_")?p:g;if(!y.has(b))return y.get(b,i),o}if(o++,o===l)return o;if(c&&++f>Ik){if(Date.now()>h)return i(),o;f=0}}}endDrawing(){k(this,Ro,F1).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),k(this,Ro,O1).call(this)}_scaleImage(t,e){const i=t.width,s=t.height;let r=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,l=s,c="prescale1",h,f;for(;r>2&&o>1||a>2&&l>1;){let p=o,g=l;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/g),h=this.cachedCanvases.getCanvas(c,p,g),f=h.context,f.clearRect(0,0,p,g),f.drawImage(t,0,0,o,l,0,0,p,g),t=h.canvas,o=p,l=g,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:s}=t,r=this.current.fillColor,a=this.current.patternFill,o=ye(e);let l,c,h,f;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(L),l||(l=new Map,this._cachedBitmapsMap.set(L,l));const M=l.get(c);if(M&&!a){const W=Math.round(Math.min(o[0],o[2])+o[4]),j=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:M,offsetX:W,offsetY:j}}h=M}h||(f=this.cachedCanvases.getCanvas("maskCanvas",i,s),Nk(f.context,t));let p=pt.transform(o,[1/i,0,0,-1/s,0,0]);p=pt.transform(p,[1,0,0,1,0,-s]);const[g,m,b,y]=pt.getAxialAlignedBoundingBox([0,0,i,s],p),w=Math.round(b-g)||1,x=Math.round(y-m)||1,R=this.cachedCanvases.getCanvas("fillCanvas",w,x),I=R.context,D=g,F=m;I.translate(-D,-F),I.transform(...p),h||(h=this._scaleImage(f.canvas,rr(I)),h=h.img,l&&a&&l.set(c,h)),I.imageSmoothingEnabled=jk(ye(I),t.interpolate),Fm(I,h,0,0,h.width,h.height,0,0,i,s),I.globalCompositeOperation="source-in";const O=pt.transform(rr(I),[1,0,0,1,-D,-F]);return I.fillStyle=a?r.getPattern(e,this,O,Hi.FILL):r,I.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,R.canvas)),{canvas:R.canvas,offsetX:Math.round(D),offsetY:Math.round(F)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=HD[t]}setLineJoin(t){this.ctx.lineJoin=$D[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=s.context;const r=this.ctx;r.setTransform(...ye(this.suspendedCtx)),Mu(this.suspendedCtx,r),jD(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Mu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const r=s[0],a=s[1],o=s[2]-r,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(e.context,i,o,l,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,r,a,o,l,c,h,f){let p=t.canvas,g=l-h,m=c-f;if(a){if(g<0||m<0||g+i>p.width||m+s>p.height){const y=this.cachedCanvases.getCanvas("maskExtension",i,s),w=y.context;w.drawImage(p,-g,-m),a.some(x=>x!==0)&&(w.globalCompositeOperation="destination-atop",w.fillStyle=pt.makeHexColor(...a),w.fillRect(0,0,i,s),w.globalCompositeOperation="source-over"),p=y.canvas,g=m=0}else if(a.some(y=>y!==0)){t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(g,m,i,s),t.clip(y),t.globalCompositeOperation="destination-atop",t.fillStyle=pt.makeHexColor(...a),t.fillRect(g,m,i,s),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(l,c,i,s),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(p,g,m,i,s,l,c,i,s),e.restore()}save(){this.inSMaskMode?(Mu(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Mu(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,s,r,a){this.ctx.transform(t,e,i,s,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const s=this.ctx,r=this.current;let a=r.x,o=r.y,l,c;const h=ye(s),f=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=f?i.slice(0):null;for(let g=0,m=0,b=t.length;g<b;g++)switch(t[g]|0){case Qs.rectangle:a=e[m++],o=e[m++];const y=e[m++],w=e[m++],x=a+y,R=o+w;s.moveTo(a,o),y===0||w===0?s.lineTo(x,R):(s.lineTo(x,o),s.lineTo(x,R),s.lineTo(a,R)),f||r.updateRectMinMax(h,[a,o,x,R]),s.closePath();break;case Qs.moveTo:a=e[m++],o=e[m++],s.moveTo(a,o),f||r.updatePathMinMax(h,a,o);break;case Qs.lineTo:a=e[m++],o=e[m++],s.lineTo(a,o),f||r.updatePathMinMax(h,a,o);break;case Qs.curveTo:l=a,c=o,a=e[m+4],o=e[m+5],s.bezierCurveTo(e[m],e[m+1],e[m+2],e[m+3],a,o),r.updateCurvePathMinMax(h,l,c,e[m],e[m+1],e[m+2],e[m+3],a,o,p),m+=6;break;case Qs.curveTo2:l=a,c=o,s.bezierCurveTo(a,o,e[m],e[m+1],e[m+2],e[m+3]),r.updateCurvePathMinMax(h,l,c,a,o,e[m],e[m+1],e[m+2],e[m+3],p),a=e[m+2],o=e[m+3],m+=4;break;case Qs.curveTo3:l=a,c=o,a=e[m+2],o=e[m+3],s.bezierCurveTo(e[m],e[m+1],a,o,a,o),r.updateCurvePathMinMax(h,l,c,e[m],e[m+1],a,o,a,o,p),m+=4;break;case Qs.closePath:s.closePath();break}f&&r.updateScalingPathMinMax(h,p),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(e.save(),e.strokeStyle=i.getPattern(e,this,rr(e),Hi.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let r=!1;s&&(e.save(),e.fillStyle=i.getPattern(e,this,rr(e),Hi.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),r&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=UD}eoClip(){this.pendingClip=Bk}beginText(){this.current.textMatrix=UT,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var h;const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||a1,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Dt("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const r=i.loadedName||"sans-serif",a=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=e;e<Lk?c=Lk:e>Mk&&(c=Mk),this.current.fontSizeScale=e/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,s,r,a){this.current.textMatrix=[t,e,i,s,r,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,s){const r=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,h=l&mi.FILL_STROKE_MASK,f=!!(l&mi.ADD_TO_PATH_FLAG),p=a.patternFill&&!o.missingFile;let g;(o.disableFontFace||f||p)&&(g=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||p?(r.save(),r.translate(e,i),r.beginPath(),g(r,c),s&&r.setTransform(...s),(h===mi.FILL||h===mi.FILL_STROKE)&&r.fill(),(h===mi.STROKE||h===mi.FILL_STROKE)&&r.stroke(),r.restore()):((h===mi.FILL||h===mi.FILL_STROKE)&&r.fillText(t,e,i),(h===mi.STROKE||h===mi.FILL_STROKE)&&r.strokeText(t,e,i)),f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ye(r),x:e,y:i,fontSize:c,addToPath:g})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return $t(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(s===0)return;const r=this.ctx,a=e.fontSizeScale,o=e.charSpacing,l=e.wordSpacing,c=e.fontDirection,h=e.textHScale*c,f=t.length,p=i.vertical,g=p?1:-1,m=i.defaultVMetrics,b=s*e.fontMatrix[0],y=e.textRenderingMode===mi.FILL&&!i.disableFontFace&&!e.patternFill;r.save(),r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),c>0?r.scale(h,-1):r.scale(h,1);let w;if(e.patternFill){r.save();const F=e.fillColor.getPattern(r,this,rr(r),Hi.FILL);w=ye(r),r.restore(),r.fillStyle=F}let x=e.lineWidth;const R=e.textMatrixScale;if(R===0||x===0){const F=e.textRenderingMode&mi.FILL_STROKE_MASK;(F===mi.STROKE||F===mi.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=R;if(a!==1&&(r.scale(a,a),x/=a),r.lineWidth=x,i.isInvalidPDFjsFont){const F=[];let O=0;for(const L of t)F.push(L.unicode),O+=L.width;r.fillText(F.join(""),0,0),e.x+=O*b*h,r.restore(),this.compose();return}let I=0,D;for(D=0;D<f;++D){const F=t[D];if(typeof F=="number"){I+=g*F*s/1e3;continue}let O=!1;const L=(F.isSpace?l:0)+o,M=F.fontChar,W=F.accent;let j,V,z=F.width;if(p){const K=F.vmetric||m,G=-(F.vmetric?K[1]:z*.5)*b,H=K[2]*b;z=K?-K[0]:z,j=G/a,V=(I+H)/a}else j=I/a,V=0;if(i.remeasure&&z>0){const K=r.measureText(M).width*1e3/s*a;if(z<K&&this.isFontSubpixelAAEnabled){const G=z/K;O=!0,r.save(),r.scale(G,1),j/=G}else z!==K&&(j+=(z-K)/2e3*s/a)}if(this.contentVisible&&(F.isInFont||i.missingFile)){if(y&&!W)r.fillText(M,j,V);else if(this.paintChar(M,j,V,w),W){const K=j+s*W.offset.x/a,G=V-s*W.offset.y/a;this.paintChar(W.fontChar,K,G,w)}}const Y=p?z*b-L*c:z*b+L*c;I+=Y,O&&r.restore()}p?e.y-=I:e.x+=I*h,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,s=i.font,r=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*a,f=i.fontMatrix||a1,p=t.length,g=i.textRenderingMode===mi.INVISIBLE;let m,b,y,w;if(!(g||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(h,a),m=0;m<p;++m){if(b=t[m],typeof b=="number"){w=o*b*r/1e3,this.ctx.translate(w,0),i.x+=w*h;continue}const x=(b.isSpace?c:0)+l,R=s.charProcOperatorList[b.operatorListId];if(!R){Dt(`Type3 character "${b.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=b,this.save(),e.scale(r,r),e.transform(...f),this.executeOperatorList(R),this.restore()),y=pt.applyTransform([b.width,0],f)[0]*r+x,e.translate(y,0),i.x+=y*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,s,r,a){this.ctx.rect(i,s,r-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=t[1],s=this.baseTransform||ye(this.ctx),r={createCanvasGraphics:a=>new wk(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new D1(t,i,this.ctx,r,s)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){const s=pt.makeHexColor(t,e,i);this.ctx.strokeStyle=s,this.current.strokeColor=s}setFillRGBColor(t,e,i){const s=pt.makeHexColor(t,e,i);this.ctx.fillStyle=s,this.current.fillColor=s,this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=FD(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,rr(e),Hi.SHADING);const s=rr(e);if(s){const{width:r,height:a}=e.canvas,[o,l,c,h]=pt.getAxialAlignedBoundingBox([0,0,r,a],s);this.ctx.fillRect(o,l,c-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){te("Should not call beginInlineImage")}beginImageData(){te("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=ye(this.ctx),e)){const i=e[2]-e[0],s=e[3]-e[1];this.ctx.rect(e[0],e[1],i,s),this.current.updateRectMinMax(ye(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||ww("TODO: Support non-isolated groups."),t.knockout&&Dt("Knockout groups not supported.");const i=ye(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=pt.getAxialAlignedBoundingBox(t.bbox,ye(e));const r=[0,0,e.canvas.width,e.canvas.height];s=pt.intersect(s,r)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,l,c),p=f.context;p.translate(-a,-o),p.transform(...i),t.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),Mu(e,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=ye(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=pt.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(t,e,i,s,r){if(k(this,Ro,F1).call(this),Om(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=o;const[l,c]=pt.singularValueDecompose2dScale(ye(this.ctx)),{viewportScale:h}=this,f=Math.ceil(a*this.outputScaleX*h),p=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:g,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),Om(this.ctx)}else Om(this.ctx),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.endPath()}this.current=new Fk(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),k(this,Ro,O1).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=WD(t)),s.compiled)){s.compiled(i);return}const r=this._createMaskCanvas(t),a=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,s=0,r,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const l=ye(o);o.transform(e,i,s,r,0,0);const c=this._createMaskCanvas(t);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,f=a.length;h<f;h+=2){const p=pt.transform(l,[e,i,s,r,a[h],a[h+1]]),[g,m]=pt.applyTransform([0,0],p);o.drawImage(c.canvas,g,m)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of t){const{data:a,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=h.context;f.save();const p=this.getObject(a,r);Nk(f,p),f.globalCompositeOperation="source-in",f.fillStyle=s?i.getPattern(f,this,rr(e),Hi.FILL):i,f.fillRect(0,0,o,l),f.restore(),e.save(),e.transform(...c),e.scale(1,-1),Fm(e,h.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Dt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,s){if(!this.contentVisible)return;const r=this.getObject(t);if(!r){Dt("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let c=0,h=s.length;c<h;c+=2)l.push({transform:[e,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,s=this.ctx;if(this.save(),!Ii){const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/e,-1/i);let r;if(t.bitmap)r=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)r=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",e,i).context;Ok(l,t),r=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(r,rr(s));s.imageSmoothingEnabled=jk(ye(s),t.interpolate),Fm(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const r=t.width,a=t.height,l=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Ok(l,t),s=this.applyTransferMapsToCanvas(l)}for(const r of e)i.save(),i.transform(...r.transform),i.scale(1,-1),Fm(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===Bk?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ye(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(e),c=Math.abs(r);if(l===c)if(t===0)a=o=1/l;else{const h=l*t;a=o=h<1?1/h:1}else if(t===0)a=1/l,o=1/c;else{const h=l*t,f=c*t;a=h<1?1/h:1,o=f<1?1/f:1}}else{const l=Math.abs(e*r-i*s),c=Math.hypot(e,i),h=Math.hypot(s,r);if(t===0)a=h/l,o=c/l;else{const f=t*l;a=h>f?h/f:1,o=c>f?c/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[s,r]=this.getScaleForStroking();if(e.lineWidth=i||1,s===1&&r===1){e.stroke();return}const a=e.getLineDash();if(t&&e.save(),e.scale(s,r),a.length>0){const o=Math.max(s,r);e.setLineDash(a.map(l=>l/o)),e.lineDashOffset/=o}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Ro=new WeakSet,F1=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},O1=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let ld=wk;for(const n in Qs)ld.prototype[n]!==void 0&&(ld.prototype[Qs[n]]=ld.prototype[n]);var yg,wg;class ha{static get workerPort(){return d(this,yg)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");S(this,yg,t)}static get workerSrc(){return d(this,wg)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");S(this,wg,t)}}yg=new WeakMap,wg=new WeakMap,P(ha,yg,null),P(ha,wg,"");const Nm={UNKNOWN:0,DATA:1,ERROR:2},Re={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function cs(n){switch(n instanceof Error||typeof n=="object"&&n!==null||te('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Bh(n.message);case"MissingPDFException":return new jh(n.message);case"PasswordException":return new l1(n.message,n.code);case"UnexpectedResponseException":return new Aw(n.message,n.status);case"UnknownErrorException":return new h1(n.message,n.details);default:return new h1(n.message,n.toString())}}var Zn,kR,CR,Ev;class ef{constructor(t,e,i){P(this,Zn);this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=s=>{const r=s.data;if(r.targetName!==this.sourceName)return;if(r.stream){k(this,Zn,CR).call(this,r);return}if(r.callback){const o=r.callbackId,l=this.callbackCapabilities[o];if(!l)throw new Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],r.callback===Nm.DATA)l.resolve(r.data);else if(r.callback===Nm.ERROR)l.reject(cs(r.reason));else throw new Error("Unexpected callback case");return}const a=this.actionHandler[r.action];if(!a)throw new Error(`Unknown action from worker: ${r.action}`);if(r.callbackId){const o=this.sourceName,l=r.sourceName;new Promise(function(c){c(a(r.data))}).then(function(c){i.postMessage({sourceName:o,targetName:l,callback:Nm.DATA,callbackId:r.callbackId,data:c})},function(c){i.postMessage({sourceName:o,targetName:l,callback:Nm.ERROR,callbackId:r.callbackId,reason:cs(c)})});return}if(r.streamId){k(this,Zn,kR).call(this,r);return}a(r.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(t,e,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:t,streamId:r,data:e,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:Re.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{$e(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Re.CANCEL,streamId:r,reason:cs(c)}),h.promise}},i)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}Zn=new WeakSet,kR=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,r=this.comObj,a=this,o=this.actionHandler[t.action],l={enqueue(c,h=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Re.ENQUEUE,streamId:e,chunk:c},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Re.CLOSE,streamId:e}),delete a.streamSinks[e])},error(c){$e(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Re.ERROR,streamId:e,reason:cs(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,new Promise(function(c){c(o(t.data,l))}).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Re.START_COMPLETE,streamId:e,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:Re.START_COMPLETE,streamId:e,reason:cs(c)})})},CR=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,r=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case Re.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(cs(t.reason));break;case Re.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(cs(t.reason));break;case Re.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:Re.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,new Promise(function(l){var c;l((c=o.onPull)==null?void 0:c.call(o))}).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Re.PULL_COMPLETE,streamId:e,success:!0})},function(l){r.postMessage({sourceName:i,targetName:s,stream:Re.PULL_COMPLETE,streamId:e,reason:cs(l)})});break;case Re.ENQUEUE:if($e(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Re.CLOSE:if($e(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),k(this,Zn,Ev).call(this,a,e);break;case Re.ERROR:$e(a,"error should have stream controller"),a.controller.error(cs(t.reason)),k(this,Zn,Ev).call(this,a,e);break;case Re.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(cs(t.reason)),k(this,Zn,Ev).call(this,a,e);break;case Re.CANCEL:if(!o)break;new Promise(function(l){var c;l((c=o.onCancel)==null?void 0:c.call(o,cs(t.reason)))}).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Re.CANCEL_COMPLETE,streamId:e,success:!0})},function(l){r.postMessage({sourceName:i,targetName:s,stream:Re.CANCEL_COMPLETE,streamId:e,reason:cs(l)})}),o.sinkCapability.reject(cs(t.reason)),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},Ev=async function(t,e){var i,s,r;await Promise.allSettled([(i=t.startCall)==null?void 0:i.promise,(s=t.pullCall)==null?void 0:s.promise,(r=t.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[e]};var Vl,Ag;class zD{constructor({parsedData:t,rawData:e}){P(this,Vl);P(this,Ag);S(this,Vl,t),S(this,Ag,e)}getRaw(){return d(this,Ag)}get(t){return d(this,Vl).get(t)??null}getAll(){return ES(d(this,Vl))}has(t){return d(this,Vl).has(t)}}Vl=new WeakMap,Ag=new WeakMap;const _a=Symbol("INTERNAL");var _g,Eg,xg,jd;class VD{constructor(t,{name:e,intent:i,usage:s}){P(this,_g,!1);P(this,Eg,!1);P(this,xg,!1);P(this,jd,!0);S(this,_g,!!(t&js.DISPLAY)),S(this,Eg,!!(t&js.PRINT)),this.name=e,this.intent=i,this.usage=s}get visible(){if(d(this,xg))return d(this,jd);if(!d(this,jd))return!1;const{print:t,view:e}=this.usage;return d(this,_g)?(e==null?void 0:e.viewState)!=="OFF":d(this,Eg)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,i=!1){t!==_a&&te("Internal method `_setVisible` called."),S(this,xg,i),S(this,jd,e)}}_g=new WeakMap,Eg=new WeakMap,xg=new WeakMap,jd=new WeakMap;var ro,Zt,Bd,Wd,Sg,N1;class GD{constructor(t,e=js.DISPLAY){P(this,Sg);P(this,ro,null);P(this,Zt,new Map);P(this,Bd,null);P(this,Wd,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,S(this,Wd,t.order);for(const i of t.groups)d(this,Zt).set(i.id,new VD(e,i));if(t.baseState==="OFF")for(const i of d(this,Zt).values())i._setVisible(_a,!1);for(const i of t.on)d(this,Zt).get(i)._setVisible(_a,!0);for(const i of t.off)d(this,Zt).get(i)._setVisible(_a,!1);S(this,Bd,this.getHash())}}isVisible(t){if(d(this,Zt).size===0)return!0;if(!t)return ww("Optional content group not defined."),!0;if(t.type==="OCG")return d(this,Zt).has(t.id)?d(this,Zt).get(t.id).visible:(Dt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return k(this,Sg,N1).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!d(this,Zt).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(d(this,Zt).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!d(this,Zt).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(!d(this,Zt).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!d(this,Zt).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(!d(this,Zt).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!d(this,Zt).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(d(this,Zt).get(e).visible)return!1}return!0}return Dt(`Unknown optional content policy ${t.policy}.`),!0}return Dt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0){const i=d(this,Zt).get(t);if(!i){Dt(`Optional content group not found: ${t}`);return}i._setVisible(_a,!!e,!0),S(this,ro,null)}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=d(this,Zt).get(s);if(r)switch(i){case"ON":r._setVisible(_a,!0);break;case"OFF":r._setVisible(_a,!1);break;case"Toggle":r._setVisible(_a,!r.visible);break}}S(this,ro,null)}get hasInitialVisibility(){return d(this,Bd)===null||this.getHash()===d(this,Bd)}getOrder(){return d(this,Zt).size?d(this,Wd)?d(this,Wd).slice():[...d(this,Zt).keys()]:null}getGroups(){return d(this,Zt).size>0?ES(d(this,Zt)):null}getGroup(t){return d(this,Zt).get(t)||null}getHash(){if(d(this,ro)!==null)return d(this,ro);const t=new _R;for(const[e,i]of d(this,Zt))t.update(`${e}:${i.visible}`);return S(this,ro,t.hexdigest())}}ro=new WeakMap,Zt=new WeakMap,Bd=new WeakMap,Wd=new WeakMap,Sg=new WeakSet,N1=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const r=t[s];let a;if(Array.isArray(r))a=k(this,Sg,N1).call(this,r);else if(d(this,Zt).has(r))a=d(this,Zt).get(r).visible;else return Dt(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class qD{constructor(t,{disableRange:e=!1,disableStream:i=!1}){$e(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(i),!0)});$e(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,i,s,r;t.total===void 0?(i=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||i.call(e,{loaded:t.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){$e(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new XD(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new YD(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class XD{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=TS(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class YD{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function KD(n){let t=!0,e=i("filename\\*","i").exec(n);if(e){e=e[1];let h=o(e);return h=unescape(h),h=l(h),h=c(h),r(h)}if(e=a(n),e){const h=c(e);return r(h)}if(e=i("filename","i").exec(n),e){e=e[1];let h=o(e);return h=c(h),r(h)}function i(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(h,{fatal:!0}),g=_w(f);f=p.decode(g),t=!1}catch{}}return f}function r(h){return t&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),t&&(h=s("iso-8859-1",h))),h}function a(h){const f=[];let p;const g=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=g.exec(h))!==null;){let[,b,y,w]=p;if(b=parseInt(b,10),b in f){if(b===0)break;continue}f[b]=[y,w]}const m=[];for(let b=0;b<f.length&&b in f;++b){let[y,w]=f[b];w=o(w),y&&(w=unescape(w),b===0&&(w=l(w))),m.push(w)}return m.join("")}function o(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let p=0;p<f.length;++p){const g=f[p].indexOf('"');g!==-1&&(f[p]=f[p].slice(0,g),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function l(h){const f=h.indexOf("'");if(f===-1)return h;const p=h.slice(0,f),m=h.slice(f+1).replace(/^[^']*'/,"");return s(p,m)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,g,m){if(g==="q"||g==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,y){return String.fromCharCode(parseInt(y,16))}),s(p,m);try{m=atob(m)}catch{}return s(p,m)})}return""}function LS({getResponseHeader:n,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*e)||i||!t||n("Accept-Ranges")!=="bytes"||(n("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function MS(n){const t=n("Content-Disposition");if(t){let e=KD(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(TS(e))return e}return null}function Cw(n,t){return n===404||n===0&&t.startsWith("file:")?new jh('Missing PDF "'+t+'".'):new Aw(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n)}function TR(n){return n===200||n===206}function RR(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function PR(n){const t=new Headers;for(const e in n){const i=n[e];i!==void 0&&t.append(e,i)}return t}function LR(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Dt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class Wk{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return $e(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new QD(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new ZD(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class QD{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._headers=PR(this._stream.httpHeaders);const i=e.url;fetch(i,RR(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!TR(s.status))throw Cw(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const r=l=>s.headers.get(l),{allowRangeRequests:a,suggestedLength:o}=LS({getResponseHeader:r,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=MS(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Bh("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:LR(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class ZD{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController,this._headers=PR(this._stream.httpHeaders),this._headers.append("Range",`bytes=${e}-${i-1}`);const r=s.url;fetch(r,RR(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!TR(a.status))throw Cw(a.status,r);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:LR(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const pA=200,gA=206;function JD(n){const t=n.response;return typeof t!="string"?t:_w(t).buffer}class tF{constructor(t,e={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const s={begin:t,end:e};for(const r in i)s[r]=i[r];return this.request(s)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const r in this.httpHeaders){const a=this.httpHeaders[r];a!==void 0&&e.setRequestHeader(r,a)}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=gA):s.expectedStatus=pA,e.responseType="arraybuffer",t.onError&&(e.onerror=function(r){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){var s;const i=this.pendingRequests[t];i&&((s=i.onProgress)==null||s.call(i,e))}onStateChange(t,e){var l,c,h;const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){(l=i.onError)==null||l.call(i,s.status);return}const r=s.status||pA;if(!(r===pA&&i.expectedStatus===gA)&&r!==i.expectedStatus){(c=i.onError)==null||c.call(i,s.status);return}const o=JD(s);if(r===gA){const f=s.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);i.onDone({begin:parseInt(p[1],10),chunk:o})}else o?i.onDone({begin:0,chunk:o}):(h=i.onError)==null||h.call(i,s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class eF{constructor(t){this._source=t,this._manager=new tF(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return $e(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new iF(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new sF(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class iF{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=a=>e.getResponseHeader(a),{allowRangeRequests:s,suggestedLength:r}=LS({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=MS(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Cw(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class sF{constructor(t,e,i){this._manager=t;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=Cw(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const MR=/^file:\/\/\/[a-zA-Z]:\//;function nF(n){const t=tr.get("url"),e=t.parse(n);return e.protocol==="file:"||e.host?e:/^[a-z]:[/\\]/i.test(n)?t.parse(`file:///${n}`):(e.host||(e.protocol="file:"),e)}class rF{constructor(t){this.source=t,this.url=nF(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return $e(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new lF(this):new aF(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new hF(this,t,e):new oF(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class IR{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Bh("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class DR{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Yb(n,t){return{protocol:n.protocol,auth:n.auth,host:n.hostname,port:n.port,path:n.path,method:"GET",headers:t}}class aF extends IR{constructor(t){super(t);const e=i=>{if(i.statusCode===404){const o=new jh(`Missing PDF "${this._url}".`);this._storedError=o,this._headersCapability.reject(o);return}this._headersCapability.resolve(),this._setReadableStream(i);const s=o=>this._readableStream.headers[o.toLowerCase()],{allowRangeRequests:r,suggestedLength:a}=LS({getResponseHeader:s,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=a||this._contentLength,this._filename=MS(s)};if(this._request=null,this._url.protocol==="http:"){const i=tr.get("http");this._request=i.request(Yb(this._url,t.httpHeaders),e)}else{const i=tr.get("https");this._request=i.request(Yb(this._url,t.httpHeaders),e)}this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}}class oF extends DR{constructor(t,e,i){super(t),this._httpHeaders={};for(const r in t.httpHeaders){const a=t.httpHeaders[r];a!==void 0&&(this._httpHeaders[r]=a)}this._httpHeaders.Range=`bytes=${e}-${i-1}`;const s=r=>{if(r.statusCode===404){const a=new jh(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(r)};if(this._request=null,this._url.protocol==="http:"){const r=tr.get("http");this._request=r.request(Yb(this._url,this._httpHeaders),s)}else{const r=tr.get("https");this._request=r.request(Yb(this._url,this._httpHeaders),s)}this._request.on("error",r=>{this._storedError=r}),this._request.end()}}class lF extends IR{constructor(t){super(t);let e=decodeURIComponent(this._url.path);MR.test(this._url.href)&&(e=e.replace(/^\//,""));const i=tr.get("fs");i.promises.lstat(e).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(e)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new jh(`Missing PDF "${e}".`)),this._storedError=s,this._headersCapability.reject(s)})}}class hF extends DR{constructor(t,e,i){super(t);let s=decodeURIComponent(this._url.path);MR.test(this._url.href)&&(s=s.replace(/^\//,""));const r=tr.get("fs");this._setReadableStream(r.createReadStream(s,{start:e,end:i-1}))}}const cF=1e5,Gi=30,dF=.8;var HT,ao,Qi,kg,Cg,Gl,Br,Tg,Rg,ql,Hd,$d,oo,Ud,Pg,zd,Xl,Lg,Mg,He,Yl,Kl,lo,Vd,ma,FR,OR,j1,Jn,xv,NR,jR;let Kb=(He=class{constructor({textContentSource:t,container:e,viewport:i}){P(this,ma);P(this,ao,Promise.withResolvers());P(this,Qi,null);P(this,kg,!1);P(this,Cg,!!((HT=globalThis.FontInspector)!=null&&HT.enabled));P(this,Gl,null);P(this,Br,null);P(this,Tg,0);P(this,Rg,0);P(this,ql,null);P(this,Hd,null);P(this,$d,0);P(this,oo,0);P(this,Ud,Object.create(null));P(this,Pg,[]);P(this,zd,null);P(this,Xl,[]);P(this,Lg,new WeakMap);P(this,Mg,null);var l;if(t instanceof ReadableStream)S(this,zd,t);else if(typeof t=="object")S(this,zd,new ReadableStream({start(c){c.enqueue(t),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');S(this,Qi,S(this,Hd,e)),S(this,oo,i.scale*(globalThis.devicePixelRatio||1)),S(this,$d,i.rotation),S(this,Br,{prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:a,pageY:o}=i.rawDims;S(this,Mg,[1,0,0,-1,-a,o+r]),S(this,Rg,s),S(this,Tg,r),k(l=He,Jn,NR).call(l),kh(e,i),d(this,ao).promise.catch(()=>{}).then(()=>{d(He,Vd).delete(this),S(this,Br,null),S(this,Ud,null)})}render(){const t=()=>{d(this,ql).read().then(({value:e,done:i})=>{if(i){d(this,ao).resolve();return}d(this,Gl)??S(this,Gl,e.lang),Object.assign(d(this,Ud),e.styles),k(this,ma,FR).call(this,e.items),t()},d(this,ao).reject)};return S(this,ql,d(this,zd).getReader()),d(He,Vd).add(this),t(),d(this,ao).promise}update({viewport:t,onBefore:e=null}){var r;const i=t.scale*(globalThis.devicePixelRatio||1),s=t.rotation;if(s!==d(this,$d)&&(e==null||e(),S(this,$d,s),kh(d(this,Hd),{rotation:s})),i!==d(this,oo)){e==null||e(),S(this,oo,i);const a={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:k(r=He,Jn,xv).call(r,d(this,Gl))};for(const o of d(this,Xl))a.properties=d(this,Lg).get(o),a.div=o,k(this,ma,j1).call(this,a)}}cancel(){var e;const t=new Bh("TextLayer task cancelled.");(e=d(this,ql))==null||e.cancel(t).catch(()=>{}),S(this,ql,null),d(this,ao).reject(t)}get textDivs(){return d(this,Xl)}get textContentItemsStr(){return d(this,Pg)}static cleanup(){if(!(d(this,Vd).size>0)){d(this,Yl).clear();for(const{canvas:t}of d(this,Kl).values())t.remove();d(this,Kl).clear()}}},ao=new WeakMap,Qi=new WeakMap,kg=new WeakMap,Cg=new WeakMap,Gl=new WeakMap,Br=new WeakMap,Tg=new WeakMap,Rg=new WeakMap,ql=new WeakMap,Hd=new WeakMap,$d=new WeakMap,oo=new WeakMap,Ud=new WeakMap,Pg=new WeakMap,zd=new WeakMap,Xl=new WeakMap,Lg=new WeakMap,Mg=new WeakMap,Yl=new WeakMap,Kl=new WeakMap,lo=new WeakMap,Vd=new WeakMap,ma=new WeakSet,FR=function(t){var s,r;if(d(this,kg))return;(r=d(this,Br)).ctx??(r.ctx=k(s=He,Jn,xv).call(s,d(this,Gl)));const e=d(this,Xl),i=d(this,Pg);for(const a of t){if(e.length>cF){Dt("Ignoring additional textDivs for performance reasons."),S(this,kg,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=d(this,Qi);S(this,Qi,document.createElement("span")),d(this,Qi).classList.add("markedContent"),a.id!==null&&d(this,Qi).setAttribute("id",`${a.id}`),o.append(d(this,Qi))}else a.type==="endMarkedContent"&&S(this,Qi,d(this,Qi).parentNode);continue}i.push(a.str),k(this,ma,OR).call(this,a)}},OR=function(t){var b;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};d(this,Xl).push(e);const s=pt.transform(d(this,Mg),t.transform);let r=Math.atan2(s[1],s[0]);const a=d(this,Ud)[t.fontName];a.vertical&&(r+=Math.PI/2);const o=d(this,Cg)&&a.fontSubstitution||a.fontFamily,l=Math.hypot(s[2],s[3]),c=l*k(b=He,Jn,jR).call(b,o,d(this,Gl));let h,f;r===0?(h=s[4],f=s[5]-c):(h=s[4]+c*Math.sin(r),f=s[5]-c*Math.cos(r));const p="calc(var(--scale-factor)*",g=e.style;d(this,Qi)===d(this,Hd)?(g.left=`${(100*h/d(this,Rg)).toFixed(2)}%`,g.top=`${(100*f/d(this,Tg)).toFixed(2)}%`):(g.left=`${p}${h.toFixed(2)}px)`,g.top=`${p}${f.toFixed(2)}px)`),g.fontSize=`${p}${(d(He,lo)*l).toFixed(2)}px)`,g.fontFamily=o,i.fontSize=l,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,d(this,Cg)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),r!==0&&(i.angle=r*(180/Math.PI));let m=!1;if(t.str.length>1)m=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const y=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);y!==w&&Math.max(y,w)/Math.min(y,w)>1.5&&(m=!0)}if(m&&(i.canvasWidth=a.vertical?t.height:t.width),d(this,Lg).set(e,i),d(this,Br).div=e,d(this,Br).properties=i,k(this,ma,j1).call(this,d(this,Br)),i.hasText&&d(this,Qi).append(e),i.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),d(this,Qi).append(y)}},j1=function(t){const{div:e,properties:i,ctx:s,prevFontSize:r,prevFontFamily:a}=t,{style:o}=e;let l="";if(d(He,lo)>1&&(l=`scale(${1/d(He,lo)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=o,{canvasWidth:h,fontSize:f}=i;(r!==f||a!==c)&&(s.font=`${f*d(this,oo)}px ${c}`,t.prevFontSize=f,t.prevFontFamily=c);const{width:p}=s.measureText(e.textContent);p>0&&(l=`scaleX(${h*d(this,oo)/p}) ${l}`)}i.angle!==0&&(l=`rotate(${i.angle}deg) ${l}`),l.length>0&&(o.transform=l)},Jn=new WeakSet,xv=function(t=null){let e=d(this,Kl).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),d(this,Kl).set(t,e)}return e},NR=function(){if(d(this,lo)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.textContent="X",document.body.append(t),S(this,lo,t.getBoundingClientRect().height),t.remove()},jR=function(t,e){const i=d(this,Yl).get(t);if(i)return i;const s=k(this,Jn,xv).call(this,e),r=s.font;s.canvas.width=s.canvas.height=Gi,s.font=`${Gi}px ${t}`;const a=s.measureText("");let o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);if(o){const f=o/(o+l);return d(this,Yl).set(t,f),s.canvas.width=s.canvas.height=0,s.font=r,f}s.strokeStyle="red",s.clearRect(0,0,Gi,Gi),s.strokeText("g",0,0);let c=s.getImageData(0,0,Gi,Gi).data;l=0;for(let f=c.length-1-3;f>=0;f-=4)if(c[f]>0){l=Math.ceil(f/4/Gi);break}s.clearRect(0,0,Gi,Gi),s.strokeText("A",0,Gi),c=s.getImageData(0,0,Gi,Gi).data,o=0;for(let f=0,p=c.length;f<p;f+=4)if(c[f]>0){o=Gi-Math.floor(f/4/Gi);break}s.canvas.width=s.canvas.height=0,s.font=r;const h=o?o/(o+l):dF;return d(this,Yl).set(t,h),h},P(He,Jn),P(He,Yl,new Map),P(He,Kl,new Map),P(He,lo,null),P(He,Vd,new Set),He);function uF(){KT("`renderTextLayer`, please use `TextLayer` instead.");const{textContentSource:n,container:t,viewport:e,...i}=arguments[0],s=Object.keys(i);s.length>0&&Dt("Ignoring `renderTextLayer` parameters: "+s.join(", "));const r=new Kb({textContentSource:n,container:t,viewport:e}),{textDivs:a,textContentItemsStr:o}=r;return{promise:r.render(),textDivs:a,textContentItemsStr:o}}function fF(){KT("`updateTextLayer`, please use `TextLayer` instead.")}class Bp{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Bp.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&e.push({str:a}),!!r.children)for(const c of r.children)s(c)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const pF=65536,gF=100,mF=5e3,vF=Ii?TD:gD,bF=Ii?RD:XT,yF=Ii?CD:pD,wF=Ii?PD:YT;function AF(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new B1,{docId:e}=t,i=n.url?_F(n.url):null,s=n.data?EF(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof BR?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:pF;let h=n.worker instanceof hd?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!CS(n.docBaseUrl)?n.docBaseUrl:null,g=typeof n.cMapUrl=="string"?n.cMapUrl:null,m=n.cMapPacked!==!1,b=n.CMapReaderFactory||bF,y=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,w=n.StandardFontDataFactory||wF,x=n.stopAtErrors!==!0,R=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,I=n.isEvalSupported!==!1,D=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ii,F=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,O=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ii,L=n.fontExtraProperties===!0,M=n.enableXfa===!0,W=n.ownerDocument||globalThis.document,j=n.disableRange===!0,V=n.disableStream===!0,z=n.disableAutoFetch===!0,Y=n.pdfBug===!0,K=n.enableHWA===!0,G=l?l.length:n.length??NaN,H=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ii&&!O,Q=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:b===XT&&w===YT&&g&&y&&Zu(g,document.baseURI)&&Zu(y,document.baseURI),Z=n.canvasFactory||new vF({ownerDocument:W,enableHWA:K}),yt=n.filterFactory||new yF({docId:e,ownerDocument:W}),bt=null;sD(f);const X={canvasFactory:Z,filterFactory:yt};if(Q||(X.cMapReaderFactory=new b({baseUrl:g,isCompressed:m}),X.standardFontDataFactory=new w({baseUrl:y})),!h){const lt={verbosity:f,port:ha.workerPort};h=lt.port?hd.fromPort(lt):new hd(lt),t._worker=h}const nt={docId:e,apiVersion:"4.4.168",data:s,password:o,disableAutoFetch:z,rangeChunkSize:c,length:G,docBaseUrl:p,enableXfa:M,evaluatorOptions:{maxImageSize:R,disableFontFace:O,ignoreErrors:x,isEvalSupported:I,isOffscreenCanvasSupported:D,canvasMaxAreaInBytes:F,fontExtraProperties:L,useSystemFonts:H,cMapUrl:Q?g:null,standardFontDataUrl:Q?y:null}},ht={disableFontFace:O,fontExtraProperties:L,ownerDocument:W,pdfBug:Y,styleElement:bt,loadingParams:{disableAutoFetch:z,enableXfa:M}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const lt=h.messageHandler.sendWithPromise("GetDocRequest",nt,s?[s.buffer]:null);let ct;if(l)ct=new qD(l,{disableRange:j,disableStream:V});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");ct=(vt=>Ii?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&Zu(vt.url)?new Wk(vt):new rF(vt):Zu(vt.url)?new Wk(vt):new eF(vt))({url:i,length:G,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:j,disableStream:V})}return lt.then(st=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const vt=new ef(e,st,h.port),tt=new CF(vt,t,ct,ht,X);t._transport=tt,vt.send("Ready",null)})}).catch(t._capability.reject),t}function _F(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Ii&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function EF(n){if(Ii&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return _w(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Hk(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var cw;const dw=class dw{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${hs(dw,cw)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};cw=new WeakMap,P(dw,cw,0);let B1=dw,BR=class{constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){te("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class xF{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return $t(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var ho,Wr,Us,rc,Sv;class SF{constructor(t,e,i,s=!1){P(this,Us);P(this,ho,null);P(this,Wr,!1);this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new Ck:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new WR,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new _m({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return $t(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:s=$a.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null}){var R,I;(R=this._stats)==null||R.time("Overall");const f=this._transport.getRenderingIntent(i,s,h),{renderingIntent:p,cacheKey:g}=f;S(this,Wr,!1),k(this,Us,Sv).call(this),o||(o=this._transport.getOptionalContentConfig(p));let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const b=!!(p&js.PRINT);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(I=this._stats)==null||I.time("Page Request"),this._pumpOperatorList(f));const y=D=>{var F;m.renderTasks.delete(w),(this._maybeCleanupAfterRender||b)&&S(this,Wr,!0),k(this,Us,rc).call(this,!b),D?(w.capability.reject(D),this._abortOperatorList({intentState:m,reason:D instanceof Error?D:new Error(D)})):w.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},w=new H1({callback:y,params:{canvasContext:t,viewport:e,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||(m.renderTasks=new Set)).add(w);const x=w.task;return Promise.all([m.displayReadyCapability.promise,o]).then(([D,F])=>{var O;if(this.destroyed){y();return}if((O=this._stats)==null||O.time("Rendering"),!(F.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");w.initializeGraphics({transparency:D,optionalContentConfig:F}),w.operatorListChanged()}).catch(y),x}getOperatorList({intent:t="display",annotationMode:e=$a.ENABLE,printAnnotationStorage:i=null}={}){var l;function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(o))}const r=this._transport.getRenderingIntent(t,e,i,!0);let a=this._intentStates.get(r.cacheKey);a||(a=Object.create(null),this._intentStates.set(r.cacheKey,a));let o;return a.opListReadCapability||(o=Object.create(null),o.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(o),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(l=this._stats)==null||l.time("Page Request"),this._pumpOperatorList(r)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Bp.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function r(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},s)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),S(this,Wr,!1),k(this,Us,Sv).call(this),Promise.all(t)}cleanup(t=!1){S(this,Wr,!0);const e=k(this,Us,rc).call(this,!1);return t&&e&&this._stats&&(this._stats=new Ck),e}_startRenderPage(t,e){var s,r;const i=this._intentStates.get(e);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&k(this,Us,rc).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i}){const{map:s,transfer:r}=i,o=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s},r).getReader(),l=this._intentStates.get(e);l.streamReader=o;const c=()=>{o.read().then(({value:h,done:f})=>{if(f){l.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,l),c())},h=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const f of l.renderTasks)f.operatorListChanged();k(this,Us,rc).call(this,!0)}if(l.displayReadyCapability)l.displayReadyCapability.reject(h);else if(l.opListReadCapability)l.opListReadCapability.reject(h);else throw h}})};c()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof kS){let s=gF;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new Bh(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}ho=new WeakMap,Wr=new WeakMap,Us=new WeakSet,rc=function(t=!1){if(k(this,Us,Sv).call(this),!d(this,Wr)||this.destroyed)return!1;if(t)return S(this,ho,setTimeout(()=>{S(this,ho,null),k(this,Us,rc).call(this,!1)},mF)),!1;for(const{renderTasks:e,operatorList:i}of this._intentStates.values())if(e.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),S(this,Wr,!1),!0},Sv=function(){d(this,ho)&&(clearTimeout(d(this,ho)),S(this,ho,null))};var Ql,uw;class kF{constructor(){P(this,Ql,new Set);P(this,uw,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};d(this,uw).then(()=>{for(const s of d(this,Ql))s.call(this,i)})}addEventListener(t,e){d(this,Ql).add(e)}removeEventListener(t,e){d(this,Ql).delete(e)}terminate(){d(this,Ql).clear()}}Ql=new WeakMap,uw=new WeakMap;const Rr={isWorkerDisabled:!1,fakeWorkerId:0};Ii&&(Rr.isWorkerDisabled=!0,ha.workerSrc||(ha.workerSrc="./pdf.worker.mjs")),Rr.isSameOrigin=function(n,t){let e;try{if(e=new URL(n),!e.origin||e.origin==="null")return!1}catch{return!1}const i=new URL(t,e);return e.origin===i.origin},Rr.createCDNWrapper=function(n){const t=`await import("${n}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};var Zl,Gd,kv,qd,Cv;const fs=class fs{constructor({name:t=null,port:e=null,verbosity:i=nD()}={}){P(this,Gd);var s;if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((s=d(fs,Zl))!=null&&s.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(d(fs,Zl)||S(fs,Zl,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return Ii?Promise.all([tr.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new ef("main","worker",t),this._messageHandler.on("ready",function(){}),k(this,Gd,kv).call(this)}_initialize(){if(Rr.isWorkerDisabled||d(fs,qd,Cv)){this._setupFakeWorker();return}let{workerSrc:t}=fs;try{Rr.isSameOrigin(window.location.href,t)||(t=Rr.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new ef("main","worker",e),s=()=>{r.abort(),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;e.addEventListener("error",()=>{this._webWorker||s()},{signal:r.signal}),i.on("test",o=>{if(r.abort(),this.destroyed||!o){s();return}this._messageHandler=i,this._port=e,this._webWorker=e,k(this,Gd,kv).call(this)}),i.on("ready",o=>{if(r.abort(),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{ww("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Rr.isWorkerDisabled||(Dt("Setting up fake worker."),Rr.isWorkerDisabled=!0),fs._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new kF;this._port=e;const i=`fake${Rr.fakeWorkerId++}`,s=new ef(i+"_worker",i,e);t.setup(s,e),this._messageHandler=new ef(i,i+"_worker",e),k(this,Gd,kv).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=d(fs,Zl))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var i;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(i=d(this,Zl))==null?void 0:i.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new fs(t)}static get workerSrc(){if(ha.workerSrc)return ha.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return $t(this,"_setupFakeWorkerGlobal",(async()=>d(this,qd,Cv)?d(this,qd,Cv):(await import(this.workerSrc)).WorkerMessageHandler)())}};Zl=new WeakMap,Gd=new WeakSet,kv=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},qd=new WeakSet,Cv=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},P(fs,qd),P(fs,Zl);let hd=fs;var Hr,jn,Xd,Yd,Bn,Jl,sf;class CF{constructor(t,e,i,s,r){P(this,Jl);P(this,Hr,new Map);P(this,jn,new Map);P(this,Xd,new Map);P(this,Yd,new Map);P(this,Bn,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new WR,this.fontLoader=new SD({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return $t(this,"annotationStorage",new PS)}getRenderingIntent(t,e=$a.ENABLE,i=null,s=!1){let r=js.DISPLAY,a=L1;switch(t){case"any":r=js.ANY;break;case"display":break;case"print":r=js.PRINT;break;default:Dt(`getRenderingIntent - invalid intent: ${t}`)}switch(e){case $a.DISABLE:r+=js.ANNOTATIONS_DISABLE;break;case $a.ENABLE:break;case $a.ENABLE_FORMS:r+=js.ANNOTATIONS_FORMS;break;case $a.ENABLE_STORAGE:r+=js.ANNOTATIONS_STORAGE,a=(r&js.PRINT&&i instanceof xR?i:this.annotationStorage).serializable;break;default:Dt(`getRenderingIntent - invalid annotationMode: ${e}`)}return s&&(r+=js.OPLIST),{renderingIntent:r,cacheKey:`${r}_${a.hash}`,annotationStorageSerializable:a}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=d(this,Bn))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of d(this,jn).values())t.push(s._destroy());d(this,jn).clear(),d(this,Xd).clear(),d(this,Yd).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var s;this.commonObjs.clear(),this.fontLoader.clear(),d(this,Hr).clear(),this.filterFactory.destroy(),Kb.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Bh("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{$e(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){s.close();return}$e(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",i=>{const s=Promise.withResolvers(),r=this._fullReader;return r.headersReady.then(()=>{var a;(!r.isStreamingSupported||!r.isRangeSupported)&&(this._lastProgress&&((a=e.onProgress)==null||a.call(e,this._lastProgress)),r.onProgress=o=>{var l;(l=e.onProgress)==null||l.call(e,{loaded:o.loaded,total:o.total})}),s.resolve({isStreamingSupported:r.isStreamingSupported,isRangeSupported:r.isRangeSupported,contentLength:r.contentLength})},s.reject),s.promise}),t.on("GetRangeReader",(i,s)=>{$e(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}$e(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new xF(i,this))}),t.on("DocException",function(i){let s;switch(i.name){case"PasswordException":s=new l1(i.message,i.code);break;case"InvalidPDFException":s=new zT(i.message);break;case"MissingPDFException":s=new jh(i.message);break;case"UnexpectedResponseException":s=new Aw(i.message,i.status);break;case"UnknownErrorException":s=new h1(i.message,i.details);break;default:te("DocException - expected a valid Error.")}e._capability.reject(s)}),t.on("PasswordRequest",i=>{if(S(this,Bn,Promise.withResolvers()),e.onPassword){const s=r=>{r instanceof Error?d(this,Bn).reject(r):d(this,Bn).resolve({password:r})};try{e.onPassword(s,i.code)}catch(r){d(this,Bn).reject(r)}}else d(this,Bn).reject(new l1(i.message,i.code));return d(this,Bn).promise}),t.on("DataLoaded",i=>{var s;(s=e.onProgress)==null||s.call(e,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;d(this,jn).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:o,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in r){const g=r.error;Dt(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const h=c&&((a=globalThis.FontInspector)!=null&&a.enabled)?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,f=new kD(r,{disableFontFace:o,inspectFont:h});this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l&&f.data&&(f.data=null),this.commonObjs.resolve(i,f)});break;case"CopyLocalImage":const{imageRef:p}=r;$e(p,"The imageRef must be defined.");for(const g of d(this,jn).values())for(const[,m]of g.objs)if((m==null?void 0:m.ref)===p)return m.dataLen?(this.commonObjs.resolve(i,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,r,a])=>{var l;if(this.destroyed)return;const o=d(this,jn).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":o.objs.resolve(i,a),(a==null?void 0:a.dataLen)>J2&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",i=>{var s;this.destroyed||(s=e.onProgress)==null||s.call(e,{loaded:i.loaded,total:i.total})}),t.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&Dt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((i=this._fullReader)==null?void 0:i.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=d(this,Xd).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&d(this,Yd).set(r.refStr,t);const a=new SF(e,r,this,this._params.pdfBug);return d(this,jn).set(e,a),a});return d(this,Xd).set(e,s),s}getPageIndex(t){return Hk(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return k(this,Jl,sf).call(this,"GetFieldObjects")}hasJSActions(){return k(this,Jl,sf).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return k(this,Jl,sf).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return k(this,Jl,sf).call(this,"GetOptionalContentConfig").then(e=>new GD(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=d(this,Hr).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new zD(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return d(this,Hr).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of d(this,jn).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),d(this,Hr).clear(),this.filterFactory.destroy(!0),Kb.cleanup()}}cachedPageNumber(t){if(!Hk(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return d(this,Yd).get(e)??null}}Hr=new WeakMap,jn=new WeakMap,Xd=new WeakMap,Yd=new WeakMap,Bn=new WeakMap,Jl=new WeakSet,sf=function(t,e=null){const i=d(this,Hr).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return d(this,Hr).set(t,s),s};const jm=Symbol("INITIAL_DATA");var an,Ig,W1;class WR{constructor(){P(this,Ig);P(this,an,Object.create(null))}get(t,e=null){if(e){const s=k(this,Ig,W1).call(this,t);return s.promise.then(()=>e(s.data)),null}const i=d(this,an)[t];if(!i||i.data===jm)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=d(this,an)[t];return!!e&&e.data!==jm}resolve(t,e=null){const i=k(this,Ig,W1).call(this,t);i.data=e,i.resolve()}clear(){var t;for(const e in d(this,an)){const{data:i}=d(this,an)[e];(t=i==null?void 0:i.bitmap)==null||t.close()}S(this,an,Object.create(null))}*[Symbol.iterator](){for(const t in d(this,an)){const{data:e}=d(this,an)[t];e!==jm&&(yield[t,e])}}}an=new WeakMap,Ig=new WeakSet,W1=function(t){var e;return(e=d(this,an))[t]||(e[t]={...Promise.withResolvers(),data:jm})};var co;class TF{constructor(t){P(this,co,null);S(this,co,t),this.onContinue=null}get promise(){return d(this,co).capability.promise}cancel(t=0){d(this,co).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=d(this,co).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=d(this,co);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}co=new WeakMap;var uo,th;const vl=class vl{constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:p=null}){P(this,uo,null);this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new TF(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var o,l;if(this.cancelled)return;if(this._canvas){if(d(vl,th).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");d(vl,th).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:a}=this.params;this.gfx=new ld(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(t=null,e=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),d(this,uo)&&(window.cancelAnimationFrame(d(this,uo)),S(this,uo,null)),d(vl,th).delete(this._canvas),this.callback(t||new kS(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?S(this,uo,window.requestAnimationFrame(()=>{S(this,uo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),d(vl,th).delete(this._canvas),this.callback())))}};uo=new WeakMap,th=new WeakMap,P(vl,th,new WeakSet);let H1=vl;const RF="4.4.168",PF="19fbc8998";function $k(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Iu(n){return Math.max(0,Math.min(255,255*n))}class Uk{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Iu(t),[t,t,t]}static G_HTML([t]){const e=$k(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Iu)}static RGB_HTML(t){return`#${t.map($k).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[Iu(1-Math.min(1,t+s)),Iu(1-Math.min(1,i+s)),Iu(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,r=1-e,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class HR{static setupStorage(t,e,i,s,r){const a=s.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),r==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",o=>{s.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),r==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:r}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}o&&r.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){var f,p;const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,r=t.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:r,linkService:i});const o=r!=="richText",l=t.div;if(l.append(a),t.viewport){const g=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=g}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const g=document.createTextNode(s.value);a.append(g),o&&Bp.shouldBuildText(s.name)&&c.push(g)}return{textDivs:c}}const h=[[s,-1,a]];for(;h.length>0;){const[g,m,b]=h.at(-1);if(m+1===g.children.length){h.pop();continue}const y=g.children[++h.at(-1)[1]];if(y===null)continue;const{name:w}=y;if(w==="#text"){const R=document.createTextNode(y.value);c.push(R),b.append(R);continue}const x=(f=y==null?void 0:y.attributes)!=null&&f.xmlns?document.createElementNS(y.attributes.xmlns,w):document.createElement(w);if(b.append(x),y.attributes&&this.setAttributes({html:x,element:y,storage:e,intent:r,linkService:i}),((p=y.children)==null?void 0:p.length)>0)h.push([y,-1,x]);else if(y.value){const R=document.createTextNode(y.value);o&&Bp.shouldBuildText(w)&&c.push(R),x.append(R)}}for(const g of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Sm=1e3,LF=9,Th=new WeakSet;function ca(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class MF{static create(t){switch(t.data.annotationType){case De.LINK:return new $R(t);case De.TEXT:return new IF(t);case De.WIDGET:switch(t.data.fieldType){case"Tx":return new DF(t);case"Btn":return t.data.radioButton?new VR(t):t.data.checkBox?new OF(t):new NF(t);case"Ch":return new jF(t);case"Sig":return new FF(t)}return new Wh(t);case De.POPUP:return new U1(t);case De.FREETEXT:return new KR(t);case De.LINE:return new WF(t);case De.SQUARE:return new HF(t);case De.CIRCLE:return new $F(t);case De.POLYLINE:return new QR(t);case De.CARET:return new zF(t);case De.INK:return new ZR(t);case De.POLYGON:return new UF(t);case De.HIGHLIGHT:return new VF(t);case De.UNDERLINE:return new GF(t);case De.SQUIGGLY:return new qF(t);case De.STRIKEOUT:return new XF(t);case De.STAMP:return new JR(t);case De.FILEATTACHMENT:return new YF(t);default:return new Se(t)}}}var eh,Kd,Qd,Dg,$1;const Ak=class Ak{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){P(this,Dg);P(this,eh,null);P(this,Kd,!1);P(this,Qd,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t!=null&&t.str||e!=null&&e.str||i!=null&&i.str)}get hasPopupData(){return Ak._hasPopupData(this.data)}updateEdited(t){var i;if(!this.container)return;d(this,eh)||S(this,eh,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&k(this,Dg,$1).call(this,e),(i=d(this,Qd))==null||i.popup.updateEdited(t)}resetEdited(){var t;d(this,eh)&&(k(this,Dg,$1).call(this,d(this,eh).rect),(t=d(this,Qd))==null||t.popup.resetEdited(),S(this,eh,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof Wh||(r.tabIndex=Sm);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,e.popupRef&&r.setAttribute("aria-haspopup","dialog"),e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof U1){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:o,height:l}=ca(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,y=e.borderStyle.verticalCornerRadius;if(b>0||y>0){const x=`calc(${b}px * var(--scale-factor)) / calc(${y}px * var(--scale-factor))`;a.borderRadius=x}else if(this instanceof VR){const x=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=x}switch(e.borderStyle.style){case Lu.SOLID:a.borderStyle="solid";break;case Lu.DASHED:a.borderStyle="dashed";break;case Lu.BEVELED:Dt("Unimplemented border style: beveled");break;case Lu.INSET:Dt("Unimplemented border style: inset");break;case Lu.UNDERLINE:a.borderBottomStyle="solid";break}const w=e.borderColor||null;w?(S(this,Kd,!0),a.borderColor=pt.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):a.borderWidth=0}const c=pt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:f,pageX:p,pageY:g}=s.rawDims;a.left=`${100*(c[0]-p)/h}%`,a.top=`${100*(c[1]-g)/f}%`;const{rotation:m}=e;return e.hasOwnCanvas||m===0?(a.width=`${100*o/h}%`,a.height=`${100*l/f}%`):this.setRotation(m,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:r,height:a}=ca(this.data.rect);let o,l;t%180===0?(o=100*r/i,l=100*a/s):(o=100*a/i,l=100*r/s),e.style.width=`${o}%`,e.style.height=`${l}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const r=s.detail[e],a=r[0],o=r.slice(1);s.target.style[i]=Uk[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:Uk[`${a}_rgb`](o)})};return $t(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail)){const r=t[s]||i[s];r==null||r(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,r]of Object.entries(e)){const a=i[s];if(a){const o={detail:{[s]:r},target:t};a(o),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,r]=this.data.rect.map(b=>Math.fround(b));if(t.length===8){const[b,y,w,x]=t.subarray(2,6);if(s===b&&r===y&&e===w&&i===x)return}const{style:a}=this.container;let o;if(d(this,Kd)){const{borderColor:b,borderWidth:y}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const l=s-e,c=r-i,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=h.createElement("defs");f.append(p);const g=h.createElement("clipPath"),m=`clippath_${this.data.id}`;g.setAttribute("id",m),g.setAttribute("clipPathUnits","objectBoundingBox"),p.append(g);for(let b=2,y=t.length;b<y;b+=8){const w=t[b],x=t[b+1],R=t[b+2],I=t[b+3],D=h.createElement("rect"),F=(R-e)/l,O=(r-x)/c,L=(w-R)/l,M=(x-I)/c;D.setAttribute("x",F),D.setAttribute("y",O),D.setAttribute("width",L),D.setAttribute("height",M),g.append(D),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${O}" width="${L}" height="${M}"/>`)}d(this,Kd)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const i=S(this,Qd,new U1({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}render(){te("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===e)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Th.has(c)){Dt(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(t)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==e&&Th.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};eh=new WeakMap,Kd=new WeakMap,Qd=new WeakMap,Dg=new WeakSet,$1=function(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...t);const{width:c,height:h}=ca(t);e.left=`${100*(t[0]-o)/r}%`,e.top=`${100*(a-t[3]+l)/a}%`,s===0?(e.width=`${100*c/r}%`,e.height=`${100*h/a}%`):this.setRotation(s)};let Se=Ak;var Es,Ho,UR,zR;class $R extends Se{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});P(this,Es);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let r=!1;return e.url?(i.addLinkAttributes(s,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(s,e.action),r=!0):e.attachment?(k(this,Es,UR).call(this,s,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(k(this,Es,zR).call(this,s,e.setOCGState),r=!0):e.dest?(this._bindLink(s,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),r=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&k(this,Es,Ho).call(this)}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),k(this,Es,Ho).call(this)}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const a=s.get(r);a&&(e[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}e.onclick||(e.onclick=()=>!1),k(this,Es,Ho).call(this)}_bindResetFormAction(e,i){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),k(this,Es,Ho).call(this),!this._fieldObjects){Dt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{var f;s==null||s();const{fields:r,refs:a,include:o}=i,l=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const g of r){const m=this._fieldObjects[g]||[];for(const{id:b}of m)p.add(b)}for(const g of Object.values(this._fieldObjects))for(const m of g)p.has(m.id)===o&&l.push(m)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const c=this.annotationStorage,h=[];for(const p of l){const{id:g}=p;switch(h.push(g),p.type){case"text":{const b=p.defaultValue||"";c.setValue(g,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;c.setValue(g,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";c.setValue(g,{value:b});break}default:continue}const m=document.querySelector(`[data-element-id="${g}"]`);if(m){if(!Th.has(m)){Dt(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Es=new WeakSet,Ho=function(){this.container.setAttribute("data-internal-link","")},UR=function(e,i,s=null){e.href=this.linkService.getAnchorUrl(""),i.description&&(e.title=i.description),e.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},k(this,Es,Ho).call(this)},zR=function(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),k(this,Es,Ho).call(this)};class IF extends Se{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Wh extends Se{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ns.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,r){i.includes("mouse")?t.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{var o;if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(t,e,i,s){var r,a,o;for(const[l,c]of i)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":pt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||LF,r=t.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(cA*s))||1,f=c/h;a=Math.min(s,l(f/cA))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/cA))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=pt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class DF extends Wh{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),r.setValue(a.id,{[s]:i})}render(){var s,r;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Th.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=Sm,this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",p=>{t.setValue(e,{value:p.target.value}),this.setPropertyOnSiblings(i,"value",p.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue??"";i.value=h.userValue=g,h.formattedValue=null});let f=p=>{const{formattedValue:g}=h;g!=null&&(p.target.value=g),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",g=>{var b;if(h.focused)return;const{target:m}=g;h.userValue&&(m.value=h.userValue),h.lastCommittedValue=m.value,h.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(b){h.userValue=b.detail.value??"",t.setValue(e,{value:h.userValue.toString()}),b.target.value=h.userValue},formattedValue(b){const{formattedValue:y}=b.detail;h.formattedValue=y,y!=null&&b.target!==document.activeElement&&(b.target.value=y),t.setValue(e,{formattedValue:y})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var R;const{charLimit:y}=b.detail,{target:w}=b;if(y===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",y);let x=h.userValue;!x||x.length<=y||(x=x.slice(0,y),w.value=h.userValue=x,t.setValue(e,{value:x}),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),i.addEventListener("keydown",g=>{var y;h.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(h.commitKey=3),m===-1)return;const{value:b}=g.target;h.lastCommittedValue!==b&&(h.lastCommittedValue=b,h.userValue=b,(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const p=f;f=null,i.addEventListener("blur",g=>{var b,y;if(!h.focused||!g.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(h.focused=!1);const{value:m}=g.target;h.userValue=m,h.lastCommittedValue!==m&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),p(g)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",g=>{var D;h.lastCommittedValue=null;const{data:m,target:b}=g,{value:y,selectionStart:w,selectionEnd:x}=b;let R=w,I=x;switch(g.inputType){case"deleteWordBackward":{const F=y.substring(0,w).match(/\w*[^\w]*$/);F&&(R-=F[0].length);break}case"deleteWordForward":{const F=y.substring(w).match(/^[^\w]*\w*/);F&&(I+=F[0].length);break}case"deleteContentBackward":w===x&&(R-=1);break;case"deleteContentForward":w===x&&(I+=1);break}g.preventDefault(),(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,change:m||"",willCommit:!1,selStart:R,selEnd:I}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${g}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class FF extends Wh{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class OF extends Wh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Th.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=Sm,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const h=l&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=h),t.setValue(c.id,{value:h})}t.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class VR extends Wh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const r=document.createElement("input");if(Th.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=Sm,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))t.setValue(c.id,{value:!1});t.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const p=h&&f.id===i;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class NF extends $R{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class jF extends Wh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Th.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=Sm;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const p of s.options)p.selected=p.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,i.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),r=!1),s.append(f)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const f=h?"value":"textContent",{options:p,multiple:g}=s;return g?Array.prototype.filter.call(p,m=>m.selected).map(m=>m[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const c=h=>{const f=h.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const f={value(p){a==null||a();const g=p.detail.value,m=new Set(Array.isArray(g)?g:[g]);for(const b of s.options)b.selected=m.has(b.value);t.setValue(e,{value:o(!0)}),l=o(!1)},multipleSelection(p){s.multiple=!0},remove(p){const g=s.options,m=p.detail.remove;g[m].selected=!1,s.remove(m),g.length>0&&Array.prototype.findIndex.call(g,y=>y.selected)===-1&&(g[0].selected=!0),t.setValue(e,{value:o(!0),items:c(p)}),l=o(!1)},clear(p){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),l=o(!1)},insert(p){const{index:g,displayValue:m,exportValue:b}=p.detail.insert,y=s.children[g],w=document.createElement("option");w.textContent=m,w.value=b,y?y.before(w):s.append(w),t.setValue(e,{value:o(!0),items:c(p)}),l=o(!1)},items(p){const{items:g}=p.detail;for(;s.length!==0;)s.remove(0);for(const m of g){const{displayValue:b,exportValue:y}=m,w=document.createElement("option");w.textContent=b,w.value=y,s.append(w)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(p)}),l=o(!1)},indices(p){const g=new Set(p.detail.indices);for(const m of p.target.options)m.selected=g.has(m.index);t.setValue(e,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,h)}),s.addEventListener("input",h=>{var g;const f=o(!0),p=o(!1);t.setValue(e,{value:f}),h.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class U1 extends Se{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:Se._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new BF({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${GT}${i}`).join(",")),this.container}}var Zd,fw,pw,Jd,ih,_e,$r,sh,Fg,Og,tu,Ur,on,zr,Ng,Vr,jg,nh,rh,ie,Tv,z1,GR,qR,XR,YR,Rv,Pv,V1;class BF{constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:f}){P(this,ie);P(this,Zd,k(this,ie,XR).bind(this));P(this,fw,k(this,ie,V1).bind(this));P(this,pw,k(this,ie,Pv).bind(this));P(this,Jd,k(this,ie,Rv).bind(this));P(this,ih,null);P(this,_e,null);P(this,$r,null);P(this,sh,null);P(this,Fg,null);P(this,Og,null);P(this,tu,null);P(this,Ur,!1);P(this,on,null);P(this,zr,null);P(this,Ng,null);P(this,Vr,null);P(this,jg,null);P(this,nh,null);P(this,rh,!1);var p;S(this,_e,t),S(this,jg,s),S(this,$r,a),S(this,Vr,o),S(this,Og,l),S(this,ih,e),S(this,Ng,c),S(this,tu,h),S(this,Fg,i),S(this,sh,QT.toDateObject(r)),this.trigger=i.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",d(this,Jd)),g.addEventListener("mouseenter",d(this,pw)),g.addEventListener("mouseleave",d(this,fw)),g.classList.add("popupTriggerArea");for(const g of i)(p=g.container)==null||p.addEventListener("keydown",d(this,Zd));d(this,_e).hidden=!0,f&&k(this,ie,Rv).call(this)}render(){if(d(this,on))return;const t=S(this,on,document.createElement("div"));if(t.className="popup",d(this,ih)){const r=t.style.outlineColor=pt.makeHexColor(...d(this,ih));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:t.style.backgroundColor=pt.makeHexColor(...d(this,ih).map(o=>Math.floor(.7*(255-o)+o)))}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=d(this,jg),t.append(e),d(this,sh)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),r.setAttribute("data-l10n-args",JSON.stringify({date:d(this,sh).toLocaleDateString(),time:d(this,sh).toLocaleTimeString()})),e.append(r)}const s=d(this,ie,Tv);if(s)HR.render({xfaHtml:s,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(d(this,$r));t.append(r)}d(this,_e).append(t)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let r=0,a=s.length;r<a;++r){const o=s[r];i.append(document.createTextNode(o)),r<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:t,popupContent:e}){var i;d(this,nh)||S(this,nh,{contentsObj:d(this,$r),richText:d(this,Vr)}),t&&S(this,zr,null),e&&(S(this,Vr,k(this,ie,qR).call(this,e)),S(this,$r,null)),(i=d(this,on))==null||i.remove(),S(this,on,null)}resetEdited(){var t;d(this,nh)&&({contentsObj:hs(this,$r)._,richText:hs(this,Vr)._}=d(this,nh),S(this,nh,null),(t=d(this,on))==null||t.remove(),S(this,on,null),S(this,zr,null))}forceHide(){S(this,rh,this.isVisible),d(this,rh)&&(d(this,_e).hidden=!0)}maybeShow(){d(this,rh)&&(d(this,on)||k(this,ie,Pv).call(this),S(this,rh,!1),d(this,_e).hidden=!1)}get isVisible(){return d(this,_e).hidden===!1}}Zd=new WeakMap,fw=new WeakMap,pw=new WeakMap,Jd=new WeakMap,ih=new WeakMap,_e=new WeakMap,$r=new WeakMap,sh=new WeakMap,Fg=new WeakMap,Og=new WeakMap,tu=new WeakMap,Ur=new WeakMap,on=new WeakMap,zr=new WeakMap,Ng=new WeakMap,Vr=new WeakMap,jg=new WeakMap,nh=new WeakMap,rh=new WeakMap,ie=new WeakSet,Tv=function(){const t=d(this,Vr),e=d(this,$r);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&d(this,Vr).html||null},z1=function(){var t,e,i;return((i=(e=(t=d(this,ie,Tv))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.fontSize)||0},GR=function(){var t,e,i;return((i=(e=(t=d(this,ie,Tv))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.color)||null},qR=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:d(this,ie,GR),fontSize:d(this,ie,z1)?`calc(${d(this,ie,z1)}px * var(--scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:s});return i},XR=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&d(this,Ur))&&k(this,ie,Rv).call(this)},YR=function(){if(d(this,zr)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:r}}}=d(this,Og);let a=!!d(this,tu),o=a?d(this,tu):d(this,Ng);for(const m of d(this,Fg))if(!o||pt.intersect(m.data.rect,o)!==null){o=m.data.rect,a=!0;break}const l=pt.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),h=a?o[2]-o[0]+5:0,f=l[0]+h,p=l[1];S(this,zr,[100*(f-s)/e,100*(p-r)/i]);const{style:g}=d(this,_e);g.left=`${d(this,zr)[0]}%`,g.top=`${d(this,zr)[1]}%`},Rv=function(){S(this,Ur,!d(this,Ur)),d(this,Ur)?(k(this,ie,Pv).call(this),d(this,_e).addEventListener("click",d(this,Jd)),d(this,_e).addEventListener("keydown",d(this,Zd))):(k(this,ie,V1).call(this),d(this,_e).removeEventListener("click",d(this,Jd)),d(this,_e).removeEventListener("keydown",d(this,Zd)))},Pv=function(){d(this,on)||this.render(),this.isVisible?d(this,Ur)&&d(this,_e).classList.add("focused"):(k(this,ie,YR).call(this),d(this,_e).hidden=!1,d(this,_e).style.zIndex=parseInt(d(this,_e).style.zIndex)+1e3)},V1=function(){d(this,_e).classList.remove("focused"),!(d(this,Ur)||!this.isVisible)&&(d(this,_e).hidden=!0,d(this,_e).style.zIndex=parseInt(d(this,_e).style.zIndex)-1e3)};class KR extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Wt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}var Bg;class WF extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});P(this,Bg,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:i,height:s}=ca(e.rect),r=this.svgFactory.create(i,s,!0),a=S(this,Bg,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,Bg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bg=new WeakMap;var Wg;class HF extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});P(this,Wg,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:i,height:s}=ca(e.rect),r=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=S(this,Wg,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,Wg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wg=new WeakMap;var Hg;class $F extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});P(this,Hg,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:i,height:s}=ca(e.rect),r=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=S(this,Hg,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,Hg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hg=new WeakMap;var $g;class QR extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});P(this,$g,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:i,borderStyle:s,popupRef:r}}=this;if(!i)return this.container;const{width:a,height:o}=ca(e),l=this.svgFactory.create(a,o,!0);let c=[];for(let f=0,p=i.length;f<p;f+=2){const g=i[f]-e[0],m=e[3]-i[f+1];c.push(`${g},${m}`)}c=c.join(" ");const h=S(this,$g,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",c),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,$g)}addHighlightArea(){this.container.classList.add("highlightArea")}}$g=new WeakMap;class UF extends QR{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class zF extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Ug;class ZR extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});P(this,Ug,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=Wt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:i,borderStyle:s,popupRef:r}}=this,{width:a,height:o}=ca(e),l=this.svgFactory.create(a,o,!0);for(const c of i){let h=[];for(let p=0,g=c.length;p<g;p+=2){const m=c[p]-e[0],b=e[3]-c[p+1];h.push(`${m},${b}`)}h=h.join(" ");const f=this.svgFactory.createElement(this.svgElementName);d(this,Ug).push(f),f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),!r&&this.hasPopupData&&this._createPopup(),l.append(f)}return this.container.append(l),this.container}getElementsToTriggerPopup(){return d(this,Ug)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ug=new WeakMap;class VF extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class GF extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class qF extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class XF extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class JR extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var zg,Vg,G1;class YF extends Se{constructor(e){var s;super(e,{isRenderable:!0});P(this,Vg);P(this,zg,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",k(this,Vg,G1).bind(this)),S(this,zg,s);const{isMac:r}=ns.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&k(this,Vg,G1).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return d(this,zg)}addHighlightArea(){this.container.classList.add("highlightArea")}}zg=new WeakMap,Vg=new WeakSet,G1=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var Gg,ah,eu,Oh,tP,q1,$T;let KF=($T=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a}){P(this,Oh);P(this,Gg,null);P(this,ah,null);P(this,eu,new Map);this.div=t,S(this,Gg,e),S(this,ah,i),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}async render(t){var a;const{annotations:e}=t,i=this.div;kh(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new SS,annotationStorage:t.annotationStorage||new PS,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const l=o.annotationType===De.POPUP;if(l){const f=s.get(o.id);if(!f)continue;r.elements=f}else{const{width:f,height:p}=ca(o.rect);if(f<=0||p<=0)continue}r.data=o;const c=MF.create(r);if(!c.isRenderable)continue;if(!l&&o.popupRef){const f=s.get(o.popupRef);f?f.push(c):s.set(o.popupRef,[c])}const h=c.render();o.hidden&&(h.style.visibility="hidden"),k(this,Oh,tP).call(this,h,o.id),c.annotationEditorType>0&&(d(this,eu).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}k(this,Oh,q1).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,kh(e,{rotation:t.rotation}),k(this,Oh,q1).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(d(this,eu).values())}getEditableAnnotation(t){return d(this,eu).get(t)}},Gg=new WeakMap,ah=new WeakMap,eu=new WeakMap,Oh=new WeakSet,tP=function(t,e){var s;const i=t.firstChild||t;i.id=`${GT}${e}`,this.div.append(t),(s=d(this,Gg))==null||s.moveElementInDOM(this.div,t,i,!1)},q1=function(){if(!d(this,ah))return;const t=this.div;for(const[e,i]of d(this,ah)){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i)}d(this,ah).clear()},$T);const Bm=/\r\n?|\n/g;var qg,Xg,Yg,Kg,Qg,ln,bs,Zg,ys,iu,Ie,eP,iP,sP,Lv,fa,Mv,Iv,nP,Y1,rP;const de=class de extends Qt{constructor(e){super({...e,name:"freeTextEditor"});P(this,Ie);P(this,qg,this.editorDivBlur.bind(this));P(this,Xg,this.editorDivFocus.bind(this));P(this,Yg,this.editorDivInput.bind(this));P(this,Kg,this.editorDivKeydown.bind(this));P(this,Qg,this.editorDivPaste.bind(this));P(this,ln);P(this,bs,"");P(this,Zg,`${this.id}-editor`);P(this,ys);P(this,iu,null);S(this,ln,e.color||de._defaultColor||Qt._defaultLineColor),S(this,ys,e.fontSize||de._defaultFontSize)}static get _keyboardManager(){const e=de.prototype,i=a=>a.isEmpty(),s=Ch.TRANSLATE_SMALL,r=Ch.TRANSLATE_BIG;return $t(this,"_keyboardManager",new Em([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(e,i){Qt.initialize(e,i,{strings:["pdfjs-free-text-default-content"]});const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case kt.FREETEXT_SIZE:de._defaultFontSize=i;break;case kt.FREETEXT_COLOR:de._defaultColor=i;break}}updateParams(e,i){switch(e){case kt.FREETEXT_SIZE:k(this,Ie,eP).call(this,i);break;case kt.FREETEXT_COLOR:k(this,Ie,iP).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[kt.FREETEXT_SIZE,de._defaultFontSize],[kt.FREETEXT_COLOR,de._defaultColor||Qt._defaultLineColor]]}get propertiesToUpdate(){return[[kt.FREETEXT_SIZE,d(this,ys)],[kt.FREETEXT_COLOR,d(this,ln)]]}_translateEmpty(e,i){this._uiManager.translateSelectedEditors(e,i,!0)}getInitialTranslation(){const e=this.parentScale;return[-de._internalPadding*e,-(de._internalPadding+d(this,ys))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Wt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant");const e=this._uiManager._signal;this.editorDiv.addEventListener("keydown",d(this,Kg),{signal:e}),this.editorDiv.addEventListener("focus",d(this,Xg),{signal:e}),this.editorDiv.addEventListener("blur",d(this,qg),{signal:e}),this.editorDiv.addEventListener("input",d(this,Yg),{signal:e}),this.editorDiv.addEventListener("paste",d(this,Qg),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",d(this,Zg)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",d(this,Kg)),this.editorDiv.removeEventListener("focus",d(this,Xg)),this.editorDiv.removeEventListener("blur",d(this,qg)),this.editorDiv.removeEventListener("input",d(this,Yg)),this.editorDiv.removeEventListener("paste",d(this,Qg)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=d(this,bs),i=S(this,bs,k(this,Ie,sP).call(this).trimEnd());if(e===i)return;const s=r=>{if(S(this,bs,r),!r){this.remove();return}k(this,Ie,Iv).call(this),this._uiManager.rebuild(this),k(this,Ie,Lv).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(e)},mustExec:!1}),k(this,Ie,Lv).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){de._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",d(this,Zg)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),Qt._l10nPromise.get("pdfjs-free-text-default-content").then(r=>{var a;return(a=this.editorDiv)==null?void 0:a.setAttribute("default-content",r)}),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${d(this,ys)}px * var(--scale-factor))`,s.color=d(this,ln),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),qb(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=d(this,iu);let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[h,f]=this.pageDimensions,[p,g]=this.pageTranslation;let m,b;switch(this.rotation){case 0:m=e+(o[0]-p)/h,b=i+this.height-(o[1]-g)/f;break;case 90:m=e+(o[0]-p)/h,b=i-(o[1]-g)/f,[l,c]=[c,-l];break;case 180:m=e-this.width+(o[0]-p)/h,b=i-(o[1]-g)/f,[l,c]=[-l,-c];break;case 270:m=e+(o[0]-p-this.height*f)/h,b=i+(o[1]-g-this.width*h)/f,[l,c]=[-c,l];break}this.setAt(m*r,b*a,l,c)}else this.setAt(e*r,i*a,this.width*r,this.height*a);k(this,Ie,Iv).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var m,b,y;const i=e.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const r=k(m=de,fa,Y1).call(m,i.getData("text")||"").replaceAll(Bm,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,h=[],f=[];if(l.nodeType===Node.TEXT_NODE){const w=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll(Bm,"")),w!==this.editorDiv){let x=h;for(const R of this.editorDiv.childNodes){if(R===w){x=f;continue}x.push(k(b=de,fa,Mv).call(b,R))}}h.push(l.nodeValue.slice(0,c).replaceAll(Bm,""))}else if(l===this.editorDiv){let w=h,x=0;for(const R of this.editorDiv.childNodes)x++===c&&(w=f),w.push(k(y=de,fa,Mv).call(y,R))}S(this,bs,`${h.join(`
`)}${r}${f.join(`
`)}`),k(this,Ie,Iv).call(this);const p=new Range;let g=h.reduce((w,x)=>w+x.length,0);for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const x=w.nodeValue.length;if(g<=x){p.setStart(w,g),p.setEnd(w,g);break}g-=x}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}static deserialize(e,i,s){var o;let r=null;if(e instanceof KR){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:f,id:p},textContent:g,textPosition:m,parent:{page:{pageNumber:b}}}=e;if(!g||g.length===0)return null;r=e={annotationType:Wt.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:m,pageIndex:b-1,rect:h.slice(0),rotation:f,id:p,deleted:!1}}const a=super.deserialize(e,i,s);return S(a,ys,e.fontSize),S(a,ln,pt.makeHexColor(...e.color)),S(a,bs,k(o=de,fa,Y1).call(o,e.value)),a.annotationElementId=e.id||null,S(a,iu,r),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const i=de._internalPadding*this.parentScale,s=this.getRect(i,i),r=Qt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:d(this,ln)),a={annotationType:Wt.FREETEXT,color:r,fontSize:d(this,ys),value:k(this,Ie,nP).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?a:this.annotationElementId&&!k(this,Ie,rP).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(e){const i=super.renderAnnotationElement(e);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${d(this,ys)}px * var(--scale-factor))`,s.color=d(this,ln),i.replaceChildren();for(const a of d(this,bs).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const r=de._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:d(this,bs)}),i}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};qg=new WeakMap,Xg=new WeakMap,Yg=new WeakMap,Kg=new WeakMap,Qg=new WeakMap,ln=new WeakMap,bs=new WeakMap,Zg=new WeakMap,ys=new WeakMap,iu=new WeakMap,Ie=new WeakSet,eP=function(e){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-d(this,ys))*this.parentScale),S(this,ys,r),k(this,Ie,Lv).call(this)},s=d(this,ys);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},iP=function(e){const i=r=>{S(this,ln,this.editorDiv.style.color=r)},s=d(this,ln);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},sP=function(){var i;const e=[];this.editorDiv.normalize();for(const s of this.editorDiv.childNodes)e.push(k(i=de,fa,Mv).call(i,s));return e.join(`
`)},Lv=function(){const[e,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/i):(this.width=s.height/e,this.height=s.width/i),this.fixAndSetPosition()},fa=new WeakSet,Mv=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Bm,"")},Iv=function(){if(this.editorDiv.replaceChildren(),!!d(this,bs))for(const e of d(this,bs).split(`
`)){const i=document.createElement("div");i.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(i)}},nP=function(){return d(this,bs).replaceAll(" "," ")},Y1=function(e){return e.replaceAll(" "," ")},rP=function(e){const{value:i,fontSize:s,color:r,pageIndex:a}=d(this,iu);return this._hasBeenMoved||e.value!==i||e.fontSize!==s||e.color.some((o,l)=>o!==r[l])||e.pageIndex!==a},P(de,fa),Pt(de,"_freeTextDefaultContent",""),Pt(de,"_internalPadding",0),Pt(de,"_defaultColor",null),Pt(de,"_defaultFontSize",10),Pt(de,"_type","freetext"),Pt(de,"_editorType",Wt.FREETEXT);let X1=de;var Jg,fo,hn,zi,aP,Dv,oP,lP,Q1;class K1{constructor(t,e=0,i=0,s=!0){P(this,zi);P(this,Jg);P(this,fo,[]);P(this,hn,[]);let r=1/0,a=-1/0,o=1/0,l=-1/0;const h=10**-4;for(const{x:w,y:x,width:R,height:I}of t){const D=Math.floor((w-e)/h)*h,F=Math.ceil((w+R+e)/h)*h,O=Math.floor((x-e)/h)*h,L=Math.ceil((x+I+e)/h)*h,M=[D,O,L,!0],W=[F,O,L,!1];d(this,fo).push(M,W),r=Math.min(r,D),a=Math.max(a,F),o=Math.min(o,O),l=Math.max(l,L)}const f=a-r+2*i,p=l-o+2*i,g=r-i,m=o-i,b=d(this,fo).at(s?-1:-2),y=[b[0],b[2]];for(const w of d(this,fo)){const[x,R,I]=w;w[0]=(x-g)/f,w[1]=(R-m)/p,w[2]=(I-m)/p}S(this,Jg,{x:g,y:m,width:f,height:p,lastPoint:y})}getOutlines(){d(this,fo).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of d(this,fo))e[3]?(t.push(...k(this,zi,Q1).call(this,e)),k(this,zi,oP).call(this,e)):(k(this,zi,lP).call(this,e),t.push(...k(this,zi,Q1).call(this,e)));return k(this,zi,aP).call(this,t)}}Jg=new WeakMap,fo=new WeakMap,hn=new WeakMap,zi=new WeakSet,aP=function(t){const e=[],i=new Set;for(const a of t){const[o,l,c]=a;e.push([o,l,a],[o,c,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const l=e[a][2],c=e[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let r;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,h,f]=a;i.delete(a);let p=o,g=l;for(r=[o,c],s.push(r);;){let m;if(i.has(h))m=h;else if(i.has(f))m=f;else break;i.delete(m),[o,l,c,h,f]=m,p!==o&&(r.push(p,g,o,g===l?l:c),p=o),g=g===l?c:l}r.push(p,g)}return new QF(s,d(this,Jg))},Dv=function(t){const e=d(this,hn);let i=0,s=e.length-1;for(;i<=s;){const r=i+s>>1,a=e[r][0];if(a===t)return r;a<t?i=r+1:s=r-1}return s+1},oP=function([,t,e]){const i=k(this,zi,Dv).call(this,t);d(this,hn).splice(i,0,[t,e])},lP=function([,t,e]){const i=k(this,zi,Dv).call(this,t);for(let s=i;s<d(this,hn).length;s++){const[r,a]=d(this,hn)[s];if(r!==t)break;if(r===t&&a===e){d(this,hn).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,a]=d(this,hn)[s];if(r!==t)break;if(r===t&&a===e){d(this,hn).splice(s,1);return}}},Q1=function(t){const[e,i,s]=t,r=[[e,i,s]],a=k(this,zi,Dv).call(this,s);for(let o=0;o<a;o++){const[l,c]=d(this,hn)[o];for(let h=0,f=r.length;h<f;h++){const[,p,g]=r[h];if(!(c<=p||g<=l)){if(p>=l){if(g>c)r[h][1]=c;else{if(f===1)return[];r.splice(h,1),h--,f--}continue}r[h][2]=l,g>c&&r.push([e,c,g])}}}return r};class hP{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(t,e){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof J1}}var tm,su;class QF extends hP{constructor(e,i){super();P(this,tm);P(this,su);S(this,su,e),S(this,tm,i)}toSVGPath(){const e=[];for(const i of d(this,su)){let[s,r]=i;e.push(`M${s} ${r}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(e.push(`V${l}`),r=l):l===r&&(e.push(`H${o}`),s=o)}e.push("Z")}return e.join(" ")}serialize([e,i,s,r],a){const o=[],l=s-e,c=r-i;for(const h of d(this,su)){const f=new Array(h.length);for(let p=0;p<h.length;p+=2)f[p]=e+h[p]*l,f[p+1]=r-h[p+1]*c;o.push(f)}return o}get box(){return d(this,tm)}}tm=new WeakMap,su=new WeakMap;var Wn,Gr,nu,ru,Hn,jt,oh,lh,em,im,au,ou,po,sm,gw,mw,nm,Z1;const Cr=class Cr{constructor({x:t,y:e},i,s,r,a,o=0){P(this,nm);P(this,Wn);P(this,Gr,[]);P(this,nu);P(this,ru);P(this,Hn,[]);P(this,jt,new Float64Array(18));P(this,oh);P(this,lh);P(this,em);P(this,im);P(this,au);P(this,ou);P(this,po,[]);S(this,Wn,i),S(this,ou,r*s),S(this,ru,a),d(this,jt).set([NaN,NaN,NaN,NaN,t,e],6),S(this,nu,o),S(this,im,d(Cr,sm)*s),S(this,em,d(Cr,mw)*s),S(this,au,s),d(this,po).push(t,e)}get free(){return!0}isEmpty(){return isNaN(d(this,jt)[8])}add({x:t,y:e}){var M;S(this,oh,t),S(this,lh,e);const[i,s,r,a]=d(this,Wn);let[o,l,c,h]=d(this,jt).subarray(8,12);const f=t-c,p=e-h,g=Math.hypot(f,p);if(g<d(this,em))return!1;const m=g-d(this,im),b=m/g,y=b*f,w=b*p;let x=o,R=l;o=c,l=h,c+=y,h+=w,(M=d(this,po))==null||M.push(t,e);const I=-w/m,D=y/m,F=I*d(this,ou),O=D*d(this,ou);return d(this,jt).set(d(this,jt).subarray(2,8),0),d(this,jt).set([c+F,h+O],4),d(this,jt).set(d(this,jt).subarray(14,18),12),d(this,jt).set([c-F,h-O],16),isNaN(d(this,jt)[6])?(d(this,Hn).length===0&&(d(this,jt).set([o+F,l+O],2),d(this,Hn).push(NaN,NaN,NaN,NaN,(o+F-i)/r,(l+O-s)/a),d(this,jt).set([o-F,l-O],14),d(this,Gr).push(NaN,NaN,NaN,NaN,(o-F-i)/r,(l-O-s)/a)),d(this,jt).set([x,R,o,l,c,h],6),!this.isEmpty()):(d(this,jt).set([x,R,o,l,c,h],6),Math.abs(Math.atan2(R-l,x-o)-Math.atan2(w,y))<Math.PI/2?([o,l,c,h]=d(this,jt).subarray(2,6),d(this,Hn).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/r,((l+h)/2-s)/a),[o,l,x,R]=d(this,jt).subarray(14,18),d(this,Gr).push(NaN,NaN,NaN,NaN,((x+o)/2-i)/r,((R+l)/2-s)/a),!0):([x,R,o,l,c,h]=d(this,jt).subarray(0,6),d(this,Hn).push(((x+5*o)/6-i)/r,((R+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),[c,h,o,l,x,R]=d(this,jt).subarray(12,18),d(this,Gr).push(((x+5*o)/6-i)/r,((R+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=d(this,Hn),e=d(this,Gr),i=d(this,jt).subarray(4,6),s=d(this,jt).subarray(16,18),[r,a,o,l]=d(this,Wn),[c,h,f,p]=k(this,nm,Z1).call(this);if(isNaN(d(this,jt)[6])&&!this.isEmpty())return`M${(d(this,jt)[2]-r)/o} ${(d(this,jt)[3]-a)/l} L${(d(this,jt)[4]-r)/o} ${(d(this,jt)[5]-a)/l} L${c} ${h} L${f} ${p} L${(d(this,jt)[16]-r)/o} ${(d(this,jt)[17]-a)/l} L${(d(this,jt)[14]-r)/o} ${(d(this,jt)[15]-a)/l} Z`;const g=[];g.push(`M${t[4]} ${t[5]}`);for(let m=6;m<t.length;m+=6)isNaN(t[m])?g.push(`L${t[m+4]} ${t[m+5]}`):g.push(`C${t[m]} ${t[m+1]} ${t[m+2]} ${t[m+3]} ${t[m+4]} ${t[m+5]}`);g.push(`L${(i[0]-r)/o} ${(i[1]-a)/l} L${c} ${h} L${f} ${p} L${(s[0]-r)/o} ${(s[1]-a)/l}`);for(let m=e.length-6;m>=6;m-=6)isNaN(e[m])?g.push(`L${e[m+4]} ${e[m+5]}`):g.push(`C${e[m]} ${e[m+1]} ${e[m+2]} ${e[m+3]} ${e[m+4]} ${e[m+5]}`);return g.push(`L${e[4]} ${e[5]} Z`),g.join(" ")}getOutlines(){var w;const t=d(this,Hn),e=d(this,Gr),i=d(this,jt),s=i.subarray(4,6),r=i.subarray(16,18),[a,o,l,c]=d(this,Wn),h=new Float64Array((((w=d(this,po))==null?void 0:w.length)??0)+2);for(let x=0,R=h.length-2;x<R;x+=2)h[x]=(d(this,po)[x]-a)/l,h[x+1]=(d(this,po)[x+1]-o)/c;h[h.length-2]=(d(this,oh)-a)/l,h[h.length-1]=(d(this,lh)-o)/c;const[f,p,g,m]=k(this,nm,Z1).call(this);if(isNaN(i[6])&&!this.isEmpty()){const x=new Float64Array(36);return x.set([NaN,NaN,NaN,NaN,(i[2]-a)/l,(i[3]-o)/c,NaN,NaN,NaN,NaN,(i[4]-a)/l,(i[5]-o)/c,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(i[16]-a)/l,(i[17]-o)/c,NaN,NaN,NaN,NaN,(i[14]-a)/l,(i[15]-o)/c],0),new J1(x,h,d(this,Wn),d(this,au),d(this,nu),d(this,ru))}const b=new Float64Array(d(this,Hn).length+24+d(this,Gr).length);let y=t.length;for(let x=0;x<y;x+=2){if(isNaN(t[x])){b[x]=b[x+1]=NaN;continue}b[x]=t[x],b[x+1]=t[x+1]}b.set([NaN,NaN,NaN,NaN,(s[0]-a)/l,(s[1]-o)/c,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(r[0]-a)/l,(r[1]-o)/c],y),y+=24;for(let x=e.length-6;x>=6;x-=6)for(let R=0;R<6;R+=2){if(isNaN(e[x+R])){b[y]=b[y+1]=NaN,y+=2;continue}b[y]=e[x+R],b[y+1]=e[x+R+1],y+=2}return b.set([NaN,NaN,NaN,NaN,e[4],e[5]],y),new J1(b,h,d(this,Wn),d(this,au),d(this,nu),d(this,ru))}};Wn=new WeakMap,Gr=new WeakMap,nu=new WeakMap,ru=new WeakMap,Hn=new WeakMap,jt=new WeakMap,oh=new WeakMap,lh=new WeakMap,em=new WeakMap,im=new WeakMap,au=new WeakMap,ou=new WeakMap,po=new WeakMap,sm=new WeakMap,gw=new WeakMap,mw=new WeakMap,nm=new WeakSet,Z1=function(){const t=d(this,jt).subarray(4,6),e=d(this,jt).subarray(16,18),[i,s,r,a]=d(this,Wn);return[(d(this,oh)+(t[0]-e[0])/2-i)/r,(d(this,lh)+(t[1]-e[1])/2-s)/a,(d(this,oh)+(e[0]-t[0])/2-i)/r,(d(this,lh)+(e[1]-t[1])/2-s)/a]},P(Cr,sm,8),P(Cr,gw,2),P(Cr,mw,d(Cr,sm)+d(Cr,gw));let Qb=Cr;var lu,hh,qr,rm,ws,am,Ee,rs,nf,rf,cP;class J1 extends hP{constructor(e,i,s,r,a,o){super();P(this,rs);P(this,lu);P(this,hh,null);P(this,qr);P(this,rm);P(this,ws);P(this,am);P(this,Ee);S(this,Ee,e),S(this,ws,i),S(this,lu,s),S(this,am,r),S(this,qr,a),S(this,rm,o),k(this,rs,cP).call(this,o);const{x:l,y:c,width:h,height:f}=d(this,hh);for(let p=0,g=e.length;p<g;p+=2)e[p]=(e[p]-l)/h,e[p+1]=(e[p+1]-c)/f;for(let p=0,g=i.length;p<g;p+=2)i[p]=(i[p]-l)/h,i[p+1]=(i[p+1]-c)/f}toSVGPath(){const e=[`M${d(this,Ee)[4]} ${d(this,Ee)[5]}`];for(let i=6,s=d(this,Ee).length;i<s;i+=6){if(isNaN(d(this,Ee)[i])){e.push(`L${d(this,Ee)[i+4]} ${d(this,Ee)[i+5]}`);continue}e.push(`C${d(this,Ee)[i]} ${d(this,Ee)[i+1]} ${d(this,Ee)[i+2]} ${d(this,Ee)[i+3]} ${d(this,Ee)[i+4]} ${d(this,Ee)[i+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,i,s,r],a){const o=s-e,l=r-i;let c,h;switch(a){case 0:c=k(this,rs,nf).call(this,d(this,Ee),e,r,o,-l),h=k(this,rs,nf).call(this,d(this,ws),e,r,o,-l);break;case 90:c=k(this,rs,rf).call(this,d(this,Ee),e,i,o,l),h=k(this,rs,rf).call(this,d(this,ws),e,i,o,l);break;case 180:c=k(this,rs,nf).call(this,d(this,Ee),s,i,-o,l),h=k(this,rs,nf).call(this,d(this,ws),s,i,-o,l);break;case 270:c=k(this,rs,rf).call(this,d(this,Ee),s,r,-o,-l),h=k(this,rs,rf).call(this,d(this,ws),s,r,-o,-l);break}return{outline:Array.from(c),points:[Array.from(h)]}}get box(){return d(this,hh)}getNewOutline(e,i){const{x:s,y:r,width:a,height:o}=d(this,hh),[l,c,h,f]=d(this,lu),p=a*h,g=o*f,m=s*h+l,b=r*f+c,y=new Qb({x:d(this,ws)[0]*p+m,y:d(this,ws)[1]*g+b},d(this,lu),d(this,am),e,d(this,rm),i??d(this,qr));for(let w=2;w<d(this,ws).length;w+=2)y.add({x:d(this,ws)[w]*p+m,y:d(this,ws)[w+1]*g+b});return y.getOutlines()}}lu=new WeakMap,hh=new WeakMap,qr=new WeakMap,rm=new WeakMap,ws=new WeakMap,am=new WeakMap,Ee=new WeakMap,rs=new WeakSet,nf=function(e,i,s,r,a){const o=new Float64Array(e.length);for(let l=0,c=e.length;l<c;l+=2)o[l]=i+e[l]*r,o[l+1]=s+e[l+1]*a;return o},rf=function(e,i,s,r,a){const o=new Float64Array(e.length);for(let l=0,c=e.length;l<c;l+=2)o[l]=i+e[l+1]*r,o[l+1]=s+e[l]*a;return o},cP=function(e){const i=d(this,Ee);let s=i[4],r=i[5],a=s,o=r,l=s,c=r,h=s,f=r;const p=e?Math.max:Math.min;for(let w=6,x=i.length;w<x;w+=6){if(isNaN(i[w]))a=Math.min(a,i[w+4]),o=Math.min(o,i[w+5]),l=Math.max(l,i[w+4]),c=Math.max(c,i[w+5]),f<i[w+5]?(h=i[w+4],f=i[w+5]):f===i[w+5]&&(h=p(h,i[w+4]));else{const R=pt.bezierBoundingBox(s,r,...i.slice(w,w+6));a=Math.min(a,R[0]),o=Math.min(o,R[1]),l=Math.max(l,R[2]),c=Math.max(c,R[3]),f<R[3]?(h=R[2],f=R[3]):f===R[3]&&(h=p(h,R[2]))}s=i[w+4],r=i[w+5]}const g=a-d(this,qr),m=o-d(this,qr),b=l-a+2*d(this,qr),y=c-o+2*d(this,qr);S(this,hh,{x:g,y:m,width:b,height:y,lastPoint:[h,f]})};var om,lm,cn,ch,hu,je,hm,cu,cm,dm,dn,du,he,t_,e_,dP,$o,uP,Ea;const Tr=class Tr{constructor({editor:t=null,uiManager:e=null}){P(this,he);P(this,om,k(this,he,dP).bind(this));P(this,lm,k(this,he,uP).bind(this));P(this,cn,null);P(this,ch,null);P(this,hu);P(this,je,null);P(this,hm,!1);P(this,cu,!1);P(this,cm,null);P(this,dm);P(this,dn,null);P(this,du);var i;t?(S(this,cu,!1),S(this,du,kt.HIGHLIGHT_COLOR),S(this,cm,t)):(S(this,cu,!0),S(this,du,kt.HIGHLIGHT_DEFAULT_COLOR)),S(this,dn,(t==null?void 0:t._uiManager)||e),S(this,dm,d(this,dn)._eventBus),S(this,hu,(t==null?void 0:t.color)||((i=d(this,dn))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return $t(this,"_keyboardManager",new Em([[["Escape","mac+Escape"],Tr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Tr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Tr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Tr.prototype._moveToPrevious],[["Home","mac+Home"],Tr.prototype._moveToBeginning],[["End","mac+End"],Tr.prototype._moveToEnd]]))}renderButton(){const t=S(this,cn,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=d(this,dn)._signal;t.addEventListener("click",k(this,he,$o).bind(this),{signal:e}),t.addEventListener("keydown",d(this,om),{signal:e});const i=S(this,ch,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=d(this,hu),t.append(i),t}renderMainDropdown(){const t=S(this,je,k(this,he,t_).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===d(this,cn)){k(this,he,$o).call(this,t);return}const e=t.target.getAttribute("data-color");e&&k(this,he,e_).call(this,e,t)}_moveToNext(t){var e,i;if(!d(this,he,Ea)){k(this,he,$o).call(this,t);return}if(t.target===d(this,cn)){(e=d(this,je).firstChild)==null||e.focus();return}(i=t.target.nextSibling)==null||i.focus()}_moveToPrevious(t){var e,i;if(t.target===((e=d(this,je))==null?void 0:e.firstChild)||t.target===d(this,cn)){d(this,he,Ea)&&this._hideDropdownFromKeyboard();return}d(this,he,Ea)||k(this,he,$o).call(this,t),(i=t.target.previousSibling)==null||i.focus()}_moveToBeginning(t){var e;if(!d(this,he,Ea)){k(this,he,$o).call(this,t);return}(e=d(this,je).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!d(this,he,Ea)){k(this,he,$o).call(this,t);return}(e=d(this,je).lastChild)==null||e.focus()}hideDropdown(){var t;(t=d(this,je))==null||t.classList.add("hidden"),window.removeEventListener("pointerdown",d(this,lm))}_hideDropdownFromKeyboard(){var t;if(!d(this,cu)){if(!d(this,he,Ea)){(t=d(this,cm))==null||t.unselect();return}this.hideDropdown(),d(this,cn).focus({preventScroll:!0,focusVisible:d(this,hm)})}}updateColor(t){if(d(this,ch)&&(d(this,ch).style.backgroundColor=t),!d(this,je))return;const e=d(this,dn).highlightColors.values();for(const i of d(this,je).children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=d(this,cn))==null||t.remove(),S(this,cn,null),S(this,ch,null),(e=d(this,je))==null||e.remove(),S(this,je,null)}};om=new WeakMap,lm=new WeakMap,cn=new WeakMap,ch=new WeakMap,hu=new WeakMap,je=new WeakMap,hm=new WeakMap,cu=new WeakMap,cm=new WeakMap,dm=new WeakMap,dn=new WeakMap,du=new WeakMap,he=new WeakSet,t_=function(){const t=document.createElement("div"),e=d(this,dn)._signal;t.addEventListener("contextmenu",as,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of d(this,dn).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${i}`);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=s,r.setAttribute("aria-selected",s===d(this,hu)),r.addEventListener("click",k(this,he,e_).bind(this,s),{signal:e}),t.append(r)}return t.addEventListener("keydown",d(this,om),{signal:e}),t},e_=function(t,e){e.stopPropagation(),d(this,dm).dispatch("switchannotationeditorparams",{source:this,type:d(this,du),value:t})},dP=function(t){Tr._keyboardManager.exec(this,t)},$o=function(t){if(d(this,he,Ea)){this.hideDropdown();return}if(S(this,hm,t.detail===0),window.addEventListener("pointerdown",d(this,lm),{signal:d(this,dn)._signal}),d(this,je)){d(this,je).classList.remove("hidden");return}const e=S(this,je,k(this,he,t_).call(this));d(this,cn).append(e)},uP=function(t){var e;(e=d(this,je))!=null&&e.contains(t.target)||this.hideDropdown()},Ea=function(){return d(this,je)&&!d(this,je).classList.contains("hidden")};let Zb=Tr;var uu,um,go,dh,fu,Os,fm,pm,uh,un,ji,As,vw,pu,fh,Be,gu,$n,gm,Nt,i_,s_,fP,pP,gP,n_,af,zs,ac,mP,Fv,of,vP,bP,yP,wP;const qt=class qt extends Qt{constructor(e){super({...e,name:"highlightEditor"});P(this,Nt);P(this,uu,null);P(this,um,0);P(this,go);P(this,dh,null);P(this,fu,null);P(this,Os,null);P(this,fm,null);P(this,pm,0);P(this,uh,null);P(this,un,null);P(this,ji,null);P(this,As,!1);P(this,vw,k(this,Nt,mP).bind(this));P(this,pu,null);P(this,fh);P(this,Be,null);P(this,gu,"");P(this,$n);P(this,gm,"");this.color=e.color||qt._defaultColor,S(this,$n,e.thickness||qt._defaultThickness),S(this,fh,e.opacity||qt._defaultOpacity),S(this,go,e.boxes||null),S(this,gm,e.methodOfCreation||""),S(this,gu,e.text||""),this._isDraggable=!1,e.highlightId>-1?(S(this,As,!0),k(this,Nt,s_).call(this,e),k(this,Nt,af).call(this)):(S(this,uu,e.anchorNode),S(this,um,e.anchorOffset),S(this,fm,e.focusNode),S(this,pm,e.focusOffset),k(this,Nt,i_).call(this),k(this,Nt,af).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=qt.prototype;return $t(this,"_keyboardManager",new Em([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:d(this,As)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:d(this,$n),methodOfCreation:d(this,gm)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,i){var s;Qt.initialize(e,i),qt._defaultColor||(qt._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(e,i){switch(e){case kt.HIGHLIGHT_DEFAULT_COLOR:qt._defaultColor=i;break;case kt.HIGHLIGHT_THICKNESS:qt._defaultThickness=i;break}}translateInPage(e,i){}get toolbarPosition(){return d(this,pu)}updateParams(e,i){switch(e){case kt.HIGHLIGHT_COLOR:k(this,Nt,fP).call(this,i);break;case kt.HIGHLIGHT_THICKNESS:k(this,Nt,pP).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[kt.HIGHLIGHT_DEFAULT_COLOR,qt._defaultColor],[kt.HIGHLIGHT_THICKNESS,qt._defaultThickness]]}get propertiesToUpdate(){return[[kt.HIGHLIGHT_COLOR,this.color||qt._defaultColor],[kt.HIGHLIGHT_THICKNESS,d(this,$n)||qt._defaultThickness],[kt.HIGHLIGHT_FREE,d(this,As)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(S(this,fu,new Zb({editor:this})),e.addColorPicker(d(this,fu))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(k(this,Nt,of).call(this))}getBaseTranslation(){return[0,0]}getRect(e,i){return super.getRect(e,i,k(this,Nt,of).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){k(this,Nt,n_).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(k(this,Nt,af).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var s;let i=!1;this.parent&&!e?k(this,Nt,n_).call(this):e&&(k(this,Nt,af).call(this,e),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),i&&this.select()}rotate(e){var r,a,o;const{drawLayer:i}=this.parent;let s;d(this,As)?(e=(e-this.rotation+360)%360,s=k(r=qt,zs,ac).call(r,d(this,un).box,e)):s=k(a=qt,zs,ac).call(a,this,e),i.rotate(d(this,ji),e),i.rotate(d(this,Be),e),i.updateBox(d(this,ji),s),i.updateBox(d(this,Be),k(o=qt,zs,ac).call(o,d(this,Os).box,e))}render(){if(this.div)return this.div;const e=super.render();d(this,gu)&&(e.setAttribute("aria-label",d(this,gu)),e.setAttribute("role","mark")),d(this,As)?e.classList.add("free"):this.div.addEventListener("keydown",d(this,vw),{signal:this._uiManager._signal});const i=S(this,uh,document.createElement("div"));e.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=d(this,dh);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),qb(this,d(this,uh),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(d(this,Be),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(d(this,Be),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:k(this,Nt,Fv).call(this,!0);break;case 1:case 3:k(this,Nt,Fv).call(this,!1);break}}select(){var e,i;super.select(),d(this,Be)&&((e=this.parent)==null||e.drawLayer.removeClass(d(this,Be),"hovered"),(i=this.parent)==null||i.drawLayer.addClass(d(this,Be),"selected"))}unselect(){var e;super.unselect(),d(this,Be)&&((e=this.parent)==null||e.drawLayer.removeClass(d(this,Be),"selected"),d(this,As)||k(this,Nt,Fv).call(this,!1))}get _mustFixPosition(){return!d(this,As)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(d(this,ji),e),this.parent.drawLayer.show(d(this,Be),e))}static startHighlighting(e,i,{target:s,x:r,y:a}){const{x:o,y:l,width:c,height:h}=s.getBoundingClientRect(),f=y=>{k(this,zs,yP).call(this,e,y)},p=e._signal,g={capture:!0,passive:!1,signal:p},m=y=>{y.preventDefault(),y.stopPropagation()},b=y=>{s.removeEventListener("pointermove",f),window.removeEventListener("blur",b),window.removeEventListener("pointerup",b),window.removeEventListener("pointerdown",m,g),window.removeEventListener("contextmenu",as),k(this,zs,wP).call(this,e,y)};window.addEventListener("blur",b,{signal:p}),window.addEventListener("pointerup",b,{signal:p}),window.addEventListener("pointerdown",m,g),window.addEventListener("contextmenu",as,{signal:p}),s.addEventListener("pointermove",f,{signal:p}),this._freeHighlight=new Qb({x:r,y:a},[o,l,c,h],e.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(e,i,s){var b;const r=super.deserialize(e,i,s),{rect:[a,o,l,c],color:h,quadPoints:f}=e;r.color=pt.makeHexColor(...h),S(r,fh,e.opacity);const[p,g]=r.pageDimensions;r.width=(l-a)/p,r.height=(c-o)/g;const m=S(r,go,[]);for(let y=0;y<f.length;y+=8)m.push({x:(f[4]-l)/p,y:(c-(1-f[y+5]))/g,width:(f[y+2]-f[y])/p,height:(f[y+5]-f[y+1])/g});return k(b=r,Nt,i_).call(b),r}serialize(e=!1){if(this.isEmpty()||e)return null;const i=this.getRect(0,0),s=Qt._colorManager.convert(this.color);return{annotationType:Wt.HIGHLIGHT,color:s,opacity:d(this,fh),thickness:d(this,$n),quadPoints:k(this,Nt,vP).call(this),outlines:k(this,Nt,bP).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:k(this,Nt,of).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};uu=new WeakMap,um=new WeakMap,go=new WeakMap,dh=new WeakMap,fu=new WeakMap,Os=new WeakMap,fm=new WeakMap,pm=new WeakMap,uh=new WeakMap,un=new WeakMap,ji=new WeakMap,As=new WeakMap,vw=new WeakMap,pu=new WeakMap,fh=new WeakMap,Be=new WeakMap,gu=new WeakMap,$n=new WeakMap,gm=new WeakMap,Nt=new WeakSet,i_=function(){const e=new K1(d(this,go),.001);S(this,un,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=d(this,un).box;const i=new K1(d(this,go),.0025,.001,this._uiManager.direction==="ltr");S(this,Os,i.getOutlines());const{lastPoint:s}=d(this,Os).box;S(this,pu,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},s_=function({highlightOutlines:e,highlightId:i,clipPathId:s}){var f,p;if(S(this,un,e),S(this,Os,e.getNewOutline(d(this,$n)/2+1.5,.0025)),i>=0)S(this,ji,i),S(this,dh,s),this.parent.drawLayer.finalizeLine(i,e),S(this,Be,this.parent.drawLayer.highlightOutline(d(this,Os)));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(d(this,ji),e),this.parent.drawLayer.updateBox(d(this,ji),k(f=qt,zs,ac).call(f,d(this,un).box,(g-this.rotation+360)%360)),this.parent.drawLayer.updateLine(d(this,Be),d(this,Os)),this.parent.drawLayer.updateBox(d(this,Be),k(p=qt,zs,ac).call(p,d(this,Os).box,g))}const{x:a,y:o,width:l,height:c}=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[g,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*m/g,this.height=c*g/m;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[g,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*m/g,this.height=c*g/m;break}}const{lastPoint:h}=d(this,Os).box;S(this,pu,[(h[0]-a)/l,(h[1]-o)/c])},fP=function(e){const i=r=>{var a,o;this.color=r,(a=this.parent)==null||a.drawLayer.changeColor(d(this,ji),r),(o=d(this,fu))==null||o.updateColor(r)},s=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},pP=function(e){const i=d(this,$n),s=r=>{S(this,$n,r),k(this,Nt,gP).call(this,r)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},gP=function(e){if(!d(this,As))return;k(this,Nt,s_).call(this,{highlightOutlines:d(this,un).getNewOutline(e/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},n_=function(){d(this,ji)===null||!this.parent||(this.parent.drawLayer.remove(d(this,ji)),S(this,ji,null),this.parent.drawLayer.remove(d(this,Be)),S(this,Be,null))},af=function(e=this.parent){d(this,ji)===null&&({id:hs(this,ji)._,clipPathId:hs(this,dh)._}=e.drawLayer.highlight(d(this,un),this.color,d(this,fh)),S(this,Be,e.drawLayer.highlightOutline(d(this,Os))),d(this,uh)&&(d(this,uh).style.clipPath=d(this,dh)))},zs=new WeakSet,ac=function({x:e,y:i,width:s,height:r},a){switch(a){case 90:return{x:1-i-r,y:e,width:r,height:s};case 180:return{x:1-e-s,y:1-i-r,width:s,height:r};case 270:return{x:i,y:1-e-s,width:r,height:s}}return{x:e,y:i,width:s,height:r}},mP=function(e){qt._keyboardManager.exec(this,e)},Fv=function(e){if(!d(this,uu))return;const i=window.getSelection();e?i.setPosition(d(this,uu),d(this,um)):i.setPosition(d(this,fm),d(this,pm))},of=function(){return d(this,As)?this.rotation:0},vP=function(){if(d(this,As))return null;const[e,i]=this.pageDimensions,s=d(this,go),r=new Float32Array(s.length*8);let a=0;for(const{x:o,y:l,width:c,height:h}of s){const f=o*e,p=(1-l-h)*i;r[a]=r[a+4]=f,r[a+1]=r[a+3]=p,r[a+2]=r[a+6]=f+c*e,r[a+5]=r[a+7]=p+h*i,a+=8}return r},bP=function(e){return d(this,un).serialize(e,k(this,Nt,of).call(this))},yP=function(e,i){this._freeHighlight.add(i)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},wP=function(e,i){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},P(qt,zs),Pt(qt,"_defaultColor",null),Pt(qt,"_defaultOpacity",1),Pt(qt,"_defaultThickness",12),Pt(qt,"_l10nPromise"),Pt(qt,"_type","highlight"),Pt(qt,"_editorType",Wt.HIGHLIGHT),Pt(qt,"_freeHighlightId",-1),Pt(qt,"_freeHighlight",null),Pt(qt,"_freeHighlightClipId","");let Jb=qt;var ph,gh,mm,vm,bm,mh,Un,Xr,Ns,vh,bh,Yr,yh,wh,mo,ot,AP,_P,EP,xP,a_,SP,o_,kP,CP,TP,RP,PP,Uo,l_,Ov,Nv,oc,h_,jv,va,LP,c_,MP,IP,d_,Bv,lf;const be=class be extends Qt{constructor(e){super({...e,name:"inkEditor"});P(this,ot);P(this,ph,0);P(this,gh,0);P(this,mm,this.canvasPointermove.bind(this));P(this,vm,this.canvasPointerleave.bind(this));P(this,bm,this.canvasPointerup.bind(this));P(this,mh,this.canvasPointerdown.bind(this));P(this,Un,null);P(this,Xr,new Path2D);P(this,Ns,!1);P(this,vh,!1);P(this,bh,!1);P(this,Yr,null);P(this,yh,0);P(this,wh,0);P(this,mo,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,i){Qt.initialize(e,i)}static updateDefaultParams(e,i){switch(e){case kt.INK_THICKNESS:be._defaultThickness=i;break;case kt.INK_COLOR:be._defaultColor=i;break;case kt.INK_OPACITY:be._defaultOpacity=i/100;break}}updateParams(e,i){switch(e){case kt.INK_THICKNESS:k(this,ot,AP).call(this,i);break;case kt.INK_COLOR:k(this,ot,_P).call(this,i);break;case kt.INK_OPACITY:k(this,ot,EP).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[kt.INK_THICKNESS,be._defaultThickness],[kt.INK_COLOR,be._defaultColor||Qt._defaultLineColor],[kt.INK_OPACITY,Math.round(be._defaultOpacity*100)]]}get propertiesToUpdate(){return[[kt.INK_THICKNESS,this.thickness||be._defaultThickness],[kt.INK_COLOR,this.color||be._defaultColor||Qt._defaultLineColor],[kt.INK_OPACITY,Math.round(100*(this.opacity??be._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(k(this,ot,Ov).call(this),k(this,ot,Nv).call(this)),this.isAttachedToDOM||(this.parent.add(this),k(this,ot,oc).call(this)),k(this,ot,lf).call(this)))}remove(){var e;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,d(this,Un)&&(clearTimeout(d(this,Un)),S(this,Un,null)),(e=d(this,Yr))==null||e.disconnect(),S(this,Yr,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,i]=this.parentDimensions,s=this.width*e,r=this.height*i;this.setDimensions(s,r)}enableEditMode(){d(this,Ns)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",d(this,mh),{signal:this._uiManager._signal}))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",d(this,mh)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){d(this,Ns)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),S(this,Ns,!0),this.div.classList.add("disabled"),k(this,ot,lf).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||d(this,Ns)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),k(this,ot,SP).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),k(this,ot,o_).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),k(this,ot,l_).call(this,e)}canvasPointerleave(e){k(this,ot,l_).call(this,e)}get isResizable(){return!this.isEmpty()&&d(this,Ns)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[s,r,a,o]=k(this,ot,xP).call(this);if(this.setAt(s,r,0,0),this.setDims(a,o),k(this,ot,Ov).call(this),this.width){const[l,c]=this.parentDimensions;this.setAspectRatio(this.width*l,this.height*c),this.setAt(e*l,i*c,this.width*l,this.height*c),S(this,bh,!0),k(this,ot,oc).call(this),this.setDims(this.width*l,this.height*c),k(this,ot,Uo).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return k(this,ot,Nv).call(this),this.div}setDimensions(e,i){const s=Math.round(e),r=Math.round(i);if(d(this,yh)===s&&d(this,wh)===r)return;S(this,yh,s),S(this,wh,r),this.canvas.style.visibility="hidden";const[a,o]=this.parentDimensions;this.width=e/a,this.height=i/o,this.fixAndSetPosition(),d(this,Ns)&&k(this,ot,h_).call(this,e,i),k(this,ot,oc).call(this),k(this,ot,Uo).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(e,i,s){var y,w,x;if(e instanceof ZR)return null;const r=super.deserialize(e,i,s);r.thickness=e.thickness,r.color=pt.makeHexColor(...e.color),r.opacity=e.opacity;const[a,o]=r.pageDimensions,l=r.width*a,c=r.height*o,h=r.parentScale,f=e.thickness/2;S(r,Ns,!0),S(r,yh,Math.round(l)),S(r,wh,Math.round(c));const{paths:p,rect:g,rotation:m}=e;for(let{bezier:R}of p){R=k(y=be,va,MP).call(y,R,g,m);const I=[];r.paths.push(I);let D=h*(R[0]-f),F=h*(R[1]-f);for(let L=2,M=R.length;L<M;L+=6){const W=h*(R[L]-f),j=h*(R[L+1]-f),V=h*(R[L+2]-f),z=h*(R[L+3]-f),Y=h*(R[L+4]-f),K=h*(R[L+5]-f);I.push([[D,F],[W,j],[V,z],[Y,K]]),D=Y,F=K}const O=k(this,va,LP).call(this,I);r.bezierPath2D.push(O)}const b=k(w=r,ot,d_).call(w);return S(r,gh,Math.max(Qt.MIN_SIZE,b[2]-b[0])),S(r,ph,Math.max(Qt.MIN_SIZE,b[3]-b[1])),k(x=r,ot,h_).call(x,l,c),r}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),i=Qt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:Wt.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:k(this,ot,IP).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ph=new WeakMap,gh=new WeakMap,mm=new WeakMap,vm=new WeakMap,bm=new WeakMap,mh=new WeakMap,Un=new WeakMap,Xr=new WeakMap,Ns=new WeakMap,vh=new WeakMap,bh=new WeakMap,Yr=new WeakMap,yh=new WeakMap,wh=new WeakMap,mo=new WeakMap,ot=new WeakSet,AP=function(e){const i=r=>{this.thickness=r,k(this,ot,lf).call(this)},s=this.thickness;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},_P=function(e){const i=r=>{this.color=r,k(this,ot,Uo).call(this)},s=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},EP=function(e){const i=r=>{this.opacity=r,k(this,ot,Uo).call(this)};e/=100;const s=this.opacity;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},xP=function(){const{parentRotation:e,parentDimensions:[i,s]}=this;switch(e){case 90:return[0,s,s,i];case 180:return[i,s,i,s];case 270:return[i,0,s,i];default:return[0,0,i,s]}},a_=function(){const{ctx:e,color:i,opacity:s,thickness:r,parentScale:a,scaleFactor:o}=this;e.lineWidth=r*a/o,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${i}${AD(s)}`},SP=function(e,i){const s=this._uiManager._signal;this.canvas.addEventListener("contextmenu",as,{signal:s}),this.canvas.addEventListener("pointerleave",d(this,vm),{signal:s}),this.canvas.addEventListener("pointermove",d(this,mm),{signal:s}),this.canvas.addEventListener("pointerup",d(this,bm),{signal:s}),this.canvas.removeEventListener("pointerdown",d(this,mh)),this.isEditing=!0,d(this,bh)||(S(this,bh,!0),k(this,ot,oc).call(this),this.thickness||(this.thickness=be._defaultThickness),this.color||(this.color=be._defaultColor||Qt._defaultLineColor),this.opacity??(this.opacity=be._defaultOpacity)),this.currentPath.push([e,i]),S(this,vh,!1),k(this,ot,a_).call(this),S(this,mo,()=>{k(this,ot,TP).call(this),d(this,mo)&&window.requestAnimationFrame(d(this,mo))}),window.requestAnimationFrame(d(this,mo))},o_=function(e,i){const[s,r]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===s&&i===r)return;const a=this.currentPath;let o=d(this,Xr);if(a.push([e,i]),S(this,vh,!0),a.length<=2){o.moveTo(...a[0]),o.lineTo(e,i);return}a.length===3&&(S(this,Xr,o=new Path2D),o.moveTo(...a[0])),k(this,ot,RP).call(this,o,...a.at(-3),...a.at(-2),e,i)},kP=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);d(this,Xr).lineTo(...e)},CP=function(e,i){S(this,mo,null),e=Math.min(Math.max(e,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),k(this,ot,o_).call(this,e,i),k(this,ot,kP).call(this);let s;if(this.currentPath.length!==1)s=k(this,ot,PP).call(this);else{const c=[e,i];s=[[c,c.slice(),c.slice(),c]]}const r=d(this,Xr),a=this.currentPath;this.currentPath=[],S(this,Xr,new Path2D);const o=()=>{this.allRawPaths.push(a),this.paths.push(s),this.bezierPath2D.push(r),this._uiManager.rebuild(this)},l=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(k(this,ot,Ov).call(this),k(this,ot,Nv).call(this)),k(this,ot,lf).call(this))};this.addCommands({cmd:o,undo:l,mustExec:!0})},TP=function(){if(!d(this,vh))return;S(this,vh,!1);const e=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),s=i.map(o=>o[0]),r=i.map(o=>o[1]);Math.min(...s)-e,Math.max(...s)+e,Math.min(...r)-e,Math.max(...r)+e;const{ctx:a}=this;a.save(),a.clearRect(0,0,this.canvas.width,this.canvas.height);for(const o of this.bezierPath2D)a.stroke(o);a.stroke(d(this,Xr)),a.restore()},RP=function(e,i,s,r,a,o,l){const c=(i+r)/2,h=(s+a)/2,f=(r+o)/2,p=(a+l)/2;e.bezierCurveTo(c+2*(r-c)/3,h+2*(a-h)/3,f+2*(r-f)/3,p+2*(a-p)/3,f,p)},PP=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const i=[];let s,[r,a]=e[0];for(s=1;s<e.length-2;s++){const[g,m]=e[s],[b,y]=e[s+1],w=(g+b)/2,x=(m+y)/2,R=[r+2*(g-r)/3,a+2*(m-a)/3],I=[w+2*(g-w)/3,x+2*(m-x)/3];i.push([[r,a],R,I,[w,x]]),[r,a]=[w,x]}const[o,l]=e[s],[c,h]=e[s+1],f=[r+2*(o-r)/3,a+2*(l-a)/3],p=[c+2*(o-c)/3,h+2*(l-h)/3];return i.push([[r,a],f,p,[c,h]]),i},Uo=function(){if(this.isEmpty()){k(this,ot,jv).call(this);return}k(this,ot,a_).call(this);const{canvas:e,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),k(this,ot,jv).call(this);for(const s of this.bezierPath2D)i.stroke(s)},l_=function(e){this.canvas.removeEventListener("pointerleave",d(this,vm)),this.canvas.removeEventListener("pointermove",d(this,mm)),this.canvas.removeEventListener("pointerup",d(this,bm)),this.canvas.addEventListener("pointerdown",d(this,mh),{signal:this._uiManager._signal}),d(this,Un)&&clearTimeout(d(this,Un)),S(this,Un,setTimeout(()=>{S(this,Un,null),this.canvas.removeEventListener("contextmenu",as)},10)),k(this,ot,CP).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ov=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Nv=function(){S(this,Yr,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)})),d(this,Yr).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=d(this,Yr))==null||e.disconnect(),S(this,Yr,null)},{once:!0})},oc=function(){if(!d(this,bh))return;const[e,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*i),k(this,ot,jv).call(this)},h_=function(e,i){const s=k(this,ot,Bv).call(this),r=(e-s)/d(this,gh),a=(i-s)/d(this,ph);this.scaleFactor=Math.min(r,a)},jv=function(){const e=k(this,ot,Bv).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},va=new WeakSet,LP=function(e){const i=new Path2D;for(let s=0,r=e.length;s<r;s++){const[a,o,l,c]=e[s];s===0&&i.moveTo(...a),i.bezierCurveTo(o[0],o[1],l[0],l[1],c[0],c[1])}return i},c_=function(e,i,s){const[r,a,o,l]=i;switch(s){case 0:for(let c=0,h=e.length;c<h;c+=2)e[c]+=r,e[c+1]=l-e[c+1];break;case 90:for(let c=0,h=e.length;c<h;c+=2){const f=e[c];e[c]=e[c+1]+r,e[c+1]=f+a}break;case 180:for(let c=0,h=e.length;c<h;c+=2)e[c]=o-e[c],e[c+1]+=a;break;case 270:for(let c=0,h=e.length;c<h;c+=2){const f=e[c];e[c]=o-e[c+1],e[c+1]=l-f}break;default:throw new Error("Invalid rotation")}return e},MP=function(e,i,s){const[r,a,o,l]=i;switch(s){case 0:for(let c=0,h=e.length;c<h;c+=2)e[c]-=r,e[c+1]=l-e[c+1];break;case 90:for(let c=0,h=e.length;c<h;c+=2){const f=e[c];e[c]=e[c+1]-a,e[c+1]=f-r}break;case 180:for(let c=0,h=e.length;c<h;c+=2)e[c]=o-e[c],e[c+1]-=a;break;case 270:for(let c=0,h=e.length;c<h;c+=2){const f=e[c];e[c]=l-e[c+1],e[c+1]=o-f}break;default:throw new Error("Invalid rotation")}return e},IP=function(e,i,s,r){var h,f;const a=[],o=this.thickness/2,l=e*i+o,c=e*s+o;for(const p of this.paths){const g=[],m=[];for(let b=0,y=p.length;b<y;b++){const[w,x,R,I]=p[b];if(w[0]===I[0]&&w[1]===I[1]&&y===1){const z=e*w[0]+l,Y=e*w[1]+c;g.push(z,Y),m.push(z,Y);break}const D=e*w[0]+l,F=e*w[1]+c,O=e*x[0]+l,L=e*x[1]+c,M=e*R[0]+l,W=e*R[1]+c,j=e*I[0]+l,V=e*I[1]+c;b===0&&(g.push(D,F),m.push(D,F)),g.push(O,L,M,W,j,V),m.push(O,L),b===y-1&&m.push(j,V)}a.push({bezier:k(h=be,va,c_).call(h,g,r,this.rotation),points:k(f=be,va,c_).call(f,m,r,this.rotation)})}return a},d_=function(){let e=1/0,i=-1/0,s=1/0,r=-1/0;for(const a of this.paths)for(const[o,l,c,h]of a){const f=pt.bezierBoundingBox(...o,...l,...c,...h);e=Math.min(e,f[0]),s=Math.min(s,f[1]),i=Math.max(i,f[2]),r=Math.max(r,f[3])}return[e,s,i,r]},Bv=function(){return d(this,Ns)?Math.ceil(this.thickness*this.parentScale):0},lf=function(e=!1){if(this.isEmpty())return;if(!d(this,Ns)){k(this,ot,Uo).call(this);return}const i=k(this,ot,d_).call(this),s=k(this,ot,Bv).call(this);S(this,gh,Math.max(Qt.MIN_SIZE,i[2]-i[0])),S(this,ph,Math.max(Qt.MIN_SIZE,i[3]-i[1]));const r=Math.ceil(s+d(this,gh)*this.scaleFactor),a=Math.ceil(s+d(this,ph)*this.scaleFactor),[o,l]=this.parentDimensions;this.width=r/o,this.height=a/l,this.setAspectRatio(r,a);const c=this.translationX,h=this.translationY;this.translationX=-i[0],this.translationY=-i[1],k(this,ot,oc).call(this),k(this,ot,Uo).call(this),S(this,yh,r),S(this,wh,a),this.setDims(r,a);const f=e?s/this.scaleFactor/2:0;this.translate(c-this.translationX-f,h-this.translationY-f)},P(be,va),Pt(be,"_defaultColor",null),Pt(be,"_defaultOpacity",1),Pt(be,"_defaultThickness",1),Pt(be,"_type","ink"),Pt(be,"_editorType",Wt.INK);let r_=be;var fi,pi,vo,Kr,bo,mu,zn,Qr,Vn,fn,ym,zt,hf,cf,Wv,f_,DP,FP,p_,Hv,OP;const jp=class jp extends Qt{constructor(e){super({...e,name:"stampEditor"});P(this,zt);P(this,fi,null);P(this,pi,null);P(this,vo,null);P(this,Kr,null);P(this,bo,null);P(this,mu,"");P(this,zn,null);P(this,Qr,null);P(this,Vn,null);P(this,fn,!1);P(this,ym,!1);S(this,Kr,e.bitmapUrl),S(this,bo,e.bitmapFile)}static initialize(e,i){Qt.initialize(e,i)}static get supportedTypes(){return $t(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return $t(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,i){i.pasteEditor(Wt.STAMP,{bitmapFile:e.getAsFile()})}remove(){var e,i;d(this,pi)&&(S(this,fi,null),this._uiManager.imageManager.deleteId(d(this,pi)),(e=d(this,zn))==null||e.remove(),S(this,zn,null),(i=d(this,Qr))==null||i.disconnect(),S(this,Qr,null),d(this,Vn)&&(clearTimeout(d(this,Vn)),S(this,Vn,null))),super.remove()}rebuild(){if(!this.parent){d(this,pi)&&k(this,zt,Wv).call(this);return}super.rebuild(),this.div!==null&&(d(this,pi)&&d(this,zn)===null&&k(this,zt,Wv).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(d(this,vo)||d(this,fi)||d(this,Kr)||d(this,bo)||d(this,pi))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,i;if(this.width&&(e=this.x,i=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),d(this,fi)?k(this,zt,f_).call(this):k(this,zt,Wv).call(this),this.width){const[s,r]=this.parentDimensions;this.setAt(e*s,i*r,this.width*s,this.height*r)}return this.div}getImageForAltText(){return d(this,zn)}static deserialize(e,i,s){if(e instanceof JR)return null;const r=super.deserialize(e,i,s),{rect:a,bitmapUrl:o,bitmapId:l,isSvg:c,accessibilityData:h}=e;l&&s.imageManager.isValidId(l)?S(r,pi,l):S(r,Kr,o),S(r,fn,c);const[f,p]=r.pageDimensions;return r.width=(a[2]-a[0])/f,r.height=(a[3]-a[1])/p,h&&(r.altTextData=h),r}serialize(e=!1,i=null){if(this.isEmpty())return null;const s={annotationType:Wt.STAMP,bitmapId:d(this,pi),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:d(this,fn),structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=k(this,zt,Hv).call(this,!0),s.accessibilityData=this.altTextData,s;const{decorative:r,altText:a}=this.altTextData;if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),i===null)return s;i.stamps||(i.stamps=new Map);const o=d(this,fn)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(d(this,pi)))i.stamps.set(d(this,pi),{area:o,serialized:s}),s.bitmap=k(this,zt,Hv).call(this,!1);else if(d(this,fn)){const l=i.stamps.get(d(this,pi));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=k(this,zt,Hv).call(this,!1))}return s}};fi=new WeakMap,pi=new WeakMap,vo=new WeakMap,Kr=new WeakMap,bo=new WeakMap,mu=new WeakMap,zn=new WeakMap,Qr=new WeakMap,Vn=new WeakMap,fn=new WeakMap,ym=new WeakMap,zt=new WeakSet,hf=function(e,i=!1){if(!e){this.remove();return}S(this,fi,e.bitmap),i||(S(this,pi,e.id),S(this,fn,e.isSvg)),e.file&&S(this,mu,e.file.name),k(this,zt,f_).call(this)},cf=function(){S(this,vo,null),this._uiManager.enableWaiting(!1),d(this,zn)&&this.div.focus()},Wv=function(){if(d(this,pi)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(d(this,pi)).then(s=>k(this,zt,hf).call(this,s,!0)).finally(()=>k(this,zt,cf).call(this));return}if(d(this,Kr)){const s=d(this,Kr);S(this,Kr,null),this._uiManager.enableWaiting(!0),S(this,vo,this._uiManager.imageManager.getFromUrl(s).then(r=>k(this,zt,hf).call(this,r)).finally(()=>k(this,zt,cf).call(this)));return}if(d(this,bo)){const s=d(this,bo);S(this,bo,null),this._uiManager.enableWaiting(!0),S(this,vo,this._uiManager.imageManager.getFromFile(s).then(r=>k(this,zt,hf).call(this,r)).finally(()=>k(this,zt,cf).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=jp.supportedTypesStr;const i=this._uiManager._signal;S(this,vo,new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);k(this,zt,hf).call(this,r)}s()},{signal:i}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>k(this,zt,cf).call(this))),e.click()},f_=function(){const{div:e}=this;let{width:i,height:s}=d(this,fi);const[r,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*r,s=this.height*a;else if(i>o*r||s>o*a){const f=Math.min(o*r/i,o*a/s);i*=f,s*=f}const[l,c]=this.parentDimensions;this.setDims(i*l/r,s*c/a),this._uiManager.enableWaiting(!1);const h=S(this,zn,document.createElement("canvas"));e.append(h),e.hidden=!1,k(this,zt,p_).call(this,i,s),k(this,zt,OP).call(this),d(this,ym)||(this.parent.addUndoableEditor(this),S(this,ym,!0)),this._reportTelemetry({action:"inserted_image"}),d(this,mu)&&h.setAttribute("aria-label",d(this,mu))},DP=function(e,i){var o;const[s,r]=this.parentDimensions;this.width=e/s,this.height=i/r,this.setDims(e,i),(o=this._initialOptions)!=null&&o.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,d(this,Vn)!==null&&clearTimeout(d(this,Vn)),S(this,Vn,setTimeout(()=>{S(this,Vn,null),k(this,zt,p_).call(this,e,i)},200))},FP=function(e,i){const{width:s,height:r}=d(this,fi);let a=s,o=r,l=d(this,fi);for(;a>2*e||o>2*i;){const c=a,h=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,c,h,0,0,a,o),l=f.transferToImageBitmap()}return l},p_=function(e,i){e=Math.ceil(e),i=Math.ceil(i);const s=d(this,zn);if(!s||s.width===e&&s.height===i)return;s.width=e,s.height=i;const r=d(this,fn)?d(this,fi):k(this,zt,FP).call(this,e,i);if(this._uiManager.hasMLManager&&!this.hasAltText()){const l=new OffscreenCanvas(e,i).getContext("2d");l.drawImage(r,0,0,r.width,r.height,0,0,e,i),this._uiManager.mlGuess({service:"image-to-text",request:{data:l.getImageData(0,0,e,i).data,width:e,height:i,channels:4}}).then(c=>{const h=(c==null?void 0:c.output)||"";this.parent&&h&&!this.hasAltText()&&(this.altTextData={altText:h,decorative:!1})})}const a=s.getContext("2d");a.filter=this._uiManager.hcmFilter,a.drawImage(r,0,0,r.width,r.height,0,0,e,i)},Hv=function(e){if(e){if(d(this,fn)){const r=this._uiManager.imageManager.getSvgUrl(d(this,pi));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=d(this,fi),i.getContext("2d").drawImage(d(this,fi),0,0),i.toDataURL()}if(d(this,fn)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*ko.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*ko.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(d(this,fi),0,0,d(this,fi).width,d(this,fi).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(d(this,fi))},OP=function(){this._uiManager._signal&&(S(this,Qr,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&k(this,zt,DP).call(this,i.width,i.height)})),d(this,Qr).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=d(this,Qr))==null||e.disconnect(),S(this,Qr,null)},{once:!0}))},Pt(jp,"_type","stamp"),Pt(jp,"_editorType",Wt.STAMP);let u_=jp;var Ah,vu,Gn,_h,Zr,Jr,ta,_s,yo,bu,yu,Bi,gt,wo,gi,NP,m_,v_,b_,$v;const Ks=class Ks{constructor({uiManager:t,pageIndex:e,div:i,accessibilityManager:s,annotationLayer:r,drawLayer:a,textLayer:o,viewport:l,l10n:c}){P(this,gi);P(this,Ah);P(this,vu,!1);P(this,Gn,null);P(this,_h,null);P(this,Zr,null);P(this,Jr,null);P(this,ta,null);P(this,_s,new Map);P(this,yo,!1);P(this,bu,!1);P(this,yu,!1);P(this,Bi,null);P(this,gt);const h=[...d(Ks,wo).values()];if(!Ks._initialized){Ks._initialized=!0;for(const f of h)f.initialize(c,t)}t.registerEditorTypes(h),S(this,gt,t),this.pageIndex=e,this.div=i,S(this,Ah,s),S(this,Gn,r),this.viewport=l,S(this,Bi,o),this.drawLayer=a,d(this,gt).addLayer(this)}get isEmpty(){return d(this,_s).size===0}get isInvisible(){return this.isEmpty&&d(this,gt).getMode()===Wt.NONE}updateToolbar(t){d(this,gt).updateToolbar(t)}updateMode(t=d(this,gt).getMode()){switch(k(this,gi,$v).call(this),t){case Wt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Wt.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case Wt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of d(Ks,wo).values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=d(this,Bi))==null?void 0:e.div)}addInkEditorIfNeeded(t){if(d(this,gt).getMode()!==Wt.INK)return;if(!t){for(const i of d(this,_s).values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){d(this,gt).setEditingState(t)}addCommands(t){d(this,gt).addCommands(t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=d(this,Gn))==null||e.div.classList.toggle("disabled",!t)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of d(this,_s).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(d(this,gt).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!d(this,Gn))return;const e=d(this,Gn).getEditableAnnotations();for(const i of e){if(i.hide(),d(this,gt).isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){var s;S(this,yu,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const r of d(this,_s).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(d(this,Gn)){const r=d(this,Gn).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(d(this,gt).isDeletedAnnotationElement(o))continue;let l=e.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=t.get(o),l&&(d(this,gt).addChangedExistingAnnotation(l),l.renderAnnotationElement(a),l.show(!1)),a.show()}}k(this,gi,$v).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of d(Ks,wo).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),S(this,yu,!1)}getEditableAnnotation(t){var e;return((e=d(this,Gn))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){d(this,gt).getActive()!==t&&d(this,gt).setActiveEditor(t)}enableTextSelection(){var t;this.div.tabIndex=-1,(t=d(this,Bi))!=null&&t.div&&!d(this,Jr)&&(S(this,Jr,k(this,gi,NP).bind(this)),d(this,Bi).div.addEventListener("pointerdown",d(this,Jr),{signal:d(this,gt)._signal}),d(this,Bi).div.classList.add("highlighting"))}disableTextSelection(){var t;this.div.tabIndex=0,(t=d(this,Bi))!=null&&t.div&&d(this,Jr)&&(d(this,Bi).div.removeEventListener("pointerdown",d(this,Jr)),S(this,Jr,null),d(this,Bi).div.classList.remove("highlighting"))}enableClick(){if(d(this,Zr))return;const t=d(this,gt)._signal;S(this,Zr,this.pointerdown.bind(this)),S(this,_h,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",d(this,Zr),{signal:t}),this.div.addEventListener("pointerup",d(this,_h),{signal:t})}disableClick(){d(this,Zr)&&(this.div.removeEventListener("pointerdown",d(this,Zr)),this.div.removeEventListener("pointerup",d(this,_h)),S(this,Zr,null),S(this,_h,null))}attach(t){d(this,_s).set(t.id,t);const{annotationElementId:e}=t;e&&d(this,gt).isDeletedAnnotationElement(e)&&d(this,gt).removeDeletedAnnotationElement(t)}detach(t){var e;d(this,_s).delete(t.id),(e=d(this,Ah))==null||e.removePointerInTextLayer(t.contentDiv),!d(this,yu)&&t.annotationElementId&&d(this,gt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),d(this,gt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,d(this,bu)||this.addInkEditorIfNeeded(!1)}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(d(this,gt).addDeletedAnnotationElement(t.annotationElementId),Qt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),d(this,gt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),d(this,gt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var i;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!d(this,ta)&&(t._focusEventsAllowed=!1,S(this,ta,setTimeout(()=>{S(this,ta,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:d(this,gt)._signal}),e.focus())},0))),t._structTreeParentId=(i=d(this,Ah))==null?void 0:i.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return d(this,gt).getId()}get _signal(){return d(this,gt)._signal}canCreateNewEmptyEditor(){var t;return(t=d(this,gi,m_))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){d(this,gt).updateToolbar(t),d(this,gt).updateMode(t);const{offsetX:i,offsetY:s}=k(this,gi,b_).call(this),r=this.getNextId(),a=k(this,gi,v_).call(this,{parent:this,id:r,x:i,y:s,uiManager:d(this,gt),isCentered:!0,...e});a&&this.add(a)}deserialize(t){var e;return((e=d(Ks,wo).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,d(this,gt)))||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),r=k(this,gi,v_).call(this,{parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:d(this,gt),isCentered:e,...i});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(k(this,gi,b_).call(this),!0)}setSelected(t){d(this,gt).setSelected(t)}toggleSelected(t){d(this,gt).toggleSelected(t)}isSelected(t){return d(this,gt).isSelected(t)}unselect(t){d(this,gt).unselect(t)}pointerup(t){const{isMac:e}=ns.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&d(this,yo)){if(S(this,yo,!1),!d(this,vu)){S(this,vu,!0);return}if(d(this,gt).getMode()===Wt.STAMP){d(this,gt).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(d(this,gt).getMode()===Wt.HIGHLIGHT&&this.enableTextSelection(),d(this,yo)){S(this,yo,!1);return}const{isMac:e}=ns.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;S(this,yo,!0);const i=d(this,gt).getActive();S(this,vu,!i||i.isEmpty())}findNewParent(t,e,i){const s=d(this,gt).findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){var t,e;((t=d(this,gt).getActive())==null?void 0:t.parent)===this&&(d(this,gt).commitOrRemove(),d(this,gt).setActiveEditor(null)),d(this,ta)&&(clearTimeout(d(this,ta)),S(this,ta,null));for(const i of d(this,_s).values())(e=d(this,Ah))==null||e.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,d(this,_s).clear(),d(this,gt).removeLayer(this)}render({viewport:t}){this.viewport=t,kh(this.div,t);for(const e of d(this,gt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){d(this,gt).commitOrRemove(),k(this,gi,$v).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,kh(this.div,{rotation:i}),e!==i)for(const s of d(this,_s).values())s.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return d(this,gt).viewParameters.realScale}};Ah=new WeakMap,vu=new WeakMap,Gn=new WeakMap,_h=new WeakMap,Zr=new WeakMap,Jr=new WeakMap,ta=new WeakMap,_s=new WeakMap,yo=new WeakMap,bu=new WeakMap,yu=new WeakMap,Bi=new WeakMap,gt=new WeakMap,wo=new WeakMap,gi=new WeakSet,NP=function(t){if(d(this,gt).unselectAll(),t.target===d(this,Bi).div){const{isMac:e}=ns.platform;if(t.button!==0||t.ctrlKey&&e)return;d(this,gt).showAllEditors("highlight",!0,!0),d(this,Bi).div.classList.add("free"),Jb.startHighlighting(this,d(this,gt).direction==="ltr",t),d(this,Bi).div.addEventListener("pointerup",()=>{d(this,Bi).div.classList.remove("free")},{once:!0,signal:d(this,gt)._signal}),t.preventDefault()}},m_=function(){return d(Ks,wo).get(d(this,gt).getMode())},v_=function(t){const e=d(this,gi,m_);return e?new e.prototype.constructor(t):null},b_=function(){const{x:t,y:e,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,t),a=Math.max(0,e),o=Math.min(window.innerWidth,t+i),l=Math.min(window.innerHeight,e+s),c=(r+o)/2-t,h=(a+l)/2-e,[f,p]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:f,offsetY:p}},$v=function(){S(this,bu,!0);for(const t of d(this,_s).values())t.isEmpty()&&t.remove();S(this,bu,!1)},Pt(Ks,"_initialized",!1),P(Ks,wo,new Map([X1,r_,u_,Jb].map(t=>[t._editorType,t])));let g_=Ks;var qn,wm,We,Ao,Am,w_,Nh,A_,jP;const li=class li{constructor({pageIndex:t}){P(this,Nh);P(this,qn,null);P(this,wm,0);P(this,We,new Map);P(this,Ao,new Map);this.pageIndex=t}setParent(t){if(!d(this,qn)){S(this,qn,t);return}if(d(this,qn)!==t){if(d(this,We).size>0)for(const e of d(this,We).values())e.remove(),t.append(e);S(this,qn,t)}}static get _svgFactory(){return $t(this,"_svgFactory",new SS)}highlight(t,e,i,s=!1){const r=hs(this,wm)._++,a=k(this,Nh,A_).call(this,t.box);a.classList.add("highlight"),t.free&&a.classList.add("free");const o=li._svgFactory.createElement("defs");a.append(o);const l=li._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${r}`;l.setAttribute("id",c),l.setAttribute("d",t.toSVGPath()),s&&d(this,Ao).set(r,l);const h=k(this,Nh,jP).call(this,o,c),f=li._svgFactory.createElement("use");return a.append(f),a.setAttribute("fill",e),a.setAttribute("fill-opacity",i),f.setAttribute("href",`#${c}`),d(this,We).set(r,a),{id:r,clipPathId:`url(#${h})`}}highlightOutline(t){const e=hs(this,wm)._++,i=k(this,Nh,A_).call(this,t.box);i.classList.add("highlightOutline");const s=li._svgFactory.createElement("defs");i.append(s);const r=li._svgFactory.createElement("path");s.append(r);const a=`path_p${this.pageIndex}_${e}`;r.setAttribute("id",a),r.setAttribute("d",t.toSVGPath()),r.setAttribute("vector-effect","non-scaling-stroke");let o;if(t.free){i.classList.add("free");const h=li._svgFactory.createElement("mask");s.append(h),o=`mask_p${this.pageIndex}_${e}`,h.setAttribute("id",o),h.setAttribute("maskUnits","objectBoundingBox");const f=li._svgFactory.createElement("rect");h.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=li._svgFactory.createElement("use");h.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const l=li._svgFactory.createElement("use");i.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return i.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),d(this,We).set(e,i),e}finalizeLine(t,e){const i=d(this,Ao).get(t);d(this,Ao).delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){d(this,We).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}removeFreeHighlight(t){this.remove(t),d(this,Ao).delete(t)}updatePath(t,e){d(this,Ao).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var i;k(i=li,Am,w_).call(i,d(this,We).get(t),e)}show(t,e){d(this,We).get(t).classList.toggle("hidden",!e)}rotate(t,e){d(this,We).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){d(this,We).get(t).setAttribute("fill",e)}changeOpacity(t,e){d(this,We).get(t).setAttribute("fill-opacity",e)}addClass(t,e){d(this,We).get(t).classList.add(e)}removeClass(t,e){d(this,We).get(t).classList.remove(e)}remove(t){d(this,qn)!==null&&(d(this,We).get(t).remove(),d(this,We).delete(t))}destroy(){S(this,qn,null);for(const t of d(this,We).values())t.remove();d(this,We).clear()}};qn=new WeakMap,wm=new WeakMap,We=new WeakMap,Ao=new WeakMap,Am=new WeakSet,w_=function(t,{x:e=0,y:i=0,width:s=1,height:r=1}={}){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*s}%`,a.height=`${100*r}%`},Nh=new WeakSet,A_=function(t){var i;const e=li._svgFactory.create(1,1,!0);return d(this,qn).append(e),e.setAttribute("aria-hidden",!0),k(i=li,Am,w_).call(i,e,t),e},jP=function(t,e){const i=li._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=li._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),s},P(li,Am);let y_=li;var ZF=Et.AbortException,JF=Et.AnnotationEditorLayer,tO=Et.AnnotationEditorParamsType,eO=Et.AnnotationEditorType,iO=Et.AnnotationEditorUIManager,BP=Et.AnnotationLayer,WP=Et.AnnotationMode,sO=Et.CMapCompressionType,nO=Et.ColorPicker,rO=Et.DOMSVGFactory,aO=Et.DrawLayer,oO=Et.FeatureTest,IS=Et.GlobalWorkerOptions,lO=Et.ImageKind,hO=Et.InvalidPDFException,cO=Et.MissingPDFException,dO=Et.OPS,uO=Et.Outliner,fO=Et.PDFDataRangeTransport,pO=Et.PDFDateString,gO=Et.PDFWorker,mO=Et.PasswordResponses,vO=Et.PermissionFlag,bO=Et.PixelsPerInch,yO=Et.RenderingCancelledException,HP=Et.TextLayer,wO=Et.UnexpectedResponseException,AO=Et.Util,_O=Et.VerbosityLevel,EO=Et.XfaLayer,xO=Et.build,SO=Et.createValidAbsoluteUrl,kO=Et.fetchData,$P=Et.getDocument,CO=Et.getFilenameFromUrl,TO=Et.getPdfFilenameFromUrl,RO=Et.getXfaPageViewport,PO=Et.isDataScheme,LO=Et.isPdfFile,MO=Et.noContextMenu,IO=Et.normalizeUnicode,DO=Et.renderTextLayer,FO=Et.setLayerDimensions,OO=Et.shadow,NO=Et.updateTextLayer,jO=Et.version;const BO=Object.freeze(Object.defineProperty({__proto__:null,AbortException:ZF,AnnotationEditorLayer:JF,AnnotationEditorParamsType:tO,AnnotationEditorType:eO,AnnotationEditorUIManager:iO,AnnotationLayer:BP,AnnotationMode:WP,CMapCompressionType:sO,ColorPicker:nO,DOMSVGFactory:rO,DrawLayer:aO,FeatureTest:oO,GlobalWorkerOptions:IS,ImageKind:lO,InvalidPDFException:hO,MissingPDFException:cO,OPS:dO,Outliner:uO,PDFDataRangeTransport:fO,PDFDateString:pO,PDFWorker:gO,PasswordResponses:mO,PermissionFlag:vO,PixelsPerInch:bO,RenderingCancelledException:yO,TextLayer:HP,UnexpectedResponseException:wO,Util:AO,VerbosityLevel:_O,XfaLayer:EO,build:xO,createValidAbsoluteUrl:SO,fetchData:kO,getDocument:$P,getFilenameFromUrl:CO,getPdfFilenameFromUrl:TO,getXfaPageViewport:RO,isDataScheme:PO,isPdfFile:LO,noContextMenu:MO,normalizeUnicode:IO,renderTextLayer:DO,setLayerDimensions:FO,shadow:OO,updateTextLayer:NO,version:jO},Symbol.toStringTag,{value:"Module"}));var Ge=function(n,t,e){if(e||arguments.length===2)for(var i=0,s=t.length,r;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))},WO=["onCopy","onCut","onPaste"],HO=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],$O=["onFocus","onBlur"],UO=["onInput","onInvalid","onReset","onSubmit"],zO=["onLoad","onError"],VO=["onKeyDown","onKeyPress","onKeyUp"],GO=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],qO=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],XO=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],YO=["onSelect"],KO=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],QO=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],ZO=["onScroll"],JO=["onWheel"],tN=["onAnimationStart","onAnimationEnd","onAnimationIteration"],eN=["onTransitionEnd"],iN=["onToggle"],sN=["onChange"],nN=Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge(Ge([],WO,!0),HO,!0),$O,!0),UO,!0),zO,!0),VO,!0),GO,!0),qO,!0),XO,!0),YO,!0),KO,!0),QO,!0),ZO,!0),JO,!0),tN,!0),eN,!0),sN,!0),iN,!0);function UP(n,t){var e={};return nN.forEach(function(i){var s=n[i];s&&(t?e[i]=function(r){return s(r,t(i))}:e[i]=s)}),e}function km(n){var t=!1,e=new Promise(function(i,s){n.then(function(r){return!t&&i(r)}).catch(function(r){return!t&&s(r)})});return{promise:e,cancel:function(){t=!0}}}function zP(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(t=0;t<s;t++)n[t]&&(e=zP(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function Tw(){for(var n,t,e=0,i="",s=arguments.length;e<s;e++)(n=arguments[e])&&(t=zP(n))&&(i&&(i+=" "),i+=t);return i}var rN=function(){},aN=rN;const Li=H2(aN);var zk=Object.prototype.hasOwnProperty;function Vk(n,t,e){for(e of n.keys())if(cd(e,t))return e}function cd(n,t){var e,i,s;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((i=n.length)===t.length)for(;i--&&cd(n[i],t[i]););return i===-1}if(e===Set){if(n.size!==t.size)return!1;for(i of n)if(s=i,s&&typeof s=="object"&&(s=Vk(t,s),!s)||!t.has(s))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(i of n)if(s=i[0],s&&typeof s=="object"&&(s=Vk(t,s),!s)||!cd(i[1],t.get(s)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((i=n.byteLength)===t.byteLength)for(;i--&&n.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(n)){if((i=n.byteLength)===t.byteLength)for(;i--&&n[i]===t[i];);return i===-1}if(!e||typeof n=="object"){i=0;for(e in n)if(zk.call(n,e)&&++i&&!zk.call(t,e)||!(e in t)||!cd(n[e],t[e]))return!1;return Object.keys(t).length===i}}return n!==n&&t!==t}const VP=U.createContext(null);function dd({children:n,type:t}){return N.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:n})}const oN="noopener noreferrer nofollow";class lN{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return ae(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){ae(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{ae(this.pdfDocument),ae(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{ae(Array.isArray(e));const i=e[0];new Promise(s=>{ae(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(r=>{s(r)}).catch(()=>{ae(!1)}):typeof i=="number"?s(i):ae(!1)}).then(s=>{const r=s+1;ae(this.pdfViewer),ae(r>=1&&r<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:s,pageNumber:r})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;ae(this.pdfViewer),ae(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||oN,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const Gk={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Rw=typeof document<"u",GP=Rw&&window.location.protocol==="file:";function hN(n){return typeof n<"u"}function Do(n){return hN(n)&&n!==null}function cN(n){return typeof n=="string"}function dN(n){return n instanceof ArrayBuffer}function uN(n){return ae(Rw),n instanceof Blob}function __(n){return cN(n)&&/^data:/.test(n)}function qk(n){ae(__(n));const[t="",e=""]=n.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function fN(){return Rw&&window.devicePixelRatio||1}const qP="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function Xk(){Li(!GP,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${qP}`)}function pN(){Li(!GP,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${qP}`)}function Rh(n){n!=null&&n.cancel&&n.cancel()}function E_(n,t){return Object.defineProperty(n,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function gN(n){return n.name==="RenderingCancelledException"}function mN(n){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=s=>{if(!s.target)return e(new Error("Error while reading a file."));const{error:r}=s.target;if(!r)return e(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(n)})}function vN(n,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function wu(){return U.useReducer(vN,{value:void 0,error:void 0})}var bN=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(a){a(r)})}return new(e||(e=Promise))(function(r,a){function o(h){try{c(i.next(h))}catch(f){a(f)}}function l(h){try{c(i.throw(h))}catch(f){a(f)}}function c(h){h.done?r(h.value):s(h.value).then(o,l)}c((i=i.apply(n,t||[])).next())})},Yk=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]]);return e};const{PDFDataRangeTransport:yN}=BO,wN=(n,t)=>{switch(t){case Gk.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");n(e);break}case Gk.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");n(e);break}}};function Kk(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const AN=U.forwardRef(function(t,e){var{children:i,className:s,error:r="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:h,loading:f="Loading PDF…",noData:p="No PDF file specified.",onItemClick:g,onLoadError:m,onLoadProgress:b,onLoadSuccess:y,onPassword:w=wN,onSourceError:x,onSourceSuccess:R,options:I,renderMode:D,rotate:F}=t,O=Yk(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[L,M]=wu(),{value:W,error:j}=L,[V,z]=wu(),{value:Y,error:K}=V,G=U.useRef(new lN),H=U.useRef([]),Q=U.useRef(void 0),Z=U.useRef(void 0);l&&l!==Q.current&&Kk(l)&&(Li(!cd(l,Q.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),Q.current=l),I&&I!==Z.current&&(Li(!cd(I,Z.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),Z.current=I);const yt=U.useRef({scrollPageIntoView:rt=>{const{dest:mt,pageNumber:dt,pageIndex:et=dt-1}=rt;if(g){g({dest:mt,pageIndex:et,pageNumber:dt});return}const Rt=H.current[et];if(Rt){Rt.scrollIntoView();return}Li(!1,`An internal link leading to page ${dt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});U.useImperativeHandle(e,()=>({linkService:G,pages:H,viewer:yt}),[]);function bt(){R&&R()}function X(){j&&(Li(!1,j.toString()),x&&x(j))}function nt(){M({type:"RESET"})}U.useEffect(nt,[l,M]);const ht=U.useCallback(()=>bN(this,void 0,void 0,function*(){if(!l)return null;if(typeof l=="string")return __(l)?{data:qk(l)}:(Xk(),{url:l});if(l instanceof yN)return{range:l};if(dN(l))return{data:l};if(Rw&&uN(l))return{data:yield mN(l)};if(ae(typeof l=="object"),ae(Kk(l)),"url"in l&&typeof l.url=="string"){if(__(l.url)){const{url:rt}=l,mt=Yk(l,["url"]),dt=qk(rt);return Object.assign({data:dt},mt)}Xk()}return l}),[l]);U.useEffect(()=>{const rt=km(ht());return rt.promise.then(mt=>{M({type:"RESOLVE",value:mt})}).catch(mt=>{M({type:"REJECT",error:mt})}),()=>{Rh(rt)}},[ht,M]),U.useEffect(()=>{if(!(typeof W>"u")){if(W===!1){X();return}bt()}},[W]);function lt(){Y&&(y&&y(Y),H.current=new Array(Y.numPages),G.current.setDocument(Y))}function ct(){K&&(Li(!1,K.toString()),m&&m(K))}U.useEffect(function(){z({type:"RESET"})},[z,W]),U.useEffect(function(){if(!W)return;const mt=Object.assign(Object.assign({},W),I),dt=$P(mt);b&&(dt.onProgress=b),w&&(dt.onPassword=w);const et=dt;return et.promise.then(Rt=>{z({type:"RESOLVE",value:Rt})}).catch(Rt=>{et.destroyed||z({type:"REJECT",error:Rt})}),()=>{et.destroy()}},[I,z,W]),U.useEffect(()=>{if(!(typeof Y>"u")){if(Y===!1){ct();return}lt()}},[Y]),U.useEffect(function(){G.current.setViewer(yt.current),G.current.setExternalLinkRel(a),G.current.setExternalLinkTarget(o)},[a,o]);const st=U.useCallback((rt,mt)=>{H.current[rt]=mt},[]),vt=U.useCallback(rt=>{delete H.current[rt]},[]),tt=U.useMemo(()=>({imageResourcesPath:h,linkService:G.current,onItemClick:g,pdf:Y,registerPage:st,renderMode:D,rotate:F,unregisterPage:vt}),[h,g,Y,st,D,F,vt]),it=U.useMemo(()=>UP(O,()=>Y),[O,Y]);function wt(){return N.jsx(VP.Provider,{value:tt,children:i})}function St(){return l?Y==null?N.jsx(dd,{type:"loading",children:typeof f=="function"?f():f}):Y===!1?N.jsx(dd,{type:"error",children:typeof r=="function"?r():r}):wt():N.jsx(dd,{type:"no-data",children:typeof p=="function"?p():p})}return N.jsx("div",Object.assign({className:Tw("react-pdf__Document",s),ref:c,style:{"--scale-factor":"1"}},it,{children:St()}))});function XP(){return U.useContext(VP)}function YP(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(r){e.forEach(function(a){typeof a=="function"?a(r):a&&(a.current=r)})}}const KP=U.createContext(null),QP={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},_N=/^H(\d+)$/;function EN(n){return n in QP}function Pw(n){return"children"in n}function ZP(n){return Pw(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function xN(n){const t={};if(Pw(n)){const{role:e}=n,i=e.match(_N);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(EN(e)){const s=QP[e];s&&(t.role=s)}}return t}function JP(n){const t={};if(Pw(n)){if(n.alt!==void 0&&(t["aria-label"]=n.alt),n.lang!==void 0&&(t.lang=n.lang),ZP(n)){const[e]=n.children;if(e){const i=JP(e);return Object.assign(Object.assign({},t),i)}}}else"id"in n&&(t["aria-owns"]=n.id);return t}function SN(n){return n?Object.assign(Object.assign({},xN(n)),JP(n)):null}function tL({className:n,node:t}){const e=U.useMemo(()=>SN(t),[t]),i=U.useMemo(()=>!Pw(t)||ZP(t)?null:t.children.map((s,r)=>N.jsx(tL,{node:s},r)),[t]);return N.jsx("span",Object.assign({className:n},e,{children:i}))}function Lw(){return U.useContext(KP)}function kN(){const n=Lw();ae(n);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=n,[i,s]=wu(),{value:r,error:a}=i,{customTextRenderer:o,page:l}=n;function c(){r&&e&&e(r)}function h(){a&&(Li(!1,a.toString()),t&&t(a))}return U.useEffect(function(){s({type:"RESET"})},[s,l]),U.useEffect(function(){if(o||!l)return;const p=km(l.getStructTree()),g=p;return p.promise.then(m=>{s({type:"RESOLVE",value:m})}).catch(m=>{s({type:"REJECT",error:m})}),()=>Rh(g)},[o,l,s]),U.useEffect(()=>{if(r!==void 0){if(r===!1){h();return}c()}},[r]),r?N.jsx(tL,{className:"react-pdf__Page__structTree structTree",node:r}):null}const Qk=WP;function CN(n){const t=Lw();ae(t);const e=Object.assign(Object.assign({},t),n),{_className:i,canvasBackground:s,devicePixelRatio:r=fN(),onRenderError:a,onRenderSuccess:o,page:l,renderForms:c,renderTextLayer:h,rotate:f,scale:p}=e,{canvasRef:g}=n;ae(l);const m=U.useRef(null);function b(){l&&o&&o(E_(l,p))}function y(I){gN(I)||(Li(!1,I.toString()),a&&a(I))}const w=U.useMemo(()=>l.getViewport({scale:p*r,rotation:f}),[r,l,f,p]),x=U.useMemo(()=>l.getViewport({scale:p,rotation:f}),[l,f,p]);U.useEffect(function(){if(!l)return;l.cleanup();const{current:D}=m;if(!D)return;D.width=w.width,D.height=w.height,D.style.width=`${Math.floor(x.width)}px`,D.style.height=`${Math.floor(x.height)}px`,D.style.visibility="hidden";const F={annotationMode:c?Qk.ENABLE_FORMS:Qk.ENABLE,canvasContext:D.getContext("2d",{alpha:!1}),viewport:w};s&&(F.background=s);const O=l.render(F),L=O;return O.promise.then(()=>{D.style.visibility="",b()}).catch(y),()=>Rh(L)},[s,l,c,w,x]);const R=U.useCallback(()=>{const{current:I}=m;I&&(I.width=0,I.height=0)},[]);return U.useEffect(()=>R,[R]),N.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:YP(g,m),style:{display:"block",userSelect:"none"},children:h?N.jsx(kN,{}):null})}function TN(n){return"str"in n}function RN(){const n=Lw();ae(n);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:s,onRenderTextLayerSuccess:r,page:a,pageIndex:o,pageNumber:l,rotate:c,scale:h}=n;ae(a);const[f,p]=wu(),{value:g,error:m}=f,b=U.useRef(null),y=U.useRef(void 0);Li(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function w(){g&&i&&i(g)}function x(){m&&(Li(!1,m.toString()),e&&e(m))}U.useEffect(function(){p({type:"RESET"})},[a,p]),U.useEffect(function(){if(!a)return;const M=km(a.getTextContent()),W=M;return M.promise.then(j=>{p({type:"RESOLVE",value:j})}).catch(j=>{p({type:"REJECT",error:j})}),()=>Rh(W)},[a,p]),U.useEffect(()=>{if(g!==void 0){if(g===!1){x();return}w()}},[g]);const R=U.useCallback(()=>{r&&r()},[r]),I=U.useCallback(L=>{Li(!1,L.toString()),s&&s(L)},[s]);function D(){const L=y.current;L&&L.classList.add("active")}function F(){const L=y.current;L&&L.classList.remove("active")}const O=U.useMemo(()=>a.getViewport({scale:h,rotation:c}),[a,c,h]);return U.useLayoutEffect(function(){if(!a||!g)return;const{current:M}=b;if(!M)return;M.innerHTML="";const W=a.streamTextContent({includeMarkedContent:!0}),j={container:M,textContentSource:W,viewport:O},V=new HP(j),z=V;return V.render().then(()=>{const Y=document.createElement("div");Y.className="endOfContent",M.append(Y),y.current=Y;const K=M.querySelectorAll('[role="presentation"]');if(t){let G=0;g.items.forEach((H,Q)=>{if(!TN(H))return;const Z=K[G];if(!Z)return;const yt=t(Object.assign({pageIndex:o,pageNumber:l,itemIndex:Q},H));Z.innerHTML=yt,G+=H.str&&H.hasEOL?2:1})}R()}).catch(I),()=>Rh(z)},[t,I,R,a,o,l,g,O]),N.jsx("div",{className:Tw("react-pdf__Page__textContent","textLayer"),onMouseUp:F,onMouseDown:D,ref:b})}function PN(){const n=XP(),t=Lw();ae(t);const e=Object.assign(Object.assign({},n),t),{imageResourcesPath:i,linkService:s,onGetAnnotationsError:r,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:l,page:c,pdf:h,renderForms:f,rotate:p,scale:g=1}=e;ae(h),ae(c),ae(s);const[m,b]=wu(),{value:y,error:w}=m,x=U.useRef(null);Li(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function R(){y&&a&&a(y)}function I(){w&&(Li(!1,w.toString()),r&&r(w))}U.useEffect(function(){b({type:"RESET"})},[b,c]),U.useEffect(function(){if(!c)return;const M=km(c.getAnnotations()),W=M;return M.promise.then(j=>{b({type:"RESOLVE",value:j})}).catch(j=>{b({type:"REJECT",error:j})}),()=>{Rh(W)}},[b,c]),U.useEffect(()=>{if(y!==void 0){if(y===!1){I();return}R()}},[y]);function D(){l&&l()}function F(L){Li(!1,`${L}`),o&&o(L)}const O=U.useMemo(()=>c.getViewport({scale:g,rotation:p}),[c,p,g]);return U.useEffect(function(){if(!h||!c||!s||!y)return;const{current:M}=x;if(!M)return;const W=O.clone({dontFlip:!0}),j={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:M,l10n:null,page:c,viewport:W},V={annotations:y,annotationStorage:h.annotationStorage,div:M,imageResourcesPath:i,linkService:s,page:c,renderForms:f,viewport:W};M.innerHTML="";try{new BP(j).render(V),D()}catch(z){F(z)}return()=>{}},[y,i,s,c,h,f,O]),N.jsx("div",{className:Tw("react-pdf__Page__annotations","annotationLayer"),ref:x})}var LN=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]]);return e};const Zk=1;function Jk(n){const t=XP(),e=Object.assign(Object.assign({},t),n),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:r,canvasRef:a,children:o,className:l,customRenderer:c,customTextRenderer:h,devicePixelRatio:f,error:p="Failed to load the page.",height:g,inputRef:m,loading:b="Loading page…",noData:y="No page specified.",onGetAnnotationsError:w,onGetAnnotationsSuccess:x,onGetStructTreeError:R,onGetStructTreeSuccess:I,onGetTextError:D,onGetTextSuccess:F,onLoadError:O,onLoadSuccess:L,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:W,onRenderError:j,onRenderSuccess:V,onRenderTextLayerError:z,onRenderTextLayerSuccess:Y,pageIndex:K,pageNumber:G,pdf:H,registerPage:Q,renderAnnotationLayer:Z=!0,renderForms:yt=!1,renderMode:bt="canvas",renderTextLayer:X=!0,rotate:nt,scale:ht=Zk,unregisterPage:lt,width:ct}=e,st=LN(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[vt,tt]=wu(),{value:it,error:wt}=vt,St=U.useRef(null);ae(H);const rt=Do(G)?G-1:K??null,mt=G??(Do(K)?K+1:null),dt=nt??(it?it.rotate:null),et=U.useMemo(()=>{if(!it)return null;let Ae=1;const ve=ht??Zk;if(ct||g){const ii=it.getViewport({scale:1,rotation:dt});ct?Ae=ct/ii.width:g&&(Ae=g/ii.height)}return ve*Ae},[g,it,dt,ht,ct]);U.useEffect(function(){return()=>{Do(rt)&&s&&lt&&lt(rt)}},[s,H,rt,lt]);function Rt(){if(L){if(!it||!et)return;L(E_(it,et))}if(s&&Q){if(!Do(rt)||!St.current)return;Q(rt,St.current)}}function Xt(){wt&&(Li(!1,wt.toString()),O&&O(wt))}U.useEffect(function(){tt({type:"RESET"})},[tt,H,rt]),U.useEffect(function(){if(!H||!mt)return;const ve=km(H.getPage(mt)),ii=ve;return ve.promise.then(v=>{tt({type:"RESOLVE",value:v})}).catch(v=>{tt({type:"REJECT",error:v})}),()=>Rh(ii)},[tt,H,mt]),U.useEffect(()=>{if(it!==void 0){if(it===!1){Xt();return}Rt()}},[it,et]);const pe=U.useMemo(()=>it&&Do(rt)&&mt&&Do(dt)&&Do(et)?{_className:i,canvasBackground:r,customTextRenderer:h,devicePixelRatio:f,onGetAnnotationsError:w,onGetAnnotationsSuccess:x,onGetStructTreeError:R,onGetStructTreeSuccess:I,onGetTextError:D,onGetTextSuccess:F,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:W,onRenderError:j,onRenderSuccess:V,onRenderTextLayerError:z,onRenderTextLayerSuccess:Y,page:it,pageIndex:rt,pageNumber:mt,renderForms:yt,renderTextLayer:X,rotate:dt,scale:et}:null,[i,r,h,f,w,x,R,I,D,F,M,W,j,V,z,Y,it,rt,mt,yt,X,dt,et]),Ce=U.useMemo(()=>UP(st,()=>it&&(et?E_(it,et):void 0)),[st,it,et]),se=`${rt}@${et}/${dt}`;function Vt(){switch(bt){case"custom":return ae(c),N.jsx(c,{},`${se}_custom`);case"none":return null;case"canvas":default:return N.jsx(CN,{canvasRef:a},`${se}_canvas`)}}function Gt(){return X?N.jsx(RN,{},`${se}_text`):null}function ge(){return Z?N.jsx(PN,{},`${se}_annotations`):null}function _t(){return N.jsxs(KP.Provider,{value:pe,children:[Vt(),Gt(),ge(),o]})}function ei(){return mt?H===null||it===void 0||it===null?N.jsx(dd,{type:"loading",children:typeof b=="function"?b():b}):H===!1||it===!1?N.jsx(dd,{type:"error",children:typeof p=="function"?p():p}):_t():N.jsx(dd,{type:"no-data",children:typeof y=="function"?y():y})}return N.jsx("div",Object.assign({className:Tw(i,l),"data-page-number":mt,ref:YP(m,St),style:{"--scale-factor":`${et}`,backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Ce,{children:ei()}))}pN();IS.workerSrc="pdf.worker.mjs";function MN(n){return AS({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor"},child:[]}]})(n)}function IN({pageNumber:n,numPages:t,toggleSidebar:e,setScale:i,isFullscreen:s,setIsFullscreen:r}){const{colorMode:a}=_S(),o=()=>r(!s);return N.jsxs(hA,{justifyContent:"space-between",bg:a==="dark"?"gray.700":"gray.300",p:3,position:"sticky",top:0,left:0,zIndex:4,w:"full",id:"pdf-toolbar",children:[N.jsxs(hA,{children:[N.jsx($c,{size:"sm",variant:"ghost",py:5,onClick:e,isDisabled:!s,children:N.jsx(MN,{size:23})}),N.jsx($c,{size:"md",py:5,onClick:o,children:s?"Exit Fullscreen":"Fullscreen"})]}),N.jsxs(ec,{children:["Page ",n," of ",t]}),N.jsxs(hA,{children:[N.jsx($c,{onClick:()=>i(l=>l+.1),children:"Zoom In"}),N.jsx($c,{onClick:()=>i(l=>l-.1),children:"Zoom Out"})]})]})}IS.workerSrc=new URL("/assets/pdf.worker.min-DGf6LXVo.mjs",import.meta.url).toString();function DN({id:n}){const{colorMode:t}=_S(),[e,i]=U.useState(!1),[s,r]=U.useState(),[a,o]=U.useState(1),[l,c]=U.useState(1),[h,f]=U.useState(!1),[p,g]=U.useState("gray.200"),m=U.useRef(null);U.useEffect(()=>{if(m.current){const R=m.current.querySelectorAll(".react-pdf__Page")[a-1];R&&R.scrollIntoView({behavior:"smooth"})}},[a,t]);function b({numPages:x}){r(x)}const y=()=>i(!e);function w(){g(t==="light"?"gray.200":"gray.800")}return N.jsxs(od,{width:"100%",pos:h?"absolute":"relative",top:0,left:0,mb:12,bg:p,overflowX:"hidden",overflowY:"auto",pt:0,height:"100vh",children:[N.jsx(IN,{pageNumber:a,numPages:s,toggleSidebar:y,setScale:c,isFullscreen:h,setIsFullscreen:f}),N.jsx(gv,{w:"max-content",mx:"auto",pos:"relative",children:N.jsxs(AN,{file:`https://academic-nexus-iqrauni.vercel.app/api/assessments/view-assessment-file/${n}`,onLoadSuccess:b,loading:N.jsx(mv,{mt:12}),onLoadError:w,children:[N.jsx($2.div,{initial:{x:"-100%"},animate:{x:e?0:"-100%"},transition:{type:"tween",duration:.3},style:{position:"fixed",left:0,top:"64px",bottom:0,width:"20%",padding:"16px",overflowY:"auto",zIndex:2,height:"90vh",backgroundColor:t==="light"?"rgb(209,209,209)":"gray.400"},id:"sidebar-pages",children:N.jsx(Sk,{alignItems:"center",w:"full",children:Array.from(new Array(s),(x,R)=>N.jsx(od,{onClick:()=>o(R+1),cursor:"pointer",p:1,border:a===R+1?"2px solid purple":"1px solid gray",my:5,children:N.jsx(Jk,{pageNumber:R+1,width:150})},`thumbnail-${R+1}`))})}),N.jsx(Sk,{ref:m,children:Array.from(new Array(s),(x,R)=>N.jsx(od,{my:4,boxShadow:"0 0 15px gray",rounded:"lg",overflow:"hidden",children:N.jsx(Jk,{pageNumber:R+1,scale:l})},R))})]})})]})}function FN(n){return AS({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 0a256 256 0 1 0 0 512A256 256 0 1 0 256 0zM127 281c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l71 71L232 136c0-13.3 10.7-24 24-24s24 10.7 24 24l0 182.1 71-71c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9L273 393c-9.4 9.4-24.6 9.4-33.9 0L127 281z"},child:[]}]})(n)}function ON(n){return AS({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM385 231c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-71-71V376c0 13.3-10.7 24-24 24s-24-10.7-24-24V193.9l-71 71c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9L239 119c9.4-9.4 24.6-9.4 33.9 0L385 231z"},child:[]}]})(n)}var NN=Object.defineProperty,jN=(n,t,e)=>t in n?NN(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,Lt=(n,t,e)=>(jN(n,typeof t!="symbol"?t+"":t,e),e),DS=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)},u=(n,t,e)=>(DS(n,t,"read from private field"),e?e.call(n):t.get(n)),_=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)},T=(n,t,e,i)=>(DS(n,t,"write to private field"),t.set(n,e),e),Vs=(n,t,e,i)=>({set _(s){T(n,t,s)},get _(){return u(n,t,i)}}),C=(n,t,e)=>(DS(n,t,"access private method"),e),df=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eL(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function rG(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var s=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return n[i]}})}),e}var Du=function(n){return n&&n.Math===Math&&n},ir=Du(typeof globalThis=="object"&&globalThis)||Du(typeof window=="object"&&window)||Du(typeof self=="object"&&self)||Du(typeof df=="object"&&df)||Du(typeof df=="object"&&df)||function(){return this}()||Function("return this")(),FS={},Lo=function(n){try{return!!n()}catch{return!0}},BN=Lo,Hh=!BN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),WN=Lo,iL=!WN(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),HN=iL,Wm=Function.prototype.call,OS=HN?Wm.bind(Wm):function(){return Wm.apply(Wm,arguments)},sL={},nL={}.propertyIsEnumerable,rL=Object.getOwnPropertyDescriptor,$N=rL&&!nL.call({1:2},1);sL.f=$N?function(n){var t=rL(this,n);return!!t&&t.enumerable}:nL;var aL=function(n,t){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:t}},oL=iL,lL=Function.prototype,x_=lL.call,UN=oL&&lL.bind.bind(x_,x_),ba=oL?UN:function(n){return function(){return x_.apply(n,arguments)}},hL=ba,zN=hL({}.toString),VN=hL("".slice),GN=function(n){return VN(zN(n),8,-1)},qN=ba,XN=Lo,YN=GN,mA=Object,KN=qN("".split),QN=XN(function(){return!mA("z").propertyIsEnumerable(0)})?function(n){return YN(n)==="String"?KN(n,""):mA(n)}:mA,cL=function(n){return n==null},ZN=cL,JN=TypeError,dL=function(n){if(ZN(n))throw new JN("Can't call method on "+n);return n},t3=QN,e3=dL,NS=function(n){return t3(e3(n))},vA=typeof document=="object"&&document.all,sr=typeof vA>"u"&&vA!==void 0?function(n){return typeof n=="function"||n===vA}:function(n){return typeof n=="function"},i3=sr,Cm=function(n){return typeof n=="object"?n!==null:i3(n)},bA=ir,s3=sr,n3=function(n){return s3(n)?n:void 0},uL=function(n,t){return arguments.length<2?n3(bA[n]):bA[n]&&bA[n][t]},r3=ba,a3=r3({}.isPrototypeOf),o3=typeof navigator<"u"&&String(navigator.userAgent)||"",fL=ir,yA=o3,tC=fL.process,eC=fL.Deno,iC=tC&&tC.versions||eC&&eC.version,sC=iC&&iC.v8,pn,ty;sC&&(pn=sC.split("."),ty=pn[0]>0&&pn[0]<4?1:+(pn[0]+pn[1]));!ty&&yA&&(pn=yA.match(/Edge\/(\d+)/),(!pn||pn[1]>=74)&&(pn=yA.match(/Chrome\/(\d+)/),pn&&(ty=+pn[1])));var l3=ty,nC=l3,h3=Lo,c3=ir,d3=c3.String,pL=!!Object.getOwnPropertySymbols&&!h3(function(){var n=Symbol("symbol detection");return!d3(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&nC&&nC<41}),u3=pL,gL=u3&&!Symbol.sham&&typeof Symbol.iterator=="symbol",f3=uL,p3=sr,g3=a3,m3=gL,v3=Object,mL=m3?function(n){return typeof n=="symbol"}:function(n){var t=f3("Symbol");return p3(t)&&g3(t.prototype,v3(n))},b3=String,y3=function(n){try{return b3(n)}catch{return"Object"}},w3=sr,A3=y3,_3=TypeError,vL=function(n){if(w3(n))return n;throw new _3(A3(n)+" is not a function")},E3=vL,x3=cL,S3=function(n,t){var e=n[t];return x3(e)?void 0:E3(e)},wA=OS,AA=sr,_A=Cm,k3=TypeError,C3=function(n,t){var e,i;if(t==="string"&&AA(e=n.toString)&&!_A(i=wA(e,n))||AA(e=n.valueOf)&&!_A(i=wA(e,n))||t!=="string"&&AA(e=n.toString)&&!_A(i=wA(e,n)))return i;throw new k3("Can't convert object to primitive value")},bL={exports:{}},rC=ir,T3=Object.defineProperty,jS=function(n,t){try{T3(rC,n,{value:t,configurable:!0,writable:!0})}catch{rC[n]=t}return t},R3=ir,P3=jS,aC="__core-js_shared__",oC=bL.exports=R3[aC]||P3(aC,{});(oC.versions||(oC.versions=[])).push({version:"3.37.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"});var BS=bL.exports,lC=BS,yL=function(n,t){return lC[n]||(lC[n]=t||{})},L3=dL,M3=Object,I3=function(n){return M3(L3(n))},D3=ba,F3=I3,O3=D3({}.hasOwnProperty),$h=Object.hasOwn||function(n,t){return O3(F3(n),t)},N3=ba,j3=0,B3=Math.random(),W3=N3(1 .toString),wL=function(n){return"Symbol("+(n===void 0?"":n)+")_"+W3(++j3+B3,36)},H3=ir,$3=yL,hC=$h,U3=wL,z3=pL,V3=gL,Uc=H3.Symbol,EA=$3("wks"),G3=V3?Uc.for||Uc:Uc&&Uc.withoutSetter||U3,q3=function(n){return hC(EA,n)||(EA[n]=z3&&hC(Uc,n)?Uc[n]:G3("Symbol."+n)),EA[n]},X3=OS,cC=Cm,dC=mL,Y3=S3,K3=C3,Q3=q3,Z3=TypeError,J3=Q3("toPrimitive"),tj=function(n,t){if(!cC(n)||dC(n))return n;var e=Y3(n,J3),i;if(e){if(t===void 0&&(t="default"),i=X3(e,n,t),!cC(i)||dC(i))return i;throw new Z3("Can't convert object to primitive value")}return t===void 0&&(t="number"),K3(n,t)},ej=tj,ij=mL,AL=function(n){var t=ej(n,"string");return ij(t)?t:t+""},sj=ir,uC=Cm,S_=sj.document,nj=uC(S_)&&uC(S_.createElement),rj=function(n){return nj?S_.createElement(n):{}},aj=Hh,oj=Lo,lj=rj,_L=!aj&&!oj(function(){return Object.defineProperty(lj("div"),"a",{get:function(){return 7}}).a!==7}),hj=Hh,cj=OS,dj=sL,uj=aL,fj=NS,pj=AL,gj=$h,mj=_L,fC=Object.getOwnPropertyDescriptor;FS.f=hj?fC:function(n,t){if(n=fj(n),t=pj(t),mj)try{return fC(n,t)}catch{}if(gj(n,t))return uj(!cj(dj.f,n,t),n[t])};var Mw={},vj=Hh,bj=Lo,yj=vj&&bj(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),wj=Cm,Aj=String,_j=TypeError,EL=function(n){if(wj(n))return n;throw new _j(Aj(n)+" is not an object")},Ej=Hh,xj=_L,Sj=yj,Hm=EL,pC=AL,kj=TypeError,xA=Object.defineProperty,Cj=Object.getOwnPropertyDescriptor,SA="enumerable",kA="configurable",CA="writable";Mw.f=Ej?Sj?function(n,t,e){if(Hm(n),t=pC(t),Hm(e),typeof n=="function"&&t==="prototype"&&"value"in e&&CA in e&&!e[CA]){var i=Cj(n,t);i&&i[CA]&&(n[t]=e.value,e={configurable:kA in e?e[kA]:i[kA],enumerable:SA in e?e[SA]:i[SA],writable:!1})}return xA(n,t,e)}:xA:function(n,t,e){if(Hm(n),t=pC(t),Hm(e),xj)try{return xA(n,t,e)}catch{}if("get"in e||"set"in e)throw new kj("Accessors not supported");return"value"in e&&(n[t]=e.value),n};var Tj=Hh,Rj=Mw,Pj=aL,xL=Tj?function(n,t,e){return Rj.f(n,t,Pj(1,e))}:function(n,t,e){return n[t]=e,n},SL={exports:{}},k_=Hh,Lj=$h,kL=Function.prototype,Mj=k_&&Object.getOwnPropertyDescriptor,WS=Lj(kL,"name"),Ij=WS&&(function(){}).name==="something",Dj=WS&&(!k_||k_&&Mj(kL,"name").configurable),Fj={EXISTS:WS,PROPER:Ij,CONFIGURABLE:Dj},Oj=ba,Nj=sr,C_=BS,jj=Oj(Function.toString);Nj(C_.inspectSource)||(C_.inspectSource=function(n){return jj(n)});var Bj=C_.inspectSource,Wj=ir,Hj=sr,gC=Wj.WeakMap,$j=Hj(gC)&&/native code/.test(String(gC)),Uj=yL,zj=wL,mC=Uj("keys"),Vj=function(n){return mC[n]||(mC[n]=zj(n))},CL={},Gj=$j,TL=ir,qj=Cm,Xj=xL,TA=$h,RA=BS,Yj=Vj,Kj=CL,vC="Object already initialized",T_=TL.TypeError,Qj=TL.WeakMap,ey,Wp,iy,Zj=function(n){return iy(n)?Wp(n):ey(n,{})},Jj=function(n){return function(t){var e;if(!qj(t)||(e=Wp(t)).type!==n)throw new T_("Incompatible receiver, "+n+" required");return e}};if(Gj||RA.state){var vn=RA.state||(RA.state=new Qj);vn.get=vn.get,vn.has=vn.has,vn.set=vn.set,ey=function(n,t){if(vn.has(n))throw new T_(vC);return t.facade=n,vn.set(n,t),t},Wp=function(n){return vn.get(n)||{}},iy=function(n){return vn.has(n)}}else{var qh=Yj("state");Kj[qh]=!0,ey=function(n,t){if(TA(n,qh))throw new T_(vC);return t.facade=n,Xj(n,qh,t),t},Wp=function(n){return TA(n,qh)?n[qh]:{}},iy=function(n){return TA(n,qh)}}var tB={set:ey,get:Wp,has:iy,enforce:Zj,getterFor:Jj},HS=ba,eB=Lo,iB=sr,$m=$h,R_=Hh,sB=Fj.CONFIGURABLE,nB=Bj,RL=tB,rB=RL.enforce,aB=RL.get,bC=String,Uv=Object.defineProperty,oB=HS("".slice),lB=HS("".replace),hB=HS([].join),cB=R_&&!eB(function(){return Uv(function(){},"length",{value:8}).length!==8}),dB=String(String).split("String"),uB=SL.exports=function(n,t,e){oB(bC(t),0,7)==="Symbol("&&(t="["+lB(bC(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!$m(n,"name")||sB&&n.name!==t)&&(R_?Uv(n,"name",{value:t,configurable:!0}):n.name=t),cB&&e&&$m(e,"arity")&&n.length!==e.arity&&Uv(n,"length",{value:e.arity});try{e&&$m(e,"constructor")&&e.constructor?R_&&Uv(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var i=rB(n);return $m(i,"source")||(i.source=hB(dB,typeof t=="string"?t:"")),n};Function.prototype.toString=uB(function(){return iB(this)&&aB(this).source||nB(this)},"toString");var fB=SL.exports,pB=sr,gB=Mw,mB=fB,vB=jS,bB=function(n,t,e,i){i||(i={});var s=i.enumerable,r=i.name!==void 0?i.name:t;if(pB(e)&&mB(e,r,i),i.global)s?n[t]=e:vB(t,e);else{try{i.unsafe?n[t]&&(s=!0):delete n[t]}catch{}s?n[t]=e:gB.f(n,t,{value:e,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return n},PL={},yB=Math.ceil,wB=Math.floor,AB=Math.trunc||function(n){var t=+n;return(t>0?wB:yB)(t)},_B=AB,LL=function(n){var t=+n;return t!==t||t===0?0:_B(t)},EB=LL,xB=Math.max,SB=Math.min,kB=function(n,t){var e=EB(n);return e<0?xB(e+t,0):SB(e,t)},CB=LL,TB=Math.min,RB=function(n){var t=CB(n);return t>0?TB(t,9007199254740991):0},PB=RB,LB=function(n){return PB(n.length)},MB=NS,IB=kB,DB=LB,yC=function(n){return function(t,e,i){var s=MB(t),r=DB(s);if(r===0)return!n&&-1;var a=IB(i,r),o;if(n&&e!==e){for(;r>a;)if(o=s[a++],o!==o)return!0}else for(;r>a;a++)if((n||a in s)&&s[a]===e)return n||a||0;return!n&&-1}},FB={includes:yC(!0),indexOf:yC(!1)},OB=ba,PA=$h,NB=NS,jB=FB.indexOf,BB=CL,wC=OB([].push),WB=function(n,t){var e=NB(n),i=0,s=[],r;for(r in e)!PA(BB,r)&&PA(e,r)&&wC(s,r);for(;t.length>i;)PA(e,r=t[i++])&&(~jB(s,r)||wC(s,r));return s},HB=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],$B=WB,UB=HB,zB=UB.concat("length","prototype");PL.f=Object.getOwnPropertyNames||function(n){return $B(n,zB)};var ML={};ML.f=Object.getOwnPropertySymbols;var VB=uL,GB=ba,qB=PL,XB=ML,YB=EL,KB=GB([].concat),QB=VB("Reflect","ownKeys")||function(n){var t=qB.f(YB(n)),e=XB.f;return e?KB(t,e(n)):t},AC=$h,ZB=QB,JB=FS,t5=Mw,e5=function(n,t,e){for(var i=ZB(t),s=t5.f,r=JB.f,a=0;a<i.length;a++){var o=i[a];!AC(n,o)&&!(e&&AC(e,o))&&s(n,o,r(t,o))}},i5=Lo,s5=sr,n5=/#|\.prototype\./,Tm=function(n,t){var e=a5[r5(n)];return e===l5?!0:e===o5?!1:s5(t)?i5(t):!!t},r5=Tm.normalize=function(n){return String(n).replace(n5,".").toLowerCase()},a5=Tm.data={},o5=Tm.NATIVE="N",l5=Tm.POLYFILL="P",h5=Tm,Um=ir,c5=FS.f,d5=xL,u5=bB,f5=jS,p5=e5,g5=h5,m5=function(n,t){var e=n.target,i=n.global,s=n.stat,r,a,o,l,c,h;if(i?a=Um:s?a=Um[e]||f5(e,{}):a=Um[e]&&Um[e].prototype,a)for(o in t){if(c=t[o],n.dontCallGetSet?(h=c5(a,o),l=h&&h.value):l=a[o],r=g5(i?o:e+(s?".":"#")+o,n.forced),!r&&l!==void 0){if(typeof c==typeof l)continue;p5(c,l)}(n.sham||l&&l.sham)&&d5(c,"sham",!0),u5(a,o,c,n)}},IL={},_C=vL,v5=TypeError,b5=function(n){var t,e;this.promise=new n(function(i,s){if(t!==void 0||e!==void 0)throw new v5("Bad Promise constructor");t=i,e=s}),this.resolve=_C(t),this.reject=_C(e)};IL.f=function(n){return new b5(n)};var y5=m5,w5=IL;y5({target:"Promise",stat:!0},{withResolvers:function(){var n=w5.f(this);return{promise:n.promise,resolve:n.resolve,reject:n.reject}}});function A5(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var DL={exports:{}},ke=DL.exports={},Cn,Tn;function P_(){throw new Error("setTimeout has not been defined")}function L_(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Cn=setTimeout:Cn=P_}catch{Cn=P_}try{typeof clearTimeout=="function"?Tn=clearTimeout:Tn=L_}catch{Tn=L_}})();function FL(n){if(Cn===setTimeout)return setTimeout(n,0);if((Cn===P_||!Cn)&&setTimeout)return Cn=setTimeout,setTimeout(n,0);try{return Cn(n,0)}catch{try{return Cn.call(null,n,0)}catch{return Cn.call(this,n,0)}}}function _5(n){if(Tn===clearTimeout)return clearTimeout(n);if((Tn===L_||!Tn)&&clearTimeout)return Tn=clearTimeout,clearTimeout(n);try{return Tn(n)}catch{try{return Tn.call(null,n)}catch{return Tn.call(this,n)}}}var oa=[],ud=!1,bl,zv=-1;function E5(){!ud||!bl||(ud=!1,bl.length?oa=bl.concat(oa):zv=-1,oa.length&&OL())}function OL(){if(!ud){var n=FL(E5);ud=!0;for(var t=oa.length;t;){for(bl=oa,oa=[];++zv<t;)bl&&bl[zv].run();zv=-1,t=oa.length}bl=null,ud=!1,_5(n)}}ke.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];oa.push(new NL(n,t)),oa.length===1&&!ud&&FL(OL)};function NL(n,t){this.fun=n,this.array=t}NL.prototype.run=function(){this.fun.apply(null,this.array)};ke.title="browser";ke.browser=!0;ke.env={};ke.argv=[];ke.version="";ke.versions={};function ya(){}ke.on=ya;ke.addListener=ya;ke.once=ya;ke.off=ya;ke.removeListener=ya;ke.removeAllListeners=ya;ke.emit=ya;ke.prependListener=ya;ke.prependOnceListener=ya;ke.listeners=function(n){return[]};ke.binding=function(n){throw new Error("process.binding is not supported")};ke.cwd=function(){return"/"};ke.chdir=function(n){throw new Error("process.chdir is not supported")};ke.umask=function(){return 0};var x5=DL.exports;const Tt=A5(x5);var Di=function(){return Di=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Di.apply(this,arguments)};function Ph(n,t,e){if(e||arguments.length===2)for(var i=0,s=t.length,r;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))}function S5(n){var t=Object.create(null);return function(e){return t[e]===void 0&&(t[e]=n(e)),t[e]}}var k5=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,C5=S5(function(n){return k5.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91}),fe="-ms-",dp="-moz-",Yt="-webkit-",jL="comm",Iw="rule",$S="decl",T5="@import",BL="@keyframes",R5="@layer",WL=Math.abs,US=String.fromCharCode,M_=Object.assign;function P5(n,t){return ti(n,0)^45?(((t<<2^ti(n,0))<<2^ti(n,1))<<2^ti(n,2))<<2^ti(n,3):0}function HL(n){return n.trim()}function Ar(n,t){return(n=t.exec(n))?n[0]:n}function Mt(n,t,e){return n.replace(t,e)}function Vv(n,t,e){return n.indexOf(t,e)}function ti(n,t){return n.charCodeAt(t)|0}function Au(n,t,e){return n.slice(t,e)}function Xn(n){return n.length}function $L(n){return n.length}function uf(n,t){return t.push(n),n}function L5(n,t){return n.map(t).join("")}function EC(n,t){return n.filter(function(e){return!Ar(e,t)})}var Dw=1,_u=1,UL=0,Gs=0,Me=0,Tu="";function Fw(n,t,e,i,s,r,a,o){return{value:n,root:t,parent:e,type:i,props:s,children:r,line:Dw,column:_u,length:a,return:"",siblings:o}}function xa(n,t){return M_(Fw("",null,null,"",null,null,0,n.siblings),n,{length:-n.length},t)}function Xh(n){for(;n.root;)n=xa(n.root,{children:[n]});uf(n,n.siblings)}function M5(){return Me}function I5(){return Me=Gs>0?ti(Tu,--Gs):0,_u--,Me===10&&(_u=1,Dw--),Me}function gn(){return Me=Gs<UL?ti(Tu,Gs++):0,_u++,Me===10&&(_u=1,Dw++),Me}function Eh(){return ti(Tu,Gs)}function Gv(){return Gs}function Ow(n,t){return Au(Tu,n,t)}function I_(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function D5(n){return Dw=_u=1,UL=Xn(Tu=n),Gs=0,[]}function F5(n){return Tu="",n}function LA(n){return HL(Ow(Gs-1,D_(n===91?n+2:n===40?n+1:n)))}function O5(n){for(;(Me=Eh())&&Me<33;)gn();return I_(n)>2||I_(Me)>3?"":" "}function N5(n,t){for(;--t&&gn()&&!(Me<48||Me>102||Me>57&&Me<65||Me>70&&Me<97););return Ow(n,Gv()+(t<6&&Eh()==32&&gn()==32))}function D_(n){for(;gn();)switch(Me){case n:return Gs;case 34:case 39:n!==34&&n!==39&&D_(Me);break;case 40:n===41&&D_(n);break;case 92:gn();break}return Gs}function j5(n,t){for(;gn()&&n+Me!==57&&!(n+Me===84&&Eh()===47););return"/*"+Ow(t,Gs-1)+"*"+US(n===47?n:gn())}function B5(n){for(;!I_(Eh());)gn();return Ow(n,Gs)}function W5(n){return F5(qv("",null,null,null,[""],n=D5(n),0,[0],n))}function qv(n,t,e,i,s,r,a,o,l){for(var c=0,h=0,f=a,p=0,g=0,m=0,b=1,y=1,w=1,x=0,R="",I=s,D=r,F=i,O=R;y;)switch(m=x,x=gn()){case 40:if(m!=108&&ti(O,f-1)==58){Vv(O+=Mt(LA(x),"&","&\f"),"&\f",WL(c?o[c-1]:0))!=-1&&(w=-1);break}case 34:case 39:case 91:O+=LA(x);break;case 9:case 10:case 13:case 32:O+=O5(m);break;case 92:O+=N5(Gv()-1,7);continue;case 47:switch(Eh()){case 42:case 47:uf(H5(j5(gn(),Gv()),t,e,l),l);break;default:O+="/"}break;case 123*b:o[c++]=Xn(O)*w;case 125*b:case 59:case 0:switch(x){case 0:case 125:y=0;case 59+h:w==-1&&(O=Mt(O,/\f/g,"")),g>0&&Xn(O)-f&&uf(g>32?SC(O+";",i,e,f-1,l):SC(Mt(O," ","")+";",i,e,f-2,l),l);break;case 59:O+=";";default:if(uf(F=xC(O,t,e,c,h,s,o,R,I=[],D=[],f,r),r),x===123)if(h===0)qv(O,t,F,F,I,r,f,o,D);else switch(p===99&&ti(O,3)===110?100:p){case 100:case 108:case 109:case 115:qv(n,F,F,i&&uf(xC(n,F,F,0,0,s,o,R,s,I=[],f,D),D),s,D,f,o,i?I:D);break;default:qv(O,F,F,F,[""],D,0,o,D)}}c=h=g=0,b=w=1,R=O="",f=a;break;case 58:f=1+Xn(O),g=m;default:if(b<1){if(x==123)--b;else if(x==125&&b++==0&&I5()==125)continue}switch(O+=US(x),x*b){case 38:w=h>0?1:(O+="\f",-1);break;case 44:o[c++]=(Xn(O)-1)*w,w=1;break;case 64:Eh()===45&&(O+=LA(gn())),p=Eh(),h=f=Xn(R=O+=B5(Gv())),x++;break;case 45:m===45&&Xn(O)==2&&(b=0)}}return r}function xC(n,t,e,i,s,r,a,o,l,c,h,f){for(var p=s-1,g=s===0?r:[""],m=$L(g),b=0,y=0,w=0;b<i;++b)for(var x=0,R=Au(n,p+1,p=WL(y=a[b])),I=n;x<m;++x)(I=HL(y>0?g[x]+" "+R:Mt(R,/&\f/g,g[x])))&&(l[w++]=I);return Fw(n,t,e,s===0?Iw:o,l,c,h,f)}function H5(n,t,e,i){return Fw(n,t,e,jL,US(M5()),Au(n,2,-2),0,i)}function SC(n,t,e,i,s){return Fw(n,t,e,$S,Au(n,0,i),Au(n,i+1,-1),i,s)}function zL(n,t,e){switch(P5(n,t)){case 5103:return Yt+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Yt+n+n;case 4789:return dp+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Yt+n+dp+n+fe+n+n;case 5936:switch(ti(n,t+11)){case 114:return Yt+n+fe+Mt(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Yt+n+fe+Mt(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Yt+n+fe+Mt(n,/[svh]\w+-[tblr]{2}/,"lr")+n}case 6828:case 4268:case 2903:return Yt+n+fe+n+n;case 6165:return Yt+n+fe+"flex-"+n+n;case 5187:return Yt+n+Mt(n,/(\w+).+(:[^]+)/,Yt+"box-$1$2"+fe+"flex-$1$2")+n;case 5443:return Yt+n+fe+"flex-item-"+Mt(n,/flex-|-self/g,"")+(Ar(n,/flex-|baseline/)?"":fe+"grid-row-"+Mt(n,/flex-|-self/g,""))+n;case 4675:return Yt+n+fe+"flex-line-pack"+Mt(n,/align-content|flex-|-self/g,"")+n;case 5548:return Yt+n+fe+Mt(n,"shrink","negative")+n;case 5292:return Yt+n+fe+Mt(n,"basis","preferred-size")+n;case 6060:return Yt+"box-"+Mt(n,"-grow","")+Yt+n+fe+Mt(n,"grow","positive")+n;case 4554:return Yt+Mt(n,/([^-])(transform)/g,"$1"+Yt+"$2")+n;case 6187:return Mt(Mt(Mt(n,/(zoom-|grab)/,Yt+"$1"),/(image-set)/,Yt+"$1"),n,"")+n;case 5495:case 3959:return Mt(n,/(image-set\([^]*)/,Yt+"$1$`$1");case 4968:return Mt(Mt(n,/(.+:)(flex-)?(.*)/,Yt+"box-pack:$3"+fe+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Yt+n+n;case 4200:if(!Ar(n,/flex-|baseline/))return fe+"grid-column-align"+Au(n,t)+n;break;case 2592:case 3360:return fe+Mt(n,"template-","")+n;case 4384:case 3616:return e&&e.some(function(i,s){return t=s,Ar(i.props,/grid-\w+-end/)})?~Vv(n+(e=e[t].value),"span",0)?n:fe+Mt(n,"-start","")+n+fe+"grid-row-span:"+(~Vv(e,"span",0)?Ar(e,/\d+/):+Ar(e,/\d+/)-+Ar(n,/\d+/))+";":fe+Mt(n,"-start","")+n;case 4896:case 4128:return e&&e.some(function(i){return Ar(i.props,/grid-\w+-start/)})?n:fe+Mt(Mt(n,"-end","-span"),"span ","")+n;case 4095:case 3583:case 4068:case 2532:return Mt(n,/(.+)-inline(.+)/,Yt+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Xn(n)-1-t>6)switch(ti(n,t+1)){case 109:if(ti(n,t+4)!==45)break;case 102:return Mt(n,/(.+:)(.+)-([^]+)/,"$1"+Yt+"$2-$3$1"+dp+(ti(n,t+3)==108?"$3":"$2-$3"))+n;case 115:return~Vv(n,"stretch",0)?zL(Mt(n,"stretch","fill-available"),t,e)+n:n}break;case 5152:case 5920:return Mt(n,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(i,s,r,a,o,l,c){return fe+s+":"+r+c+(a?fe+s+"-span:"+(o?l:+l-+r)+c:"")+n});case 4949:if(ti(n,t+6)===121)return Mt(n,":",":"+Yt)+n;break;case 6444:switch(ti(n,ti(n,14)===45?18:11)){case 120:return Mt(n,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Yt+(ti(n,14)===45?"inline-":"")+"box$3$1"+Yt+"$2$3$1"+fe+"$2box$3")+n;case 100:return Mt(n,":",":"+fe)+n}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Mt(n,"scroll-","scroll-snap-")+n}return n}function sy(n,t){for(var e="",i=0;i<n.length;i++)e+=t(n[i],i,n,t)||"";return e}function $5(n,t,e,i){switch(n.type){case R5:if(n.children.length)break;case T5:case $S:return n.return=n.return||n.value;case jL:return"";case BL:return n.return=n.value+"{"+sy(n.children,i)+"}";case Iw:if(!Xn(n.value=n.props.join(",")))return""}return Xn(e=sy(n.children,i))?n.return=n.value+"{"+e+"}":""}function U5(n){var t=$L(n);return function(e,i,s,r){for(var a="",o=0;o<t;o++)a+=n[o](e,i,s,r)||"";return a}}function z5(n){return function(t){t.root||(t=t.return)&&n(t)}}function V5(n,t,e,i){if(n.length>-1&&!n.return)switch(n.type){case $S:n.return=zL(n.value,n.length,e);return;case BL:return sy([xa(n,{value:Mt(n.value,"@","@"+Yt)})],i);case Iw:if(n.length)return L5(e=n.props,function(s){switch(Ar(s,i=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Xh(xa(n,{props:[Mt(s,/:(read-\w+)/,":"+dp+"$1")]})),Xh(xa(n,{props:[s]})),M_(n,{props:EC(e,i)});break;case"::placeholder":Xh(xa(n,{props:[Mt(s,/:(plac\w+)/,":"+Yt+"input-$1")]})),Xh(xa(n,{props:[Mt(s,/:(plac\w+)/,":"+dp+"$1")]})),Xh(xa(n,{props:[Mt(s,/:(plac\w+)/,fe+"input-$1")]})),Xh(xa(n,{props:[s]})),M_(n,{props:EC(e,i)});break}return""})}}var G5={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Lh=typeof Tt<"u"&&Tt.env!==void 0&&(Tt.env.REACT_APP_SC_ATTR||Tt.env.SC_ATTR)||"data-styled",VL="active",GL="data-styled-version",Nw="6.1.11",zS=`/*!sc*/
`,VS=typeof window<"u"&&"HTMLElement"in window,q5=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof Tt<"u"&&Tt.env!==void 0&&Tt.env.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Tt.env.REACT_APP_SC_DISABLE_SPEEDY!==""?Tt.env.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Tt.env.REACT_APP_SC_DISABLE_SPEEDY:typeof Tt<"u"&&Tt.env!==void 0&&Tt.env.SC_DISABLE_SPEEDY!==void 0&&Tt.env.SC_DISABLE_SPEEDY!==""?Tt.env.SC_DISABLE_SPEEDY!=="false"&&Tt.env.SC_DISABLE_SPEEDY:Tt.env.NODE_ENV!=="production"),kC=/invalid hook call/i,zm=new Set,X5=function(n,t){if(Tt.env.NODE_ENV!=="production"){var e=t?' with the id of "'.concat(t,'"'):"",i="The component ".concat(n).concat(e,` has been created dynamically.
`)+`You may see this warning because you've called styled inside another component.
To resolve this only create new StyledComponents outside of any render method and function component.`,s=console.error;try{var r=!0;console.error=function(a){for(var o=[],l=1;l<arguments.length;l++)o[l-1]=arguments[l];kC.test(a)?(r=!1,zm.delete(i)):s.apply(void 0,Ph([a],o,!1))},U.useRef(),r&&!zm.has(i)&&(console.warn(i),zm.add(i))}catch(a){kC.test(a.message)&&zm.delete(i)}finally{console.error=s}}},jw=Object.freeze([]),Eu=Object.freeze({});function Y5(n,t,e){return e===void 0&&(e=Eu),n.theme!==e.theme&&n.theme||t||e.theme}var F_=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),K5=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Q5=/(^-|-$)/g;function CC(n){return n.replace(K5,"-").replace(Q5,"")}var Z5=/(a)(d)/gi,Vm=52,TC=function(n){return String.fromCharCode(n+(n>25?39:97))};function O_(n){var t,e="";for(t=Math.abs(n);t>Vm;t=t/Vm|0)e=TC(t%Vm)+e;return(TC(t%Vm)+e).replace(Z5,"$1-$2")}var MA,qL=5381,ol=function(n,t){for(var e=t.length;e;)n=33*n^t.charCodeAt(--e);return n},XL=function(n){return ol(qL,n)};function YL(n){return O_(XL(n)>>>0)}function KL(n){return Tt.env.NODE_ENV!=="production"&&typeof n=="string"&&n||n.displayName||n.name||"Component"}function IA(n){return typeof n=="string"&&(Tt.env.NODE_ENV==="production"||n.charAt(0)===n.charAt(0).toLowerCase())}var QL=typeof Symbol=="function"&&Symbol.for,ZL=QL?Symbol.for("react.memo"):60115,J5=QL?Symbol.for("react.forward_ref"):60112,tW={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},eW={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},JL={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},iW=((MA={})[J5]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MA[ZL]=JL,MA);function RC(n){return("type"in(t=n)&&t.type.$$typeof)===ZL?JL:"$$typeof"in n?iW[n.$$typeof]:tW;var t}var sW=Object.defineProperty,nW=Object.getOwnPropertyNames,PC=Object.getOwnPropertySymbols,rW=Object.getOwnPropertyDescriptor,aW=Object.getPrototypeOf,LC=Object.prototype;function tM(n,t,e){if(typeof t!="string"){if(LC){var i=aW(t);i&&i!==LC&&tM(n,i,e)}var s=nW(t);PC&&(s=s.concat(PC(t)));for(var r=RC(n),a=RC(t),o=0;o<s.length;++o){var l=s[o];if(!(l in eW||e&&e[l]||a&&l in a||r&&l in r)){var c=rW(t,l);try{sW(n,l,c)}catch{}}}}return n}function Mh(n){return typeof n=="function"}function GS(n){return typeof n=="object"&&"styledComponentId"in n}function yl(n,t){return n&&t?"".concat(n," ").concat(t):n||t||""}function N_(n,t){if(n.length===0)return"";for(var e=n[0],i=1;i<n.length;i++)e+=n[i];return e}function xu(n){return n!==null&&typeof n=="object"&&n.constructor.name===Object.name&&!("props"in n&&n.$$typeof)}function j_(n,t,e){if(e===void 0&&(e=!1),!e&&!xu(n)&&!Array.isArray(n))return t;if(Array.isArray(t))for(var i=0;i<t.length;i++)n[i]=j_(n[i],t[i]);else if(xu(t))for(var i in t)n[i]=j_(n[i],t[i]);return n}function qS(n,t){Object.defineProperty(n,"toString",{value:t})}var oW=Tt.env.NODE_ENV!=="production"?{1:`Cannot create styled-component for component: %s.

`,2:`Can't collect styles once you've consumed a \`ServerStyleSheet\`'s styles! \`ServerStyleSheet\` is a one off instance for each server-side render cycle.

- Are you trying to reuse it across renders?
- Are you accidentally calling collectStyles twice?

`,3:`Streaming SSR is only supported in a Node.js environment; Please do not try to call this method in the browser.

`,4:`The \`StyleSheetManager\` expects a valid target or sheet prop!

- Does this error occur on the client and is your target falsy?
- Does this error occur on the server and is the sheet falsy?

`,5:`The clone method cannot be used on the client!

- Are you running in a client-like environment on the server?
- Are you trying to run SSR on the client?

`,6:`Trying to insert a new style tag, but the given Node is unmounted!

- Are you using a custom target that isn't mounted?
- Does your document not have a valid head element?
- Have you accidentally removed a style tag manually?

`,7:'ThemeProvider: Please return an object from your "theme" prop function, e.g.\n\n```js\ntheme={() => ({})}\n```\n\n',8:`ThemeProvider: Please make your "theme" prop an object.

`,9:"Missing document `<head>`\n\n",10:`Cannot find a StyleSheet instance. Usually this happens if there are multiple copies of styled-components loaded at once. Check out this issue for how to troubleshoot and fix the common cases where this situation can happen: https://github.com/styled-components/styled-components/issues/1941#issuecomment-417862021

`,11:`_This error was replaced with a dev-time warning, it will be deleted for v4 final._ [createGlobalStyle] received children which will not be rendered. Please use the component without passing children elements.

`,12:"It seems you are interpolating a keyframe declaration (%s) into an untagged string. This was supported in styled-components v3, but is not longer supported in v4 as keyframes are now injected on-demand. Please wrap your string in the css\\`\\` helper which ensures the styles are injected correctly. See https://www.styled-components.com/docs/api#css\n\n",13:`%s is not a styled component and cannot be referred to via component selector. See https://www.styled-components.com/docs/advanced#referring-to-other-components for more details.

`,14:`ThemeProvider: "theme" prop is required.

`,15:"A stylis plugin has been supplied that is not named. We need a name for each plugin to be able to prevent styling collisions between different stylis configurations within the same app. Before you pass your plugin to `<StyleSheetManager stylisPlugins={[]}>`, please make sure each plugin is uniquely-named, e.g.\n\n```js\nObject.defineProperty(importedPlugin, 'name', { value: 'some-unique-name' });\n```\n\n",16:`Reached the limit of how many styled components may be created at group %s.
You may only create up to 1,073,741,824 components. If you're creating components dynamically,
as for instance in your render method then you may be running into this limitation.

`,17:`CSSStyleSheet could not be found on HTMLStyleElement.
Has styled-components' style tag been unmounted or altered by another script?
`,18:"ThemeProvider: Please make sure your useTheme hook is within a `<ThemeProvider>`"}:{};function lW(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var e=n[0],i=[],s=1,r=n.length;s<r;s+=1)i.push(n[s]);return i.forEach(function(a){e=e.replace(/%[a-z]/,a)}),e}function da(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return Tt.env.NODE_ENV==="production"?new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(n," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):"")):new Error(lW.apply(void 0,Ph([oW[n]],t,!1)).trim())}var hW=function(){function n(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return n.prototype.indexOfGroup=function(t){for(var e=0,i=0;i<t;i++)e+=this.groupSizes[i];return e},n.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var i=this.groupSizes,s=i.length,r=s;t>=r;)if((r<<=1)<0)throw da(16,"".concat(t));this.groupSizes=new Uint32Array(r),this.groupSizes.set(i),this.length=r;for(var a=s;a<r;a++)this.groupSizes[a]=0}for(var o=this.indexOfGroup(t+1),l=(a=0,e.length);a<l;a++)this.tag.insertRule(o,e[a])&&(this.groupSizes[t]++,o++)},n.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],i=this.indexOfGroup(t),s=i+e;this.groupSizes[t]=0;for(var r=i;r<s;r++)this.tag.deleteRule(i)}},n.prototype.getGroup=function(t){var e="";if(t>=this.length||this.groupSizes[t]===0)return e;for(var i=this.groupSizes[t],s=this.indexOfGroup(t),r=s+i,a=s;a<r;a++)e+="".concat(this.tag.getRule(a)).concat(zS);return e},n}(),cW=1<<30,Xv=new Map,ny=new Map,Yv=1,Gm=function(n){if(Xv.has(n))return Xv.get(n);for(;ny.has(Yv);)Yv++;var t=Yv++;if(Tt.env.NODE_ENV!=="production"&&((0|t)<0||t>cW))throw da(16,"".concat(t));return Xv.set(n,t),ny.set(t,n),t},dW=function(n,t){Yv=t+1,Xv.set(n,t),ny.set(t,n)},uW="style[".concat(Lh,"][").concat(GL,'="').concat(Nw,'"]'),fW=new RegExp("^".concat(Lh,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),pW=function(n,t,e){for(var i,s=e.split(","),r=0,a=s.length;r<a;r++)(i=s[r])&&n.registerName(t,i)},gW=function(n,t){for(var e,i=((e=t.textContent)!==null&&e!==void 0?e:"").split(zS),s=[],r=0,a=i.length;r<a;r++){var o=i[r].trim();if(o){var l=o.match(fW);if(l){var c=0|parseInt(l[1],10),h=l[2];c!==0&&(dW(h,c),pW(n,h,l[3]),n.getTag().insertRules(c,s)),s.length=0}else s.push(o)}}};function mW(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var eM=function(n){var t=document.head,e=n||t,i=document.createElement("style"),s=function(o){var l=Array.from(o.querySelectorAll("style[".concat(Lh,"]")));return l[l.length-1]}(e),r=s!==void 0?s.nextSibling:null;i.setAttribute(Lh,VL),i.setAttribute(GL,Nw);var a=mW();return a&&i.setAttribute("nonce",a),e.insertBefore(i,r),i},vW=function(){function n(t){this.element=eM(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var i=document.styleSheets,s=0,r=i.length;s<r;s++){var a=i[s];if(a.ownerNode===e)return a}throw da(17)}(this.element),this.length=0}return n.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch{return!1}},n.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},n.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},n}(),bW=function(){function n(t){this.element=eM(t),this.nodes=this.element.childNodes,this.length=0}return n.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var i=document.createTextNode(e);return this.element.insertBefore(i,this.nodes[t]||null),this.length++,!0}return!1},n.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},n.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},n}(),yW=function(){function n(t){this.rules=[],this.length=0}return n.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},n.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},n.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},n}(),MC=VS,wW={isServer:!VS,useCSSOMInjection:!q5},iM=function(){function n(t,e,i){t===void 0&&(t=Eu),e===void 0&&(e={});var s=this;this.options=Di(Di({},wW),t),this.gs=e,this.names=new Map(i),this.server=!!t.isServer,!this.server&&VS&&MC&&(MC=!1,function(r){for(var a=document.querySelectorAll(uW),o=0,l=a.length;o<l;o++){var c=a[o];c&&c.getAttribute(Lh)!==VL&&(gW(r,c),c.parentNode&&c.parentNode.removeChild(c))}}(this)),qS(this,function(){return function(r){for(var a=r.getTag(),o=a.length,l="",c=function(f){var p=function(w){return ny.get(w)}(f);if(p===void 0)return"continue";var g=r.names.get(p),m=a.getGroup(f);if(g===void 0||m.length===0)return"continue";var b="".concat(Lh,".g").concat(f,'[id="').concat(p,'"]'),y="";g!==void 0&&g.forEach(function(w){w.length>0&&(y+="".concat(w,","))}),l+="".concat(m).concat(b,'{content:"').concat(y,'"}').concat(zS)},h=0;h<o;h++)c(h);return l}(s)})}return n.registerId=function(t){return Gm(t)},n.prototype.reconstructWithOptions=function(t,e){return e===void 0&&(e=!0),new n(Di(Di({},this.options),t),this.gs,e&&this.names||void 0)},n.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},n.prototype.getTag=function(){return this.tag||(this.tag=(t=function(e){var i=e.useCSSOMInjection,s=e.target;return e.isServer?new yW(s):i?new vW(s):new bW(s)}(this.options),new hW(t)));var t},n.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},n.prototype.registerName=function(t,e){if(Gm(t),this.names.has(t))this.names.get(t).add(e);else{var i=new Set;i.add(e),this.names.set(t,i)}},n.prototype.insertRules=function(t,e,i){this.registerName(t,e),this.getTag().insertRules(Gm(t),i)},n.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},n.prototype.clearRules=function(t){this.getTag().clearGroup(Gm(t)),this.clearNames(t)},n.prototype.clearTag=function(){this.tag=void 0},n}(),AW=/&/g,_W=/^\s*\/\/.*$/gm;function sM(n,t){return n.map(function(e){return e.type==="rule"&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(i){return"".concat(t," ").concat(i)})),Array.isArray(e.children)&&e.type!=="@keyframes"&&(e.children=sM(e.children,t)),e})}function EW(n){var t,e,i,s=Eu,r=s.options,a=r===void 0?Eu:r,o=s.plugins,l=o===void 0?jw:o,c=function(p,g,m){return m.startsWith(e)&&m.endsWith(e)&&m.replaceAll(e,"").length>0?".".concat(t):p},h=l.slice();h.push(function(p){p.type===Iw&&p.value.includes("&")&&(p.props[0]=p.props[0].replace(AW,e).replace(i,c))}),a.prefix&&h.push(V5),h.push($5);var f=function(p,g,m,b){g===void 0&&(g=""),m===void 0&&(m=""),b===void 0&&(b="&"),t=b,e=g,i=new RegExp("\\".concat(e,"\\b"),"g");var y=p.replace(_W,""),w=W5(m||g?"".concat(m," ").concat(g," { ").concat(y," }"):y);a.namespace&&(w=sM(w,a.namespace));var x=[];return sy(w,U5(h.concat(z5(function(R){return x.push(R)})))),x};return f.hash=l.length?l.reduce(function(p,g){return g.name||da(15),ol(p,g.name)},qL).toString():"",f}var xW=new iM,B_=EW(),nM=Sh.createContext({shouldForwardProp:void 0,styleSheet:xW,stylis:B_});nM.Consumer;Sh.createContext(void 0);function IC(){return U.useContext(nM)}var W_=function(){function n(t,e){var i=this;this.inject=function(s,r){r===void 0&&(r=B_);var a=i.name+r.hash;s.hasNameForId(i.id,a)||s.insertRules(i.id,a,r(i.rules,a,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,qS(this,function(){throw da(12,String(i.name))})}return n.prototype.getName=function(t){return t===void 0&&(t=B_),this.name+t.hash},n}(),SW=function(n){return n>="A"&&n<="Z"};function DC(n){for(var t="",e=0;e<n.length;e++){var i=n[e];if(e===1&&i==="-"&&n[0]==="-")return n;SW(i)?t+="-"+i.toLowerCase():t+=i}return t.startsWith("ms-")?"-"+t:t}var rM=function(n){return n==null||n===!1||n===""},aM=function(n){var t,e,i=[];for(var s in n){var r=n[s];n.hasOwnProperty(s)&&!rM(r)&&(Array.isArray(r)&&r.isCss||Mh(r)?i.push("".concat(DC(s),":"),r,";"):xu(r)?i.push.apply(i,Ph(Ph(["".concat(s," {")],aM(r),!1),["}"],!1)):i.push("".concat(DC(s),": ").concat((t=s,(e=r)==null||typeof e=="boolean"||e===""?"":typeof e!="number"||e===0||t in G5||t.startsWith("--")?String(e).trim():"".concat(e,"px")),";")))}return i};function xh(n,t,e,i){if(rM(n))return[];if(GS(n))return[".".concat(n.styledComponentId)];if(Mh(n)){if(!Mh(r=n)||r.prototype&&r.prototype.isReactComponent||!t)return[n];var s=n(t);return Tt.env.NODE_ENV==="production"||typeof s!="object"||Array.isArray(s)||s instanceof W_||xu(s)||s===null||console.error("".concat(KL(n)," is not a styled component and cannot be referred to via component selector. See https://www.styled-components.com/docs/advanced#referring-to-other-components for more details.")),xh(s,t,e,i)}var r;return n instanceof W_?e?(n.inject(e,i),[n.getName(i)]):[n]:xu(n)?aM(n):Array.isArray(n)?Array.prototype.concat.apply(jw,n.map(function(a){return xh(a,t,e,i)})):[n.toString()]}function kW(n){for(var t=0;t<n.length;t+=1){var e=n[t];if(Mh(e)&&!GS(e))return!1}return!0}var CW=XL(Nw),TW=function(){function n(t,e,i){this.rules=t,this.staticRulesId="",this.isStatic=Tt.env.NODE_ENV==="production"&&(i===void 0||i.isStatic)&&kW(t),this.componentId=e,this.baseHash=ol(CW,e),this.baseStyle=i,iM.registerId(e)}return n.prototype.generateAndInjectStyles=function(t,e,i){var s=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,i):"";if(this.isStatic&&!i.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))s=yl(s,this.staticRulesId);else{var r=N_(xh(this.rules,t,e,i)),a=O_(ol(this.baseHash,r)>>>0);if(!e.hasNameForId(this.componentId,a)){var o=i(r,".".concat(a),void 0,this.componentId);e.insertRules(this.componentId,a,o)}s=yl(s,a),this.staticRulesId=a}else{for(var l=ol(this.baseHash,i.hash),c="",h=0;h<this.rules.length;h++){var f=this.rules[h];if(typeof f=="string")c+=f,Tt.env.NODE_ENV!=="production"&&(l=ol(l,f));else if(f){var p=N_(xh(f,t,e,i));l=ol(l,p+h),c+=p}}if(c){var g=O_(l>>>0);e.hasNameForId(this.componentId,g)||e.insertRules(this.componentId,g,i(c,".".concat(g),void 0,this.componentId)),s=yl(s,g)}}return s},n}(),ry=Sh.createContext(void 0);ry.Consumer;function RW(n){var t=Sh.useContext(ry),e=U.useMemo(function(){return function(i,s){if(!i)throw da(14);if(Mh(i)){var r=i(s);if(Tt.env.NODE_ENV!=="production"&&(r===null||Array.isArray(r)||typeof r!="object"))throw da(7);return r}if(Array.isArray(i)||typeof i!="object")throw da(8);return s?Di(Di({},s),i):i}(n.theme,t)},[n.theme,t]);return n.children?Sh.createElement(ry.Provider,{value:e},n.children):null}var DA={},FC=new Set;function PW(n,t,e){var i=GS(n),s=n,r=!IA(n),a=t.attrs,o=a===void 0?jw:a,l=t.componentId,c=l===void 0?function(I,D){var F=typeof I!="string"?"sc":CC(I);DA[F]=(DA[F]||0)+1;var O="".concat(F,"-").concat(YL(Nw+F+DA[F]));return D?"".concat(D,"-").concat(O):O}(t.displayName,t.parentComponentId):l,h=t.displayName,f=h===void 0?function(I){return IA(I)?"styled.".concat(I):"Styled(".concat(KL(I),")")}(n):h,p=t.displayName&&t.componentId?"".concat(CC(t.displayName),"-").concat(t.componentId):t.componentId||c,g=i&&s.attrs?s.attrs.concat(o).filter(Boolean):o,m=t.shouldForwardProp;if(i&&s.shouldForwardProp){var b=s.shouldForwardProp;if(t.shouldForwardProp){var y=t.shouldForwardProp;m=function(I,D){return b(I,D)&&y(I,D)}}else m=b}var w=new TW(e,p,i?s.componentStyle:void 0);function x(I,D){return function(F,O,L){var M=F.attrs,W=F.componentStyle,j=F.defaultProps,V=F.foldedComponentIds,z=F.styledComponentId,Y=F.target,K=Sh.useContext(ry),G=IC(),H=F.shouldForwardProp||G.shouldForwardProp;Tt.env.NODE_ENV!=="production"&&U.useDebugValue(z);var Q=Y5(O,K,j)||Eu,Z=function(lt,ct,st){for(var vt,tt=Di(Di({},ct),{className:void 0,theme:st}),it=0;it<lt.length;it+=1){var wt=Mh(vt=lt[it])?vt(tt):vt;for(var St in wt)tt[St]=St==="className"?yl(tt[St],wt[St]):St==="style"?Di(Di({},tt[St]),wt[St]):wt[St]}return ct.className&&(tt.className=yl(tt.className,ct.className)),tt}(M,O,Q),yt=Z.as||Y,bt={};for(var X in Z)Z[X]===void 0||X[0]==="$"||X==="as"||X==="theme"&&Z.theme===Q||(X==="forwardedAs"?bt.as=Z.forwardedAs:H&&!H(X,yt)||(bt[X]=Z[X],H||Tt.env.NODE_ENV!=="development"||C5(X)||FC.has(X)||!F_.has(yt)||(FC.add(X),console.warn('styled-components: it looks like an unknown prop "'.concat(X,'" is being sent through to the DOM, which will likely trigger a React console error. If you would like automatic filtering of unknown props, you can opt-into that behavior via `<StyleSheetManager shouldForwardProp={...}>` (connect an API like `@emotion/is-prop-valid`) or consider using transient props (`$` prefix for automatic filtering.)')))));var nt=function(lt,ct){var st=IC(),vt=lt.generateAndInjectStyles(ct,st.styleSheet,st.stylis);return Tt.env.NODE_ENV!=="production"&&U.useDebugValue(vt),vt}(W,Z);Tt.env.NODE_ENV!=="production"&&F.warnTooManyClasses&&F.warnTooManyClasses(nt);var ht=yl(V,z);return nt&&(ht+=" "+nt),Z.className&&(ht+=" "+Z.className),bt[IA(yt)&&!F_.has(yt)?"class":"className"]=ht,bt.ref=L,U.createElement(yt,bt)}(R,I,D)}x.displayName=f;var R=Sh.forwardRef(x);return R.attrs=g,R.componentStyle=w,R.displayName=f,R.shouldForwardProp=m,R.foldedComponentIds=i?yl(s.foldedComponentIds,s.styledComponentId):"",R.styledComponentId=p,R.target=i?s.target:n,Object.defineProperty(R,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(I){this._foldedDefaultProps=i?function(D){for(var F=[],O=1;O<arguments.length;O++)F[O-1]=arguments[O];for(var L=0,M=F;L<M.length;L++)j_(D,M[L],!0);return D}({},s.defaultProps,I):I}}),Tt.env.NODE_ENV!=="production"&&(X5(f,p),R.warnTooManyClasses=function(I,D){var F={},O=!1;return function(L){if(!O&&(F[L]=!0,Object.keys(F).length>=200)){var M=D?' with the id of "'.concat(D,'"'):"";console.warn("Over ".concat(200," classes were generated for component ").concat(I).concat(M,`.
`)+`Consider using the attrs method, together with a style object for frequently changed styles.
Example:
  const Component = styled.div.attrs(props => ({
    style: {
      background: props.background,
    },
  }))\`width: 100%;\`

  <Component />`),O=!0,F={}}}}(f,p)),qS(R,function(){return".".concat(R.styledComponentId)}),r&&tM(R,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),R}function OC(n,t){for(var e=[n[0]],i=0,s=t.length;i<s;i+=1)e.push(t[i],n[i+1]);return e}var NC=function(n){return Object.assign(n,{isCss:!0})};function Bw(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(Mh(n)||xu(n))return NC(xh(OC(jw,Ph([n],t,!0))));var i=n;return t.length===0&&i.length===1&&typeof i[0]=="string"?xh(i):NC(xh(OC(i,t)))}function H_(n,t,e){if(e===void 0&&(e=Eu),!t)throw da(1,t);var i=function(s){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];return n(t,e,Bw.apply(void 0,Ph([s],r,!1)))};return i.attrs=function(s){return H_(n,t,Di(Di({},e),{attrs:Array.prototype.concat(e.attrs,s).filter(Boolean)}))},i.withConfig=function(s){return H_(n,t,Di(Di({},e),s))},i}var oM=function(n){return H_(PW,n)},It=oM;F_.forEach(function(n){It[n]=oM(n)});function LW(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];Tt.env.NODE_ENV!=="production"&&typeof navigator<"u"&&navigator.product==="ReactNative"&&console.warn("`keyframes` cannot be used on ReactNative, only on the web. To do animation in ReactNative please use Animated.");var i=N_(Bw.apply(void 0,Ph([n],t,!1))),s=YL(i);return new W_(s,i)}Tt.env.NODE_ENV!=="production"&&typeof navigator<"u"&&navigator.product==="ReactNative"&&console.warn(`It looks like you've imported 'styled-components' on React Native.
Perhaps you're looking to import 'styled-components/native'?
Read more about this at https://www.styled-components.com/docs/basics#react-native`);var qm="__sc-".concat(Lh,"__");Tt.env.NODE_ENV!=="production"&&Tt.env.NODE_ENV!=="test"&&typeof window<"u"&&(window[qm]||(window[qm]=0),window[qm]===1&&console.warn(`It looks like there are several instances of 'styled-components' initialized in this application. This may cause dynamic styles to not render properly, errors during the rehydration process, a missing theme prop, and makes your application bigger without good reason.

See https://s-c.sh/2BAXzed for more info.`),window[qm]+=1);const MW="Document {{ currentFileNo }} of {{ allFilesCount }}",IW="No renderer for file type: {{{ fileType }}}",DW="Download file",FW="Your file is broken. Please check it on your machine.",OW="Recipients",NW="Sender",jW="Loading...",BW="Page {{ currentPage }}/{{ allPagesCount }}",WW={documentNavInfo:MW,noRendererMessage:IW,downloadButtonLabel:DW,brokenFile:FW,msgPluginRecipients:OW,msgPluginSender:NW,pdfPluginLoading:jW,pdfPluginPageNumber:BW},HW="Dokument {{ currentFileNo }} z {{ allFilesCount }}",$W="Brak funckji renderującej dla: {{{ fileType }}}",UW="Pobierz plik",zW="Twój plik jest uszkodzony. Sprawdź go na swoim komputerze.",VW="Odbiorcy",GW="Nadawca",qW="Wczytywanie...",XW="Strona {{ currentPage }}/{{ allPagesCount }}",YW={documentNavInfo:HW,noRendererMessage:$W,downloadButtonLabel:UW,brokenFile:zW,msgPluginRecipients:VW,msgPluginSender:GW,pdfPluginLoading:qW,pdfPluginPageNumber:XW},KW="Documento {{ currentFileNo }} de {{ allFilesCount }}",QW="No hay procesador para el tipo de archivo: {{{ fileType }}}",ZW="Descargar archivo",JW="Tu archivo está roto. Compruébalo en tu máquina.",tH="Destinatarios",eH="Remitente",iH="Cargando...",sH="Página {{ currentPage }}/{{ allPagesCount }}",nH={documentNavInfo:KW,noRendererMessage:QW,downloadButtonLabel:ZW,brokenFile:JW,msgPluginRecipients:tH,msgPluginSender:eH,pdfPluginLoading:iH,pdfPluginPageNumber:sH},rH="Dokument {{ currentFileNo }} von {{ allFilesCount }}",aH="Kein Renderer für Dateityp: {{{ fileType }}}",oH="Datei herunterladen",lH="Ihre Datei ist defekt. Bitte überprüfen Sie sie auf Ihrem Rechner.",hH="Empfänger",cH="Absender",dH="Wird geladen...",uH="Seite {{ currentPage }}/{{ allPagesCount }}",fH={documentNavInfo:rH,noRendererMessage:aH,downloadButtonLabel:oH,brokenFile:lH,msgPluginRecipients:hH,msgPluginSender:cH,pdfPluginLoading:dH,pdfPluginPageNumber:uH},pH="Documento {{ currentFileNo }} di {{ allFilesCount }}",gH="Nessun renderer per il tipo di file: {{{ fileType }}}",mH="Scarica file",vH="Il tuo file è danneggiato. Controllalo sul tuo computer.",bH="Destinatari",yH="Mittente",wH="Caricamento in corso...",AH="Pagina {{ currentPage }}/{{ allPagesCount }}",_H={documentNavInfo:pH,noRendererMessage:gH,downloadButtonLabel:mH,brokenFile:vH,msgPluginRecipients:bH,msgPluginSender:yH,pdfPluginLoading:wH,pdfPluginPageNumber:AH},EH="Documento {{ currentFileNo }} de {{ allFilesCount }}",xH="Nenhum renderizador para o tipo de arquivo: {{{ fileType }}}",SH="Baixar arquivo",kH="Seu arquivo está quebrado. Por favor, verifique-o em sua máquina.",CH="Destinatários",TH="Remetente",RH="Carregando...",PH="Página {{ currentPage }}/{{ allPagesCount }}",LH={documentNavInfo:EH,noRendererMessage:xH,downloadButtonLabel:SH,brokenFile:kH,msgPluginRecipients:CH,msgPluginSender:TH,pdfPluginLoading:RH,pdfPluginPageNumber:PH},MH="Document {{ currentFileNo }} de {{ allFilesCount }}",IH="Aucun moteur de rendu pour le type de fichier : {{{ fileType }}}",DH="Télécharger le fichier",FH="Votre fichier est cassé. Veuillez le vérifier sur votre machine.",OH="Destinataires",NH="Expéditeur",jH="Chargement...",BH="Page {{ currentPage }}/{{ allPagesCount }}",WH={documentNavInfo:MH,noRendererMessage:IH,downloadButtonLabel:DH,brokenFile:FH,msgPluginRecipients:OH,msgPluginSender:NH,pdfPluginLoading:jH,pdfPluginPageNumber:BH},HH="مستند {{ currentFileNo }} من {{ allFilesCount }}",$H="{{{ fileType }}} : لا يمكننا عرض هذا النوع من الملفات",UH="تحميل الملف",zH="الملف تالف، يرجى التحقق منه على جهازك الخاص.",VH="المستلمين",GH="المرسل",qH="تحميل ...",XH=" {{ allPagesCount }} \\ {{ currentPage }} صفحة ",YH={documentNavInfo:HH,noRendererMessage:$H,downloadButtonLabel:UH,brokenFile:zH,msgPluginRecipients:VH,msgPluginSender:GH,pdfPluginLoading:qH,pdfPluginPageNumber:XH},KH="Dokument {{ currentFileNo }} od {{ allFilesCount }}",QH="Ne postoji pregledač za tip fajla: {{ fileType }}",ZH="Preuzimanje fajla",JH="Vaš fajl nije dobar. Molimo Vas da probate da ga otvorite na vašem računaru.",t4="Primaoci",e4="Pošiljalac",i4="Učitavanje...",s4="Strana {{ currentPage }}/{{ allPagesCount }}",n4={documentNavInfo:KH,noRendererMessage:QH,downloadButtonLabel:ZH,brokenFile:JH,msgPluginRecipients:t4,msgPluginSender:e4,pdfPluginLoading:i4,pdfPluginPageNumber:s4},r4="Документ {{ currentFileNo }} od {{ allFilesCount }}",a4="Не постоји прегледач за тип фајла: {{ fileType }}",o4="Преузимање фајла",l4="Ваш фајл није добар. Молимо Вас да пробате да га отворите на вашем рачунару.",h4="Примаоци",c4="Пошиљалац",d4="Учитавање...",u4="Страна {{ currentPage }}/{{ allPagesCount }}",f4={documentNavInfo:r4,noRendererMessage:a4,downloadButtonLabel:o4,brokenFile:l4,msgPluginRecipients:h4,msgPluginSender:c4,pdfPluginLoading:d4,pdfPluginPageNumber:u4},p4="ファイル {{ currentFileNo }} / {{ allFilesCount }}",g4="ファイルタイプに対応したレンダラーはありません: {{ fileType }}",m4="ダウンロード",v4="ファイルが壊れています。あなたのマシンでファイルを確認してください。",b4="受信者",y4="送信者",w4="ローティング中...",A4="ページ {{ currentPage }}/{{ allPagesCount }}",_4={documentNavInfo:p4,noRendererMessage:g4,downloadButtonLabel:m4,brokenFile:v4,msgPluginRecipients:b4,msgPluginSender:y4,pdfPluginLoading:w4,pdfPluginPageNumber:A4},E4="Документ {{ currentFileNo }} из {{ allFilesCount }}",x4="Данный тип файла не поддерживается рендером: {{{ fileType }}}",S4="Скачать файл",k4="Ваш файл сломан. Пожалуйста, проверьте его на своём комьютере.",C4="Получатели",T4="Отправитель",R4="Загрузка...",P4="Страница {{ currentPage }}/{{ allPagesCount }}",L4={documentNavInfo:E4,noRendererMessage:x4,downloadButtonLabel:S4,brokenFile:k4,msgPluginRecipients:C4,msgPluginSender:T4,pdfPluginLoading:R4,pdfPluginPageNumber:P4},M4="Dokument {{ currentFileNo }} av {{ allFilesCount }}",I4="Ingen renderare för filtypen: {{{ fileType }}}",D4="Ladda ner",F4="Filen är trasig. Var vänlig kontrollera den på din maskin.",O4="Mottagare",N4="Avsändare",j4="Laddar...",B4="Sida {{ currentPage }}/{{ allPagesCount }}",W4={documentNavInfo:M4,noRendererMessage:I4,downloadButtonLabel:D4,brokenFile:F4,msgPluginRecipients:O4,msgPluginSender:N4,pdfPluginLoading:j4,pdfPluginPageNumber:B4},$_={en:WW,pl:YW,es:nH,de:fH,it:_H,pt:LH,fr:WH,ar:YH,sr:n4,sr_cyr:f4,ja:_4,ru:L4,se:W4},XS="en",lM="SET_ALL_DOCUMENTS",hM="SET_DOCUMENT_LOADING",cM="NEXT_DOCUMENT",dM="PREVIOUS_DOCUMENT",uM="UPDATE_CURRENT_DOCUMENT",fM="SET_RENDERER_RECT",pM="SET_MAIN_CONFIG",H4=(n,t)=>({type:lM,documents:n,initialActiveDocument:t}),FA=n=>({type:hM,value:n}),YS=()=>({type:cM}),KS=()=>({type:dM}),U_=n=>({type:uM,document:n}),$4=n=>({type:fM,rect:n}),U4=n=>({type:pM,config:n}),ay={currentFileNo:0,documents:[],documentLoading:!0,currentDocument:void 0,rendererRect:void 0,config:{},pluginRenderers:[],language:XS},z4=(n=ay,t)=>{switch(t.type){case lM:{const{documents:e,initialActiveDocument:i}=t;return{...n,documents:e,currentDocument:i||e[0]||null,currentFileNo:i&&e.includes(i)?e.indexOf(i):ay.currentFileNo}}case hM:{const{value:e}=t;return{...n,documentLoading:e}}case cM:{if(n.currentFileNo>=n.documents.length-1)return n;const e=n.currentFileNo+1;return n.onDocumentChange&&n.onDocumentChange(n.documents[e]),{...n,currentFileNo:e,currentDocument:n.documents[e],documentLoading:!0}}case dM:{if(n.currentFileNo<=0)return n;const e=n.currentFileNo-1;return n.onDocumentChange&&n.onDocumentChange(n.documents[e]),{...n,currentFileNo:n.currentFileNo-1,currentDocument:n.documents[e],documentLoading:!0}}case uM:{const{document:e}=t;return{...n,currentDocument:e,currentFileNo:n.documents.findIndex(i=>i.uri===e.uri)}}case fM:{const{rect:e}=t;return{...n,rendererRect:e}}case pM:{const{config:e}=t;return{...n,config:e}}default:return n}},Mo=U.createContext({state:ay,dispatch:()=>null}),V4=U.forwardRef((n,t)=>{const{children:e,documents:i,config:s,pluginRenderers:r,prefetchMethod:a,requestHeaders:o,initialActiveDocument:l,language:c,activeDocument:h,onDocumentChange:f}=n,[p,g]=U.useReducer(z4,{...ay,documents:i||[],currentDocument:i&&i.length?l||i[0]:void 0,config:s,pluginRenderers:r,prefetchMethod:a,requestHeaders:o,currentFileNo:l?i.findIndex(m=>m===l)??0:0,language:c&&$_[c]?c:XS,activeDocument:h,onDocumentChange:f});return U.useEffect(()=>{g(H4(i,l)),s&&g(U4(s))},[i,s,l]),U.useEffect(()=>{h&&g(U_(h))},[h]),U.useImperativeHandle(t,()=>({prev(){g(KS())},next(){g(YS())}}),[g]),N.jsx(Mo.Provider,{value:{state:p,dispatch:g},children:e})}),G4=Bw`
  background-color: ${n=>n.theme.primary};
  color: ${n=>n.theme.textPrimary};
`,q4=Bw`
  background-color: ${n=>n.theme.secondary};
  color: ${n=>n.theme.textSecondary};
`,Ww=It.button`
  ${G4}
  display: flex;
  justify-content: center;
  align-items: center;
  width: 35px;
  height: 35px;
  padding: 0;
  margin: 0 0 0 5px;
  text-align: center;
  font-size: 18px;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  opacity: ${n=>n.disabled?.4:1};
  pointer-events: ${n=>n.disabled?"none":"all"};
  box-shadow: 2px 2px 3px #00000033;

  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`,gM=It.a`
  display: flex;
  justify-content: center;
  align-items: center;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  background-color: ${n=>n.theme.primary};
  color: ${n=>n.theme.textPrimary};
  box-shadow: 2px 2px 3px #00000033;

  width: 35px;
  height: 35px;
  font-size: 18px;
  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`;It(Ww)``;const X4=It(Ww)`
  ${q4}
`,Y4=n=>N.jsx(mM,{...n}),K4=n=>N.jsx(mM,{...n,reverse:!0}),mM=({color:n,size:t,reverse:e})=>N.jsx("svg",{width:t||"100%",height:t||"100%",style:{transform:`${e?"rotate(180deg)":""}`},id:"arrow_left",version:"1.1",viewBox:"0 0 32 32",xmlSpace:"preserve",children:N.jsx("path",{clipRule:"evenodd",d:"M31.106,15H3.278l8.325-8.293  c0.391-0.391,0.391-1.024,0-1.414c-0.391-0.391-1.024-0.391-1.414,0l-9.9,9.899c-0.385,0.385-0.385,1.029,0,1.414l9.9,9.9  c0.391,0.391,1.024,0.391,1.414,0c0.391-0.391,0.391-1.024,0-1.414L3.278,17h27.828c0.552,0,1-0.448,1-1  C32.106,15.448,31.658,15,31.106,15z",fill:n||"#aaa",fillRule:"evenodd",id:"Arrow_Back"})}),Q4=n=>{const{color:t,size:e}=n;return N.jsx("svg",{width:e||"100%",height:e||"100%",version:"1.1",id:"Icons",viewBox:"0 0 32 32",xmlSpace:"preserve",style:{alignSelf:"center",justifySelf:"center"},children:N.jsxs("g",{children:[N.jsx("path",{fill:t||"#aaa",d:"M16,2c-0.6,0-1,0.4-1,1v5c0,0.6,0.4,1,1,1s1-0.4,1-1V3C17,2.4,16.6,2,16,2z"}),N.jsx("path",{fill:t||"#aaa",d:`M7.5,6.1c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l3.5,3.5c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.5,6.1
		z`}),N.jsx("path",{fill:t||"#aaa",d:"M9,16c0-0.6-0.4-1-1-1H3c-0.6,0-1,0.4-1,1s0.4,1,1,1h5C8.6,17,9,16.6,9,16z"}),N.jsx("path",{fill:t||"#aaa",d:`M9.6,20.9l-3.5,3.5c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l3.5-3.5c0.4-0.4,0.4-1,0-1.4
		S10,20.6,9.6,20.9z`}),N.jsx("path",{fill:t||"#aaa",d:"M16,23c-0.6,0-1,0.4-1,1v5c0,0.6,0.4,1,1,1s1-0.4,1-1v-5C17,23.4,16.6,23,16,23z"}),N.jsx("path",{fill:t||"#aaa",d:`M22.4,20.9c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l3.5,3.5c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4
		L22.4,20.9z`}),N.jsx("path",{fill:t||"#aaa",d:"M29,15h-5c-0.6,0-1,0.4-1,1s0.4,1,1,1h5c0.6,0,1-0.4,1-1S29.6,15,29,15z"}),N.jsx("path",{fill:t||"#aaa",d:`M21.7,11.3c0.3,0,0.5-0.1,0.7-0.3l3.5-3.5c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-3.5,3.5c-0.4,0.4-0.4,1,0,1.4
		C21.1,11.2,21.4,11.3,21.7,11.3z`})]})})};/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Z4=Object.prototype.toString,Ru=Array.isArray||function(n){return Z4.call(n)==="[object Array]"};function QS(n){return typeof n=="function"}function J4(n){return Ru(n)?"array":typeof n}function OA(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function jC(n,t){return n!=null&&typeof n=="object"&&t in n}function t6(n,t){return n!=null&&typeof n!="object"&&n.hasOwnProperty&&n.hasOwnProperty(t)}var e6=RegExp.prototype.test;function i6(n,t){return e6.call(n,t)}var s6=/\S/;function n6(n){return!i6(s6,n)}var r6={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function a6(n){return String(n).replace(/[&<>"'`=\/]/g,function(t){return r6[t]})}var o6=/\s*/,l6=/\s+/,BC=/\s*=/,h6=/\s*\}/,c6=/#|\^|\/|>|\{|&|=|!/;function d6(n,t){if(!n)return[];var e=!1,i=[],s=[],r=[],a=!1,o=!1,l="",c=0;function h(){if(a&&!o)for(;r.length;)delete s[r.pop()];else r=[];a=!1,o=!1}var f,p,g;function m(L){if(typeof L=="string"&&(L=L.split(l6,2)),!Ru(L)||L.length!==2)throw new Error("Invalid tags: "+L);f=new RegExp(OA(L[0])+"\\s*"),p=new RegExp("\\s*"+OA(L[1])),g=new RegExp("\\s*"+OA("}"+L[1]))}m(t||Ss.tags);for(var b=new Rm(n),y,w,x,R,I,D;!b.eos();){if(y=b.pos,x=b.scanUntil(f),x)for(var F=0,O=x.length;F<O;++F)R=x.charAt(F),n6(R)?(r.push(s.length),l+=R):(o=!0,e=!0,l+=" "),s.push(["text",R,y,y+1]),y+=1,R===`
`&&(h(),l="",c=0,e=!1);if(!b.scan(f))break;if(a=!0,w=b.scan(c6)||"name",b.scan(o6),w==="="?(x=b.scanUntil(BC),b.scan(BC),b.scanUntil(p)):w==="{"?(x=b.scanUntil(g),b.scan(h6),b.scanUntil(p),w="&"):x=b.scanUntil(p),!b.scan(p))throw new Error("Unclosed tag at "+b.pos);if(w==">"?I=[w,x,y,b.pos,l,c,e]:I=[w,x,y,b.pos],c++,s.push(I),w==="#"||w==="^")i.push(I);else if(w==="/"){if(D=i.pop(),!D)throw new Error('Unopened section "'+x+'" at '+y);if(D[1]!==x)throw new Error('Unclosed section "'+D[1]+'" at '+y)}else w==="name"||w==="{"||w==="&"?o=!0:w==="="&&m(x)}if(h(),D=i.pop(),D)throw new Error('Unclosed section "'+D[1]+'" at '+b.pos);return f6(u6(s))}function u6(n){for(var t=[],e,i,s=0,r=n.length;s<r;++s)e=n[s],e&&(e[0]==="text"&&i&&i[0]==="text"?(i[1]+=e[1],i[3]=e[3]):(t.push(e),i=e));return t}function f6(n){for(var t=[],e=t,i=[],s,r,a=0,o=n.length;a<o;++a)switch(s=n[a],s[0]){case"#":case"^":e.push(s),i.push(s),e=s[4]=[];break;case"/":r=i.pop(),r[5]=s[2],e=i.length>0?i[i.length-1][4]:t;break;default:e.push(s)}return t}function Rm(n){this.string=n,this.tail=n,this.pos=0}Rm.prototype.eos=function(){return this.tail===""};Rm.prototype.scan=function(n){var t=this.tail.match(n);if(!t||t.index!==0)return"";var e=t[0];return this.tail=this.tail.substring(e.length),this.pos+=e.length,e};Rm.prototype.scanUntil=function(n){var t=this.tail.search(n),e;switch(t){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=e.length,e};function Su(n,t){this.view=n,this.cache={".":this.view},this.parent=t}Su.prototype.push=function(n){return new Su(n,this)};Su.prototype.lookup=function(n){var t=this.cache,e;if(t.hasOwnProperty(n))e=t[n];else{for(var i=this,s,r,a,o=!1;i;){if(n.indexOf(".")>0)for(s=i.view,r=n.split("."),a=0;s!=null&&a<r.length;)a===r.length-1&&(o=jC(s,r[a])||t6(s,r[a])),s=s[r[a++]];else s=i.view[n],o=jC(i.view,n);if(o){e=s;break}i=i.parent}t[n]=e}return QS(e)&&(e=e.call(this.view)),e};function Vi(){this.templateCache={_cache:{},set:function(n,t){this._cache[n]=t},get:function(n){return this._cache[n]},clear:function(){this._cache={}}}}Vi.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};Vi.prototype.parse=function(n,t){var e=this.templateCache,i=n+":"+(t||Ss.tags).join(":"),s=typeof e<"u",r=s?e.get(i):void 0;return r==null&&(r=d6(n,t),s&&e.set(i,r)),r};Vi.prototype.render=function(n,t,e,i){var s=this.getConfigTags(i),r=this.parse(n,s),a=t instanceof Su?t:new Su(t,void 0);return this.renderTokens(r,a,e,n,i)};Vi.prototype.renderTokens=function(n,t,e,i,s){for(var r="",a,o,l,c=0,h=n.length;c<h;++c)l=void 0,a=n[c],o=a[0],o==="#"?l=this.renderSection(a,t,e,i,s):o==="^"?l=this.renderInverted(a,t,e,i,s):o===">"?l=this.renderPartial(a,t,e,s):o==="&"?l=this.unescapedValue(a,t):o==="name"?l=this.escapedValue(a,t,s):o==="text"&&(l=this.rawValue(a)),l!==void 0&&(r+=l);return r};Vi.prototype.renderSection=function(n,t,e,i,s){var r=this,a="",o=t.lookup(n[1]);function l(f){return r.render(f,t,e,s)}if(o){if(Ru(o))for(var c=0,h=o.length;c<h;++c)a+=this.renderTokens(n[4],t.push(o[c]),e,i,s);else if(typeof o=="object"||typeof o=="string"||typeof o=="number")a+=this.renderTokens(n[4],t.push(o),e,i,s);else if(QS(o)){if(typeof i!="string")throw new Error("Cannot use higher-order sections without the original template");o=o.call(t.view,i.slice(n[3],n[5]),l),o!=null&&(a+=o)}else a+=this.renderTokens(n[4],t,e,i,s);return a}};Vi.prototype.renderInverted=function(n,t,e,i,s){var r=t.lookup(n[1]);if(!r||Ru(r)&&r.length===0)return this.renderTokens(n[4],t,e,i,s)};Vi.prototype.indentPartial=function(n,t,e){for(var i=t.replace(/[^ \t]/g,""),s=n.split(`
`),r=0;r<s.length;r++)s[r].length&&(r>0||!e)&&(s[r]=i+s[r]);return s.join(`
`)};Vi.prototype.renderPartial=function(n,t,e,i){if(e){var s=this.getConfigTags(i),r=QS(e)?e(n[1]):e[n[1]];if(r!=null){var a=n[6],o=n[5],l=n[4],c=r;o==0&&l&&(c=this.indentPartial(r,l,a));var h=this.parse(c,s);return this.renderTokens(h,t,e,c,i)}}};Vi.prototype.unescapedValue=function(n,t){var e=t.lookup(n[1]);if(e!=null)return e};Vi.prototype.escapedValue=function(n,t,e){var i=this.getConfigEscape(e)||Ss.escape,s=t.lookup(n[1]);if(s!=null)return typeof s=="number"&&i===Ss.escape?String(s):i(s)};Vi.prototype.rawValue=function(n){return n[1]};Vi.prototype.getConfigTags=function(n){return Ru(n)?n:n&&typeof n=="object"?n.tags:void 0};Vi.prototype.getConfigEscape=function(n){if(n&&typeof n=="object"&&!Ru(n))return n.escape};var Ss={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(n){Hp.templateCache=n},get templateCache(){return Hp.templateCache}},Hp=new Vi;Ss.clearCache=function(){return Hp.clearCache()};Ss.parse=function(n,t){return Hp.parse(n,t)};Ss.render=function(n,t,e,i){if(typeof n!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+J4(n)+'" was given as the first argument for mustache#render(template, view, partials)');return Hp.render(n,t,e,i)};Ss.escape=a6;Ss.Scanner=Rm;Ss.Context=Su;Ss.Writer=Vi;const Uh=()=>{const{state:{language:n}}=U.useContext(Mo),t=$_[XS];return{t:U.useCallback((e,i)=>{const s=$_[n];return s[e]?Ss.render(s[e],i):t[e]?Ss.render(t[e],i):e},[n,t])}},p6=()=>{const{state:{currentDocument:n,currentFileNo:t,documents:e},dispatch:i}=U.useContext(Mo),{t:s}=Uh();if(e.length<=1||!n)return null;let r=n.uri||"";const a=r==null?void 0:r.split("/");return a.length&&(r=a[a.length-1]),N.jsxs(g6,{id:"doc-nav",children:[N.jsx("p",{id:"doc-nav-info",children:s("documentNavInfo",{currentFileNo:t+1,allFilesCount:e.length})}),N.jsx(vM,{id:"doc-nav-prev",onClick:()=>i(KS()),disabled:t===0,children:N.jsx(Y4,{color:"#fff",size:"60%"})}),N.jsx(m6,{id:"doc-nav-next",onClick:()=>i(YS()),disabled:t>=e.length-1,children:N.jsx(K4,{color:"#fff",size:"60%"})})]})},g6=It.div`
  min-width: 150px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
  margin: 0 10px;
  color: ${n=>n.theme.textPrimary};
`,vM=It(X4)`
  width: 30px;
  height: 30px;
  margin: 0 5px 0 10px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`,m6=It(vM)`
  margin: 0 5px;
`,bM=(n,t)=>{var e;if(!n)return"";let i="";if(n.fileName)i=n.fileName;else{i=n.uri||"",i=decodeURI(i),t||(i=(e=i==null?void 0:i.split("?"))==null?void 0:e[0]);const s=i==null?void 0:i.split("/");s.length&&(i=s[s.length-1])}return i},v6=()=>{var n,t;const{state:{config:e,currentDocument:i}}=U.useContext(Mo);if(!i||(n=e==null?void 0:e.header)!=null&&n.disableFileName)return null;const s=bM(i,((t=e==null?void 0:e.header)==null?void 0:t.retainURLParams)||!1);return N.jsx(b6,{id:"file-name","data-testid":"file-name",children:s})},b6=It.div`
  flex: 1;
  text-align: left;
  color: ${n=>n.theme.textPrimary};
  font-weight: bold;
  margin: 0 10px;
  overflow: hidden;
`,y6=()=>{var n,t,e;const{state:i,dispatch:s}=U.useContext(Mo),{config:r}=i;return(n=r==null?void 0:r.header)!=null&&n.disableHeader?null:((e=(t=r==null?void 0:r.header)==null?void 0:t.overrideComponent)==null?void 0:e.call(t,i,()=>s(KS()),()=>s(YS())))||N.jsxs(w6,{id:"header-bar","data-testid":"header-bar",children:[N.jsx(v6,{}),N.jsx(p6,{})]})},w6=It.div`
  display: flex;
  justify-content: flex-end;
  align-items: center;
  z-index: 1;
  padding: 0 10px;
  background-color: ${n=>n.theme.primary};
  font-size: 16px;
  min-height: 50px;

  @media (max-width: 768px) {
    min-height: 30px;
    padding: 5px;
    font-size: 10px;
  }
`,ZS=({documentURI:n,signal:t,fileLoaderComplete:e,readerTypeFunction:i,headers:s})=>fetch(n,{signal:t,headers:s}).then(async r=>{const a=await r.blob(),o=new FileReader;switch(o.addEventListener("loadend",()=>e(o)),i){case"arrayBuffer":o.readAsArrayBuffer(a);break;case"binaryString":o.readAsBinaryString(a);break;case"dataURL":o.readAsDataURL(a);break;case"text":o.readAsText(a);break}}).catch(r=>r),A6=n=>ZS({...n,readerTypeFunction:"arrayBuffer"}),yM=n=>ZS({...n,readerTypeFunction:"dataURL"}),wM=n=>ZS({...n,readerTypeFunction:"text"}),_6=yM,E6=()=>{const{state:{currentDocument:n,pluginRenderers:t}}=U.useContext(Mo),[e,i]=U.useState();return U.useEffect(()=>{if(!n)return;if(!n.fileType){i(void 0);return}const s=[];t==null||t.forEach(a=>{n.fileType!==void 0&&a.fileTypes.indexOf(n.fileType)>=0&&s.push(a)});const[r]=s.sort((a,o)=>o.weight-a.weight);i(r&&r!==void 0?()=>r:null)},[n,t]),{CurrentRenderer:e}},x6=()=>{const{state:n,dispatch:t}=U.useContext(Mo),{currentFileNo:e,currentDocument:i,prefetchMethod:s}=n,{CurrentRenderer:r}=E6(),a=(i==null?void 0:i.uri)||"";return U.useEffect(()=>{if(!i||i.fileType!==void 0)return;const o=new AbortController,{signal:l}=o;return fetch(a,{method:s||a.startsWith("blob:")?"GET":"HEAD",signal:l,headers:n==null?void 0:n.requestHeaders}).then(c=>{const h=c.headers.get("content-type"),f=(h==null?void 0:h.split(";"))||[],p=f.length?f[0]:void 0;t(U_({...i,fileType:p||void 0}))}).catch(c=>{if((c==null?void 0:c.name)!=="AbortError")throw c}),()=>{o.abort()}},[e,a,i]),U.useEffect(()=>{var o;if(!i||r===void 0)return;const l=new AbortController,{signal:c}=l,h={documentURI:a,signal:c,fileLoaderComplete:f=>{if(!i||!f){t(FA(!1));return}const p={...i};f.result!==null&&(p.fileData=f.result),t(U_(p)),t(FA(!1))},headers:n==null?void 0:n.requestHeaders};return r===null?t(FA(!1)):r.fileLoader!==void 0?(o=r.fileLoader)==null||o.call(r,h):_6(h),()=>{l.abort()}},[r,e]),{state:n,dispatch:t,CurrentRenderer:r}},S6=()=>{const[n,t]=U.useState({width:void 0,height:void 0});return U.useEffect(()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),n},WC=({children:n})=>{var t,e;const{state:i}=U.useContext(Mo),{config:s}=i,[r,a]=U.useState(((t=s==null?void 0:s.loadingRenderer)==null?void 0:t.showLoadingTimeout)===!1);return U.useEffect(()=>{var o;setTimeout(()=>{a(!0)},typeof((o=s==null?void 0:s.loadingRenderer)==null?void 0:o.showLoadingTimeout)=="number"?s.loadingRenderer.showLoadingTimeout:500)},[(e=s==null?void 0:s.loadingRenderer)==null?void 0:e.showLoadingTimeout]),r?N.jsx(N.Fragment,{children:n}):null},k6=({documents:n,documentLoading:t,config:e,currentDocument:i,fileName:s,CurrentRenderer:r,state:a,t:o})=>{var l,c;if(n.length)if(t){if(e&&(l=e==null?void 0:e.loadingRenderer)!=null&&l.overrideComponent){const h=e.loadingRenderer.overrideComponent;return N.jsx(WC,{children:N.jsx(h,{document:i,fileName:s})})}return N.jsx(WC,{children:N.jsx(R6,{id:"loading-renderer","data-testid":"loading-renderer",children:N.jsx(L6,{children:N.jsx(Q4,{color:"#444",size:40})})})})}else{if(r)return N.jsx(r,{mainState:a});if(r===void 0)return null;if(e&&(c=e==null?void 0:e.noRenderer)!=null&&c.overrideComponent){const h=e.noRenderer.overrideComponent;return N.jsx(h,{document:i,fileName:s})}return N.jsxs("div",{id:"no-renderer","data-testid":"no-renderer",children:[o("noRendererMessage",{fileType:(i==null?void 0:i.fileType)??""}),N.jsx(M6,{id:"no-renderer-download",href:i==null?void 0:i.uri,download:i==null?void 0:i.uri,children:o("downloadButtonLabel")})]})}else return N.jsx("div",{id:"no-documents"})},C6=()=>{var n;const{state:t,dispatch:e,CurrentRenderer:i}=x6(),{documents:s,documentLoading:r,currentDocument:a,config:o}=t,l=S6(),{t:c}=Uh(),h=U.useCallback(p=>{p&&e($4(p==null?void 0:p.getBoundingClientRect()))},[l,e]),f=bM(a,((n=o==null?void 0:o.header)==null?void 0:n.retainURLParams)||!1);return N.jsx(T6,{id:"proxy-renderer","data-testid":"proxy-renderer",ref:h,children:N.jsx(k6,{state:t,documents:s,documentLoading:r,config:o,currentDocument:a,fileName:f,CurrentRenderer:i,t:c})})},T6=It.div`
  display: flex;
  flex: 1;
`,R6=It.div`
  display: flex;
  flex: 1;
  height: 75px;
  align-items: center;
  justify-content: center;
`,P6=LW`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,L6=It.div`
  animation-name: ${P6};
  animation-duration: 4s;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
`,M6=It(gM)`
  width: 130px;
  height: 30px;
  background-color: ${n=>n.theme.primary};
  @media (max-width: 768px) {
    width: 125px;
    height: 25px;
  }
`,HC={primary:"#fff",secondary:"#000",tertiary:"#ffffff99",textPrimary:"#000",textSecondary:"#fff",textTertiary:"#00000044",disableThemeScrollbar:!1},pa=n=>{const{mainState:{currentDocument:t},children:e}=n;return t?N.jsx(I6,{id:"image-renderer",...n,children:e||N.jsx(D6,{id:"image-img",src:t.fileData})}):null};pa.fileTypes=[];pa.weight=0;const I6=It.div`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  background-color: #fff;
`,D6=It.img`
  max-width: 95%;
  max-height: 95%;
`,JS=n=>N.jsx(pa,{...n});JS.fileTypes=["bmp","image/bmp"];JS.weight=0;const Hw=({mainState:{currentDocument:n}})=>(U.useEffect(()=>{const t=n==null?void 0:n.fileData;let e="";const i=(t==null?void 0:t.replace(/^data:text\/html;(?:charset=([^;]*);)?base64,/,(l,c)=>(e=c,"")))||"";let s=window.atob(i);if(e){const l=new Uint8Array(s.length);for(let c=0;c<s.length;c++)l[c]=s.charCodeAt(c);s=new TextDecoder(e).decode(l)}const r=document.getElementById("html-body"),a=(r==null?void 0:r.contentWindow)&&r.contentWindow;if(!a)return;const o=a.document;o.open(),o.write(`${s}`),o.close()},[n]),N.jsx(F6,{id:"html-renderer",children:N.jsx(O6,{id:"html-body",sandbox:"allow-same-origin"})}));Hw.fileTypes=["htm","html","text/htm","text/html"];Hw.weight=0;Hw.fileLoader=yM;const F6=It.div`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 0 30px;
`,O6=It.iframe`
  height: 100%;
  padding: 15px;
  margin: 20px 0 20px 0;
  border: 1px solid ${n=>n.theme.secondary};
`,tk=n=>N.jsx(pa,{...n});tk.fileTypes=["jpg","jpeg","image/jpg","image/jpeg"];tk.weight=0;const $w=({mainState:{currentDocument:n}})=>n?N.jsx(N6,{id:"msdoc-renderer",children:N.jsx(j6,{id:"msdoc-iframe",title:"msdoc-iframe",src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(n.uri)}`,frameBorder:"0"})}):null,Fo={odt:["odt","application/vnd.oasis.opendocument.text"],doc:["doc","application/msword"],docx:["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/octet-stream"],xls:["xls","application/vnd.ms-excel"],xlsx:["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ppt:["ppt","application/vnd.ms-powerpoint"],pptx:["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"]};$w.fileTypes=[...Fo.odt,...Fo.doc,...Fo.docx,...Fo.xls,...Fo.xlsx,...Fo.ppt,...Fo.pptx];$w.weight=0;$w.fileLoader=({fileLoaderComplete:n})=>n();const N6=It.div`
  width: 100%;
`,j6=It.iframe`
  width: 100%;
  height: 100%;
  border: 0;
`;var Ve={},Uw={};Uw.byteLength=H6;Uw.toByteArray=U6;Uw.fromByteArray=G6;var Kn=[],Is=[],B6=typeof Uint8Array<"u"?Uint8Array:Array,NA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Yh=0,W6=NA.length;Yh<W6;++Yh)Kn[Yh]=NA[Yh],Is[NA.charCodeAt(Yh)]=Yh;Is[45]=62;Is[95]=63;function AM(n){var t=n.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=n.indexOf("=");e===-1&&(e=t);var i=e===t?0:4-e%4;return[e,i]}function H6(n){var t=AM(n),e=t[0],i=t[1];return(e+i)*3/4-i}function $6(n,t,e){return(t+e)*3/4-e}function U6(n){var t,e=AM(n),i=e[0],s=e[1],r=new B6($6(n,i,s)),a=0,o=s>0?i-4:i,l;for(l=0;l<o;l+=4)t=Is[n.charCodeAt(l)]<<18|Is[n.charCodeAt(l+1)]<<12|Is[n.charCodeAt(l+2)]<<6|Is[n.charCodeAt(l+3)],r[a++]=t>>16&255,r[a++]=t>>8&255,r[a++]=t&255;return s===2&&(t=Is[n.charCodeAt(l)]<<2|Is[n.charCodeAt(l+1)]>>4,r[a++]=t&255),s===1&&(t=Is[n.charCodeAt(l)]<<10|Is[n.charCodeAt(l+1)]<<4|Is[n.charCodeAt(l+2)]>>2,r[a++]=t>>8&255,r[a++]=t&255),r}function z6(n){return Kn[n>>18&63]+Kn[n>>12&63]+Kn[n>>6&63]+Kn[n&63]}function V6(n,t,e){for(var i,s=[],r=t;r<e;r+=3)i=(n[r]<<16&16711680)+(n[r+1]<<8&65280)+(n[r+2]&255),s.push(z6(i));return s.join("")}function G6(n){for(var t,e=n.length,i=e%3,s=[],r=16383,a=0,o=e-i;a<o;a+=r)s.push(V6(n,a,a+r>o?o:a+r));return i===1?(t=n[e-1],s.push(Kn[t>>2]+Kn[t<<4&63]+"==")):i===2&&(t=(n[e-2]<<8)+n[e-1],s.push(Kn[t>>10]+Kn[t>>4&63]+Kn[t<<2&63]+"=")),s.join("")}var ek={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ek.read=function(n,t,e,i,s){var r,a,o=s*8-i-1,l=(1<<o)-1,c=l>>1,h=-7,f=e?s-1:0,p=e?-1:1,g=n[t+f];for(f+=p,r=g&(1<<-h)-1,g>>=-h,h+=o;h>0;r=r*256+n[t+f],f+=p,h-=8);for(a=r&(1<<-h)-1,r>>=-h,h+=i;h>0;a=a*256+n[t+f],f+=p,h-=8);if(r===0)r=1-c;else{if(r===l)return a?NaN:(g?-1:1)*(1/0);a=a+Math.pow(2,i),r=r-c}return(g?-1:1)*a*Math.pow(2,r-i)};ek.write=function(n,t,e,i,s,r){var a,o,l,c=r*8-s-1,h=(1<<c)-1,f=h>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:r-1,m=i?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+f>=1?t+=p/l:t+=p*Math.pow(2,1-f),t*l>=2&&(a++,l/=2),a+f>=h?(o=0,a=h):a+f>=1?(o=(t*l-1)*Math.pow(2,s),a=a+f):(o=t*Math.pow(2,f-1)*Math.pow(2,s),a=0));s>=8;n[e+g]=o&255,g+=m,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;n[e+g]=a&255,g+=m,a/=256,c-=8);n[e+g-m]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const t=Uw,e=ek,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=h,n.SlowBuffer=D,n.INSPECT_MAX_BYTES=50;const s=2147483647;n.kMaxLength=s;const{Uint8Array:r,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;h.TYPED_ARRAY_SUPPORT=l(),!h.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const v=new r(1),A={foo:function(){return 42}};return Object.setPrototypeOf(A,r.prototype),Object.setPrototypeOf(v,A),v.foo()===42}catch{return!1}}Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}});function c(v){if(v>s)throw new RangeError('The value "'+v+'" is invalid for option "size"');const A=new r(v);return Object.setPrototypeOf(A,h.prototype),A}function h(v,A,E){if(typeof v=="number"){if(typeof A=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(v)}return f(v,A,E)}h.poolSize=8192;function f(v,A,E){if(typeof v=="string")return b(v,A);if(a.isView(v))return w(v);if(v==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof v);if(_t(v,a)||v&&_t(v.buffer,a)||typeof o<"u"&&(_t(v,o)||v&&_t(v.buffer,o)))return x(v,A,E);if(typeof v=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const B=v.valueOf&&v.valueOf();if(B!=null&&B!==v)return h.from(B,A,E);const $=R(v);if($)return $;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof v[Symbol.toPrimitive]=="function")return h.from(v[Symbol.toPrimitive]("string"),A,E);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof v)}h.from=function(v,A,E){return f(v,A,E)},Object.setPrototypeOf(h.prototype,r.prototype),Object.setPrototypeOf(h,r);function p(v){if(typeof v!="number")throw new TypeError('"size" argument must be of type number');if(v<0)throw new RangeError('The value "'+v+'" is invalid for option "size"')}function g(v,A,E){return p(v),v<=0?c(v):A!==void 0?typeof E=="string"?c(v).fill(A,E):c(v).fill(A):c(v)}h.alloc=function(v,A,E){return g(v,A,E)};function m(v){return p(v),c(v<0?0:I(v)|0)}h.allocUnsafe=function(v){return m(v)},h.allocUnsafeSlow=function(v){return m(v)};function b(v,A){if((typeof A!="string"||A==="")&&(A="utf8"),!h.isEncoding(A))throw new TypeError("Unknown encoding: "+A);const E=F(v,A)|0;let B=c(E);const $=B.write(v,A);return $!==E&&(B=B.slice(0,$)),B}function y(v){const A=v.length<0?0:I(v.length)|0,E=c(A);for(let B=0;B<A;B+=1)E[B]=v[B]&255;return E}function w(v){if(_t(v,r)){const A=new r(v);return x(A.buffer,A.byteOffset,A.byteLength)}return y(v)}function x(v,A,E){if(A<0||v.byteLength<A)throw new RangeError('"offset" is outside of buffer bounds');if(v.byteLength<A+(E||0))throw new RangeError('"length" is outside of buffer bounds');let B;return A===void 0&&E===void 0?B=new r(v):E===void 0?B=new r(v,A):B=new r(v,A,E),Object.setPrototypeOf(B,h.prototype),B}function R(v){if(h.isBuffer(v)){const A=I(v.length)|0,E=c(A);return E.length===0||v.copy(E,0,0,A),E}if(v.length!==void 0)return typeof v.length!="number"||ei(v.length)?c(0):y(v);if(v.type==="Buffer"&&Array.isArray(v.data))return y(v.data)}function I(v){if(v>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return v|0}function D(v){return+v!=v&&(v=0),h.alloc(+v)}h.isBuffer=function(v){return v!=null&&v._isBuffer===!0&&v!==h.prototype},h.compare=function(v,A){if(_t(v,r)&&(v=h.from(v,v.offset,v.byteLength)),_t(A,r)&&(A=h.from(A,A.offset,A.byteLength)),!h.isBuffer(v)||!h.isBuffer(A))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(v===A)return 0;let E=v.length,B=A.length;for(let $=0,q=Math.min(E,B);$<q;++$)if(v[$]!==A[$]){E=v[$],B=A[$];break}return E<B?-1:B<E?1:0},h.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(v,A){if(!Array.isArray(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return h.alloc(0);let E;if(A===void 0)for(A=0,E=0;E<v.length;++E)A+=v[E].length;const B=h.allocUnsafe(A);let $=0;for(E=0;E<v.length;++E){let q=v[E];if(_t(q,r))$+q.length>B.length?(h.isBuffer(q)||(q=h.from(q)),q.copy(B,$)):r.prototype.set.call(B,q,$);else if(h.isBuffer(q))q.copy(B,$);else throw new TypeError('"list" argument must be an Array of Buffers');$+=q.length}return B};function F(v,A){if(h.isBuffer(v))return v.length;if(a.isView(v)||_t(v,a))return v.byteLength;if(typeof v!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof v);const E=v.length,B=arguments.length>2&&arguments[2]===!0;if(!B&&E===0)return 0;let $=!1;for(;;)switch(A){case"ascii":case"latin1":case"binary":return E;case"utf8":case"utf-8":return Ce(v).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E*2;case"hex":return E>>>1;case"base64":return Gt(v).length;default:if($)return B?-1:Ce(v).length;A=(""+A).toLowerCase(),$=!0}}h.byteLength=F;function O(v,A,E){let B=!1;if((A===void 0||A<0)&&(A=0),A>this.length||((E===void 0||E>this.length)&&(E=this.length),E<=0)||(E>>>=0,A>>>=0,E<=A))return"";for(v||(v="utf8");;)switch(v){case"hex":return X(this,A,E);case"utf8":case"utf-8":return H(this,A,E);case"ascii":return yt(this,A,E);case"latin1":case"binary":return bt(this,A,E);case"base64":return G(this,A,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nt(this,A,E);default:if(B)throw new TypeError("Unknown encoding: "+v);v=(v+"").toLowerCase(),B=!0}}h.prototype._isBuffer=!0;function L(v,A,E){const B=v[A];v[A]=v[E],v[E]=B}h.prototype.swap16=function(){const v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let A=0;A<v;A+=2)L(this,A,A+1);return this},h.prototype.swap32=function(){const v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let A=0;A<v;A+=4)L(this,A,A+3),L(this,A+1,A+2);return this},h.prototype.swap64=function(){const v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let A=0;A<v;A+=8)L(this,A,A+7),L(this,A+1,A+6),L(this,A+2,A+5),L(this,A+3,A+4);return this},h.prototype.toString=function(){const v=this.length;return v===0?"":arguments.length===0?H(this,0,v):O.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(v){if(!h.isBuffer(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:h.compare(this,v)===0},h.prototype.inspect=function(){let v="";const A=n.INSPECT_MAX_BYTES;return v=this.toString("hex",0,A).replace(/(.{2})/g,"$1 ").trim(),this.length>A&&(v+=" ... "),"<Buffer "+v+">"},i&&(h.prototype[i]=h.prototype.inspect),h.prototype.compare=function(v,A,E,B,$){if(_t(v,r)&&(v=h.from(v,v.offset,v.byteLength)),!h.isBuffer(v))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof v);if(A===void 0&&(A=0),E===void 0&&(E=v?v.length:0),B===void 0&&(B=0),$===void 0&&($=this.length),A<0||E>v.length||B<0||$>this.length)throw new RangeError("out of range index");if(B>=$&&A>=E)return 0;if(B>=$)return-1;if(A>=E)return 1;if(A>>>=0,E>>>=0,B>>>=0,$>>>=0,this===v)return 0;let q=$-B,J=E-A;const ue=Math.min(q,J),si=this.slice(B,$),me=v.slice(A,E);for(let ce=0;ce<ue;++ce)if(si[ce]!==me[ce]){q=si[ce],J=me[ce];break}return q<J?-1:J<q?1:0};function M(v,A,E,B,$){if(v.length===0)return-1;if(typeof E=="string"?(B=E,E=0):E>2147483647?E=2147483647:E<-2147483648&&(E=-2147483648),E=+E,ei(E)&&(E=$?0:v.length-1),E<0&&(E=v.length+E),E>=v.length){if($)return-1;E=v.length-1}else if(E<0)if($)E=0;else return-1;if(typeof A=="string"&&(A=h.from(A,B)),h.isBuffer(A))return A.length===0?-1:W(v,A,E,B,$);if(typeof A=="number")return A=A&255,typeof r.prototype.indexOf=="function"?$?r.prototype.indexOf.call(v,A,E):r.prototype.lastIndexOf.call(v,A,E):W(v,[A],E,B,$);throw new TypeError("val must be string, number or Buffer")}function W(v,A,E,B,$){let q=1,J=v.length,ue=A.length;if(B!==void 0&&(B=String(B).toLowerCase(),B==="ucs2"||B==="ucs-2"||B==="utf16le"||B==="utf-16le")){if(v.length<2||A.length<2)return-1;q=2,J/=2,ue/=2,E/=2}function si(ce,Te){return q===1?ce[Te]:ce.readUInt16BE(Te*q)}let me;if($){let ce=-1;for(me=E;me<J;me++)if(si(v,me)===si(A,ce===-1?0:me-ce)){if(ce===-1&&(ce=me),me-ce+1===ue)return ce*q}else ce!==-1&&(me-=me-ce),ce=-1}else for(E+ue>J&&(E=J-ue),me=E;me>=0;me--){let ce=!0;for(let Te=0;Te<ue;Te++)if(si(v,me+Te)!==si(A,Te)){ce=!1;break}if(ce)return me}return-1}h.prototype.includes=function(v,A,E){return this.indexOf(v,A,E)!==-1},h.prototype.indexOf=function(v,A,E){return M(this,v,A,E,!0)},h.prototype.lastIndexOf=function(v,A,E){return M(this,v,A,E,!1)};function j(v,A,E,B){E=Number(E)||0;const $=v.length-E;B?(B=Number(B),B>$&&(B=$)):B=$;const q=A.length;B>q/2&&(B=q/2);let J;for(J=0;J<B;++J){const ue=parseInt(A.substr(J*2,2),16);if(ei(ue))return J;v[E+J]=ue}return J}function V(v,A,E,B){return ge(Ce(A,v.length-E),v,E,B)}function z(v,A,E,B){return ge(se(A),v,E,B)}function Y(v,A,E,B){return ge(Gt(A),v,E,B)}function K(v,A,E,B){return ge(Vt(A,v.length-E),v,E,B)}h.prototype.write=function(v,A,E,B){if(A===void 0)B="utf8",E=this.length,A=0;else if(E===void 0&&typeof A=="string")B=A,E=this.length,A=0;else if(isFinite(A))A=A>>>0,isFinite(E)?(E=E>>>0,B===void 0&&(B="utf8")):(B=E,E=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const $=this.length-A;if((E===void 0||E>$)&&(E=$),v.length>0&&(E<0||A<0)||A>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");let q=!1;for(;;)switch(B){case"hex":return j(this,v,A,E);case"utf8":case"utf-8":return V(this,v,A,E);case"ascii":case"latin1":case"binary":return z(this,v,A,E);case"base64":return Y(this,v,A,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,v,A,E);default:if(q)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),q=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function G(v,A,E){return A===0&&E===v.length?t.fromByteArray(v):t.fromByteArray(v.slice(A,E))}function H(v,A,E){E=Math.min(v.length,E);const B=[];let $=A;for(;$<E;){const q=v[$];let J=null,ue=q>239?4:q>223?3:q>191?2:1;if($+ue<=E){let si,me,ce,Te;switch(ue){case 1:q<128&&(J=q);break;case 2:si=v[$+1],(si&192)===128&&(Te=(q&31)<<6|si&63,Te>127&&(J=Te));break;case 3:si=v[$+1],me=v[$+2],(si&192)===128&&(me&192)===128&&(Te=(q&15)<<12|(si&63)<<6|me&63,Te>2047&&(Te<55296||Te>57343)&&(J=Te));break;case 4:si=v[$+1],me=v[$+2],ce=v[$+3],(si&192)===128&&(me&192)===128&&(ce&192)===128&&(Te=(q&15)<<18|(si&63)<<12|(me&63)<<6|ce&63,Te>65535&&Te<1114112&&(J=Te))}}J===null?(J=65533,ue=1):J>65535&&(J-=65536,B.push(J>>>10&1023|55296),J=56320|J&1023),B.push(J),$+=ue}return Z(B)}const Q=4096;function Z(v){const A=v.length;if(A<=Q)return String.fromCharCode.apply(String,v);let E="",B=0;for(;B<A;)E+=String.fromCharCode.apply(String,v.slice(B,B+=Q));return E}function yt(v,A,E){let B="";E=Math.min(v.length,E);for(let $=A;$<E;++$)B+=String.fromCharCode(v[$]&127);return B}function bt(v,A,E){let B="";E=Math.min(v.length,E);for(let $=A;$<E;++$)B+=String.fromCharCode(v[$]);return B}function X(v,A,E){const B=v.length;(!A||A<0)&&(A=0),(!E||E<0||E>B)&&(E=B);let $="";for(let q=A;q<E;++q)$+=Ae[v[q]];return $}function nt(v,A,E){const B=v.slice(A,E);let $="";for(let q=0;q<B.length-1;q+=2)$+=String.fromCharCode(B[q]+B[q+1]*256);return $}h.prototype.slice=function(v,A){const E=this.length;v=~~v,A=A===void 0?E:~~A,v<0?(v+=E,v<0&&(v=0)):v>E&&(v=E),A<0?(A+=E,A<0&&(A=0)):A>E&&(A=E),A<v&&(A=v);const B=this.subarray(v,A);return Object.setPrototypeOf(B,h.prototype),B};function ht(v,A,E){if(v%1!==0||v<0)throw new RangeError("offset is not uint");if(v+A>E)throw new RangeError("Trying to access beyond buffer length")}h.prototype.readUintLE=h.prototype.readUIntLE=function(v,A,E){v=v>>>0,A=A>>>0,E||ht(v,A,this.length);let B=this[v],$=1,q=0;for(;++q<A&&($*=256);)B+=this[v+q]*$;return B},h.prototype.readUintBE=h.prototype.readUIntBE=function(v,A,E){v=v>>>0,A=A>>>0,E||ht(v,A,this.length);let B=this[v+--A],$=1;for(;A>0&&($*=256);)B+=this[v+--A]*$;return B},h.prototype.readUint8=h.prototype.readUInt8=function(v,A){return v=v>>>0,A||ht(v,1,this.length),this[v]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(v,A){return v=v>>>0,A||ht(v,2,this.length),this[v]|this[v+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(v,A){return v=v>>>0,A||ht(v,2,this.length),this[v]<<8|this[v+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(v,A){return v=v>>>0,A||ht(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(v,A){return v=v>>>0,A||ht(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])},h.prototype.readBigUInt64LE=ve(function(v){v=v>>>0,et(v,"offset");const A=this[v],E=this[v+7];(A===void 0||E===void 0)&&Rt(v,this.length-8);const B=A+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24,$=this[++v]+this[++v]*2**8+this[++v]*2**16+E*2**24;return BigInt(B)+(BigInt($)<<BigInt(32))}),h.prototype.readBigUInt64BE=ve(function(v){v=v>>>0,et(v,"offset");const A=this[v],E=this[v+7];(A===void 0||E===void 0)&&Rt(v,this.length-8);const B=A*2**24+this[++v]*2**16+this[++v]*2**8+this[++v],$=this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+E;return(BigInt(B)<<BigInt(32))+BigInt($)}),h.prototype.readIntLE=function(v,A,E){v=v>>>0,A=A>>>0,E||ht(v,A,this.length);let B=this[v],$=1,q=0;for(;++q<A&&($*=256);)B+=this[v+q]*$;return $*=128,B>=$&&(B-=Math.pow(2,8*A)),B},h.prototype.readIntBE=function(v,A,E){v=v>>>0,A=A>>>0,E||ht(v,A,this.length);let B=A,$=1,q=this[v+--B];for(;B>0&&($*=256);)q+=this[v+--B]*$;return $*=128,q>=$&&(q-=Math.pow(2,8*A)),q},h.prototype.readInt8=function(v,A){return v=v>>>0,A||ht(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]},h.prototype.readInt16LE=function(v,A){v=v>>>0,A||ht(v,2,this.length);const E=this[v]|this[v+1]<<8;return E&32768?E|4294901760:E},h.prototype.readInt16BE=function(v,A){v=v>>>0,A||ht(v,2,this.length);const E=this[v+1]|this[v]<<8;return E&32768?E|4294901760:E},h.prototype.readInt32LE=function(v,A){return v=v>>>0,A||ht(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24},h.prototype.readInt32BE=function(v,A){return v=v>>>0,A||ht(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]},h.prototype.readBigInt64LE=ve(function(v){v=v>>>0,et(v,"offset");const A=this[v],E=this[v+7];(A===void 0||E===void 0)&&Rt(v,this.length-8);const B=this[v+4]+this[v+5]*2**8+this[v+6]*2**16+(E<<24);return(BigInt(B)<<BigInt(32))+BigInt(A+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24)}),h.prototype.readBigInt64BE=ve(function(v){v=v>>>0,et(v,"offset");const A=this[v],E=this[v+7];(A===void 0||E===void 0)&&Rt(v,this.length-8);const B=(A<<24)+this[++v]*2**16+this[++v]*2**8+this[++v];return(BigInt(B)<<BigInt(32))+BigInt(this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+E)}),h.prototype.readFloatLE=function(v,A){return v=v>>>0,A||ht(v,4,this.length),e.read(this,v,!0,23,4)},h.prototype.readFloatBE=function(v,A){return v=v>>>0,A||ht(v,4,this.length),e.read(this,v,!1,23,4)},h.prototype.readDoubleLE=function(v,A){return v=v>>>0,A||ht(v,8,this.length),e.read(this,v,!0,52,8)},h.prototype.readDoubleBE=function(v,A){return v=v>>>0,A||ht(v,8,this.length),e.read(this,v,!1,52,8)};function lt(v,A,E,B,$,q){if(!h.isBuffer(v))throw new TypeError('"buffer" argument must be a Buffer instance');if(A>$||A<q)throw new RangeError('"value" argument is out of bounds');if(E+B>v.length)throw new RangeError("Index out of range")}h.prototype.writeUintLE=h.prototype.writeUIntLE=function(v,A,E,B){if(v=+v,A=A>>>0,E=E>>>0,!B){const J=Math.pow(2,8*E)-1;lt(this,v,A,E,J,0)}let $=1,q=0;for(this[A]=v&255;++q<E&&($*=256);)this[A+q]=v/$&255;return A+E},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(v,A,E,B){if(v=+v,A=A>>>0,E=E>>>0,!B){const J=Math.pow(2,8*E)-1;lt(this,v,A,E,J,0)}let $=E-1,q=1;for(this[A+$]=v&255;--$>=0&&(q*=256);)this[A+$]=v/q&255;return A+E},h.prototype.writeUint8=h.prototype.writeUInt8=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,1,255,0),this[A]=v&255,A+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,2,65535,0),this[A]=v&255,this[A+1]=v>>>8,A+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,2,65535,0),this[A]=v>>>8,this[A+1]=v&255,A+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,4,4294967295,0),this[A+3]=v>>>24,this[A+2]=v>>>16,this[A+1]=v>>>8,this[A]=v&255,A+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,4,4294967295,0),this[A]=v>>>24,this[A+1]=v>>>16,this[A+2]=v>>>8,this[A+3]=v&255,A+4};function ct(v,A,E,B,$){dt(A,B,$,v,E,7);let q=Number(A&BigInt(4294967295));v[E++]=q,q=q>>8,v[E++]=q,q=q>>8,v[E++]=q,q=q>>8,v[E++]=q;let J=Number(A>>BigInt(32)&BigInt(4294967295));return v[E++]=J,J=J>>8,v[E++]=J,J=J>>8,v[E++]=J,J=J>>8,v[E++]=J,E}function st(v,A,E,B,$){dt(A,B,$,v,E,7);let q=Number(A&BigInt(4294967295));v[E+7]=q,q=q>>8,v[E+6]=q,q=q>>8,v[E+5]=q,q=q>>8,v[E+4]=q;let J=Number(A>>BigInt(32)&BigInt(4294967295));return v[E+3]=J,J=J>>8,v[E+2]=J,J=J>>8,v[E+1]=J,J=J>>8,v[E]=J,E+8}h.prototype.writeBigUInt64LE=ve(function(v,A=0){return ct(this,v,A,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeBigUInt64BE=ve(function(v,A=0){return st(this,v,A,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeIntLE=function(v,A,E,B){if(v=+v,A=A>>>0,!B){const ue=Math.pow(2,8*E-1);lt(this,v,A,E,ue-1,-ue)}let $=0,q=1,J=0;for(this[A]=v&255;++$<E&&(q*=256);)v<0&&J===0&&this[A+$-1]!==0&&(J=1),this[A+$]=(v/q>>0)-J&255;return A+E},h.prototype.writeIntBE=function(v,A,E,B){if(v=+v,A=A>>>0,!B){const ue=Math.pow(2,8*E-1);lt(this,v,A,E,ue-1,-ue)}let $=E-1,q=1,J=0;for(this[A+$]=v&255;--$>=0&&(q*=256);)v<0&&J===0&&this[A+$+1]!==0&&(J=1),this[A+$]=(v/q>>0)-J&255;return A+E},h.prototype.writeInt8=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,1,127,-128),v<0&&(v=255+v+1),this[A]=v&255,A+1},h.prototype.writeInt16LE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,2,32767,-32768),this[A]=v&255,this[A+1]=v>>>8,A+2},h.prototype.writeInt16BE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,2,32767,-32768),this[A]=v>>>8,this[A+1]=v&255,A+2},h.prototype.writeInt32LE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,4,2147483647,-2147483648),this[A]=v&255,this[A+1]=v>>>8,this[A+2]=v>>>16,this[A+3]=v>>>24,A+4},h.prototype.writeInt32BE=function(v,A,E){return v=+v,A=A>>>0,E||lt(this,v,A,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),this[A]=v>>>24,this[A+1]=v>>>16,this[A+2]=v>>>8,this[A+3]=v&255,A+4},h.prototype.writeBigInt64LE=ve(function(v,A=0){return ct(this,v,A,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),h.prototype.writeBigInt64BE=ve(function(v,A=0){return st(this,v,A,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function vt(v,A,E,B,$,q){if(E+B>v.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("Index out of range")}function tt(v,A,E,B,$){return A=+A,E=E>>>0,$||vt(v,A,E,4),e.write(v,A,E,B,23,4),E+4}h.prototype.writeFloatLE=function(v,A,E){return tt(this,v,A,!0,E)},h.prototype.writeFloatBE=function(v,A,E){return tt(this,v,A,!1,E)};function it(v,A,E,B,$){return A=+A,E=E>>>0,$||vt(v,A,E,8),e.write(v,A,E,B,52,8),E+8}h.prototype.writeDoubleLE=function(v,A,E){return it(this,v,A,!0,E)},h.prototype.writeDoubleBE=function(v,A,E){return it(this,v,A,!1,E)},h.prototype.copy=function(v,A,E,B){if(!h.isBuffer(v))throw new TypeError("argument should be a Buffer");if(E||(E=0),!B&&B!==0&&(B=this.length),A>=v.length&&(A=v.length),A||(A=0),B>0&&B<E&&(B=E),B===E||v.length===0||this.length===0)return 0;if(A<0)throw new RangeError("targetStart out of bounds");if(E<0||E>=this.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),v.length-A<B-E&&(B=v.length-A+E);const $=B-E;return this===v&&typeof r.prototype.copyWithin=="function"?this.copyWithin(A,E,B):r.prototype.set.call(v,this.subarray(E,B),A),$},h.prototype.fill=function(v,A,E,B){if(typeof v=="string"){if(typeof A=="string"?(B=A,A=0,E=this.length):typeof E=="string"&&(B=E,E=this.length),B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!h.isEncoding(B))throw new TypeError("Unknown encoding: "+B);if(v.length===1){const q=v.charCodeAt(0);(B==="utf8"&&q<128||B==="latin1")&&(v=q)}}else typeof v=="number"?v=v&255:typeof v=="boolean"&&(v=Number(v));if(A<0||this.length<A||this.length<E)throw new RangeError("Out of range index");if(E<=A)return this;A=A>>>0,E=E===void 0?this.length:E>>>0,v||(v=0);let $;if(typeof v=="number")for($=A;$<E;++$)this[$]=v;else{const q=h.isBuffer(v)?v:h.from(v,B),J=q.length;if(J===0)throw new TypeError('The value "'+v+'" is invalid for argument "value"');for($=0;$<E-A;++$)this[$+A]=q[$%J]}return this};const wt={};function St(v,A,E){wt[v]=class extends E{constructor(){super(),Object.defineProperty(this,"message",{value:A.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${v}]`,this.stack,delete this.name}get code(){return v}set code(B){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:B,writable:!0})}toString(){return`${this.name} [${v}]: ${this.message}`}}}St("ERR_BUFFER_OUT_OF_BOUNDS",function(v){return v?`${v} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),St("ERR_INVALID_ARG_TYPE",function(v,A){return`The "${v}" argument must be of type number. Received type ${typeof A}`},TypeError),St("ERR_OUT_OF_RANGE",function(v,A,E){let B=`The value of "${v}" is out of range.`,$=E;return Number.isInteger(E)&&Math.abs(E)>2**32?$=rt(String(E)):typeof E=="bigint"&&($=String(E),(E>BigInt(2)**BigInt(32)||E<-(BigInt(2)**BigInt(32)))&&($=rt($)),$+="n"),B+=` It must be ${A}. Received ${$}`,B},RangeError);function rt(v){let A="",E=v.length;const B=v[0]==="-"?1:0;for(;E>=B+4;E-=3)A=`_${v.slice(E-3,E)}${A}`;return`${v.slice(0,E)}${A}`}function mt(v,A,E){et(A,"offset"),(v[A]===void 0||v[A+E]===void 0)&&Rt(A,v.length-(E+1))}function dt(v,A,E,B,$,q){if(v>E||v<A){const J=typeof A=="bigint"?"n":"";let ue;throw A===0||A===BigInt(0)?ue=`>= 0${J} and < 2${J} ** ${(q+1)*8}${J}`:ue=`>= -(2${J} ** ${(q+1)*8-1}${J}) and < 2 ** ${(q+1)*8-1}${J}`,new wt.ERR_OUT_OF_RANGE("value",ue,v)}mt(B,$,q)}function et(v,A){if(typeof v!="number")throw new wt.ERR_INVALID_ARG_TYPE(A,"number",v)}function Rt(v,A,E){throw Math.floor(v)!==v?(et(v,E),new wt.ERR_OUT_OF_RANGE("offset","an integer",v)):A<0?new wt.ERR_BUFFER_OUT_OF_BOUNDS:new wt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${A}`,v)}const Xt=/[^+/0-9A-Za-z-_]/g;function pe(v){if(v=v.split("=")[0],v=v.trim().replace(Xt,""),v.length<2)return"";for(;v.length%4!==0;)v=v+"=";return v}function Ce(v,A){A=A||1/0;let E;const B=v.length;let $=null;const q=[];for(let J=0;J<B;++J){if(E=v.charCodeAt(J),E>55295&&E<57344){if(!$){if(E>56319){(A-=3)>-1&&q.push(239,191,189);continue}else if(J+1===B){(A-=3)>-1&&q.push(239,191,189);continue}$=E;continue}if(E<56320){(A-=3)>-1&&q.push(239,191,189),$=E;continue}E=($-55296<<10|E-56320)+65536}else $&&(A-=3)>-1&&q.push(239,191,189);if($=null,E<128){if((A-=1)<0)break;q.push(E)}else if(E<2048){if((A-=2)<0)break;q.push(E>>6|192,E&63|128)}else if(E<65536){if((A-=3)<0)break;q.push(E>>12|224,E>>6&63|128,E&63|128)}else if(E<1114112){if((A-=4)<0)break;q.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw new Error("Invalid code point")}return q}function se(v){const A=[];for(let E=0;E<v.length;++E)A.push(v.charCodeAt(E)&255);return A}function Vt(v,A){let E,B,$;const q=[];for(let J=0;J<v.length&&!((A-=2)<0);++J)E=v.charCodeAt(J),B=E>>8,$=E%256,q.push($),q.push(B);return q}function Gt(v){return t.toByteArray(pe(v))}function ge(v,A,E,B){let $;for($=0;$<B&&!($+E>=A.length||$>=v.length);++$)A[$+E]=v[$];return $}function _t(v,A){return v instanceof A||v!=null&&v.constructor!=null&&v.constructor.name!=null&&v.constructor.name===A.name}function ei(v){return v!==v}const Ae=function(){const v="0123456789abcdef",A=new Array(256);for(let E=0;E<16;++E){const B=E*16;for(let $=0;$<16;++$)A[B+$]=v[E]+v[$]}return A}();function ve(v){return typeof BigInt>"u"?ii:v}function ii(){throw new Error("BigInt not supported")}})(Ve);const z_=Ve.Buffer,q6=Ve.Blob,X6=Ve.BlobOptions,Y6=Ve.Buffer,K6=Ve.File,Q6=Ve.FileOptions,Z6=Ve.INSPECT_MAX_BYTES,J6=Ve.SlowBuffer,t$=Ve.TranscodeEncoding,e$=Ve.atob,i$=Ve.btoa,s$=Ve.constants,n$=Ve.isAscii,r$=Ve.isUtf8,a$=Ve.kMaxLength,o$=Ve.kStringMaxLength,l$=Ve.resolveObjectURL,h$=Ve.transcode,aG=Object.freeze(Object.defineProperty({__proto__:null,Blob:q6,BlobOptions:X6,Buffer:Y6,File:K6,FileOptions:Q6,INSPECT_MAX_BYTES:Z6,SlowBuffer:J6,TranscodeEncoding:t$,atob:e$,btoa:i$,constants:s$,default:z_,isAscii:n$,isUtf8:r$,kMaxLength:a$,kStringMaxLength:o$,resolveObjectURL:l$,transcode:h$},Symbol.toStringTag,{value:"Module"}));var up={};up.d=(n,t)=>{for(var e in t)up.o(t,e)&&!up.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})};up.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var xt=globalThis.pdfjsLib={};up.d(xt,{AbortException:()=>Vh,AnnotationEditorLayer:()=>wz,AnnotationEditorParamsType:()=>Ct,AnnotationEditorType:()=>Ht,AnnotationEditorUIManager:()=>$p,AnnotationLayer:()=>gz,AnnotationMode:()=>Ua,CMapCompressionType:()=>G_,ColorPicker:()=>GI,DOMSVGFactory:()=>nk,DrawLayer:()=>Az,FeatureTest:()=>ls,GlobalWorkerOptions:()=>Co,ImageKind:()=>Kv,InvalidPDFException:()=>EM,MissingPDFException:()=>zh,OPS:()=>Zs,Outliner:()=>Ex,PDFDataRangeTransport:()=>vI,PDFDateString:()=>PM,PDFWorker:()=>q0,PasswordResponses:()=>f$,PermissionFlag:()=>u$,PixelsPerInch:()=>ku,RenderingCancelledException:()=>rk,TextLayer:()=>xy,UnexpectedResponseException:()=>qw,Util:()=>ft,VerbosityLevel:()=>zw,XfaLayer:()=>wI,build:()=>XU,createValidAbsoluteUrl:()=>v$,fetchData:()=>Jw,getDocument:()=>NU,getFilenameFromUrl:()=>C$,getPdfFilenameFromUrl:()=>T$,getXfaPageViewport:()=>R$,isDataScheme:()=>ak,isPdfFile:()=>ok,noContextMenu:()=>os,normalizeUnicode:()=>E$,renderTextLayer:()=>TU,setLayerDimensions:()=>Ih,shadow:()=>Ut,updateTextLayer:()=>RU,version:()=>qU});const Fi=typeof Tt=="object"&&Tt+""=="[object process]"&&!Tt.versions.nw&&!(Tt.versions.electron&&Tt.type&&Tt.type!=="browser"),_M=[1,0,0,1,0,0],V_=[.001,0,0,.001,0,0],c$=1e7,jA=1.35,Bs={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},Ua={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},d$="pdfjs_internal_editor_",Ht={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Ct={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},u$={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},bi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Kv={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Fe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Fu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},zw={ERRORS:0,WARNINGS:1,INFOS:5},G_={NONE:0,BINARY:1},Zs={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},f$={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Vw=zw.WARNINGS;function p$(n){Number.isInteger(n)&&(Vw=n)}function g$(){return Vw}function Gw(n){Vw>=zw.INFOS&&console.log(`Info: ${n}`)}function Ft(n){Vw>=zw.WARNINGS&&console.log(`Warning: ${n}`)}function ee(n){throw new Error(n)}function Ue(n,t){n||ee(t)}function m$(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function v$(n,t=null,e=null){if(!n)return null;try{if(e&&typeof n=="string"){if(e.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(e.tryConvertEncoding)try{n=_$(n)}catch{}}const i=t?new URL(n,t):new URL(n);if(m$(i))return i}catch{}return null}function Ut(n,t,e,i=!1){return Object.defineProperty(n,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const Io=function(){function n(t,e){this.constructor===n&&ee("Cannot initialize BaseException."),this.message=t,this.name=e}return n.prototype=new Error,n.constructor=n,n}();class q_ extends Io{constructor(t,e){super(t,"PasswordException"),this.code=e}}class X_ extends Io{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class EM extends Io{constructor(t){super(t,"InvalidPDFException")}}class zh extends Io{constructor(t){super(t,"MissingPDFException")}}class qw extends Io{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class b$ extends Io{constructor(t){super(t,"FormatError")}}class Vh extends Io{constructor(t){super(t,"AbortException")}}function xM(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&ee("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<t;s+=e){const r=Math.min(s+e,t),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Xw(n){typeof n!="string"&&ee("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=n.charCodeAt(i)&255;return e}function y$(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function ik(n){const t=Object.create(null);for(const[e,i]of n)t[e]=i;return t}function w$(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function A$(){try{return new Function(""),!0}catch{return!1}}class ls{static get isLittleEndian(){return Ut(this,"isLittleEndian",w$())}static get isEvalSupported(){return Ut(this,"isEvalSupported",A$())}static get isOffscreenCanvasSupported(){return Ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Ut(this,"platform",{isMac:navigator.platform.includes("Mac")}):Ut(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var t,e;return Ut(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const BA=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Ou,Xm,oy,Y_;class ft{static makeHexColor(t,e,i){return`#${BA[t]}${BA[e]}${BA[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],s=t[0]*e[1]+t[1]*e[3]+e[5];return[i,s]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],s=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,r=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[s,r]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),r=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],s[0],r[0],a[0]),Math.min(i[1],s[1],r[1],a[1]),Math.max(i[0],s[0],r[0],a[0]),Math.max(i[1],s[1],r[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],s=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-r*s))/2,c=o+l||1,h=o-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[i,r,s,a]}static bezierBoundingBox(t,e,i,s,r,a,o,l,c){return c?(c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,l),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,l)):c=[Math.min(t,o),Math.min(e,l),Math.max(t,o),Math.max(e,l)],C(this,oy,Y_).call(this,t,i,r,o,e,s,a,l,3*(-t+3*(i-r)+o),6*(t-2*i+r),3*(i-t),c),C(this,oy,Y_).call(this,t,i,r,o,e,s,a,l,3*(-e+3*(s-a)+l),6*(e-2*s+a),3*(s-e),c),c}}Ou=new WeakSet,Xm=function(n,t,e,i,s,r,a,o,l,c){if(l<=0||l>=1)return;const h=1-l,f=l*l,p=f*l,g=h*(h*(h*n+3*l*t)+3*f*e)+p*i,m=h*(h*(h*s+3*l*r)+3*f*a)+p*o;c[0]=Math.min(c[0],g),c[1]=Math.min(c[1],m),c[2]=Math.max(c[2],g),c[3]=Math.max(c[3],m)},oy=new WeakSet,Y_=function(n,t,e,i,s,r,a,o,l,c,h,f){if(Math.abs(l)<1e-12){Math.abs(c)>=1e-12&&C(this,Ou,Xm).call(this,n,t,e,i,s,r,a,o,-h/c,f);return}const p=c**2-4*h*l;if(p<0)return;const g=Math.sqrt(p),m=2*l;C(this,Ou,Xm).call(this,n,t,e,i,s,r,a,o,(-c+g)/m,f),C(this,Ou,Xm).call(this,n,t,e,i,s,r,a,o,(-c-g)/m,f)},_(ft,Ou),_(ft,oy);function _$(n){return decodeURIComponent(escape(n))}let WA=null,$C=null;function E$(n){return WA||(WA=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,$C=new Map([["ﬅ","ſt"]])),n.replaceAll(WA,(t,e,i)=>e?e.normalize("NFKC"):$C.get(i))}function x$(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const n=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(n);else for(let t=0;t<32;t++)n[t]=Math.floor(Math.random()*255);return xM(n)}const SM="pdfjs_internal_id_",ar={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};class Yw{constructor(){this.constructor===Yw&&ee("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,r){return"none"}destroy(t=!1){}}class Kw{constructor(){this.constructor===Kw&&ee("Cannot initialize BaseCanvasFactory.")}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d")}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){ee("Abstract method `_createCanvas` called.")}}class Qw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.constructor===Qw&&ee("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?G_.BINARY:G_.NONE;return this._fetchData(e,i).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}_fetchData(t,e){ee("Abstract method `_fetchData` called.")}}class Zw{constructor({baseUrl:t=null}){this.constructor===Zw&&ee("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetchData(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}_fetchData(t){ee("Abstract method `_fetchData` called.")}}class sk{constructor(){this.constructor===sk&&ee("Cannot initialize BaseSVGFactory.")}create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){ee("Abstract method `_createSVG` called.")}}const hr="http://www.w3.org/2000/svg",lc=class{};Lt(lc,"CSS",96),Lt(lc,"PDF",72),Lt(lc,"PDF_TO_CSS_UNITS",lc.CSS/lc.PDF);let ku=lc;var wl,ea,Sa,us,Qv,hc,ni,yi,zo,cc,Al,zc,ff,Zv,K_,kM,Jv,Q_,Vo,dc,uc,Nu,fc,pf,t0,Z_,pc,gf;class S$ extends Yw{constructor({docId:t,ownerDocument:e=globalThis.document}={}){super(),_(this,ni),_(this,zo),_(this,Al),_(this,ff),_(this,K_),_(this,Jv),_(this,Vo),_(this,uc),_(this,fc),_(this,t0),_(this,pc),_(this,wl,void 0),_(this,ea,void 0),_(this,Sa,void 0),_(this,us,void 0),_(this,Qv,void 0),_(this,hc,0),T(this,Sa,t),T(this,us,e)}addFilter(t){if(!t)return"none";let e=u(this,ni,yi).get(t);if(e)return e;const[i,s,r]=C(this,ff,Zv).call(this,t),a=t.length===1?i:`${i}${s}${r}`;if(e=u(this,ni,yi).get(a),e)return u(this,ni,yi).set(t,e),e;const o=`g_${u(this,Sa)}_transfer_map_${Vs(this,hc)._++}`,l=`url(#${o})`;u(this,ni,yi).set(t,l),u(this,ni,yi).set(a,l);const c=C(this,Vo,dc).call(this,o);return C(this,fc,pf).call(this,i,s,r,c),l}addHCMFilter(t,e){var i;const s=`${t}-${e}`,r="base";let a=u(this,zo,cc).get(r);if((a==null?void 0:a.key)===s||(a?((i=a.filter)==null||i.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},u(this,zo,cc).set(r,a)),!t||!e))return a.url;const o=C(this,pc,gf).call(this,t);t=ft.makeHexColor(...o);const l=C(this,pc,gf).call(this,e);if(e=ft.makeHexColor(...l),u(this,Al,zc).style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const c=new Array(256);for(let m=0;m<=255;m++){const b=m/255;c[m]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const h=c.join(","),f=`g_${u(this,Sa)}_hcm_filter`,p=a.filter=C(this,Vo,dc).call(this,f);C(this,fc,pf).call(this,h,h,h,p),C(this,Jv,Q_).call(this,p);const g=(m,b)=>{const y=o[m]/255,w=l[m]/255,x=new Array(b+1);for(let R=0;R<=b;R++)x[R]=y+R/b*(w-y);return x.join(",")};return C(this,fc,pf).call(this,g(0,5),g(1,5),g(2,5),p),a.url=`url(#${f})`,a.url}addAlphaFilter(t){let e=u(this,ni,yi).get(t);if(e)return e;const[i]=C(this,ff,Zv).call(this,[t]),s=`alpha_${i}`;if(e=u(this,ni,yi).get(s),e)return u(this,ni,yi).set(t,e),e;const r=`g_${u(this,Sa)}_alpha_map_${Vs(this,hc)._++}`,a=`url(#${r})`;u(this,ni,yi).set(t,a),u(this,ni,yi).set(s,a);const o=C(this,Vo,dc).call(this,r);return C(this,t0,Z_).call(this,i,o),a}addLuminosityFilter(t){let e=u(this,ni,yi).get(t||"luminosity");if(e)return e;let i,s;if(t?([i]=C(this,ff,Zv).call(this,[t]),s=`luminosity_${i}`):s="luminosity",e=u(this,ni,yi).get(s),e)return u(this,ni,yi).set(t,e),e;const r=`g_${u(this,Sa)}_luminosity_map_${Vs(this,hc)._++}`,a=`url(#${r})`;u(this,ni,yi).set(t,a),u(this,ni,yi).set(s,a);const o=C(this,Vo,dc).call(this,r);return C(this,K_,kM).call(this,o),t&&C(this,t0,Z_).call(this,i,o),a}addHighlightHCMFilter(t,e,i,s,r){var a;const o=`${e}-${i}-${s}-${r}`;let l=u(this,zo,cc).get(t);if((l==null?void 0:l.key)===o||(l?((a=l.filter)==null||a.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},u(this,zo,cc).set(t,l)),!e||!i))return l.url;const[c,h]=[e,i].map(C(this,pc,gf).bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,m]=[s,r].map(C(this,pc,gf).bind(this));p<f&&([f,p,g,m]=[p,f,m,g]),u(this,Al,zc).style.color="";const b=(x,R,I)=>{const D=new Array(256),F=(p-f)/I,O=x/255,L=(R-x)/(255*I);let M=0;for(let W=0;W<=I;W++){const j=Math.round(f+W*F),V=O+W*L;for(let z=M;z<=j;z++)D[z]=V;M=j+1}for(let W=M;W<256;W++)D[W]=D[M-1];return D.join(",")},y=`g_${u(this,Sa)}_hcm_${t}_filter`,w=l.filter=C(this,Vo,dc).call(this,y);return C(this,Jv,Q_).call(this,w),C(this,fc,pf).call(this,b(g[0],m[0],5),b(g[1],m[1],5),b(g[2],m[2],5),w),l.url=`url(#${y})`,l.url}destroy(t=!1){t&&u(this,zo,cc).size!==0||(u(this,ea)&&(u(this,ea).parentNode.parentNode.remove(),T(this,ea,null)),u(this,wl)&&(u(this,wl).clear(),T(this,wl,null)),T(this,hc,0))}}wl=new WeakMap,ea=new WeakMap,Sa=new WeakMap,us=new WeakMap,Qv=new WeakMap,hc=new WeakMap,ni=new WeakSet,yi=function(){return u(this,wl)||T(this,wl,new Map)},zo=new WeakSet,cc=function(){return u(this,Qv)||T(this,Qv,new Map)},Al=new WeakSet,zc=function(){if(!u(this,ea)){const n=u(this,us).createElement("div"),{style:t}=n;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const e=u(this,us).createElementNS(hr,"svg");e.setAttribute("width",0),e.setAttribute("height",0),T(this,ea,u(this,us).createElementNS(hr,"defs")),n.append(e),e.append(u(this,ea)),u(this,us).body.append(n)}return u(this,ea)},ff=new WeakSet,Zv=function(n){if(n.length===1){const o=n[0],l=new Array(256);for(let h=0;h<256;h++)l[h]=o[h]/255;const c=l.join(",");return[c,c,c]}const[t,e,i]=n,s=new Array(256),r=new Array(256),a=new Array(256);for(let o=0;o<256;o++)s[o]=t[o]/255,r[o]=e[o]/255,a[o]=i[o]/255;return[s.join(","),r.join(","),a.join(",")]},K_=new WeakSet,kM=function(n){const t=u(this,us).createElementNS(hr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),n.append(t)},Jv=new WeakSet,Q_=function(n){const t=u(this,us).createElementNS(hr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),n.append(t)},Vo=new WeakSet,dc=function(n){const t=u(this,us).createElementNS(hr,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",n),u(this,Al,zc).append(t),t},uc=new WeakSet,Nu=function(n,t,e){const i=u(this,us).createElementNS(hr,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",e),n.append(i)},fc=new WeakSet,pf=function(n,t,e,i){const s=u(this,us).createElementNS(hr,"feComponentTransfer");i.append(s),C(this,uc,Nu).call(this,s,"feFuncR",n),C(this,uc,Nu).call(this,s,"feFuncG",t),C(this,uc,Nu).call(this,s,"feFuncB",e)},t0=new WeakSet,Z_=function(n,t){const e=u(this,us).createElementNS(hr,"feComponentTransfer");t.append(e),C(this,uc,Nu).call(this,e,"feFuncA",n)},pc=new WeakSet,gf=function(n){return u(this,Al,zc).style.color=n,lk(getComputedStyle(u(this,Al,zc)).getPropertyValue("color"))};class k$ extends Kw{constructor({ownerDocument:t=globalThis.document}={}){super(),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}async function Jw(n,t="text"){if(mf(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class CM extends Qw{_fetchData(t,e){return Jw(t,this.isCompressed?"arraybuffer":"text").then(i=>({cMapData:i instanceof ArrayBuffer?new Uint8Array(i):Xw(i),compressionType:e}))}}class TM extends Zw{_fetchData(t){return Jw(t,"arraybuffer").then(e=>new Uint8Array(e))}}class nk extends sk{_createSVG(t){return document.createElementNS(hr,t)}}class Pm{constructor({viewBox:t,scale:e,rotation:i,offsetX:s=0,offsetY:r=0,dontFlip:a=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=s,this.offsetY=r;const o=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,h,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,h=0,f=0,p=1;break;case 90:c=0,h=1,f=1,p=0;break;case 270:c=0,h=-1,f=-1,p=0;break;case 0:c=1,h=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,p=-p);let g,m,b,y;c===0?(g=Math.abs(l-t[1])*e+s,m=Math.abs(o-t[0])*e+r,b=(t[3]-t[1])*e,y=(t[2]-t[0])*e):(g=Math.abs(o-t[0])*e+s,m=Math.abs(l-t[1])*e+r,b=(t[2]-t[0])*e,y=(t[3]-t[1])*e),this.transform=[c*e,h*e,f*e,p*e,g-c*e*o-f*e*l,m-h*e*o-p*e*l],this.width=b,this.height=y}get rawDims(){const{viewBox:t}=this;return Ut(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new Pm({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(t,e){return ft.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=ft.applyTransform([t[0],t[1]],this.transform),i=ft.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return ft.applyInverseTransform([t,e],this.transform)}}class rk extends Io{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function ak(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function ok(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function C$(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function T$(n,t="document.pdf"){if(typeof n!="string")return t;if(ak(n))return Ft('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=e.exec(n);let r=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=i.exec(decodeURIComponent(r))[0]}catch{}return r||t}class UC{constructor(){Lt(this,"started",Object.create(null)),Lt(this,"times",[])}time(t){t in this.started&&Ft(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ft(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:r}of this.times)t.push(`${i.padEnd(e)} ${r-s}ms
`);return t.join("")}}function mf(n,t){try{const{protocol:e}=t?new URL(n,t):new URL(n);return e==="http:"||e==="https:"}catch{return!1}}function os(n){n.preventDefault()}function RM(n){console.log("Deprecated API usage: "+n)}let HA;class PM{static toDateObject(t){if(!t||typeof t!="string")return null;HA||(HA=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=HA.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(e[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(a+=h,o+=f):c==="+"&&(a-=h,o-=f),new Date(Date.UTC(i,s,r,a,o,l))}}function R$(n,{scale:t=1,rotation:e=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new Pm({viewBox:r,scale:t,rotation:e})}function lk(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ft(`Not a valid color format: "${n}"`),[0,0,0])}function P$(n){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of n.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;n.set(e,lk(i))}t.remove()}function we(n){const{a:t,b:e,c:i,d:s,e:r,f:a}=n.getTransform();return[t,e,i,s,r,a]}function or(n){const{a:t,b:e,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[t,e,i,s,r,a]}function Ih(n,t,e=!1,i=!0){if(t instanceof Pm){const{pageWidth:s,pageHeight:r}=t.rawDims,{style:a}=n,o=ls.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${r}px`,h=o?`round(${l}, 1px)`:`calc(${l})`,f=o?`round(${c}, 1px)`:`calc(${c})`;!e||t.rotation%180===0?(a.width=h,a.height=f):(a.width=f,a.height=h)}i&&n.setAttribute("data-main-rotation",t.rotation)}var gc,mc,ia,Vc,J_,LM,tE,zC,eE,VC,fp,ly,iE,MM,e0,sE;const IM=class DM{constructor(t){_(this,tE),_(this,eE),_(this,fp),_(this,iE),_(this,e0),_(this,gc,null),_(this,mc,null),_(this,ia,void 0),_(this,Vc,null),T(this,ia,t)}render(){const t=T(this,gc,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",os),t.addEventListener("pointerdown",C(DM,J_,LM));const e=T(this,Vc,document.createElement("div"));e.className="buttons",t.append(e);const i=u(this,ia).toolbarPosition;if(i){const{style:s}=t,r=u(this,ia)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*r}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return C(this,iE,MM).call(this),t}hide(){var t;u(this,gc).classList.add("hidden"),(t=u(this,mc))==null||t.hideDropdown()}show(){u(this,gc).classList.remove("hidden")}addAltTextButton(t){C(this,fp,ly).call(this,t),u(this,Vc).prepend(t,u(this,e0,sE))}addColorPicker(t){T(this,mc,t);const e=t.renderButton();C(this,fp,ly).call(this,e),u(this,Vc).prepend(e,u(this,e0,sE))}remove(){var t;u(this,gc).remove(),(t=u(this,mc))==null||t.destroy(),T(this,mc,null)}};gc=new WeakMap,mc=new WeakMap,ia=new WeakMap,Vc=new WeakMap,J_=new WeakSet,LM=function(n){n.stopPropagation()},tE=new WeakSet,zC=function(n){u(this,ia)._focusEventsAllowed=!1,n.preventDefault(),n.stopPropagation()},eE=new WeakSet,VC=function(n){u(this,ia)._focusEventsAllowed=!0,n.preventDefault(),n.stopPropagation()},fp=new WeakSet,ly=function(n){n.addEventListener("focusin",C(this,tE,zC).bind(this),{capture:!0}),n.addEventListener("focusout",C(this,eE,VC).bind(this),{capture:!0}),n.addEventListener("contextmenu",os)},iE=new WeakSet,MM=function(){const n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",`pdfjs-editor-remove-${u(this,ia).editorType}-button`),C(this,fp,ly).call(this,n),n.addEventListener("click",t=>{u(this,ia)._uiManager.delete()}),u(this,Vc).append(n)},e0=new WeakSet,sE=function(){const n=document.createElement("div");return n.className="divider",n},_(IM,J_);let L$=IM;var i0,ll,hy,nE,FM,rE,OM,aE,GC;class M${constructor(t){_(this,nE),_(this,rE),_(this,aE),_(this,i0,null),_(this,ll,null),_(this,hy,void 0),T(this,hy,t)}show(t,e,i){const[s,r]=C(this,rE,OM).call(this,e,i),{style:a}=u(this,ll)||T(this,ll,C(this,nE,FM).call(this));t.append(u(this,ll)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){u(this,ll).remove()}}i0=new WeakMap,ll=new WeakMap,hy=new WeakMap,nE=new WeakSet,FM=function(){const n=T(this,ll,document.createElement("div"));n.className="editToolbar",n.setAttribute("role","toolbar"),n.addEventListener("contextmenu",os);const t=T(this,i0,document.createElement("div"));return t.className="buttons",n.append(t),C(this,aE,GC).call(this),n},rE=new WeakSet,OM=function(n,t){let e=0,i=0;for(const s of n){const r=s.y+s.height;if(r<e)continue;const a=s.x+(t?s.width:0);if(r>e){i=a,e=r;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,e]},aE=new WeakSet,GC=function(){const n=document.createElement("button");n.className="highlightButton",n.tabIndex=0,n.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");n.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),n.addEventListener("contextmenu",os),n.addEventListener("click",()=>{u(this,hy).highlightSelection("floating_button")}),u(this,i0).append(n)};function cy(n,t,e){for(const i of e)t.addEventListener(i,n[i].bind(n))}function I$(n){return Math.round(Math.min(255,Math.max(1,255*n))).toString(16).padStart(2,"0")}var oE;class D${constructor(){_(this,oE,0)}get id(){return`${d$}${Vs(this,oE)._++}`}}oE=new WeakMap;var dy,lE,is,s0,hE;const NM=class{constructor(){_(this,s0),_(this,dy,x$()),_(this,lE,0),_(this,is,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',e=new OffscreenCanvas(1,3).getContext("2d"),i=new Image;i.src=t;const s=i.decode().then(()=>(e.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]===0));return Ut(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:i,size:s,type:r}=t;return C(this,s0,hE).call(this,`${e}_${i}_${s}_${r}`,t)}async getFromUrl(t){return C(this,s0,hE).call(this,t,t)}async getFromId(t){u(this,is)||T(this,is,new Map);const e=u(this,is).get(t);return e?e.bitmap?(e.refCounter+=1,e):e.file?this.getFromFile(e.file):this.getFromUrl(e.url):null}getSvgUrl(t){const e=u(this,is).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){u(this,is)||T(this,is,new Map);const e=u(this,is).get(t);e&&(e.refCounter-=1,e.refCounter===0&&(e.bitmap=null))}isValidId(t){return t.startsWith(`image_${u(this,dy)}_`)}};dy=new WeakMap,lE=new WeakMap,is=new WeakMap,s0=new WeakSet,hE=async function(n,t){u(this,is)||T(this,is,new Map);let e=u(this,is).get(n);if(e===null)return null;if(e!=null&&e.bitmap)return e.refCounter+=1,e;try{e||(e={bitmap:null,id:`image_${u(this,dy)}_${Vs(this,lE)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(e.url=t,i=await Jw(t,"blob")):i=e.file=t,i.type==="image/svg+xml"){const s=NM._isSVGFittingCanvas,r=new FileReader,a=new Image,o=new Promise((l,c)=>{a.onload=()=>{e.bitmap=a,e.isSvg=!0,l()},r.onload=async()=>{const h=e.svgUrl=r.result;a.src=await s?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=r.onerror=c});r.readAsDataURL(i),await o}else e.bitmap=await createImageBitmap(i);e.refCounter=1}catch(i){console.error(i),e=null}return u(this,is).set(n,e),e&&u(this,is).set(e.id,e),e};let F$=NM;var ri,Go,n0,Oe;class O${constructor(t=128){_(this,ri,[]),_(this,Go,!1),_(this,n0,void 0),_(this,Oe,-1),T(this,n0,t)}add({cmd:t,undo:e,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&t(),u(this,Go))return;const l={cmd:t,undo:e,post:i,type:r};if(u(this,Oe)===-1){u(this,ri).length>0&&(u(this,ri).length=0),T(this,Oe,0),u(this,ri).push(l);return}if(a&&u(this,ri)[u(this,Oe)].type===r){o&&(l.undo=u(this,ri)[u(this,Oe)].undo),u(this,ri)[u(this,Oe)]=l;return}const c=u(this,Oe)+1;c===u(this,n0)?u(this,ri).splice(0,1):(T(this,Oe,c),c<u(this,ri).length&&u(this,ri).splice(c)),u(this,ri).push(l)}undo(){if(u(this,Oe)===-1)return;T(this,Go,!0);const{undo:t,post:e}=u(this,ri)[u(this,Oe)];t(),e==null||e(),T(this,Go,!1),T(this,Oe,u(this,Oe)-1)}redo(){if(u(this,Oe)<u(this,ri).length-1){T(this,Oe,u(this,Oe)+1),T(this,Go,!0);const{cmd:t,post:e}=u(this,ri)[u(this,Oe)];t(),e==null||e(),T(this,Go,!1)}}hasSomethingToUndo(){return u(this,Oe)!==-1}hasSomethingToRedo(){return u(this,Oe)<u(this,ri).length-1}destroy(){T(this,ri,null)}}ri=new WeakMap,Go=new WeakMap,n0=new WeakMap,Oe=new WeakMap;var cE,jM;class Lm{constructor(t){_(this,cE),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ls.platform;for(const[i,s,r={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(C(this,cE,jM).call(this,e));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(s.bind(t,...a,e)(),r||(e.stopPropagation(),e.preventDefault()))}}cE=new WeakSet,jM=function(n){n.altKey&&this.buffer.push("alt"),n.ctrlKey&&this.buffer.push("ctrl"),n.metaKey&&this.buffer.push("meta"),n.shiftKey&&this.buffer.push("shift"),this.buffer.push(n.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const BM=class WM{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return P$(t),Ut(this,"_colors",t)}convert(t){const e=lk(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((r,a)=>r===e[a]))return WM._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?ft.makeHexColor(...e):t}};Lt(BM,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let N$=BM;var Rs,Qe,Si,vf,ka,vc,yn,bf,bc,cr,Ca,yc,uy,r0,dr,yf,hl,Rn,dE,cl,a0,wc,o0,wf,Ri,Jt,Ta,Ac,Af,l0,h0,c0,d0,u0,f0,p0,g0,m0,v0,b0,y0,w0,qo,ur,Ra,A0,pp,_0,uE,qC,fE,HM,gp,fy,pE,$M,gE,UM,mE,zM,E0,vE,x0,bE,S0,yE,k0,wE,C0,AE,Ci,Wi,_r,ja,_E,VM,EE,GM,T0,xE,SE,qM,_c,_f,R0,kE;const CE=class TE{constructor(t,e,i,s,r,a,o,l,c){_(this,pp),_(this,uE),_(this,fE),_(this,gp),_(this,pE),_(this,gE),_(this,mE),_(this,E0),_(this,x0),_(this,S0),_(this,k0),_(this,C0),_(this,Ci),_(this,_r),_(this,_E),_(this,EE),_(this,T0),_(this,SE),_(this,_c),_(this,R0),_(this,Rs,null),_(this,Qe,new Map),_(this,Si,new Map),_(this,vf,null),_(this,ka,null),_(this,vc,null),_(this,yn,new O$),_(this,bf,0),_(this,bc,new Set),_(this,cr,null),_(this,Ca,null),_(this,yc,new Set),_(this,uy,!1),_(this,r0,null),_(this,dr,null),_(this,yf,null),_(this,hl,!1),_(this,Rn,null),_(this,dE,new D$),_(this,cl,!1),_(this,a0,!1),_(this,wc,null),_(this,o0,null),_(this,wf,null),_(this,Ri,Ht.NONE),_(this,Jt,new Set),_(this,Ta,null),_(this,Ac,null),_(this,Af,null),_(this,l0,this.blur.bind(this)),_(this,h0,this.focus.bind(this)),_(this,c0,this.copy.bind(this)),_(this,d0,this.cut.bind(this)),_(this,u0,this.paste.bind(this)),_(this,f0,this.keydown.bind(this)),_(this,p0,this.keyup.bind(this)),_(this,g0,this.onEditingAction.bind(this)),_(this,m0,this.onPageChanging.bind(this)),_(this,v0,this.onScaleChanging.bind(this)),_(this,b0,C(this,fE,HM).bind(this)),_(this,y0,this.onRotationChanging.bind(this)),_(this,w0,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),_(this,qo,[0,0]),_(this,ur,null),_(this,Ra,null),_(this,A0,null),T(this,Ra,t),T(this,A0,e),T(this,vf,i),this._eventBus=s,this._eventBus._on("editingaction",u(this,g0)),this._eventBus._on("pagechanging",u(this,m0)),this._eventBus._on("scalechanging",u(this,v0)),this._eventBus._on("rotationchanging",u(this,y0)),C(this,pE,$M).call(this),C(this,x0,bE).call(this),T(this,ka,r.annotationStorage),T(this,r0,r.filterFactory),T(this,Ac,a),T(this,yf,o||null),T(this,uy,l),T(this,wf,c||null),this.viewParameters={realScale:ku.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=TE.prototype,e=a=>u(a,Ra).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Ut(this,"_keyboardManager",new Lm([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,Ra).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,Ra).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}destroy(){var t,e;C(this,S0,yE).call(this),C(this,E0,vE).call(this),this._eventBus._off("editingaction",u(this,g0)),this._eventBus._off("pagechanging",u(this,m0)),this._eventBus._off("scalechanging",u(this,v0)),this._eventBus._off("rotationchanging",u(this,y0));for(const i of u(this,Si).values())i.destroy();u(this,Si).clear(),u(this,Qe).clear(),u(this,yc).clear(),T(this,Rs,null),u(this,Jt).clear(),u(this,yn).destroy(),(t=u(this,vf))==null||t.destroy(),(e=u(this,Rn))==null||e.hide(),T(this,Rn,null),u(this,dr)&&(clearTimeout(u(this,dr)),T(this,dr,null)),u(this,ur)&&(clearTimeout(u(this,ur)),T(this,ur,null)),C(this,gE,UM).call(this)}async mlGuess(t){var e;return((e=u(this,wf))==null?void 0:e.guess(t))||null}get hasMLManager(){return!!u(this,wf)}get hcmFilter(){return Ut(this,"hcmFilter",u(this,Ac)?u(this,r0).addHCMFilter(u(this,Ac).foreground,u(this,Ac).background):"none")}get direction(){return Ut(this,"direction",getComputedStyle(u(this,Ra)).direction)}get highlightColors(){return Ut(this,"highlightColors",u(this,yf)?new Map(u(this,yf).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){T(this,o0,t)}editAltText(t){var e;(e=u(this,vf))==null||e.editAltText(this,t)}onPageChanging({pageNumber:t}){T(this,bf,t-1)}focusMainContainer(){u(this,Ra).focus()}findParent(t,e){for(const i of u(this,Si).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(t>=s&&t<=s+a&&e>=r&&e<=r+o)return i}return null}disableUserSelect(t=!1){u(this,A0).classList.toggle("noUserSelect",t)}addShouldRescale(t){u(this,yc).add(t)}removeShouldRescale(t){u(this,yc).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ku.PDF_TO_CSS_UNITS;for(const e of u(this,yc))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a}=e,o=e.toString(),l=C(this,pp,_0).call(this,e).closest(".textLayer"),c=this.getSelectionBoxes(l);if(c){e.empty(),u(this,Ri)===Ht.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:Ht.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const h of u(this,Si).values())if(h.hasTextLayer(l)){h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:c,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a,text:o});break}}}addToAnnotationStorage(t){!t.isEmpty()&&u(this,ka)&&!u(this,ka).has(t.id)&&u(this,ka).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,u(this,hl)&&(T(this,hl,!1),C(this,gp,fy).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of u(this,Jt))if(e.div.contains(t)){T(this,wc,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!u(this,wc))return;const[t,e]=u(this,wc);T(this,wc,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),e.focus()}addEditListeners(){C(this,x0,bE).call(this),C(this,k0,wE).call(this)}removeEditListeners(){C(this,S0,yE).call(this),C(this,C0,AE).call(this)}copy(t){var e;if(t.preventDefault(),(e=u(this,Rs))==null||e.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of u(this,Jt)){const r=s.serialize(!0);r&&i.push(r)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const a of u(this,Ca))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){Ft(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const c=s.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)C(this,T0,xE).call(this,l);C(this,R0,kE).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){Ft(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),u(this,Ri)!==Ht.NONE&&!this.isEditorHandlingKeyboard&&TE._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,u(this,hl)&&(T(this,hl,!1),C(this,gp,fy).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(C(this,mE,zM).call(this),C(this,k0,wE).call(this),C(this,Ci,Wi).call(this,{isEditing:u(this,Ri)!==Ht.NONE,isEmpty:C(this,_c,_f).call(this),hasSomethingToUndo:u(this,yn).hasSomethingToUndo(),hasSomethingToRedo:u(this,yn).hasSomethingToRedo(),hasSelectedEditor:!1})):(C(this,E0,vE).call(this),C(this,C0,AE).call(this),C(this,Ci,Wi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!u(this,Ca)){T(this,Ca,t);for(const e of u(this,Ca))C(this,_r,ja).call(this,e.defaultPropertiesToUpdate)}}getId(){return u(this,dE).id}get currentLayer(){return u(this,Si).get(u(this,bf))}getLayer(t){return u(this,Si).get(t)}get currentPageIndex(){return u(this,bf)}addLayer(t){u(this,Si).set(t.pageIndex,t),u(this,cl)?t.enable():t.disable()}removeLayer(t){u(this,Si).delete(t.pageIndex)}updateMode(t,e=null,i=!1){if(u(this,Ri)!==t){if(T(this,Ri,t),t===Ht.NONE){this.setEditingState(!1),C(this,EE,GM).call(this);return}this.setEditingState(!0),C(this,_E,VM).call(this),this.unselectAll();for(const s of u(this,Si).values())s.updateMode(t);if(!e&&i){this.addNewEditorFromKeyboard();return}if(e){for(const s of u(this,Qe).values())if(s.annotationElementId===e){this.setSelected(s),s.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==u(this,Ri)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var i;if(u(this,Ca)){switch(t){case Ct.CREATE:this.currentLayer.addNewEditor();return;case Ct.HIGHLIGHT_DEFAULT_COLOR:(i=u(this,o0))==null||i.updateColor(e);break;case Ct.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(u(this,Af)||T(this,Af,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const s of u(this,Jt))s.updateParams(t,e);for(const s of u(this,Ca))s.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){var s;for(const r of u(this,Qe).values())r.editorType===t&&r.show(e);(((s=u(this,Af))==null?void 0:s.get(Ct.HIGHLIGHT_SHOW_ALL))??!0)!==e&&C(this,_r,ja).call(this,[[Ct.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(u(this,a0)!==t){T(this,a0,t);for(const e of u(this,Si).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of u(this,Qe).values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return u(this,Qe).get(t)}addEditor(t){u(this,Qe).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(u(this,dr)&&clearTimeout(u(this,dr)),T(this,dr,setTimeout(()=>{this.focusMainContainer(),T(this,dr,null)},0))),u(this,Qe).delete(t.id),this.unselect(t),(!t.annotationElementId||!u(this,bc).has(t.annotationElementId))&&((e=u(this,ka))==null||e.remove(t.id))}addDeletedAnnotationElement(t){u(this,bc).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return u(this,bc).has(t)}removeDeletedAnnotationElement(t){u(this,bc).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){u(this,Rs)!==t&&(T(this,Rs,t),t&&C(this,_r,ja).call(this,t.propertiesToUpdate))}updateUI(t){u(this,SE,qM)===t&&C(this,_r,ja).call(this,t.propertiesToUpdate)}toggleSelected(t){if(u(this,Jt).has(t)){u(this,Jt).delete(t),t.unselect(),C(this,Ci,Wi).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,Jt).add(t),t.select(),C(this,_r,ja).call(this,t.propertiesToUpdate),C(this,Ci,Wi).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of u(this,Jt))e!==t&&e.unselect();u(this,Jt).clear(),u(this,Jt).add(t),t.select(),C(this,_r,ja).call(this,t.propertiesToUpdate),C(this,Ci,Wi).call(this,{hasSelectedEditor:!0})}isSelected(t){return u(this,Jt).has(t)}get firstSelectedEditor(){return u(this,Jt).values().next().value}unselect(t){t.unselect(),u(this,Jt).delete(t),C(this,Ci,Wi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,Jt).size!==0}get isEnterHandled(){return u(this,Jt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){u(this,yn).undo(),C(this,Ci,Wi).call(this,{hasSomethingToUndo:u(this,yn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:C(this,_c,_f).call(this)})}redo(){u(this,yn).redo(),C(this,Ci,Wi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,yn).hasSomethingToRedo(),isEmpty:C(this,_c,_f).call(this)})}addCommands(t){u(this,yn).add(t),C(this,Ci,Wi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:C(this,_c,_f).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...u(this,Jt)],e=()=>{for(const s of t)s.remove()},i=()=>{for(const s of t)C(this,T0,xE).call(this,s)};this.addCommands({cmd:e,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=u(this,Rs))==null||t.commitOrRemove()}hasSomethingToControl(){return u(this,Rs)||this.hasSelection}selectAll(){for(const t of u(this,Jt))t.commit();C(this,R0,kE).call(this,u(this,Qe).values())}unselectAll(){if(!(u(this,Rs)&&(u(this,Rs).commitOrRemove(),u(this,Ri)!==Ht.NONE))&&this.hasSelection){for(const t of u(this,Jt))t.unselect();u(this,Jt).clear(),C(this,Ci,Wi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;u(this,qo)[0]+=t,u(this,qo)[1]+=e;const[s,r]=u(this,qo),a=[...u(this,Jt)];u(this,ur)&&clearTimeout(u(this,ur)),T(this,ur,setTimeout(()=>{T(this,ur,null),u(this,qo)[0]=u(this,qo)[1]=0,this.addCommands({cmd:()=>{for(const l of a)u(this,Qe).has(l.id)&&l.translateInPage(s,r)},undo:()=>{for(const l of a)u(this,Qe).has(l.id)&&l.translateInPage(-s,-r)},mustExec:!1})},1e3));for(const l of a)l.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),T(this,cr,new Map);for(const t of u(this,Jt))u(this,cr).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!u(this,cr))return!1;this.disableUserSelect(!1);const t=u(this,cr);T(this,cr,null);let e=!1;for(const[{x:s,y:r,pageIndex:a},o]of t)o.newX=s,o.newY=r,o.newPageIndex=a,e||(e=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!e)return!1;const i=(s,r,a,o)=>{if(u(this,Qe).has(s.id)){const l=u(this,Si).get(o);l?s._setParentAndPosition(l,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of t)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of t)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(u(this,cr))for(const i of u(this,cr).keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||u(this,Jt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return u(this,Rs)===t}getActive(){return u(this,Rs)}getMode(){return u(this,Ri)}get imageManager(){return Ut(this,"imageManager",new F$)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,h=e.rangeCount;c<h;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,h,f,p)=>({x:(h-s)/a,y:1-(c+f-i)/r,width:p/a,height:f/r});break;case"180":o=(c,h,f,p)=>({x:1-(c+f-i)/r,y:1-(h+p-s)/a,width:f/r,height:p/a});break;case"270":o=(c,h,f,p)=>({x:1-(h+p-s)/a,y:(c-i)/r,width:p/a,height:f/r});break;default:o=(c,h,f,p)=>({x:(c-i)/r,y:(h-s)/a,width:f/r,height:p/a});break}const l=[];for(let c=0,h=e.rangeCount;c<h;c++){const f=e.getRangeAt(c);if(!f.collapsed)for(const{x:p,y:g,width:m,height:b}of f.getClientRects())m===0||b===0||l.push(o(p,g,m,b))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(u(this,vc)||T(this,vc,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=u(this,vc))==null||e.delete(t)}renderAnnotationElement(t){var e;const i=(e=u(this,vc))==null?void 0:e.get(t.data.id);if(!i)return;const s=u(this,ka).getRawValue(i);s&&(u(this,Ri)===Ht.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}};Rs=new WeakMap,Qe=new WeakMap,Si=new WeakMap,vf=new WeakMap,ka=new WeakMap,vc=new WeakMap,yn=new WeakMap,bf=new WeakMap,bc=new WeakMap,cr=new WeakMap,Ca=new WeakMap,yc=new WeakMap,uy=new WeakMap,r0=new WeakMap,dr=new WeakMap,yf=new WeakMap,hl=new WeakMap,Rn=new WeakMap,dE=new WeakMap,cl=new WeakMap,a0=new WeakMap,wc=new WeakMap,o0=new WeakMap,wf=new WeakMap,Ri=new WeakMap,Jt=new WeakMap,Ta=new WeakMap,Ac=new WeakMap,Af=new WeakMap,l0=new WeakMap,h0=new WeakMap,c0=new WeakMap,d0=new WeakMap,u0=new WeakMap,f0=new WeakMap,p0=new WeakMap,g0=new WeakMap,m0=new WeakMap,v0=new WeakMap,b0=new WeakMap,y0=new WeakMap,w0=new WeakMap,qo=new WeakMap,ur=new WeakMap,Ra=new WeakMap,A0=new WeakMap,pp=new WeakSet,_0=function({anchorNode:n}){return n.nodeType===Node.TEXT_NODE?n.parentElement:n},uE=new WeakSet,qC=function(){const n=document.getSelection();if(!n||n.isCollapsed)return;const t=C(this,pp,_0).call(this,n).closest(".textLayer"),e=this.getSelectionBoxes(t);e&&(u(this,Rn)||T(this,Rn,new M$(this)),u(this,Rn).show(t,e,this.direction==="ltr"))},fE=new WeakSet,HM=function(){var n,t,e;const i=document.getSelection();if(!i||i.isCollapsed){u(this,Ta)&&((n=u(this,Rn))==null||n.hide(),T(this,Ta,null),C(this,Ci,Wi).call(this,{hasSelectedText:!1}));return}const{anchorNode:s}=i;if(s!==u(this,Ta)){if(!C(this,pp,_0).call(this,i).closest(".textLayer")){u(this,Ta)&&((t=u(this,Rn))==null||t.hide(),T(this,Ta,null),C(this,Ci,Wi).call(this,{hasSelectedText:!1}));return}if((e=u(this,Rn))==null||e.hide(),T(this,Ta,s),C(this,Ci,Wi).call(this,{hasSelectedText:!0}),!(u(this,Ri)!==Ht.HIGHLIGHT&&u(this,Ri)!==Ht.NONE)&&(u(this,Ri)===Ht.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),T(this,hl,this.isShiftKeyDown),!this.isShiftKeyDown)){const r=a=>{a.type==="pointerup"&&a.button!==0||(window.removeEventListener("pointerup",r),window.removeEventListener("blur",r),a.type==="pointerup"&&C(this,gp,fy).call(this,"main_toolbar"))};window.addEventListener("pointerup",r),window.addEventListener("blur",r)}}},gp=new WeakSet,fy=function(n=""){u(this,Ri)===Ht.HIGHLIGHT?this.highlightSelection(n):u(this,uy)&&C(this,uE,qC).call(this)},pE=new WeakSet,$M=function(){document.addEventListener("selectionchange",u(this,b0))},gE=new WeakSet,UM=function(){document.removeEventListener("selectionchange",u(this,b0))},mE=new WeakSet,zM=function(){window.addEventListener("focus",u(this,h0)),window.addEventListener("blur",u(this,l0))},E0=new WeakSet,vE=function(){window.removeEventListener("focus",u(this,h0)),window.removeEventListener("blur",u(this,l0))},x0=new WeakSet,bE=function(){window.addEventListener("keydown",u(this,f0)),window.addEventListener("keyup",u(this,p0))},S0=new WeakSet,yE=function(){window.removeEventListener("keydown",u(this,f0)),window.removeEventListener("keyup",u(this,p0))},k0=new WeakSet,wE=function(){document.addEventListener("copy",u(this,c0)),document.addEventListener("cut",u(this,d0)),document.addEventListener("paste",u(this,u0))},C0=new WeakSet,AE=function(){document.removeEventListener("copy",u(this,c0)),document.removeEventListener("cut",u(this,d0)),document.removeEventListener("paste",u(this,u0))},Ci=new WeakSet,Wi=function(n){Object.entries(n).some(([t,e])=>u(this,w0)[t]!==e)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,w0),n)}),u(this,Ri)===Ht.HIGHLIGHT&&n.hasSelectedEditor===!1&&C(this,_r,ja).call(this,[[Ct.HIGHLIGHT_FREE,!0]]))},_r=new WeakSet,ja=function(n){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:n})},_E=new WeakSet,VM=function(){if(!u(this,cl)){T(this,cl,!0);for(const n of u(this,Si).values())n.enable();for(const n of u(this,Qe).values())n.enable()}},EE=new WeakSet,GM=function(){if(this.unselectAll(),u(this,cl)){T(this,cl,!1);for(const n of u(this,Si).values())n.disable();for(const n of u(this,Qe).values())n.disable()}},T0=new WeakSet,xE=function(n){const t=u(this,Si).get(n.pageIndex);t?t.addOrRebuild(n):(this.addEditor(n),this.addToAnnotationStorage(n))},SE=new WeakSet,qM=function(){let n=null;for(n of u(this,Jt));return n},_c=new WeakSet,_f=function(){if(u(this,Qe).size===0)return!0;if(u(this,Qe).size===1)for(const n of u(this,Qe).values())return n.isEmpty();return!1},R0=new WeakSet,kE=function(n){for(const t of u(this,Jt))t.unselect();u(this,Jt).clear();for(const t of n)t.isEmpty()||(u(this,Jt).add(t),t.select());C(this,Ci,Wi).call(this,{hasSelectedEditor:this.hasSelection})},Lt(CE,"TRANSLATE_SMALL",1),Lt(CE,"TRANSLATE_BIG",10);let $p=CE;var za,Va,_n,Ba,Yn,Ef,Eo,P0,RE;const L0=class M0{constructor(t){_(this,P0),_(this,za,""),_(this,Va,!1),_(this,_n,null),_(this,Ba,null),_(this,Yn,null),_(this,Ef,!1),_(this,Eo,null),T(this,Eo,t)}static initialize(t){M0._l10nPromise||(M0._l10nPromise=t)}async render(){const t=T(this,_n,document.createElement("button"));t.className="altText";const e=await M0._l10nPromise.get("pdfjs-editor-alt-text-button-label");t.textContent=e,t.setAttribute("aria-label",e),t.tabIndex="0",t.addEventListener("contextmenu",os),t.addEventListener("pointerdown",s=>s.stopPropagation());const i=s=>{s.preventDefault(),u(this,Eo)._uiManager.editAltText(u(this,Eo))};return t.addEventListener("click",i,{capture:!0}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(T(this,Ef,!0),i(s))}),await C(this,P0,RE).call(this),t}finish(){u(this,_n)&&(u(this,_n).focus({focusVisible:u(this,Ef)}),T(this,Ef,!1))}isEmpty(){return!u(this,za)&&!u(this,Va)}get data(){return{altText:u(this,za),decorative:u(this,Va)}}set data({altText:t,decorative:e}){u(this,za)===t&&u(this,Va)===e||(T(this,za,t),T(this,Va,e),C(this,P0,RE).call(this))}toggle(t=!1){u(this,_n)&&(!t&&u(this,Yn)&&(clearTimeout(u(this,Yn)),T(this,Yn,null)),u(this,_n).disabled=!t)}destroy(){var t;(t=u(this,_n))==null||t.remove(),T(this,_n,null),T(this,Ba,null)}};za=new WeakMap,Va=new WeakMap,_n=new WeakMap,Ba=new WeakMap,Yn=new WeakMap,Ef=new WeakMap,Eo=new WeakMap,P0=new WeakSet,RE=async function(){var n;const t=u(this,_n);if(!t)return;if(!u(this,za)&&!u(this,Va)){t.classList.remove("done"),(n=u(this,Ba))==null||n.remove();return}t.classList.add("done"),L0._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(s=>{t.setAttribute("aria-label",s)});let e=u(this,Ba);if(!e){T(this,Ba,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip");const s=e.id=`alt-text-tooltip-${u(this,Eo).id}`;t.setAttribute("aria-describedby",s);const r=100;t.addEventListener("mouseenter",()=>{T(this,Yn,setTimeout(()=>{T(this,Yn,null),u(this,Ba).classList.add("show"),u(this,Eo)._reportTelemetry({action:"alt_text_tooltip"})},r))}),t.addEventListener("mouseleave",()=>{var a;u(this,Yn)&&(clearTimeout(u(this,Yn)),T(this,Yn,null)),(a=u(this,Ba))==null||a.classList.remove("show")})}e.innerText=u(this,Va)?await L0._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):u(this,za),e.parentNode||t.append(e);const i=u(this,Eo).getImageForAltText();i==null||i.setAttribute("aria-describedby",e.id)},Lt(L0,"_l10nPromise",null);let XC=L0;var Pn,Yi,xf,Ec,Pi,Gc,Sf,kf,Ni,py,qc,fr,I0,xc,xo,pr,Cf,Tf,Ps,D0,PE,F0,LE,gy,ME,O0,$A,IE,XM,DE,YC,N0,UA,my,FE,vy,OE,NE,YM,jE,KM,BE,QM,WE,ZM,by,HE,Xc,mp;const gr=class ai{constructor(t){_(this,F0),_(this,O0),_(this,IE),_(this,DE),_(this,N0),_(this,my),_(this,vy),_(this,NE),_(this,jE),_(this,BE),_(this,WE),_(this,by),_(this,Xc),_(this,Pn,null),_(this,Yi,null),_(this,xf,!1),_(this,Ec,!1),_(this,Pi,null),_(this,Gc,null),_(this,Sf,this.focusin.bind(this)),_(this,kf,this.focusout.bind(this)),_(this,Ni,null),_(this,py,""),_(this,qc,!1),_(this,fr,null),_(this,I0,!1),_(this,xc,!1),_(this,xo,!1),_(this,pr,null),_(this,Cf,0),_(this,Tf,0),_(this,Ps,null),Lt(this,"_initialOptions",Object.create(null)),Lt(this,"_isVisible",!0),Lt(this,"_uiManager",null),Lt(this,"_focusEventsAllowed",!0),Lt(this,"_l10nPromise",null),_(this,D0,!1),_(this,PE,ai._zIndex++),this.constructor===ai&&ee("Cannot initialize AnnotationEditor."),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=ai.prototype._resizeWithKeyboard,e=$p.TRANSLATE_SMALL,i=$p.TRANSLATE_BIG;return Ut(this,"_resizerKeyboardManager",new Lm([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],ai.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new j$({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e,i){if(ai._l10nPromise||(ai._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(r=>[r,t.get(r.replaceAll(/([A-Z])/g,a=>`-${a.toLowerCase()}`))]))),i!=null&&i.strings)for(const r of i.strings)ai._l10nPromise.set(r,t.get(r));if(ai._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ai._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){ee("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return u(this,D0)}set _isDraggable(t){var e;T(this,D0,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,PE)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):C(this,Xc,mp).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(u(this,qc)?T(this,qc,!1):this.parent.setSelected(this))}focusout(t){var e;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const i=t.relatedTarget;i!=null&&i.closest(`#${this.id}`)||(t.preventDefault(),(e=this.parent)!=null&&e.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/r,this.y=(e+s)/a,this.fixAndSetPosition()}translate(t,e){C(this,F0,LE).call(this,this.parentDimensions,t,e)}translateInPage(t,e){u(this,fr)||T(this,fr,[this.x,this.y]),C(this,F0,LE).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){u(this,fr)||T(this,fr,[this.x,this.y]);const[i,s]=this.parentDimensions;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:a}=this;const[o,l]=this.getBaseTranslation();r+=o,a+=l,this.div.style.left=`${(100*r).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!u(this,fr)&&(u(this,fr)[0]!==this.x||u(this,fr)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=ai,s=i/t,r=i/e;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:s,y:r,width:a,height:o}=this;if(a*=e,o*=i,s*=e,r*=i,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(e-a,s)),r=Math.max(0,Math.min(i-o,r));break;case 90:s=Math.max(0,Math.min(e-o,s)),r=Math.min(i,Math.max(a,r));break;case 180:s=Math.min(e,Math.max(a,s)),r=Math.min(i,Math.max(o,r));break;case 270:s=Math.min(e,Math.max(o,s)),r=Math.max(0,Math.min(i-a,r));break}this.x=s/=e,this.y=r/=i;const[l,c]=this.getBaseTranslation();s+=l,r+=c;const{style:h}=this.div;h.left=`${(100*s).toFixed(2)}%`,h.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return C(i=ai,gy,ME).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return C(i=ai,gy,ME).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this,s=e*t,r=i*t;return ls.isCSSRoundSupported?[Math.round(s),Math.round(r)]:[s,r]}setDims(t,e){const[i,s]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,u(this,Ec)||(this.div.style.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),r=!u(this,Ec)&&e.endsWith("%");if(s&&r)return;const[a,o]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!u(this,Ec)&&!r&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=u(this,Yi))==null||t.finish()}async addEditToolbar(){return u(this,Ni)||u(this,xc)?u(this,Ni):(T(this,Ni,new L$(this)),this.div.append(u(this,Ni).render()),u(this,Yi)&&u(this,Ni).addAltTextButton(await u(this,Yi).render()),u(this,Ni))}removeEditToolbar(){var t;u(this,Ni)&&(u(this,Ni).remove(),T(this,Ni,null),(t=u(this,Yi))==null||t.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){u(this,Yi)||(XC.initialize(ai._l10nPromise),T(this,Yi,new XC(this)),await this.addEditToolbar())}get altTextData(){var t;return(t=u(this,Yi))==null?void 0:t.data}set altTextData(t){u(this,Yi)&&(u(this,Yi).data=t)}hasAltText(){var t;return!((t=u(this,Yi))!=null&&t.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=u(this,xf)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",u(this,Sf)),this.div.addEventListener("focusout",u(this,kf));const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),cy(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=ls.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(T(this,qc,!0),this._isDraggable){C(this,NE,YM).call(this,t);return}C(this,vy,OE).call(this,t)}moveInDOM(){u(this,pr)&&clearTimeout(u(this,pr)),T(this,pr,setTimeout(()=>{var t;T(this,pr,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=t/s,h=e/s,f=this.x*r,p=this.y*a,g=this.width*r,m=this.height*a;switch(i){case 0:return[f+c+o,a-p-h-m+l,f+c+g+o,a-p-h+l];case 90:return[f+h+o,a-p+c+l,f+h+m+o,a-p+c+g+l];case 180:return[f-c-g+o,a-p+h+l,f-c+o,a-p+h+m+l];case 270:return[f-h-m+o,a-p-c-g+l,f-h+o,a-p-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,r,a]=t,o=r-i,l=a-s;switch(this.rotation){case 0:return[i,e-a,o,l];case 90:return[i,e-s,l,o];case 180:return[r,e-s,o,l];case 270:return[r,e-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){T(this,xc,!0)}disableEditMode(){T(this,xc,!1)}isInEditMode(){return u(this,xc)}shouldGetKeyboardEvents(){return u(this,xo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var t,e;(t=this.div)==null||t.addEventListener("focusin",u(this,Sf)),(e=this.div)==null||e.addEventListener("focusout",u(this,kf))}rotate(t){}serialize(t=!1,e=null){ee("An editor must be serializable")}static deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});s.rotation=t.rotation;const[r,a]=s.pageDimensions,[o,l,c,h]=s.getRectInCurrentCoords(t.rect,a);return s.x=o/r,s.y=l/a,s.width=c/r,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",u(this,Sf)),this.div.removeEventListener("focusout",u(this,kf)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),u(this,pr)&&(clearTimeout(u(this,pr)),T(this,pr,null)),C(this,Xc,mp).call(this),this.removeEditToolbar(),u(this,Ps)){for(const t of u(this,Ps).values())clearTimeout(t);T(this,Ps,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(C(this,IE,XM).call(this),u(this,Pi).classList.remove("hidden"),cy(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),T(this,Gc,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=u(this,Pi).children;if(!u(this,Pn)){T(this,Pn,Array.from(e));const a=C(this,jE,KM).bind(this),o=C(this,BE,QM).bind(this);for(const l of u(this,Pn)){const c=l.getAttribute("data-resizer-name");l.setAttribute("role","spinbutton"),l.addEventListener("keydown",a),l.addEventListener("blur",o),l.addEventListener("focus",C(this,WE,ZM).bind(this,c)),ai._l10nPromise.get(`pdfjs-editor-resizer-label-${c}`).then(h=>l.setAttribute("aria-label",h))}}const i=u(this,Pn)[0];let s=0;for(const a of e){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(u(this,Pn).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)u(this,Pi).append(u(this,Pi).firstChild);else if(r>s)for(let o=0;o<r-s;o++)u(this,Pi).firstChild.before(u(this,Pi).lastChild);let a=0;for(const o of e){const l=u(this,Pn)[a++].getAttribute("data-resizer-name");ai._l10nPromise.get(`pdfjs-editor-resizer-label-${l}`).then(c=>o.setAttribute("aria-label",c))}}C(this,by,HE).call(this,0),T(this,xo,!0),u(this,Pi).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){u(this,xo)&&C(this,my,FE).call(this,u(this,py),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){C(this,Xc,mp).call(this),this.div.focus()}select(){var t,e;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!u(this,Ni)){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=u(this,Ni))==null||s.show())});return}(e=u(this,Ni))==null||e.show()}unselect(){var t,e,i,s;(t=u(this,Pi))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=u(this,Ni))==null||s.hide()}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return u(this,I0)}set isEditing(t){T(this,I0,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){T(this,Ec,!0);const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){u(this,Ps)||T(this,Ps,new Map);const{action:i}=t;let s=u(this,Ps).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),u(this,Ps).delete(i),u(this,Ps).size===0&&T(this,Ps,null)},ai._telemetryTimeout),u(this,Ps).set(i,s);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),T(this,xf,!1)}disable(){this.div&&(this.div.tabIndex=-1),T(this,xf,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Pn=new WeakMap,Yi=new WeakMap,xf=new WeakMap,Ec=new WeakMap,Pi=new WeakMap,Gc=new WeakMap,Sf=new WeakMap,kf=new WeakMap,Ni=new WeakMap,py=new WeakMap,qc=new WeakMap,fr=new WeakMap,I0=new WeakMap,xc=new WeakMap,xo=new WeakMap,pr=new WeakMap,Cf=new WeakMap,Tf=new WeakMap,Ps=new WeakMap,D0=new WeakMap,PE=new WeakMap,F0=new WeakSet,LE=function([n,t],e,i){[e,i]=this.screenToPageTranslation(e,i),this.x+=e/n,this.y+=i/t,this.fixAndSetPosition()},gy=new WeakSet,ME=function(n,t,e){switch(e){case 90:return[t,-n];case 180:return[-n,-t];case 270:return[-t,n];default:return[n,t]}},O0=new WeakSet,$A=function(n){switch(n){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}},IE=new WeakSet,XM=function(){if(u(this,Pi))return;T(this,Pi,document.createElement("div")),u(this,Pi).classList.add("resizers");const n=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const t of n){const e=document.createElement("div");u(this,Pi).append(e),e.classList.add("resizer",t),e.setAttribute("data-resizer-name",t),e.addEventListener("pointerdown",C(this,DE,YC).bind(this,t)),e.addEventListener("contextmenu",os),e.tabIndex=-1}this.div.prepend(u(this,Pi))},DE=new WeakSet,YC=function(n,t){var e;t.preventDefault();const{isMac:i}=ls.platform;if(t.button!==0||t.ctrlKey&&i)return;(e=u(this,Yi))==null||e.toggle(!1);const s=C(this,my,FE).bind(this,n),r=this._isDraggable;this._isDraggable=!1;const a={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",s,a),window.addEventListener("contextmenu",os);const o=this.x,l=this.y,c=this.width,h=this.height,f=this.parent.div.style.cursor,p=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const g=()=>{var m;this.parent.togglePointerEvents(!0),(m=u(this,Yi))==null||m.toggle(!0),this._isDraggable=r,window.removeEventListener("pointerup",g),window.removeEventListener("blur",g),window.removeEventListener("pointermove",s,a),window.removeEventListener("contextmenu",os),this.parent.div.style.cursor=f,this.div.style.cursor=p,C(this,N0,UA).call(this,o,l,c,h)};window.addEventListener("pointerup",g),window.addEventListener("blur",g)},N0=new WeakSet,UA=function(n,t,e,i){const s=this.x,r=this.y,a=this.width,o=this.height;s===n&&r===t&&a===e&&o===i||this.addCommands({cmd:()=>{this.width=a,this.height=o,this.x=s,this.y=r;const[l,c]=this.parentDimensions;this.setDims(l*a,c*o),this.fixAndSetPosition()},undo:()=>{this.width=e,this.height=i,this.x=n,this.y=t;const[l,c]=this.parentDimensions;this.setDims(l*e,c*i),this.fixAndSetPosition()},mustExec:!0})},my=new WeakSet,FE=function(n,t){const[e,i]=this.parentDimensions,s=this.x,r=this.y,a=this.width,o=this.height,l=gr.MIN_SIZE/e,c=gr.MIN_SIZE/i,h=G=>Math.round(G*1e4)/1e4,f=C(this,O0,$A).call(this,this.rotation),p=(G,H)=>[f[0]*G+f[2]*H,f[1]*G+f[3]*H],g=C(this,O0,$A).call(this,360-this.rotation),m=(G,H)=>[g[0]*G+g[2]*H,g[1]*G+g[3]*H];let b,y,w=!1,x=!1;switch(n){case"topLeft":w=!0,b=(G,H)=>[0,0],y=(G,H)=>[G,H];break;case"topMiddle":b=(G,H)=>[G/2,0],y=(G,H)=>[G/2,H];break;case"topRight":w=!0,b=(G,H)=>[G,0],y=(G,H)=>[0,H];break;case"middleRight":x=!0,b=(G,H)=>[G,H/2],y=(G,H)=>[0,H/2];break;case"bottomRight":w=!0,b=(G,H)=>[G,H],y=(G,H)=>[0,0];break;case"bottomMiddle":b=(G,H)=>[G/2,H],y=(G,H)=>[G/2,0];break;case"bottomLeft":w=!0,b=(G,H)=>[0,H],y=(G,H)=>[G,0];break;case"middleLeft":x=!0,b=(G,H)=>[0,H/2],y=(G,H)=>[G,H/2];break}const R=b(a,o),I=y(a,o);let D=p(...I);const F=h(s+D[0]),O=h(r+D[1]);let L=1,M=1,[W,j]=this.screenToPageTranslation(t.movementX,t.movementY);if([W,j]=m(W/e,j/i),w){const G=Math.hypot(a,o);L=M=Math.max(Math.min(Math.hypot(I[0]-R[0]-W,I[1]-R[1]-j)/G,1/a,1/o),l/a,c/o)}else x?L=Math.max(l,Math.min(1,Math.abs(I[0]-R[0]-W)))/a:M=Math.max(c,Math.min(1,Math.abs(I[1]-R[1]-j)))/o;const V=h(a*L),z=h(o*M);D=p(...y(V,z));const Y=F-D[0],K=O-D[1];this.width=V,this.height=z,this.x=Y,this.y=K,this.setDims(e*V,i*z),this.fixAndSetPosition()},vy=new WeakSet,OE=function(n){const{isMac:t}=ls.platform;n.ctrlKey&&!t||n.shiftKey||n.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},NE=new WeakSet,YM=function(n){const t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let e,i;t&&(this.div.classList.add("moving"),e={passive:!0,capture:!0},T(this,Cf,n.clientX),T(this,Tf,n.clientY),i=r=>{const{clientX:a,clientY:o}=r,[l,c]=this.screenToPageTranslation(a-u(this,Cf),o-u(this,Tf));T(this,Cf,a),T(this,Tf,o),this._uiManager.dragSelectedEditors(l,c)},window.addEventListener("pointermove",i,e));const s=()=>{window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),t&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",i,e)),T(this,qc,!1),this._uiManager.endDragSession()||C(this,vy,OE).call(this,n)};window.addEventListener("pointerup",s),window.addEventListener("blur",s)},jE=new WeakSet,KM=function(n){gr._resizerKeyboardManager.exec(this,n)},BE=new WeakSet,QM=function(n){var t;u(this,xo)&&((t=n.relatedTarget)==null?void 0:t.parentNode)!==u(this,Pi)&&C(this,Xc,mp).call(this)},WE=new WeakSet,ZM=function(n){T(this,py,u(this,xo)?n:"")},by=new WeakSet,HE=function(n){if(u(this,Pn))for(const t of u(this,Pn))t.tabIndex=n},Xc=new WeakSet,mp=function(){if(T(this,xo,!1),C(this,by,HE).call(this,-1),u(this,Gc)){const{savedX:n,savedY:t,savedWidth:e,savedHeight:i}=u(this,Gc);C(this,N0,UA).call(this,n,t,e,i),T(this,Gc,null)}},_(gr,gy),Lt(gr,"_borderLineWidth",-1),Lt(gr,"_colorManager",new N$),Lt(gr,"_zIndex",1),Lt(gr,"_telemetryTimeout",1e3);let le=gr;class j$ extends le{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const KC=3285377520,Cs=4294901760,bn=65535;class JM{constructor(t){this.h1=t?t&4294967295:KC,this.h2=t?t&4294967295:KC}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let b=0,y=t.length;b<y;b++){const w=t.charCodeAt(b);w<=255?e[i++]=w:(e[i++]=w>>>8,e[i++]=w&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(e.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const f=3432918353,p=461845907,g=f&bn,m=p&bn;for(let b=0;b<s;b++)b&1?(o=a[b],o=o*f&Cs|o*g&bn,o=o<<15|o>>>17,o=o*p&Cs|o*m&bn,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[b],l=l*f&Cs|l*g&bn,l=l<<15|l>>>17,l=l*p&Cs|l*m&bn,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=e[s*4+2]<<16;case 2:o^=e[s*4+1]<<8;case 1:o^=e[s*4],o=o*f&Cs|o*g&bn,o=o<<15|o>>>17,o=o*p&Cs|o*m&bn,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Cs|t*36045&bn,e=e*4283543511&Cs|((e<<16|t>>>16)*2950163797&Cs)>>>16,t^=e>>>1,t=t*444984403&Cs|t*60499&bn,e=e*3301882366&Cs|((e<<16|t>>>16)*3120437893&Cs)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const $E=Object.freeze({map:null,hash:"",transfer:void 0});var fd,wi,UE,tI;class hk{constructor(){_(this,UE),_(this,fd,!1),_(this,wi,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=u(this,wi).get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return u(this,wi).get(t)}remove(t){if(u(this,wi).delete(t),u(this,wi).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of u(this,wi).values())if(e instanceof le)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=u(this,wi).get(t);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(e))i[r]!==a&&(s=!0,i[r]=a);else s=!0,u(this,wi).set(t,e);s&&C(this,UE,tI).call(this),e instanceof le&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return u(this,wi).has(t)}getAll(){return u(this,wi).size>0?ik(u(this,wi)):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return u(this,wi).size}resetModified(){u(this,fd)&&(T(this,fd,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new eI(this)}get serializable(){if(u(this,wi).size===0)return $E;const t=new Map,e=new JM,i=[],s=Object.create(null);let r=!1;for(const[a,o]of u(this,wi)){const l=o instanceof le?o.serialize(!1,s):o;l&&(t.set(a,l),e.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:$E}get editorStats(){let t=null;const e=new Map;for(const i of u(this,wi).values()){if(!(i instanceof le))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;e.has(r)||e.set(r,Object.getPrototypeOf(i).constructor),t||(t=Object.create(null));const a=t[r]||(t[r]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[i,s]of e)t[i]=s.computeTelemetryFinalData(t[i]);return t}}fd=new WeakMap,wi=new WeakMap,UE=new WeakSet,tI=function(){u(this,fd)||(T(this,fd,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var j0;class eI extends hk{constructor(t){super(),_(this,j0,void 0);const{map:e,hash:i,transfer:s}=t.serializable,r=structuredClone(e,s?{transfer:s}:null);T(this,j0,{map:r,hash:i,transfer:s})}get print(){ee("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,j0)}}j0=new WeakMap;var Rf;class B${constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){_(this,Rf,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),u(this,Rf).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||u(this,Rf).has(t.loadedName))){if(Ue(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:r}=t,a=new FontFace(i,s,r);this.addNativeFontFace(a);try{await a.load(),u(this,Rf).add(i),e==null||e(t)}catch{Ft(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}ee("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw Ft(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ut(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let t=!1;return(Fi||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Ut(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Ue(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ut(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(R,I){return R.charCodeAt(I)<<24|R.charCodeAt(I+1)<<16|R.charCodeAt(I+2)<<8|R.charCodeAt(I+3)&255}function s(R,I,D,F){const O=R.substring(0,I),L=R.substring(I+D);return O+F+L}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(R,I){if(++c>30){Ft("Load test font never loaded."),I();return}if(l.font="30px "+R,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(h.bind(null,R,I))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=s(p,976,f.length,f);const g=16,m=1482184792;let b=i(p,g);for(r=0,a=f.length-3;r<a;r+=4)b=b-m+i(f,r)|0;r<f.length&&(b=b-m+i(f+"XXX",r)|0),p=s(p,g,4,y$(b));const y=`url(data:font/opentype;base64,${btoa(p)});`,w=`@font-face {font-family:"${f}";src:${y}}`;this.insertRule(w);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const R of[t.loadedName,f]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=R,x.append(I)}this._document.body.append(x),h(f,()=>{x.remove(),e.complete()})}}Rf=new WeakMap;class W${constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=e===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var t;if(!this.data||this.disableFontFace)return null;const e=xM(this.data),i=`url(data:${this.mimetype};base64,${btoa(e)});`;let s;if(!this.cssFontInfo)s=`@font-face {font-family:"${this.loadedName}";src:${i}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${i}}`}return(t=this._inspectFont)==null||t.call(this,this,i),s}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(r){Ft(`getPathGenerator - ignoring character: "${r}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[e]=function(r,a){};const s=[];for(let r=0,a=i.length;r<a;)switch(i[r++]){case ar.BEZIER_CURVE_TO:{const[o,l,c,h,f,p]=i.slice(r,r+6);s.push(g=>g.bezierCurveTo(o,l,c,h,f,p)),r+=6}break;case ar.MOVE_TO:{const[o,l]=i.slice(r,r+2);s.push(c=>c.moveTo(o,l)),r+=2}break;case ar.LINE_TO:{const[o,l]=i.slice(r,r+2);s.push(c=>c.lineTo(o,l)),r+=2}break;case ar.QUADRATIC_CURVE_TO:{const[o,l,c,h]=i.slice(r,r+4);s.push(f=>f.quadraticCurveTo(o,l,c,h)),r+=4}break;case ar.RESTORE:s.push(o=>o.restore());break;case ar.SAVE:s.push(o=>o.save());break;case ar.SCALE:Ue(s.length===2,"Scale command is only valid at the third position.");break;case ar.TRANSFORM:{const[o,l,c,h,f,p]=i.slice(r,r+6);s.push(g=>g.transform(o,l,c,h,f,p)),r+=6}break;case ar.TRANSLATE:{const[o,l]=i.slice(r,r+2);s.push(c=>c.translate(o,l)),r+=2}break}return this.compiledGlyphs[e]=function(r,a){s[0](r),s[1](r),r.scale(a,-a);for(let o=2,l=s.length;o<l;o++)s[o](r)}}}if(Fi){var zE=Promise.withResolvers(),yy=null;(async()=>{const n=await _o(()=>import("./empty-GlqisfcO-CRMO4_-l.js"),[]),t=await _o(()=>import("./index-BIqdkLuE-3SvCF4Ss.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])).then(a=>a.i),e=await _o(()=>import("./index-DFn6bF3J-LEdMKbxg.js"),__vite__mapDeps([12,0,1,2,3,4,5,6,7,8,9,10,11])).then(a=>a.i),i=await _o(()=>import("./url-Dkx9cvHv-D4UJOJBe.js"),__vite__mapDeps([1,2,3,4,5,6,7,8,9,10,11])).then(a=>a.u);let s,r;return new Map(Object.entries({fs:n,http:t,https:e,url:i,canvas:s,path2d:r}))})().then(n=>{yy=n,zE.resolve()},n=>{Ft(`loadPackages: ${n}`),yy=new Map,zE.resolve()})}class er{static get promise(){return zE.promise}static get(t){return yy==null?void 0:yy.get(t)}}const iI=function(n){return er.get("fs").promises.readFile(n).then(t=>new Uint8Array(t))};class H$ extends Yw{}class $$ extends Kw{_createCanvas(t,e){return er.get("canvas").createCanvas(t,e)}}class U$ extends Qw{_fetchData(t,e){return iI(t).then(i=>({cMapData:i,compressionType:e}))}}class z$ extends Zw{_fetchData(t){return iI(t)}}const $i={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function VE(n,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),n.clip(s)}class Mm{constructor(){this.constructor===Mm&&ee("Cannot initialize BaseShadingPattern.")}getPattern(){ee("Abstract method `getPattern` called.")}}class V$ extends Mm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let r;if(s===$i.STROKE||s===$i.FILL){const a=e.current.getClippedPathBoundingBox(s,we(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,l,!0),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=ft.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),VE(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=t.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(i);r.setTransform(f)}else VE(t,this._bbox),r=this._createGradient(t);return r}}function zA(n,t,e,i,s,r,a,o){const l=t.coords,c=t.colors,h=n.data,f=n.width*4;let p;l[e+1]>l[i+1]&&(p=e,e=i,i=p,p=r,r=a,a=p),l[i+1]>l[s+1]&&(p=i,i=s,s=p,p=a,a=o,o=p),l[e+1]>l[i+1]&&(p=e,e=i,i=p,p=r,r=a,a=p);const g=(l[e]+t.offsetX)*t.scaleX,m=(l[e+1]+t.offsetY)*t.scaleY,b=(l[i]+t.offsetX)*t.scaleX,y=(l[i+1]+t.offsetY)*t.scaleY,w=(l[s]+t.offsetX)*t.scaleX,x=(l[s+1]+t.offsetY)*t.scaleY;if(m>=x)return;const R=c[r],I=c[r+1],D=c[r+2],F=c[a],O=c[a+1],L=c[a+2],M=c[o],W=c[o+1],j=c[o+2],V=Math.round(m),z=Math.round(x);let Y,K,G,H,Q,Z,yt,bt;for(let X=V;X<=z;X++){if(X<y){const st=X<m?0:(m-X)/(m-y);Y=g-(g-b)*st,K=R-(R-F)*st,G=I-(I-O)*st,H=D-(D-L)*st}else{let st;X>x?st=1:y===x?st=0:st=(y-X)/(y-x),Y=b-(b-w)*st,K=F-(F-M)*st,G=O-(O-W)*st,H=L-(L-j)*st}let nt;X<m?nt=0:X>x?nt=1:nt=(m-X)/(m-x),Q=g-(g-w)*nt,Z=R-(R-M)*nt,yt=I-(I-W)*nt,bt=D-(D-j)*nt;const ht=Math.round(Math.min(Y,Q)),lt=Math.round(Math.max(Y,Q));let ct=f*X+ht*4;for(let st=ht;st<=lt;st++)nt=(Y-st)/(Y-Q),nt<0?nt=0:nt>1&&(nt=1),h[ct++]=K-(K-Z)*nt|0,h[ct++]=G-(G-yt)*nt|0,h[ct++]=H-(H-bt)*nt|0,h[ct++]=255}}function G$(n,t,e){const i=t.coords,s=t.colors;let r,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let h=r*o;for(let f=0;f<c;f++,h++)zA(n,e,i[h],i[h+1],i[h+o],s[h],s[h+1],s[h+o]),zA(n,e,i[h+o+1],i[h+1],i[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)zA(n,e,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class q$ extends Mm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const s=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),a=Math.ceil(this._bounds[2])-s,o=Math.ceil(this._bounds[3])-r,l=Math.min(Math.ceil(Math.abs(a*t[0]*1.1)),3e3),c=Math.min(Math.ceil(Math.abs(o*t[1]*1.1)),3e3),h=a/l,f=o/c,p={coords:this._coords,colors:this._colors,offsetX:-s,offsetY:-r,scaleX:1/h,scaleY:1/f},g=l+2*2,m=c+2*2,b=i.getCanvas("mesh",g,m,!1),y=b.context,w=y.createImageData(l,c);if(e){const x=w.data;for(let R=0,I=x.length;R<I;R+=4)x[R]=e[0],x[R+1]=e[1],x[R+2]=e[2],x[R+3]=255}for(const x of this._figures)G$(w,x,p);return y.putImageData(w,2,2),{canvas:b.canvas,offsetX:s-2*h,offsetY:r-2*f,scaleX:h,scaleY:f}}getPattern(t,e,i,s){VE(t,this._bbox);let r;if(s===$i.SHADING)r=ft.singularValueDecompose2dScale(we(t));else if(r=ft.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=ft.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,s===$i.SHADING?null:this._background,e.cachedCanvases);return s!==$i.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class X$ extends Mm{getPattern(){return"hotpink"}}function Y$(n){switch(n[0]){case"RadialAxial":return new V$(n);case"Mesh":return new q$(n);case"Dummy":return new X$}throw new Error(`Unknown IR type: ${n[0]}`)}const QC={COLORED:1,UNCOLORED:2},sI=class nI{constructor(t,e,i,s,r){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t){const e=this.operatorList,i=this.bbox,s=this.xstep,r=this.ystep,a=this.paintType,o=this.tilingType,l=this.color,c=this.canvasGraphicsFactory;Gw("TilingType: "+o);const h=i[0],f=i[1],p=i[2],g=i[3],m=ft.singularValueDecompose2dScale(this.matrix),b=ft.singularValueDecompose2dScale(this.baseTransform),y=[m[0]*b[0],m[1]*b[1]],w=this.getSizeAndScale(s,this.ctx.canvas.width,y[0]),x=this.getSizeAndScale(r,this.ctx.canvas.height,y[1]),R=t.cachedCanvases.getCanvas("pattern",w.size,x.size,!0),I=R.context,D=c.createCanvasGraphics(I);D.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(D,a,l);let F=h,O=f,L=p,M=g;return h<0&&(F=0,L+=Math.abs(h)),f<0&&(O=0,M+=Math.abs(f)),I.translate(-(w.scale*F),-(x.scale*O)),D.transform(w.scale,0,0,x.scale,0,0),I.save(),this.clipBbox(D,F,O,L,M),D.baseTransform=we(D.ctx),D.executeOperatorList(e),D.endDrawing(),{canvas:R.canvas,scaleX:w.scale,scaleY:x.scale,offsetX:F,offsetY:O}}getSizeAndScale(t,e,i){t=Math.abs(t);const s=Math.max(nI.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*i);return r>=s?r=s:i=r/t,{scale:i,size:r}}clipBbox(t,e,i,s,r){const a=s-e,o=r-i;t.ctx.rect(e,i,a,o),t.current.updateRectMinMax(we(t.ctx),[e,i,s,r]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,r=t.current;switch(e){case QC.COLORED:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case QC.UNCOLORED:const o=ft.makeHexColor(i[0],i[1],i[2]);s.fillStyle=o,s.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new b$(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,s){let r=i;s!==$i.SHADING&&(r=ft.transform(r,e.baseTransform),this.matrix&&(r=ft.transform(r,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Lt(sI,"MAX_PATTERN_SIZE",3e3);let K$=sI;function Q$({src:n,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=ls.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,f=i&7,p=n.length;e=new Uint32Array(e.buffer);let g=0;for(let m=0;m<s;m++){for(const y=t+h;t<y;t++){const w=t<p?n[t]:255;e[g++]=w&128?c:l,e[g++]=w&64?c:l,e[g++]=w&32?c:l,e[g++]=w&16?c:l,e[g++]=w&8?c:l,e[g++]=w&4?c:l,e[g++]=w&2?c:l,e[g++]=w&1?c:l}if(f===0)continue;const b=t<p?n[t++]:255;for(let y=0;y<f;y++)e[g++]=b&1<<7-y?c:l}return{srcPos:t,destPos:g}}const ZC=16,JC=100,Z$=15,tT=10,eT=1e3,ts=16;function J$(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},n.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},n.transform=function(e,i,s,r,a,o){t.transform(e,i,s,r,a,o),this.__originalTransform(e,i,s,r,a,o)},n.setTransform=function(e,i,s,r,a,o){t.setTransform(e,i,s,r,a,o),this.__originalSetTransform(e,i,s,r,a,o)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},n.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},n.bezierCurveTo=function(e,i,s,r,a,o){t.bezierCurveTo(e,i,s,r,a,o),this.__originalBezierCurveTo(e,i,s,r,a,o)},n.rect=function(e,i,s,r){t.rect(e,i,s,r),this.__originalRect(e,i,s,r)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class tU{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Ym(n,t,e,i,s,r,a,o,l,c){const[h,f,p,g,m,b]=we(n);if(f===0&&p===0){const x=a*h+m,R=Math.round(x),I=o*g+b,D=Math.round(I),F=(a+l)*h+m,O=Math.abs(Math.round(F)-R)||1,L=(o+c)*g+b,M=Math.abs(Math.round(L)-D)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(g),R,D),n.drawImage(t,e,i,s,r,0,0,O,M),n.setTransform(h,f,p,g,m,b),[O,M]}if(h===0&&g===0){const x=o*p+m,R=Math.round(x),I=a*f+b,D=Math.round(I),F=(o+c)*p+m,O=Math.abs(Math.round(F)-R)||1,L=(a+l)*f+b,M=Math.abs(Math.round(L)-D)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,R,D),n.drawImage(t,e,i,s,r,0,0,M,O),n.setTransform(h,f,p,g,m,b),[M,O]}n.drawImage(t,e,i,s,r,a,o,l,c);const y=Math.hypot(h,f),w=Math.hypot(p,g);return[y*l,w*c]}function eU(n){const{width:t,height:e}=n;if(t>eT||e>eT)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=t+1;let a=new Uint8Array(r*(e+1)),o,l,c;const h=t+7&-8;let f=new Uint8Array(h*e),p=0;for(const y of n.data){let w=128;for(;w>0;)f[p++]=y&w?0:255,w>>=1}let g=0;for(p=0,f[p]!==0&&(a[0]=1,++g),l=1;l<t;l++)f[p]!==f[p+1]&&(a[l]=f[p]?2:1,++g),p++;for(f[p]!==0&&(a[l]=2,++g),o=1;o<e;o++){p=o*h,c=o*r,f[p-h]!==f[p]&&(a[c]=f[p]?1:8,++g);let y=(f[p]?4:0)+(f[p-h]?8:0);for(l=1;l<t;l++)y=(y>>2)+(f[p+1]?4:0)+(f[p-h+1]?8:0),s[y]&&(a[c+l]=s[y],++g),p++;if(f[p-h]!==f[p]&&(a[c+l]=f[p]?2:4,++g),g>i)return null}for(p=h*(e-1),c=o*r,f[p]!==0&&(a[c]=8,++g),l=1;l<t;l++)f[p]!==f[p+1]&&(a[c+l]=f[p]?4:8,++g),p++;if(f[p]!==0&&(a[c+l]=4,++g),g>i)return null;const m=new Int32Array([0,r,-1,0,-r,0,0,0,1]),b=new Path2D;for(o=0;g&&o<=e;o++){let y=o*r;const w=y+t;for(;y<w&&!a[y];)y++;if(y===w)continue;b.moveTo(y%r,o);const x=y;let R=a[y];do{const I=m[R];do y+=I;while(!a[y]);const D=a[y];D!==5&&D!==10?(R=D,a[y]=0):(R=D&51*R>>4,a[y]&=R>>2|R<<2),b.lineTo(y%r,y/r|0),a[y]||--g}while(x!==y);--o}return f=null,a=null,function(y){y.save(),y.scale(1/t,-1/e),y.translate(0,-e),y.fill(b),y.beginPath(),y.restore()}}class iT{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_M,this.textMatrixScale=1,this.fontMatrix=V_,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=bi.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=ft.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=ft.applyTransform(e,t),s=ft.applyTransform(e.slice(2),t),r=ft.applyTransform([e[0],e[3]],t),a=ft.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],s[0],r[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],r[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],r[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],r[1],a[1])}updateScalingPathMinMax(t,e){ft.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,s,r,a,o,l,c,h){const f=ft.bezierBoundingBox(e,i,s,r,a,o,l,c,h);h||this.updateRectMinMax(t,f)}getPathBoundingBox(t=$i.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===$i.STROKE){e||ee("Stroke bounding box must include transform.");const s=ft.singularValueDecompose2dScale(e),r=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=r,i[1]-=a,i[2]+=r,i[3]+=a}return i}updateClipFromPath(){const t=ft.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=$i.FILL,e=null){return ft.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function sT(n,t){if(typeof ImageData<"u"&&t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%ts,r=(e-s)/ts,a=s===0?r:r+1,o=n.createImageData(i,ts);let l=0,c;const h=t.data,f=o.data;let p,g,m,b;if(t.kind===Kv.GRAYSCALE_1BPP){const y=h.byteLength,w=new Uint32Array(f.buffer,0,f.byteLength>>2),x=w.length,R=i+7>>3,I=4294967295,D=ls.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(m=p<r?ts:s,c=0,g=0;g<m;g++){const F=y-l;let O=0;const L=F>R?i:F*8-7,M=L&-8;let W=0,j=0;for(;O<M;O+=8)j=h[l++],w[c++]=j&128?I:D,w[c++]=j&64?I:D,w[c++]=j&32?I:D,w[c++]=j&16?I:D,w[c++]=j&8?I:D,w[c++]=j&4?I:D,w[c++]=j&2?I:D,w[c++]=j&1?I:D;for(;O<L;O++)W===0&&(j=h[l++],W=128),w[c++]=j&W?I:D,W>>=1}for(;c<x;)w[c++]=0;n.putImageData(o,0,p*ts)}}else if(t.kind===Kv.RGBA_32BPP){for(g=0,b=i*ts*4,p=0;p<r;p++)f.set(h.subarray(l,l+b)),l+=b,n.putImageData(o,0,g),g+=ts;p<a&&(b=i*s*4,f.set(h.subarray(l,l+b)),n.putImageData(o,0,g))}else if(t.kind===Kv.RGB_24BPP)for(m=ts,b=i*m,p=0;p<a;p++){for(p>=r&&(m=s,b=i*m),c=0,g=b;g--;)f[c++]=h[l++],f[c++]=h[l++],f[c++]=h[l++],f[c++]=255;n.putImageData(o,0,p*ts)}else throw new Error(`bad image kind: ${t.kind}`)}function nT(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%ts,r=(e-s)/ts,a=s===0?r:r+1,o=n.createImageData(i,ts);let l=0;const c=t.data,h=o.data;for(let f=0;f<a;f++){const p=f<r?ts:s;({srcPos:l}=Q$({src:c,srcPos:l,dest:h,width:i,height:p,nonBlackColor:0})),n.putImageData(o,0,f*ts)}}function ju(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)n[i]!==void 0&&(t[i]=n[i]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function Km(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Fi){const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}}function rT(n,t){if(t)return!0;const e=ft.singularValueDecompose2dScale(n);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*ku.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const iU=["butt","round","square"],sU=["miter","round","bevel"],nU={},aT={};var B0,GE,W0,qE;const rU=class rI{constructor(t,e,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},l,c){_(this,B0),_(this,W0),this.ctx=t,this.current=new iT(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new tU(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...we(this.compositeCtx))}this.ctx.save(),Km(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=we(this.ctx)}executeOperatorList(t,e,i,s){const r=t.argsArray,a=t.fnArray;let o=e||0;const l=r.length;if(l===o)return o;const c=l-o>tT&&typeof i=="function",h=c?Date.now()+Z$:0;let f=0;const p=this.commonObjs,g=this.objs;let m;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(m=a[o],m!==Zs.dependency)this[m].apply(this,r[o]);else for(const b of r[o]){const y=b.startsWith("g_")?p:g;if(!y.has(b))return y.get(b,i),o}if(o++,o===l)return o;if(c&&++f>tT){if(Date.now()>h)return i(),o;f=0}}}endDrawing(){C(this,B0,GE).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),C(this,W0,qE).call(this)}_scaleImage(t,e){const i=t.width,s=t.height;let r=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,l=s,c="prescale1",h,f;for(;r>2&&o>1||a>2&&l>1;){let p=o,g=l;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/g),h=this.cachedCanvases.getCanvas(c,p,g),f=h.context,f.clearRect(0,0,p,g),f.drawImage(t,0,0,o,l,0,0,p,g),t=h.canvas,o=p,l=g,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:s}=t,r=this.current.fillColor,a=this.current.patternFill,o=we(e);let l,c,h,f;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(L),l||(l=new Map,this._cachedBitmapsMap.set(L,l));const M=l.get(c);if(M&&!a){const W=Math.round(Math.min(o[0],o[2])+o[4]),j=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:M,offsetX:W,offsetY:j}}h=M}h||(f=this.cachedCanvases.getCanvas("maskCanvas",i,s),nT(f.context,t));let p=ft.transform(o,[1/i,0,0,-1/s,0,0]);p=ft.transform(p,[1,0,0,1,0,-s]);const[g,m,b,y]=ft.getAxialAlignedBoundingBox([0,0,i,s],p),w=Math.round(b-g)||1,x=Math.round(y-m)||1,R=this.cachedCanvases.getCanvas("fillCanvas",w,x),I=R.context,D=g,F=m;I.translate(-D,-F),I.transform(...p),h||(h=this._scaleImage(f.canvas,or(I)),h=h.img,l&&a&&l.set(c,h)),I.imageSmoothingEnabled=rT(we(I),t.interpolate),Ym(I,h,0,0,h.width,h.height,0,0,i,s),I.globalCompositeOperation="source-in";const O=ft.transform(or(I),[1,0,0,1,-D,-F]);return I.fillStyle=a?r.getPattern(e,this,O,$i.FILL):r,I.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,R.canvas)),{canvas:R.canvas,offsetX:Math.round(D),offsetY:Math.round(F)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=iU[t]}setLineJoin(t){this.ctx.lineJoin=sU[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=s.context;const r=this.ctx;r.setTransform(...we(this.suspendedCtx)),ju(this.suspendedCtx,r),J$(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ju(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const r=s[0],a=s[1],o=s[2]-r,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(e.context,i,o,l,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,r,a,o,l,c,h,f){let p=t.canvas,g=l-h,m=c-f;if(a){if(g<0||m<0||g+i>p.width||m+s>p.height){const y=this.cachedCanvases.getCanvas("maskExtension",i,s),w=y.context;w.drawImage(p,-g,-m),a.some(x=>x!==0)&&(w.globalCompositeOperation="destination-atop",w.fillStyle=ft.makeHexColor(...a),w.fillRect(0,0,i,s),w.globalCompositeOperation="source-over"),p=y.canvas,g=m=0}else if(a.some(y=>y!==0)){t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(g,m,i,s),t.clip(y),t.globalCompositeOperation="destination-atop",t.fillStyle=ft.makeHexColor(...a),t.fillRect(g,m,i,s),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(l,c,i,s),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(p,g,m,i,s,l,c,i,s),e.restore()}save(){this.inSMaskMode?(ju(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),ju(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,s,r,a){this.ctx.transform(t,e,i,s,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const s=this.ctx,r=this.current;let a=r.x,o=r.y,l,c;const h=we(s),f=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=f?i.slice(0):null;for(let g=0,m=0,b=t.length;g<b;g++)switch(t[g]|0){case Zs.rectangle:a=e[m++],o=e[m++];const y=e[m++],w=e[m++],x=a+y,R=o+w;s.moveTo(a,o),y===0||w===0?s.lineTo(x,R):(s.lineTo(x,o),s.lineTo(x,R),s.lineTo(a,R)),f||r.updateRectMinMax(h,[a,o,x,R]),s.closePath();break;case Zs.moveTo:a=e[m++],o=e[m++],s.moveTo(a,o),f||r.updatePathMinMax(h,a,o);break;case Zs.lineTo:a=e[m++],o=e[m++],s.lineTo(a,o),f||r.updatePathMinMax(h,a,o);break;case Zs.curveTo:l=a,c=o,a=e[m+4],o=e[m+5],s.bezierCurveTo(e[m],e[m+1],e[m+2],e[m+3],a,o),r.updateCurvePathMinMax(h,l,c,e[m],e[m+1],e[m+2],e[m+3],a,o,p),m+=6;break;case Zs.curveTo2:l=a,c=o,s.bezierCurveTo(a,o,e[m],e[m+1],e[m+2],e[m+3]),r.updateCurvePathMinMax(h,l,c,a,o,e[m],e[m+1],e[m+2],e[m+3],p),a=e[m+2],o=e[m+3],m+=4;break;case Zs.curveTo3:l=a,c=o,a=e[m+2],o=e[m+3],s.bezierCurveTo(e[m],e[m+1],a,o,a,o),r.updateCurvePathMinMax(h,l,c,e[m],e[m+1],a,o,a,o,p),m+=4;break;case Zs.closePath:s.closePath();break}f&&r.updateScalingPathMinMax(h,p),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i!=null&&i.getPattern?(e.save(),e.strokeStyle=i.getPattern(e,this,or(e),$i.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let r=!1;s&&(e.save(),e.fillStyle=i.getPattern(e,this,or(e),$i.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),r&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=nU}eoClip(){this.pendingClip=aT}beginText(){this.current.textMatrix=_M,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var i;const s=this.commonObjs.get(t),r=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=s.fontMatrix||V_,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ft("Invalid font matrix for font "+t),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=e,s.isType3Font)return;const a=s.loadedName||"sans-serif",o=((i=s.systemFontInfo)==null?void 0:i.css)||`"${a}", ${s.fallbackName}`;let l="normal";s.black?l="900":s.bold&&(l="bold");const c=s.italic?"italic":"normal";let h=e;e<ZC?h=ZC:e>JC&&(h=JC),this.current.fontSizeScale=e/h,this.ctx.font=`${c} ${l} ${h}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,s,r,a){this.current.textMatrix=[t,e,i,s,r,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,s){const r=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,h=l&bi.FILL_STROKE_MASK,f=!!(l&bi.ADD_TO_PATH_FLAG),p=a.patternFill&&!o.missingFile;let g;(o.disableFontFace||f||p)&&(g=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||p?(r.save(),r.translate(e,i),r.beginPath(),g(r,c),s&&r.setTransform(...s),(h===bi.FILL||h===bi.FILL_STROKE)&&r.fill(),(h===bi.STROKE||h===bi.FILL_STROKE)&&r.stroke(),r.restore()):((h===bi.FILL||h===bi.FILL_STROKE)&&r.fillText(t,e,i),(h===bi.STROKE||h===bi.FILL_STROKE)&&r.strokeText(t,e,i)),f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:we(r),x:e,y:i,fontSize:c,addToPath:g})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return Ut(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(s===0)return;const r=this.ctx,a=e.fontSizeScale,o=e.charSpacing,l=e.wordSpacing,c=e.fontDirection,h=e.textHScale*c,f=t.length,p=i.vertical,g=p?1:-1,m=i.defaultVMetrics,b=s*e.fontMatrix[0],y=e.textRenderingMode===bi.FILL&&!i.disableFontFace&&!e.patternFill;r.save(),r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),c>0?r.scale(h,-1):r.scale(h,1);let w;if(e.patternFill){r.save();const F=e.fillColor.getPattern(r,this,or(r),$i.FILL);w=we(r),r.restore(),r.fillStyle=F}let x=e.lineWidth;const R=e.textMatrixScale;if(R===0||x===0){const F=e.textRenderingMode&bi.FILL_STROKE_MASK;(F===bi.STROKE||F===bi.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=R;if(a!==1&&(r.scale(a,a),x/=a),r.lineWidth=x,i.isInvalidPDFjsFont){const F=[];let O=0;for(const L of t)F.push(L.unicode),O+=L.width;r.fillText(F.join(""),0,0),e.x+=O*b*h,r.restore(),this.compose();return}let I=0,D;for(D=0;D<f;++D){const F=t[D];if(typeof F=="number"){I+=g*F*s/1e3;continue}let O=!1;const L=(F.isSpace?l:0)+o,M=F.fontChar,W=F.accent;let j,V,z=F.width;if(p){const K=F.vmetric||m,G=-(F.vmetric?K[1]:z*.5)*b,H=K[2]*b;z=K?-K[0]:z,j=G/a,V=(I+H)/a}else j=I/a,V=0;if(i.remeasure&&z>0){const K=r.measureText(M).width*1e3/s*a;if(z<K&&this.isFontSubpixelAAEnabled){const G=z/K;O=!0,r.save(),r.scale(G,1),j/=G}else z!==K&&(j+=(z-K)/2e3*s/a)}if(this.contentVisible&&(F.isInFont||i.missingFile)){if(y&&!W)r.fillText(M,j,V);else if(this.paintChar(M,j,V,w),W){const K=j+s*W.offset.x/a,G=V-s*W.offset.y/a;this.paintChar(W.fontChar,K,G,w)}}const Y=p?z*b-L*c:z*b+L*c;I+=Y,O&&r.restore()}p?e.y-=I:e.x+=I*h,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,s=i.font,r=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*a,f=i.fontMatrix||V_,p=t.length,g=i.textRenderingMode===bi.INVISIBLE;let m,b,y,w;if(!(g||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(h,a),m=0;m<p;++m){if(b=t[m],typeof b=="number"){w=o*b*r/1e3,this.ctx.translate(w,0),i.x+=w*h;continue}const x=(b.isSpace?c:0)+l,R=s.charProcOperatorList[b.operatorListId];if(!R){Ft(`Type3 character "${b.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=b,this.save(),e.scale(r,r),e.transform(...f),this.executeOperatorList(R),this.restore()),y=ft.applyTransform([b.width,0],f)[0]*r+x,e.translate(y,0),i.x+=y*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,s,r,a){this.ctx.rect(i,s,r-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=t[1],s=this.baseTransform||we(this.ctx),r={createCanvasGraphics:a=>new rI(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new K$(t,i,this.ctx,r,s)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){const s=ft.makeHexColor(t,e,i);this.ctx.strokeStyle=s,this.current.strokeColor=s}setFillRGBColor(t,e,i){const s=ft.makeHexColor(t,e,i);this.ctx.fillStyle=s,this.current.fillColor=s,this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=Y$(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,or(e),$i.SHADING);const s=or(e);if(s){const{width:r,height:a}=e.canvas,[o,l,c,h]=ft.getAxialAlignedBoundingBox([0,0,r,a],s);this.ctx.fillRect(o,l,c-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ee("Should not call beginInlineImage")}beginImageData(){ee("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=we(this.ctx),e)){const i=e[2]-e[0],s=e[3]-e[1];this.ctx.rect(e[0],e[1],i,s),this.current.updateRectMinMax(we(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Gw("TODO: Support non-isolated groups."),t.knockout&&Ft("Knockout groups not supported.");const i=we(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=ft.getAxialAlignedBoundingBox(t.bbox,we(e));const r=[0,0,e.canvas.width,e.canvas.height];s=ft.intersect(s,r)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,l,c),p=f.context;p.translate(-a,-o),p.transform(...i),t.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),ju(e,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=we(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=ft.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(t,e,i,s,r){if(C(this,B0,GE).call(this),Km(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=o;const[l,c]=ft.singularValueDecompose2dScale(we(this.ctx)),{viewportScale:h}=this,f=Math.ceil(a*this.outputScaleX*h),p=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:g,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),Km(this.ctx)}else Km(this.ctx),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.endPath()}this.current=new iT(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),C(this,W0,qE).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=eU(t)),s.compiled)){s.compiled(i);return}const r=this._createMaskCanvas(t),a=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,s=0,r,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const l=we(o);o.transform(e,i,s,r,0,0);const c=this._createMaskCanvas(t);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,f=a.length;h<f;h+=2){const p=ft.transform(l,[e,i,s,r,a[h],a[h+1]]),[g,m]=ft.applyTransform([0,0],p);o.drawImage(c.canvas,g,m)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of t){const{data:a,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=h.context;f.save();const p=this.getObject(a,r);nT(f,p),f.globalCompositeOperation="source-in",f.fillStyle=s?i.getPattern(f,this,or(e),$i.FILL):i,f.fillRect(0,0,o,l),f.restore(),e.save(),e.transform(...c),e.scale(1,-1),Ym(e,h.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Ft("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,s){if(!this.contentVisible)return;const r=this.getObject(t);if(!r){Ft("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let c=0,h=s.length;c<h;c+=2)l.push({transform:[e,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,s=this.ctx;if(this.save(),!Fi){const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/e,-1/i);let r;if(t.bitmap)r=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)r=t;else{const o=this.cachedCanvases.getCanvas("inlineImage",e,i).context;sT(o,t),r=this.applyTransferMapsToCanvas(o)}const a=this._scaleImage(r,or(s));s.imageSmoothingEnabled=rT(we(s),t.interpolate),Ym(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const r=t.width,a=t.height,o=this.cachedCanvases.getCanvas("inlineImage",r,a).context;sT(o,t),s=this.applyTransferMapsToCanvas(o)}for(const r of e)i.save(),i.transform(...r.transform),i.scale(1,-1),Ym(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===aT?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=we(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(e),c=Math.abs(r);if(l===c)if(t===0)a=o=1/l;else{const h=l*t;a=o=h<1?1/h:1}else if(t===0)a=1/l,o=1/c;else{const h=l*t,f=c*t;a=h<1?1/h:1,o=f<1?1/f:1}}else{const l=Math.abs(e*r-i*s),c=Math.hypot(e,i),h=Math.hypot(s,r);if(t===0)a=h/l,o=c/l;else{const f=t*l;a=h>f?h/f:1,o=c>f?c/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[s,r]=this.getScaleForStroking();if(e.lineWidth=i||1,s===1&&r===1){e.stroke();return}const a=e.getLineDash();if(t&&e.save(),e.scale(s,r),a.length>0){const o=Math.max(s,r);e.setLineDash(a.map(l=>l/o)),e.lineDashOffset/=o}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};B0=new WeakSet,GE=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},W0=new WeakSet,qE=function(){if(this.pageColors){const n=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(n!=="none"){const t=this.ctx.filter;this.ctx.filter=n,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}};let H0=rU;for(const n in Zs)H0.prototype[n]!==void 0&&(H0.prototype[Zs[n]]=H0.prototype[n]);var wy,Ay;class Co{static get workerPort(){return u(this,wy)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");T(this,wy,t)}static get workerSrc(){return u(this,Ay)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");T(this,Ay,t)}}wy=new WeakMap,Ay=new WeakMap,_(Co,wy,null),_(Co,Ay,"");const Qm={UNKNOWN:0,DATA:1,ERROR:2},Pe={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ps(n){switch(n instanceof Error||typeof n=="object"&&n!==null||ee('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Vh(n.message);case"MissingPDFException":return new zh(n.message);case"PasswordException":return new q_(n.message,n.code);case"UnexpectedResponseException":return new qw(n.message,n.status);case"UnknownErrorException":return new X_(n.message,n.details);default:return new X_(n.message,n.toString())}}var XE,aI,YE,oI,Pf,Zm;class Lf{constructor(t,e,i){_(this,XE),_(this,YE),_(this,Pf),this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=s=>{const r=s.data;if(r.targetName!==this.sourceName)return;if(r.stream){C(this,YE,oI).call(this,r);return}if(r.callback){const o=r.callbackId,l=this.callbackCapabilities[o];if(!l)throw new Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],r.callback===Qm.DATA)l.resolve(r.data);else if(r.callback===Qm.ERROR)l.reject(ps(r.reason));else throw new Error("Unexpected callback case");return}const a=this.actionHandler[r.action];if(!a)throw new Error(`Unknown action from worker: ${r.action}`);if(r.callbackId){const o=this.sourceName,l=r.sourceName;new Promise(function(c){c(a(r.data))}).then(function(c){i.postMessage({sourceName:o,targetName:l,callback:Qm.DATA,callbackId:r.callbackId,data:c})},function(c){i.postMessage({sourceName:o,targetName:l,callback:Qm.ERROR,callbackId:r.callbackId,reason:ps(c)})});return}if(r.streamId){C(this,XE,aI).call(this,r);return}a(r.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(t,e,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:t,streamId:r,data:e,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:Pe.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{Ue(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Pe.CANCEL,streamId:r,reason:ps(c)}),h.promise}},i)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}XE=new WeakSet,aI=function(n){const t=n.streamId,e=this.sourceName,i=n.sourceName,s=this.comObj,r=this,a=this.actionHandler[n.action],o={enqueue(l,c=1,h){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=c,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:e,targetName:i,stream:Pe.ENQUEUE,streamId:t,chunk:l},h)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:e,targetName:i,stream:Pe.CLOSE,streamId:t}),delete r.streamSinks[t])},error(l){Ue(l instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:e,targetName:i,stream:Pe.ERROR,streamId:t,reason:ps(l)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:n.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[t]=o,new Promise(function(l){l(a(n.data,o))}).then(function(){s.postMessage({sourceName:e,targetName:i,stream:Pe.START_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:e,targetName:i,stream:Pe.START_COMPLETE,streamId:t,reason:ps(l)})})},YE=new WeakSet,oI=function(n){const t=n.streamId,e=this.sourceName,i=n.sourceName,s=this.comObj,r=this.streamControllers[t],a=this.streamSinks[t];switch(n.stream){case Pe.START_COMPLETE:n.success?r.startCall.resolve():r.startCall.reject(ps(n.reason));break;case Pe.PULL_COMPLETE:n.success?r.pullCall.resolve():r.pullCall.reject(ps(n.reason));break;case Pe.PULL:if(!a){s.postMessage({sourceName:e,targetName:i,stream:Pe.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&n.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=n.desiredSize,new Promise(function(o){var l;o((l=a.onPull)==null?void 0:l.call(a))}).then(function(){s.postMessage({sourceName:e,targetName:i,stream:Pe.PULL_COMPLETE,streamId:t,success:!0})},function(o){s.postMessage({sourceName:e,targetName:i,stream:Pe.PULL_COMPLETE,streamId:t,reason:ps(o)})});break;case Pe.ENQUEUE:if(Ue(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(n.chunk);break;case Pe.CLOSE:if(Ue(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),C(this,Pf,Zm).call(this,r,t);break;case Pe.ERROR:Ue(r,"error should have stream controller"),r.controller.error(ps(n.reason)),C(this,Pf,Zm).call(this,r,t);break;case Pe.CANCEL_COMPLETE:n.success?r.cancelCall.resolve():r.cancelCall.reject(ps(n.reason)),C(this,Pf,Zm).call(this,r,t);break;case Pe.CANCEL:if(!a)break;new Promise(function(o){var l;o((l=a.onCancel)==null?void 0:l.call(a,ps(n.reason)))}).then(function(){s.postMessage({sourceName:e,targetName:i,stream:Pe.CANCEL_COMPLETE,streamId:t,success:!0})},function(o){s.postMessage({sourceName:e,targetName:i,stream:Pe.CANCEL_COMPLETE,streamId:t,reason:ps(o)})}),a.sinkCapability.reject(ps(n.reason)),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Pf=new WeakSet,Zm=async function(n,t){var e,i,s;await Promise.allSettled([(e=n.startCall)==null?void 0:e.promise,(i=n.pullCall)==null?void 0:i.promise,(s=n.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var Sc,$0;class aU{constructor({parsedData:t,rawData:e}){_(this,Sc,void 0),_(this,$0,void 0),T(this,Sc,t),T(this,$0,e)}getRaw(){return u(this,$0)}get(t){return u(this,Sc).get(t)??null}getAll(){return ik(u(this,Sc))}has(t){return u(this,Sc).has(t)}}Sc=new WeakMap,$0=new WeakMap;const Pa=Symbol("INTERNAL");var U0,z0,V0,Mf;class oU{constructor(t,{name:e,intent:i,usage:s}){_(this,U0,!1),_(this,z0,!1),_(this,V0,!1),_(this,Mf,!0),T(this,U0,!!(t&Bs.DISPLAY)),T(this,z0,!!(t&Bs.PRINT)),this.name=e,this.intent=i,this.usage=s}get visible(){if(u(this,V0))return u(this,Mf);if(!u(this,Mf))return!1;const{print:t,view:e}=this.usage;return u(this,U0)?(e==null?void 0:e.viewState)!=="OFF":u(this,z0)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,i=!1){t!==Pa&&ee("Internal method `_setVisible` called."),T(this,V0,i),T(this,Mf,e)}}U0=new WeakMap,z0=new WeakMap,V0=new WeakMap,Mf=new WeakMap;var Xo,re,If,Df,_y,KE;class lU{constructor(t,e=Bs.DISPLAY){if(_(this,_y),_(this,Xo,null),_(this,re,new Map),_(this,If,null),_(this,Df,null),this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,T(this,Df,t.order);for(const i of t.groups)u(this,re).set(i.id,new oU(e,i));if(t.baseState==="OFF")for(const i of u(this,re).values())i._setVisible(Pa,!1);for(const i of t.on)u(this,re).get(i)._setVisible(Pa,!0);for(const i of t.off)u(this,re).get(i)._setVisible(Pa,!1);T(this,If,this.getHash())}}isVisible(t){if(u(this,re).size===0)return!0;if(!t)return Gw("Optional content group not defined."),!0;if(t.type==="OCG")return u(this,re).has(t.id)?u(this,re).get(t.id).visible:(Ft(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return C(this,_y,KE).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!u(this,re).has(e))return Ft(`Optional content group not found: ${e}`),!0;if(u(this,re).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!u(this,re).has(e))return Ft(`Optional content group not found: ${e}`),!0;if(!u(this,re).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!u(this,re).has(e))return Ft(`Optional content group not found: ${e}`),!0;if(!u(this,re).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!u(this,re).has(e))return Ft(`Optional content group not found: ${e}`),!0;if(u(this,re).get(e).visible)return!1}return!0}return Ft(`Unknown optional content policy ${t.policy}.`),!0}return Ft(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0){const i=u(this,re).get(t);if(!i){Ft(`Optional content group not found: ${t}`);return}i._setVisible(Pa,!!e,!0),T(this,Xo,null)}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=u(this,re).get(s);if(r)switch(i){case"ON":r._setVisible(Pa,!0);break;case"OFF":r._setVisible(Pa,!1);break;case"Toggle":r._setVisible(Pa,!r.visible);break}}T(this,Xo,null)}get hasInitialVisibility(){return u(this,If)===null||this.getHash()===u(this,If)}getOrder(){return u(this,re).size?u(this,Df)?u(this,Df).slice():[...u(this,re).keys()]:null}getGroups(){return u(this,re).size>0?ik(u(this,re)):null}getGroup(t){return u(this,re).get(t)||null}getHash(){if(u(this,Xo)!==null)return u(this,Xo);const t=new JM;for(const[e,i]of u(this,re))t.update(`${e}:${i.visible}`);return T(this,Xo,t.hexdigest())}}Xo=new WeakMap,re=new WeakMap,If=new WeakMap,Df=new WeakMap,_y=new WeakSet,KE=function(n){const t=n.length;if(t<2)return!0;const e=n[0];for(let i=1;i<t;i++){const s=n[i];let r;if(Array.isArray(s))r=C(this,_y,KE).call(this,s);else if(u(this,re).has(s))r=u(this,re).get(s).visible;else return Ft(`Optional content group not found: ${s}`),!0;switch(e){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return e==="And"};class hU{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Ue(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(i),!0)});Ue(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,i,s,r;t.total===void 0?(i=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||i.call(e,{loaded:t.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ue(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new cU(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new dU(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class cU{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=ok(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class dU{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function uU(n){let t=!0,e=i("filename\\*","i").exec(n);if(e){e=e[1];let h=o(e);return h=unescape(h),h=l(h),h=c(h),r(h)}if(e=a(n),e){const h=c(e);return r(h)}if(e=i("filename","i").exec(n),e){e=e[1];let h=o(e);return h=c(h),r(h)}function i(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(h,{fatal:!0}),g=Xw(f);f=p.decode(g),t=!1}catch{}}return f}function r(h){return t&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),t&&(h=s("iso-8859-1",h))),h}function a(h){const f=[];let p;const g=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=g.exec(h))!==null;){let[,b,y,w]=p;if(b=parseInt(b,10),b in f){if(b===0)break;continue}f[b]=[y,w]}const m=[];for(let b=0;b<f.length&&b in f;++b){let[y,w]=f[b];w=o(w),y&&(w=unescape(w),b===0&&(w=l(w))),m.push(w)}return m.join("")}function o(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let p=0;p<f.length;++p){const g=f[p].indexOf('"');g!==-1&&(f[p]=f[p].slice(0,g),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function l(h){const f=h.indexOf("'");if(f===-1)return h;const p=h.slice(0,f),g=h.slice(f+1).replace(/^[^']*'/,"");return s(p,g)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,g,m){if(g==="q"||g==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,y){return String.fromCharCode(parseInt(y,16))}),s(p,m);try{m=atob(m)}catch{}return s(p,m)})}return""}function ck({getResponseHeader:n,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*e)||i||!t||n("Accept-Ranges")!=="bytes"||(n("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function dk(n){const t=n("Content-Disposition");if(t){let e=uU(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(ok(e))return e}return null}function tA(n,t){return n===404||n===0&&t.startsWith("file:")?new zh('Missing PDF "'+t+'".'):new qw(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n)}function lI(n){return n===200||n===206}function hI(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function cI(n){const t=new Headers;for(const e in n){const i=n[e];i!==void 0&&t.append(e,i)}return t}function dI(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ft(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class oT{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ue(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new fU(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new pU(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class fU{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._headers=cI(this._stream.httpHeaders);const i=e.url;fetch(i,hI(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!lI(s.status))throw tA(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const r=l=>s.headers.get(l),{allowRangeRequests:a,suggestedLength:o}=ck({getResponseHeader:r,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=dk(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Vh("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;await this._headersCapability.promise;const{value:e,done:i}=await this._reader.read();return i?{value:e,done:i}:(this._loaded+=e.byteLength,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded,total:this._contentLength}),{value:dI(e),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class pU{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController,this._headers=cI(this._stream.httpHeaders),this._headers.append("Range",`bytes=${e}-${i-1}`);const r=s.url;fetch(r,hI(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!lI(a.status))throw tA(a.status,r);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;await this._readCapability.promise;const{value:e,done:i}=await this._reader.read();return i?{value:e,done:i}:(this._loaded+=e.byteLength,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded}),{value:dI(e),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const VA=200,GA=206;function gU(n){const t=n.response;return typeof t!="string"?t:Xw(t).buffer}class mU{constructor(t,e={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const s={begin:t,end:e};for(const r in i)s[r]=i[r];return this.request(s)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const r in this.httpHeaders){const a=this.httpHeaders[r];a!==void 0&&e.setRequestHeader(r,a)}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=GA):s.expectedStatus=VA,e.responseType="arraybuffer",t.onError&&(e.onerror=function(r){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){var i;const s=this.pendingRequests[t];s&&((i=s.onProgress)==null||i.call(s,e))}onStateChange(t,e){var i,s,r;const a=this.pendingRequests[t];if(!a)return;const o=a.xhr;if(o.readyState>=2&&a.onHeadersReceived&&(a.onHeadersReceived(),delete a.onHeadersReceived),o.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],o.status===0&&this.isHttp){(i=a.onError)==null||i.call(a,o.status);return}const l=o.status||VA;if(!(l===VA&&a.expectedStatus===GA)&&l!==a.expectedStatus){(s=a.onError)==null||s.call(a,o.status);return}const c=gU(o);if(l===GA){const h=o.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);a.onDone({begin:parseInt(f[1],10),chunk:c})}else c?a.onDone({begin:0,chunk:c}):(r=a.onError)==null||r.call(a,o.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class vU{constructor(t){this._source=t,this._manager=new mU(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ue(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new bU(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new yU(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class bU{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=a=>e.getResponseHeader(a),{allowRangeRequests:s,suggestedLength:r}=ck({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=dk(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=tA(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class yU{constructor(t,e,i){this._manager=t;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=tA(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const uI=/^file:\/\/\/[a-zA-Z]:\//;function wU(n){const t=er.get("url"),e=t.parse(n);return e.protocol==="file:"||e.host?e:/^[a-z]:[/\\]/i.test(n)?t.parse(`file:///${n}`):(e.host||(e.protocol="file:"),e)}class AU{constructor(t){this.source=t,this.url=wU(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ue(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new xU(this):new _U(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new SU(this,t,e):new EU(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class fI{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Vh("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class pI{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Ey(n,t){return{protocol:n.protocol,auth:n.auth,host:n.hostname,port:n.port,path:n.path,method:"GET",headers:t}}class _U extends fI{constructor(t){super(t);const e=i=>{if(i.statusCode===404){const o=new zh(`Missing PDF "${this._url}".`);this._storedError=o,this._headersCapability.reject(o);return}this._headersCapability.resolve(),this._setReadableStream(i);const s=o=>this._readableStream.headers[o.toLowerCase()],{allowRangeRequests:r,suggestedLength:a}=ck({getResponseHeader:s,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=a||this._contentLength,this._filename=dk(s)};if(this._request=null,this._url.protocol==="http:"){const i=er.get("http");this._request=i.request(Ey(this._url,t.httpHeaders),e)}else{const i=er.get("https");this._request=i.request(Ey(this._url,t.httpHeaders),e)}this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}}class EU extends pI{constructor(t,e,i){super(t),this._httpHeaders={};for(const r in t.httpHeaders){const a=t.httpHeaders[r];a!==void 0&&(this._httpHeaders[r]=a)}this._httpHeaders.Range=`bytes=${e}-${i-1}`;const s=r=>{if(r.statusCode===404){const a=new zh(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(r)};if(this._request=null,this._url.protocol==="http:"){const r=er.get("http");this._request=r.request(Ey(this._url,this._httpHeaders),s)}else{const r=er.get("https");this._request=r.request(Ey(this._url,this._httpHeaders),s)}this._request.on("error",r=>{this._storedError=r}),this._request.end()}}class xU extends fI{constructor(t){super(t);let e=decodeURIComponent(this._url.path);uI.test(this._url.href)&&(e=e.replace(/^\//,""));const i=er.get("fs");i.promises.lstat(e).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(e)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new zh(`Missing PDF "${e}".`)),this._storedError=s,this._headersCapability.reject(s)})}}class SU extends pI{constructor(t,e,i){super(t);let s=decodeURIComponent(this._url.path);uI.test(this._url.href)&&(s=s.replace(/^\//,""));const r=er.get("fs");this._setReadableStream(r.createReadStream(s,{start:e,end:i-1}))}}const kU=1e5,qi=30,CU=.8;var lT,Oo,ds,Jm,tv,No,wa,ev,iv,Kh,Bu,Wu,jo,Hu,sv,$u,Qh,nv,rv,Ts,Zh,Jh,Uu,qA,hT,XA,cT,av,YA,zu,ov,KA,dT;let xy=(Ts=class{constructor({textContentSource:n,container:t,viewport:e}){if(_(this,qA),_(this,XA),_(this,av),_(this,Oo,Promise.withResolvers()),_(this,ds,null),_(this,Jm,!1),_(this,tv,!!((lT=globalThis.FontInspector)!=null&&lT.enabled)),_(this,No,null),_(this,wa,null),_(this,ev,0),_(this,iv,0),_(this,Kh,null),_(this,Bu,null),_(this,Wu,0),_(this,jo,0),_(this,Hu,Object.create(null)),_(this,sv,[]),_(this,$u,null),_(this,Qh,[]),_(this,nv,new WeakMap),_(this,rv,null),n instanceof ReadableStream)T(this,$u,n);else if(typeof n=="object")T(this,$u,new ReadableStream({start(o){o.enqueue(n),o.close()}}));else throw new Error('No "textContentSource" parameter specified.');T(this,ds,T(this,Bu,t)),T(this,jo,e.scale*(globalThis.devicePixelRatio||1)),T(this,Wu,e.rotation),T(this,wa,{prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:r,pageY:a}=e.rawDims;T(this,rv,[1,0,0,-1,-r,a+s]),T(this,iv,i),T(this,ev,s),Ih(t,e),u(this,Oo).promise.catch(()=>{}).then(()=>{u(Ts,Uu).delete(this),T(this,wa,null),T(this,Hu,null)})}render(){const n=()=>{u(this,Kh).read().then(({value:t,done:e})=>{if(e){u(this,Oo).resolve();return}u(this,No)??T(this,No,t.lang),Object.assign(u(this,Hu),t.styles),C(this,qA,hT).call(this,t.items),n()},u(this,Oo).reject)};return T(this,Kh,u(this,$u).getReader()),u(Ts,Uu).add(this),n(),u(this,Oo).promise}update({viewport:n,onBefore:t=null}){var e;const i=n.scale*(globalThis.devicePixelRatio||1),s=n.rotation;if(s!==u(this,Wu)&&(t==null||t(),T(this,Wu,s),Ih(u(this,Bu),{rotation:s})),i!==u(this,jo)){t==null||t(),T(this,jo,i);const r={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:C(e=Ts,zu,ov).call(e,u(this,No))};for(const a of u(this,Qh))r.properties=u(this,nv).get(a),r.div=a,C(this,av,YA).call(this,r)}}cancel(){var n;const t=new Vh("TextLayer task cancelled.");(n=u(this,Kh))==null||n.cancel(t).catch(()=>{}),T(this,Kh,null),u(this,Oo).reject(t)}get textDivs(){return u(this,Qh)}get textContentItemsStr(){return u(this,sv)}static cleanup(){if(!(u(this,Uu).size>0)){u(this,Zh).clear();for(const{canvas:n}of u(this,Jh).values())n.remove();u(this,Jh).clear()}}},Oo=new WeakMap,ds=new WeakMap,Jm=new WeakMap,tv=new WeakMap,No=new WeakMap,wa=new WeakMap,ev=new WeakMap,iv=new WeakMap,Kh=new WeakMap,Bu=new WeakMap,Wu=new WeakMap,jo=new WeakMap,Hu=new WeakMap,sv=new WeakMap,$u=new WeakMap,Qh=new WeakMap,nv=new WeakMap,rv=new WeakMap,Zh=new WeakMap,Jh=new WeakMap,Uu=new WeakMap,qA=new WeakSet,hT=function(n){var t,e;if(u(this,Jm))return;(e=u(this,wa)).ctx||(e.ctx=C(t=Ts,zu,ov).call(t,u(this,No)));const i=u(this,Qh),s=u(this,sv);for(const r of n){if(i.length>kU){Ft("Ignoring additional textDivs for performance reasons."),T(this,Jm,!0);return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const a=u(this,ds);T(this,ds,document.createElement("span")),u(this,ds).classList.add("markedContent"),r.id!==null&&u(this,ds).setAttribute("id",`${r.id}`),a.append(u(this,ds))}else r.type==="endMarkedContent"&&T(this,ds,u(this,ds).parentNode);continue}s.push(r.str),C(this,XA,cT).call(this,r)}},XA=new WeakSet,cT=function(n){var t;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:n.str!=="",hasEOL:n.hasEOL,fontSize:0};u(this,Qh).push(e);const s=ft.transform(u(this,rv),n.transform);let r=Math.atan2(s[1],s[0]);const a=u(this,Hu)[n.fontName];a.vertical&&(r+=Math.PI/2);const o=u(this,tv)&&a.fontSubstitution||a.fontFamily,l=Math.hypot(s[2],s[3]),c=l*C(t=Ts,KA,dT).call(t,o,u(this,No));let h,f;r===0?(h=s[4],f=s[5]-c):(h=s[4]+c*Math.sin(r),f=s[5]-c*Math.cos(r));const p="calc(var(--scale-factor)*",g=e.style;u(this,ds)===u(this,Bu)?(g.left=`${(100*h/u(this,iv)).toFixed(2)}%`,g.top=`${(100*f/u(this,ev)).toFixed(2)}%`):(g.left=`${p}${h.toFixed(2)}px)`,g.top=`${p}${f.toFixed(2)}px)`),g.fontSize=`${p}${l.toFixed(2)}px)`,g.fontFamily=o,i.fontSize=l,e.setAttribute("role","presentation"),e.textContent=n.str,e.dir=n.dir,u(this,tv)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||n.fontName),r!==0&&(i.angle=r*(180/Math.PI));let m=!1;if(n.str.length>1)m=!0;else if(n.str!==" "&&n.transform[0]!==n.transform[3]){const b=Math.abs(n.transform[0]),y=Math.abs(n.transform[3]);b!==y&&Math.max(b,y)/Math.min(b,y)>1.5&&(m=!0)}if(m&&(i.canvasWidth=a.vertical?n.height:n.width),u(this,nv).set(e,i),u(this,wa).div=e,u(this,wa).properties=i,C(this,av,YA).call(this,u(this,wa)),i.hasText&&u(this,ds).append(e),i.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),u(this,ds).append(b)}},av=new WeakSet,YA=function(n){const{div:t,properties:e,ctx:i,prevFontSize:s,prevFontFamily:r}=n,{style:a}=t;let o="";if(e.canvasWidth!==0&&e.hasText){const{fontFamily:l}=a,{canvasWidth:c,fontSize:h}=e;(s!==h||r!==l)&&(i.font=`${h*u(this,jo)}px ${l}`,n.prevFontSize=h,n.prevFontFamily=l);const{width:f}=i.measureText(t.textContent);f>0&&(o=`scaleX(${c*u(this,jo)/f})`)}e.angle!==0&&(o=`rotate(${e.angle}deg) ${o}`),o.length>0&&(a.transform=o)},zu=new WeakSet,ov=function(n=null){let t=u(this,Jh).get(n||(n=""));if(!t){const e=document.createElement("canvas");e.className="hiddenCanvasElement",e.lang=n,document.body.append(e),t=e.getContext("2d",{alpha:!1}),u(this,Jh).set(n,t)}return t},KA=new WeakSet,dT=function(n,t){const e=u(this,Zh).get(n);if(e)return e;const i=C(this,zu,ov).call(this,t),s=i.font;i.canvas.width=i.canvas.height=qi,i.font=`${qi}px ${n}`;const r=i.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return u(this,Zh).set(n,h),i.canvas.width=i.canvas.height=0,i.font=s,h}i.strokeStyle="red",i.clearRect(0,0,qi,qi),i.strokeText("g",0,0);let l=i.getImageData(0,0,qi,qi).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/qi);break}i.clearRect(0,0,qi,qi),i.strokeText("A",0,qi),l=i.getImageData(0,0,qi,qi).data,a=0;for(let h=0,f=l.length;h<f;h+=4)if(l[h]>0){a=qi-Math.floor(h/4/qi);break}i.canvas.width=i.canvas.height=0,i.font=s;const c=a?a/(a+o):CU;return u(this,Zh).set(n,c),c},_(Ts,zu),_(Ts,KA),_(Ts,Zh,new Map),_(Ts,Jh,new Map),_(Ts,Uu,new Set),Ts);function TU(){RM("`renderTextLayer`, please use `TextLayer` instead.");const{textContentSource:n,container:t,viewport:e,...i}=arguments[0],s=Object.keys(i);s.length>0&&Ft("Ignoring `renderTextLayer` parameters: "+s.join(", "));const r=new xy({textContentSource:n,container:t,viewport:e}),{textDivs:a,textContentItemsStr:o}=r;return{promise:r.render(),textDivs:a,textContentItemsStr:o}}function RU(){RM("`updateTextLayer`, please use `TextLayer` instead.")}class Up{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(r){var a;if(!r)return;let o=null;const l=r.name;if(l==="#text")o=r.value;else if(Up.shouldBuildText(l))(a=r==null?void 0:r.attributes)!=null&&a.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&e.push({str:o}),!!r.children)for(const c of r.children)s(c)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const PU=65536,LU=100,MU=5e3,IU=Fi?$$:k$,DU=Fi?U$:CM,FU=Fi?H$:S$,OU=Fi?z$:TM;function NU(n){if(typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n}),typeof n!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!n.url&&!n.data&&!n.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new WU,{docId:e}=t,i=n.url?jU(n.url):null,s=n.data?BU(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof vI?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:PU;let h=n.worker instanceof q0?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!ak(n.docBaseUrl)?n.docBaseUrl:null,g=typeof n.cMapUrl=="string"?n.cMapUrl:null,m=n.cMapPacked!==!1,b=n.CMapReaderFactory||DU,y=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,w=n.StandardFontDataFactory||OU,x=n.stopAtErrors!==!0,R=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,I=n.isEvalSupported!==!1,D=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Fi,F=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,O=typeof n.disableFontFace=="boolean"?n.disableFontFace:Fi,L=n.fontExtraProperties===!0,M=n.enableXfa===!0,W=n.ownerDocument||globalThis.document,j=n.disableRange===!0,V=n.disableStream===!0,z=n.disableAutoFetch===!0,Y=n.pdfBug===!0,K=l?l.length:n.length??NaN,G=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Fi&&!O,H=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:b===CM&&w===TM&&g&&y&&mf(g,document.baseURI)&&mf(y,document.baseURI),Q=n.canvasFactory||new IU({ownerDocument:W}),Z=n.filterFactory||new FU({docId:e,ownerDocument:W}),yt=null;p$(f);const bt={canvasFactory:Q,filterFactory:Z};if(H||(bt.cMapReaderFactory=new b({baseUrl:g,isCompressed:m}),bt.standardFontDataFactory=new w({baseUrl:y})),!h){const ht={verbosity:f,port:Co.workerPort};h=ht.port?q0.fromPort(ht):new q0(ht),t._worker=h}const X={docId:e,apiVersion:"4.3.136",data:s,password:o,disableAutoFetch:z,rangeChunkSize:c,length:K,docBaseUrl:p,enableXfa:M,evaluatorOptions:{maxImageSize:R,disableFontFace:O,ignoreErrors:x,isEvalSupported:I,isOffscreenCanvasSupported:D,canvasMaxAreaInBytes:F,fontExtraProperties:L,useSystemFonts:G,cMapUrl:H?g:null,standardFontDataUrl:H?y:null}},nt={disableFontFace:O,fontExtraProperties:L,ownerDocument:W,pdfBug:Y,styleElement:yt,loadingParams:{disableAutoFetch:z,enableXfa:M}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ht=h.messageHandler.sendWithPromise("GetDocRequest",X,s?[s.buffer]:null);let lt;return l?lt=new hU(l,{disableRange:j,disableStream:V}):s||(lt=(ct=>Fi?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&mf(ct.url)?new oT(ct):new AU(ct):mf(ct.url)?new oT(ct):new vU(ct))({url:i,length:K,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:j,disableStream:V})),ht.then(ct=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const st=new Lf(e,ct,h.port),vt=new zU(st,t,lt,nt,bt);t._transport=vt,st.send("Ready",null)})}).catch(t._capability.reject),t}function jU(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Fi&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function BU(n){if(Fi&&typeof z_<"u"&&n instanceof z_)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Xw(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function uT(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var QE;const gI=class mI{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Vs(mI,QE)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};QE=new WeakMap,_(gI,QE,0);let WU=gI,vI=class{constructor(n,t,e=!1,i=null){this.length=n,this.initialData=t,this.progressiveDone=e,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,t){for(const e of this._rangeListeners)e(n,t)}onDataProgress(n,t){this._readyCapability.promise.then(()=>{for(const e of this._progressListeners)e(n,t)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,t){ee("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class HU{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Yo,Ga,dl,Yc,vp,Sy;class $U{constructor(t,e,i,s=!1){_(this,dl),_(this,vp),_(this,Yo,null),_(this,Ga,!1),this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new UC:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new bI,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new Pm({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:s=Ua.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null}){var f,p;(f=this._stats)==null||f.time("Overall");const g=this._transport.getRenderingIntent(i,s,h),{renderingIntent:m,cacheKey:b}=g;T(this,Ga,!1),C(this,vp,Sy).call(this),o||(o=this._transport.getOptionalContentConfig(m));let y=this._intentStates.get(b);y||(y=Object.create(null),this._intentStates.set(b,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const w=!!(m&Bs.PRINT);y.displayReadyCapability||(y.displayReadyCapability=Promise.withResolvers(),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p=this._stats)==null||p.time("Page Request"),this._pumpOperatorList(g));const x=D=>{var F;y.renderTasks.delete(R),(this._maybeCleanupAfterRender||w)&&T(this,Ga,!0),C(this,dl,Yc).call(this,!w),D?(R.capability.reject(D),this._abortOperatorList({intentState:y,reason:D instanceof Error?D:new Error(D)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new GU({callback:x,params:{canvasContext:t,viewport:e,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:c});(y.renderTasks||(y.renderTasks=new Set)).add(R);const I=R.task;return Promise.all([y.displayReadyCapability.promise,o]).then(([D,F])=>{var O;if(this.destroyed){x();return}if((O=this._stats)==null||O.time("Rendering"),!(F.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:D,optionalContentConfig:F}),R.operatorListChanged()}).catch(x),I}getOperatorList({intent:t="display",annotationMode:e=Ua.ENABLE,printAnnotationStorage:i=null}={}){var s;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(t,e,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(s=this._stats)==null||s.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Up.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function r(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},s)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),T(this,Ga,!1),C(this,vp,Sy).call(this),Promise.all(t)}cleanup(t=!1){T(this,Ga,!0);const e=C(this,dl,Yc).call(this,!1);return t&&e&&this._stats&&(this._stats=new UC),e}_startRenderPage(t,e){var i,s;const r=this._intentStates.get(e);r&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&C(this,dl,Yc).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i}){const{map:s,transfer:r}=i,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s},r).getReader(),o=this._intentStates.get(e);o.streamReader=a;const l=()=>{a.read().then(({value:c,done:h})=>{if(h){o.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(c,o),l())},c=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const h of o.renderTasks)h.operatorListChanged();C(this,dl,Yc).call(this,!0)}if(o.displayReadyCapability)o.displayReadyCapability.reject(c);else if(o.opListReadCapability)o.opListReadCapability.reject(c);else throw c}})};l()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof rk){let s=LU;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new Vh(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Yo=new WeakMap,Ga=new WeakMap,dl=new WeakSet,Yc=function(n=!1){if(C(this,vp,Sy).call(this),!u(this,Ga)||this.destroyed)return!1;if(n)return T(this,Yo,setTimeout(()=>{T(this,Yo,null),C(this,dl,Yc).call(this,!1)},MU)),!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),T(this,Ga,!1),!0},vp=new WeakSet,Sy=function(){u(this,Yo)&&(clearTimeout(u(this,Yo)),T(this,Yo,null))};var kc,ZE;class UU{constructor(){_(this,kc,new Set),_(this,ZE,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};u(this,ZE).then(()=>{for(const s of u(this,kc))s.call(this,i)})}addEventListener(t,e){u(this,kc).add(e)}removeEventListener(t,e){u(this,kc).delete(e)}terminate(){u(this,kc).clear()}}kc=new WeakMap,ZE=new WeakMap;const Pr={isWorkerDisabled:!1,fakeWorkerId:0};Fi&&(Pr.isWorkerDisabled=!0,Co.workerSrc||(Co.workerSrc="./pdf.worker.mjs")),Pr.isSameOrigin=function(n,t){let e;try{if(e=new URL(n),!e.origin||e.origin==="null")return!1}catch{return!1}const i=new URL(t,e);return e.origin===i.origin},Pr.createCDNWrapper=function(n){const t=`await import("${n}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};var ul,bp,G0;const JE=class mr{constructor({name:t=null,port:e=null,verbosity:i=g$()}={}){var s;if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((s=u(mr,ul))!=null&&s.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(u(mr,ul)||T(mr,ul,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return Fi?Promise.all([er.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Lf("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!Pr.isWorkerDisabled&&!u(mr,bp,G0)){let{workerSrc:t}=mr;try{Pr.isSameOrigin(window.location.href,t)||(t=Pr.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Lf("main","worker",e),s=()=>{e.removeEventListener("error",r),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||s()};e.addEventListener("error",r),i.on("test",o=>{if(e.removeEventListener("error",r),this.destroyed){s();return}o?(this._messageHandler=i,this._port=e,this._webWorker=e,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),e.terminate())}),i.on("ready",o=>{if(e.removeEventListener("error",r),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{Gw("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){Pr.isWorkerDisabled||(Ft("Setting up fake worker."),Pr.isWorkerDisabled=!0),mr._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new UU;this._port=e;const i=`fake${Pr.fakeWorkerId++}`,s=new Lf(i+"_worker",i,e);t.setup(s,e);const r=new Lf(i,i+"_worker",e);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=u(mr,ul))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var e;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const i=(e=u(this,ul))==null?void 0:e.get(t.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new mr(t)}static get workerSrc(){if(Co.workerSrc)return Co.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ut(this,"_setupFakeWorkerGlobal",(async()=>u(this,bp,G0)?u(this,bp,G0):(await import(this.workerSrc)).WorkerMessageHandler)())}};ul=new WeakMap,bp=new WeakSet,G0=function(){var n;try{return((n=globalThis.pdfjsWorker)==null?void 0:n.WorkerMessageHandler)||null}catch{return null}},_(JE,bp),_(JE,ul,void 0);let q0=JE;var qa,vr,Ff,Of,br,Cc,Nf;class zU{constructor(t,e,i,s,r){_(this,Cc),_(this,qa,new Map),_(this,vr,new Map),_(this,Ff,new Map),_(this,Of,new Map),_(this,br,null),this.messageHandler=t,this.loadingTask=e,this.commonObjs=new bI,this.fontLoader=new B$({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Ut(this,"annotationStorage",new hk)}getRenderingIntent(t,e=Ua.ENABLE,i=null,s=!1){let r=Bs.DISPLAY,a=$E;switch(t){case"any":r=Bs.ANY;break;case"display":break;case"print":r=Bs.PRINT;break;default:Ft(`getRenderingIntent - invalid intent: ${t}`)}switch(e){case Ua.DISABLE:r+=Bs.ANNOTATIONS_DISABLE;break;case Ua.ENABLE:break;case Ua.ENABLE_FORMS:r+=Bs.ANNOTATIONS_FORMS;break;case Ua.ENABLE_STORAGE:r+=Bs.ANNOTATIONS_STORAGE,a=(r&Bs.PRINT&&i instanceof eI?i:this.annotationStorage).serializable;break;default:Ft(`getRenderingIntent - invalid annotationMode: ${e}`)}return s&&(r+=Bs.OPLIST),{renderingIntent:r,cacheKey:`${r}_${a.hash}`,annotationStorageSerializable:a}}destroy(){var t;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(t=u(this,br))==null||t.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of u(this,vr).values())e.push(s._destroy());u(this,vr).clear(),u(this,Ff).clear(),u(this,Of).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return e.push(i),Promise.all(e).then(()=>{var s;this.commonObjs.clear(),this.fontLoader.clear(),u(this,qa).clear(),this.filterFactory.destroy(),xy.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Vh("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{Ue(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){s.close();return}Ue(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",i=>{const s=Promise.withResolvers(),r=this._fullReader;return r.headersReady.then(()=>{var a;(!r.isStreamingSupported||!r.isRangeSupported)&&(this._lastProgress&&((a=e.onProgress)==null||a.call(e,this._lastProgress)),r.onProgress=o=>{var l;(l=e.onProgress)==null||l.call(e,{loaded:o.loaded,total:o.total})}),s.resolve({isStreamingSupported:r.isStreamingSupported,isRangeSupported:r.isRangeSupported,contentLength:r.contentLength})},s.reject),s.promise}),t.on("GetRangeReader",(i,s)=>{Ue(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}Ue(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new HU(i,this))}),t.on("DocException",function(i){let s;switch(i.name){case"PasswordException":s=new q_(i.message,i.code);break;case"InvalidPDFException":s=new EM(i.message);break;case"MissingPDFException":s=new zh(i.message);break;case"UnexpectedResponseException":s=new qw(i.message,i.status);break;case"UnknownErrorException":s=new X_(i.message,i.details);break;default:ee("DocException - expected a valid Error.")}e._capability.reject(s)}),t.on("PasswordRequest",i=>{if(T(this,br,Promise.withResolvers()),e.onPassword){const s=r=>{r instanceof Error?u(this,br).reject(r):u(this,br).resolve({password:r})};try{e.onPassword(s,i.code)}catch(r){u(this,br).reject(r)}}else u(this,br).reject(new q_(i.message,i.code));return u(this,br).promise}),t.on("DataLoaded",i=>{var s;(s=e.onProgress)==null||s.call(e,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{this.destroyed||u(this,vr).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:o,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in r){const g=r.error;Ft(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const h=c&&(a=globalThis.FontInspector)!=null&&a.enabled?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,f=new W$(r,{disableFontFace:o,inspectFont:h});this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l&&f.data&&(f.data=null),this.commonObjs.resolve(i,f)});break;case"CopyLocalImage":const{imageRef:p}=r;Ue(p,"The imageRef must be defined.");for(const g of u(this,vr).values())for(const[,m]of g.objs)if((m==null?void 0:m.ref)===p)return m.dataLen?(this.commonObjs.resolve(i,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,r,a])=>{var o;if(this.destroyed)return;const l=u(this,vr).get(s);if(!l.objs.has(i)){if(l._intentStates.size===0){(o=a==null?void 0:a.bitmap)==null||o.close();return}switch(r){case"Image":l.objs.resolve(i,a),(a==null?void 0:a.dataLen)>c$&&(l._maybeCleanupAfterRender=!0);break;case"Pattern":l.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",i=>{var s;this.destroyed||(s=e.onProgress)==null||s.call(e,{loaded:i.loaded,total:i.total})}),t.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var t;this.annotationStorage.size<=0&&Ft("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((t=this._fullReader)==null?void 0:t.filename)??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=u(this,Ff).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&u(this,Of).set(r.refStr,t);const a=new $U(e,r,this,this._params.pdfBug);return u(this,vr).set(e,a),a});return u(this,Ff).set(e,s),s}getPageIndex(t){return uT(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return C(this,Cc,Nf).call(this,"GetFieldObjects")}hasJSActions(){return C(this,Cc,Nf).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return C(this,Cc,Nf).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return C(this,Cc,Nf).call(this,"GetOptionalContentConfig").then(e=>new lU(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=u(this,qa).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new aU(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return u(this,qa).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of u(this,vr).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),u(this,qa).clear(),this.filterFactory.destroy(!0),xy.cleanup()}}cachedPageNumber(t){if(!uT(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return u(this,Of).get(e)??null}}qa=new WeakMap,vr=new WeakMap,Ff=new WeakMap,Of=new WeakMap,br=new WeakMap,Cc=new WeakSet,Nf=function(n,t=null){const e=u(this,qa).get(n);if(e)return e;const i=this.messageHandler.sendWithPromise(n,t);return u(this,qa).set(n,i),i};const X0=Symbol("INITIAL_DATA");var En,Y0,tx;class bI{constructor(){_(this,Y0),_(this,En,Object.create(null))}get(t,e=null){if(e){const s=C(this,Y0,tx).call(this,t);return s.promise.then(()=>e(s.data)),null}const i=u(this,En)[t];if(!i||i.data===X0)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=u(this,En)[t];return!!e&&e.data!==X0}resolve(t,e=null){const i=C(this,Y0,tx).call(this,t);i.data=e,i.resolve()}clear(){var t;for(const e in u(this,En)){const{data:i}=u(this,En)[e];(t=i==null?void 0:i.bitmap)==null||t.close()}T(this,En,Object.create(null))}*[Symbol.iterator](){for(const t in u(this,En)){const{data:e}=u(this,En)[t];e!==X0&&(yield[t,e])}}}En=new WeakMap,Y0=new WeakSet,tx=function(n){var t;return(t=u(this,En))[n]||(t[n]={...Promise.withResolvers(),data:X0})};var Ko;class VU{constructor(t){_(this,Ko,null),T(this,Ko,t),this.onContinue=null}get promise(){return u(this,Ko).capability.promise}cancel(t=0){u(this,Ko).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=u(this,Ko).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=u(this,Ko);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}Ko=new WeakMap;var Kc;const yI=class jf{constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:p=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new VU(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var i,s;if(this.cancelled)return;if(this._canvas){if(u(jf,Kc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(jf,Kc).add(this._canvas)}this._pdfBug&&(i=globalThis.StepperManager)!=null&&i.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:a,transform:o,background:l}=this.params;this.gfx=new H0(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:a,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,(s=this.graphicsReadyCallback)==null||s.call(this)}cancel(t=null,e=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),u(jf,Kc).delete(this._canvas),this.callback(t||new rk(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),u(jf,Kc).delete(this._canvas),this.callback())))}};Kc=new WeakMap,_(yI,Kc,new WeakSet);let GU=yI;const qU="4.3.136",XU="0cec64437";function fT(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Vu(n){return Math.max(0,Math.min(255,255*n))}class pT{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Vu(t),[t,t,t]}static G_HTML([t]){const e=fT(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Vu)}static RGB_HTML(t){return`#${t.map(fT).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[Vu(1-Math.min(1,t+s)),Vu(1-Math.min(1,i+s)),Vu(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,r=1-e,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class wI{static setupStorage(t,e,i,s,r){const a=s.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),r==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",o=>{s.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),r==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:r}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}o&&r.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){var e,i;const s=t.annotationStorage,r=t.linkService,a=t.xfaHtml,o=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:o,linkService:r});const c=o!=="richText",h=t.div;if(h.append(l),t.viewport){const g=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=g}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const g=document.createTextNode(a.value);l.append(g),c&&Up.shouldBuildText(a.name)&&f.push(g)}return{textDivs:f}}const p=[[a,-1,l]];for(;p.length>0;){const[g,m,b]=p.at(-1);if(m+1===g.children.length){p.pop();continue}const y=g.children[++p.at(-1)[1]];if(y===null)continue;const{name:w}=y;if(w==="#text"){const R=document.createTextNode(y.value);f.push(R),b.append(R);continue}const x=(e=y==null?void 0:y.attributes)!=null&&e.xmlns?document.createElementNS(y.attributes.xmlns,w):document.createElement(w);if(b.append(x),y.attributes&&this.setAttributes({html:x,element:y,storage:s,intent:o,linkService:r}),((i=y.children)==null?void 0:i.length)>0)p.push([y,-1,x]);else if(y.value){const R=document.createTextNode(y.value);c&&Up.shouldBuildText(w)&&f.push(R),x.append(R)}}for(const g of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Im=1e3,YU=9,Dh=new WeakSet;function ga(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class KU{static create(t){switch(t.data.annotationType){case Fe.LINK:return new xI(t);case Fe.TEXT:return new ZU(t);case Fe.WIDGET:switch(t.data.fieldType){case"Tx":return new JU(t);case"Btn":return t.data.radioButton?new SI(t):t.data.checkBox?new ez(t):new iz(t);case"Ch":return new sz(t);case"Sig":return new tz(t)}return new Gh(t);case Fe.POPUP:return new nx(t);case Fe.FREETEXT:return new TI(t);case Fe.LINE:return new rz(t);case Fe.SQUARE:return new az(t);case Fe.CIRCLE:return new oz(t);case Fe.POLYLINE:return new RI(t);case Fe.CARET:return new hz(t);case Fe.INK:return new PI(t);case Fe.POLYGON:return new lz(t);case Fe.HIGHLIGHT:return new cz(t);case Fe.UNDERLINE:return new dz(t);case Fe.SQUIGGLY:return new uz(t);case Fe.STRIKEOUT:return new fz(t);case Fe.STAMP:return new LI(t);case Fe.FILEATTACHMENT:return new pz(t);default:return new ze(t)}}}var Qo,Bf,Wf,K0,ex;const QU=class AI{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){_(this,K0),_(this,Qo,null),_(this,Bf,!1),_(this,Wf,null),this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t!=null&&t.str||e!=null&&e.str||i!=null&&i.str)}get hasPopupData(){return AI._hasPopupData(this.data)}updateEdited(t){var e;if(!this.container)return;u(this,Qo)||T(this,Qo,{rect:this.data.rect.slice(0)});const{rect:i}=t;i&&C(this,K0,ex).call(this,i),(e=u(this,Wf))==null||e.popup.updateEdited(t)}resetEdited(){var t;u(this,Qo)&&(C(this,K0,ex).call(this,u(this,Qo).rect),(t=u(this,Wf))==null||t.popup.resetEdited(),T(this,Qo,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof Gh||(r.tabIndex=Im);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,e.popupRef&&r.setAttribute("aria-haspopup","dialog"),e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof nx){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:o,height:l}=ga(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,y=e.borderStyle.verticalCornerRadius;if(b>0||y>0){const x=`calc(${b}px * var(--scale-factor)) / calc(${y}px * var(--scale-factor))`;a.borderRadius=x}else if(this instanceof SI){const x=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=x}switch(e.borderStyle.style){case Fu.SOLID:a.borderStyle="solid";break;case Fu.DASHED:a.borderStyle="dashed";break;case Fu.BEVELED:Ft("Unimplemented border style: beveled");break;case Fu.INSET:Ft("Unimplemented border style: inset");break;case Fu.UNDERLINE:a.borderBottomStyle="solid";break}const w=e.borderColor||null;w?(T(this,Bf,!0),a.borderColor=ft.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):a.borderWidth=0}const c=ft.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:f,pageX:p,pageY:g}=s.rawDims;a.left=`${100*(c[0]-p)/h}%`,a.top=`${100*(c[1]-g)/f}%`;const{rotation:m}=e;return e.hasOwnCanvas||m===0?(a.width=`${100*o/h}%`,a.height=`${100*l/f}%`):this.setRotation(m,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:r,height:a}=ga(this.data.rect);let o,l;t%180===0?(o=100*r/i,l=100*a/s):(o=100*a/i,l=100*r/s),e.style.width=`${o}%`,e.style.height=`${l}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const r=s.detail[e],a=r[0],o=r.slice(1);s.target.style[i]=pT[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:pT[`${a}_rgb`](o)})};return Ut(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail)){const r=t[s]||i[s];r==null||r(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,r]of Object.entries(e)){const a=i[s];if(a){const o={detail:{[s]:r},target:t};a(o),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,r]=this.data.rect;if(t.length===1){const[,{x:b,y},{x:w,y:x}]=t[0];if(s===b&&r===y&&e===w&&i===x)return}const{style:a}=this.container;let o;if(u(this,Bf)){const{borderColor:b,borderWidth:y}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const l=s-e,c=r-i,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=h.createElement("defs");f.append(p);const g=h.createElement("clipPath"),m=`clippath_${this.data.id}`;g.setAttribute("id",m),g.setAttribute("clipPathUnits","objectBoundingBox"),p.append(g);for(const[,{x:b,y},{x:w,y:x}]of t){const R=h.createElement("rect"),I=(w-e)/l,D=(r-y)/c,F=(b-w)/l,O=(y-x)/c;R.setAttribute("x",I),R.setAttribute("y",D),R.setAttribute("width",F),R.setAttribute("height",O),g.append(R),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${I}" y="${D}" width="${F}" height="${O}"/>`)}u(this,Bf)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const i=T(this,Wf,new nx({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}render(){ee("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===e)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Dh.has(c)){Ft(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(t)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==e&&Dh.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};Qo=new WeakMap,Bf=new WeakMap,Wf=new WeakMap,K0=new WeakSet,ex=function(n){const{container:{style:t},data:{rect:e,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:a,pageY:o}}}}=this;e==null||e.splice(0,4,...n);const{width:l,height:c}=ga(n);t.left=`${100*(n[0]-a)/s}%`,t.top=`${100*(r-n[3]+o)/r}%`,i===0?(t.width=`${100*l/s}%`,t.height=`${100*c/r}%`):this.setRotation(i)};let ze=QU;var Xa,_l,ix,_I,sx,EI;class xI extends ze{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!(e!=null&&e.ignoreBorder),createQuadrilaterals:!0}),_(this,Xa),_(this,ix),_(this,sx),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action),s=!0):t.attachment?(C(this,ix,_I).call(this,i,t.attachment,t.attachmentDest),s=!0):t.setOCGState?(C(this,sx,EI).call(this,i,t.setOCGState),s=!0):t.dest?(this._bindLink(i,t.dest),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&C(this,Xa,_l).call(this)}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),C(this,Xa,_l).call(this)}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const r=i.get(s);r&&(t[r]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1})}t.onclick||(t.onclick=()=>!1),C(this,Xa,_l).call(this)}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),C(this,Xa,_l).call(this),!this._fieldObjects){Ft('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var s;i==null||i();const{fields:r,refs:a,include:o}=e,l=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const p of r){const g=this._fieldObjects[p]||[];for(const{id:m}of g)f.add(m)}for(const p of Object.values(this._fieldObjects))for(const g of p)f.has(g.id)===o&&l.push(g)}else for(const f of Object.values(this._fieldObjects))l.push(...f);const c=this.annotationStorage,h=[];for(const f of l){const{id:p}=f;switch(h.push(p),f.type){case"text":{const m=f.defaultValue||"";c.setValue(p,{value:m});break}case"checkbox":case"radiobutton":{const m=f.defaultValue===f.exportValues;c.setValue(p,{value:m});break}case"combobox":case"listbox":{const m=f.defaultValue||"";c.setValue(p,{value:m});break}default:continue}const g=document.querySelector(`[data-element-id="${p}"]`);if(g){if(!Dh.has(g)){Ft(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((s=this.linkService.eventBus)==null||s.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Xa=new WeakSet,_l=function(){this.container.setAttribute("data-internal-link","")},ix=new WeakSet,_I=function(n,t,e=null){n.href=this.linkService.getAnchorUrl(""),t.description&&(n.title=t.description),n.onclick=()=>{var i;return(i=this.downloadManager)==null||i.openOrDownloadData(t.content,t.filename,e),!1},C(this,Xa,_l).call(this)},sx=new WeakSet,EI=function(n,t){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeSetOCGState(t),!1),C(this,Xa,_l).call(this)};class ZU extends ze{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Gh extends ze{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ls.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,r){i.includes("mouse")?t.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{var o;if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(t,e,i,s){var r,a,o;for(const[l,c]of i)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":ft.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||YU,r=t.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(jA*s))||1,f=c/h;a=Math.min(s,l(f/jA))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/jA))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=ft.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class JU extends Gh{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),r.setValue(a.id,{[s]:i})}render(){var t,e;const i=this.annotationStorage,s=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const a=i.getValue(s,{value:this.data.fieldValue});let o=a.value||"";const l=i.getValue(s,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((t=this.data.textContent)==null?void 0:t.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=c??o,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type="text",r.setAttribute("value",c??o),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Dh.add(r),r.setAttribute("data-element-id",s),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=Im,this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",p=>{i.setValue(s,{value:p.target.value}),this.setPropertyOnSiblings(r,"value",p.target.value,"value"),h.formattedValue=null}),r.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue??"";r.value=h.userValue=g,h.formattedValue=null});let f=p=>{const{formattedValue:g}=h;g!=null&&(p.target.value=g),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",g=>{var m;if(h.focused)return;const{target:b}=g;h.userValue&&(b.value=h.userValue),h.lastCommittedValue=b.value,h.commitKey=1,(m=this.data.actions)!=null&&m.Focus||(h.focused=!0)}),r.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(b){h.userValue=b.detail.value??"",i.setValue(s,{value:h.userValue.toString()}),b.target.value=h.userValue},formattedValue(b){const{formattedValue:y}=b.detail;h.formattedValue=y,y!=null&&b.target!==document.activeElement&&(b.target.value=y),i.setValue(s,{formattedValue:y})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var y;const{charLimit:w}=b.detail,{target:x}=b;if(w===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",w);let R=h.userValue;!R||R.length<=w||(R=R.slice(0,w),x.value=h.userValue=R,i.setValue(s,{value:R}),(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),r.addEventListener("keydown",g=>{var m;h.commitKey=1;let b=-1;if(g.key==="Escape"?b=0:g.key==="Enter"&&!this.data.multiLine?b=2:g.key==="Tab"&&(h.commitKey=3),b===-1)return;const{value:y}=g.target;h.lastCommittedValue!==y&&(h.lastCommittedValue=y,h.userValue=y,(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:y,willCommit:!0,commitKey:b,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const p=f;f=null,r.addEventListener("blur",g=>{var m,b;if(!h.focused||!g.relatedTarget)return;(m=this.data.actions)!=null&&m.Blur||(h.focused=!1);const{value:y}=g.target;h.userValue=y,h.lastCommittedValue!==y&&((b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),p(g)}),(e=this.data.actions)!=null&&e.Keystroke&&r.addEventListener("beforeinput",g=>{var m;h.lastCommittedValue=null;const{data:b,target:y}=g,{value:w,selectionStart:x,selectionEnd:R}=y;let I=x,D=R;switch(g.inputType){case"deleteWordBackward":{const F=w.substring(0,x).match(/\w*[^\w]*$/);F&&(I-=F[0].length);break}case"deleteWordForward":{const F=w.substring(x).match(/^[^\w]*\w*/);F&&(D+=F[0].length);break}case"deleteContentBackward":x===R&&(I-=1);break;case"deleteContentForward":x===R&&(D+=1);break}g.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:w,change:b||"",willCommit:!1,selStart:I,selEnd:D}})}),this._setEventListeners(r,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(f&&r.addEventListener("blur",f),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class tz extends Gh{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class ez extends Gh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Dh.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=Im,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const h=l&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=h),t.setValue(c.id,{value:h})}t.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class SI extends Gh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const r=document.createElement("input");if(Dh.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=Im,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))t.setValue(c.id,{value:!1});t.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const p=h&&f.id===i;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class iz extends xI{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class sz extends Gh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Dh.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=Im;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const p of s.options)p.selected=p.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,i.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),r=!1),s.append(f)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const f=h?"value":"textContent",{options:p,multiple:g}=s;return g?Array.prototype.filter.call(p,m=>m.selected).map(m=>m[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const c=h=>{const f=h.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const f={value(p){a==null||a();const g=p.detail.value,m=new Set(Array.isArray(g)?g:[g]);for(const b of s.options)b.selected=m.has(b.value);t.setValue(e,{value:o(!0)}),l=o(!1)},multipleSelection(p){s.multiple=!0},remove(p){const g=s.options,m=p.detail.remove;g[m].selected=!1,s.remove(m),g.length>0&&Array.prototype.findIndex.call(g,b=>b.selected)===-1&&(g[0].selected=!0),t.setValue(e,{value:o(!0),items:c(p)}),l=o(!1)},clear(p){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),l=o(!1)},insert(p){const{index:g,displayValue:m,exportValue:b}=p.detail.insert,y=s.children[g],w=document.createElement("option");w.textContent=m,w.value=b,y?y.before(w):s.append(w),t.setValue(e,{value:o(!0),items:c(p)}),l=o(!1)},items(p){const{items:g}=p.detail;for(;s.length!==0;)s.remove(0);for(const m of g){const{displayValue:b,exportValue:y}=m,w=document.createElement("option");w.textContent=b,w.value=y,s.append(w)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(p)}),l=o(!1)},indices(p){const g=new Set(p.detail.indices);for(const m of p.target.options)m.selected=g.has(m.index);t.setValue(e,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,h)}),s.addEventListener("input",h=>{var f;const p=o(!0),g=o(!1);t.setValue(e,{value:p}),h.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:g,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class nx extends ze{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:ze._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new nz({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${SM}${i}`).join(",")),this.container}}var yp,rx,ax,wp,Tc,xe,Wa,Rc,ky,Cy,Ap,La,xn,Ya,Ty,Ka,Q0,Zo,Pc,_p,Z0,J0,QA,ox,gT,lx,kI,hx,CI,cx,mT,Ep,Ry,xp,Py,Ly,dx;class nz{constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:f}){_(this,_p),_(this,J0),_(this,ox),_(this,lx),_(this,hx),_(this,cx),_(this,Ep),_(this,xp),_(this,Ly),_(this,yp,C(this,hx,CI).bind(this)),_(this,rx,C(this,Ly,dx).bind(this)),_(this,ax,C(this,xp,Py).bind(this)),_(this,wp,C(this,Ep,Ry).bind(this)),_(this,Tc,null),_(this,xe,null),_(this,Wa,null),_(this,Rc,null),_(this,ky,null),_(this,Cy,null),_(this,Ap,null),_(this,La,!1),_(this,xn,null),_(this,Ya,null),_(this,Ty,null),_(this,Ka,null),_(this,Q0,null),_(this,Zo,null),_(this,Pc,!1);var p;T(this,xe,t),T(this,Q0,s),T(this,Wa,a),T(this,Ka,o),T(this,Cy,l),T(this,Tc,e),T(this,Ty,c),T(this,Ap,h),T(this,ky,i),T(this,Rc,PM.toDateObject(r)),this.trigger=i.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",u(this,wp)),g.addEventListener("mouseenter",u(this,ax)),g.addEventListener("mouseleave",u(this,rx)),g.classList.add("popupTriggerArea");for(const g of i)(p=g.container)==null||p.addEventListener("keydown",u(this,yp));u(this,xe).hidden=!0,f&&C(this,Ep,Ry).call(this)}render(){if(u(this,xn))return;const t=T(this,xn,document.createElement("div"));if(t.className="popup",u(this,Tc)){const r=t.style.outlineColor=ft.makeHexColor(...u(this,Tc));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:t.style.backgroundColor=ft.makeHexColor(...u(this,Tc).map(a=>Math.floor(.7*(255-a)+a)))}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=u(this,Q0),t.append(e),u(this,Rc)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),r.setAttribute("data-l10n-args",JSON.stringify({date:u(this,Rc).toLocaleDateString(),time:u(this,Rc).toLocaleTimeString()})),e.append(r)}const s=u(this,_p,Z0);if(s)wI.render({xfaHtml:s,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(u(this,Wa));t.append(r)}u(this,xe).append(t)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let r=0,a=s.length;r<a;++r){const o=s[r];i.append(document.createTextNode(o)),r<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:t,popupContent:e}){var i;u(this,Zo)||T(this,Zo,{contentsObj:u(this,Wa),richText:u(this,Ka)}),t&&T(this,Ya,null),e&&(T(this,Ka,C(this,lx,kI).call(this,e)),T(this,Wa,null)),(i=u(this,xn))==null||i.remove(),T(this,xn,null)}resetEdited(){var t;u(this,Zo)&&({contentsObj:Vs(this,Wa)._,richText:Vs(this,Ka)._}=u(this,Zo),T(this,Zo,null),(t=u(this,xn))==null||t.remove(),T(this,xn,null),T(this,Ya,null))}forceHide(){T(this,Pc,this.isVisible),u(this,Pc)&&(u(this,xe).hidden=!0)}maybeShow(){u(this,Pc)&&(u(this,xn)||C(this,xp,Py).call(this),T(this,Pc,!1),u(this,xe).hidden=!1)}get isVisible(){return u(this,xe).hidden===!1}}yp=new WeakMap,rx=new WeakMap,ax=new WeakMap,wp=new WeakMap,Tc=new WeakMap,xe=new WeakMap,Wa=new WeakMap,Rc=new WeakMap,ky=new WeakMap,Cy=new WeakMap,Ap=new WeakMap,La=new WeakMap,xn=new WeakMap,Ya=new WeakMap,Ty=new WeakMap,Ka=new WeakMap,Q0=new WeakMap,Zo=new WeakMap,Pc=new WeakMap,_p=new WeakSet,Z0=function(){const n=u(this,Ka),t=u(this,Wa);return n!=null&&n.str&&(!(t!=null&&t.str)||t.str===n.str)&&u(this,Ka).html||null},J0=new WeakSet,QA=function(){var n,t,e;return((e=(t=(n=u(this,_p,Z0))==null?void 0:n.attributes)==null?void 0:t.style)==null?void 0:e.fontSize)||0},ox=new WeakSet,gT=function(){var n,t,e;return((e=(t=(n=u(this,_p,Z0))==null?void 0:n.attributes)==null?void 0:t.style)==null?void 0:e.color)||null},lx=new WeakSet,kI=function(n){const t=[],e={str:n,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:u(this,ox,gT),fontSize:u(this,J0,QA)?`calc(${u(this,J0,QA)}px * var(--scale-factor))`:""}};for(const s of n.split(`
`))t.push({name:"span",value:s,attributes:i});return e},hx=new WeakSet,CI=function(n){n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||(n.key==="Enter"||n.key==="Escape"&&u(this,La))&&C(this,Ep,Ry).call(this)},cx=new WeakSet,mT=function(){if(u(this,Ya)!==null)return;const{page:{view:n},viewport:{rawDims:{pageWidth:t,pageHeight:e,pageX:i,pageY:s}}}=u(this,Cy);let r=!!u(this,Ap),a=r?u(this,Ap):u(this,Ty);for(const p of u(this,ky))if(!a||ft.intersect(p.data.rect,a)!==null){a=p.data.rect,r=!0;break}const o=ft.normalizeRect([a[0],n[3]-a[1]+n[1],a[2],n[3]-a[3]+n[1]]),l=r?a[2]-a[0]+5:0,c=o[0]+l,h=o[1];T(this,Ya,[100*(c-i)/t,100*(h-s)/e]);const{style:f}=u(this,xe);f.left=`${u(this,Ya)[0]}%`,f.top=`${u(this,Ya)[1]}%`},Ep=new WeakSet,Ry=function(){T(this,La,!u(this,La)),u(this,La)?(C(this,xp,Py).call(this),u(this,xe).addEventListener("click",u(this,wp)),u(this,xe).addEventListener("keydown",u(this,yp))):(C(this,Ly,dx).call(this),u(this,xe).removeEventListener("click",u(this,wp)),u(this,xe).removeEventListener("keydown",u(this,yp)))},xp=new WeakSet,Py=function(){u(this,xn)||this.render(),this.isVisible?u(this,La)&&u(this,xe).classList.add("focused"):(C(this,cx,mT).call(this),u(this,xe).hidden=!1,u(this,xe).style.zIndex=parseInt(u(this,xe).style.zIndex)+1e3)},Ly=new WeakSet,dx=function(){u(this,xe).classList.remove("focused"),!(u(this,La)||!this.isVisible)&&(u(this,xe).hidden=!0,u(this,xe).style.zIndex=parseInt(u(this,xe).style.zIndex)-1e3)};class TI extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Ht.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}var tb;class rz extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),_(this,tb,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:i}=ga(t.rect),s=this.svgFactory.create(e,i,!0),r=T(this,tb,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),s.append(r),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,tb)}addHighlightArea(){this.container.classList.add("highlightArea")}}tb=new WeakMap;var eb;class az extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),_(this,eb,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:i}=ga(t.rect),s=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,a=T(this,eb,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",e-r),a.setAttribute("height",i-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,eb)}addHighlightArea(){this.container.classList.add("highlightArea")}}eb=new WeakMap;var ib;class oz extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),_(this,ib,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:i}=ga(t.rect),s=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,a=T(this,ib,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",e/2),a.setAttribute("cy",i/2),a.setAttribute("rx",e/2-r/2),a.setAttribute("ry",i/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,ib)}addHighlightArea(){this.container.classList.add("highlightArea")}}ib=new WeakMap;var sb;class RI extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),_(this,sb,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=ga(t.rect),s=this.svgFactory.create(e,i,!0);let r=[];for(const o of t.vertices){const l=o.x-t.rect[0],c=t.rect[3]-o.y;r.push(l+","+c)}r=r.join(" ");const a=T(this,sb,this.svgFactory.createElement(this.svgElementName));return a.setAttribute("points",r),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,sb)}addHighlightArea(){this.container.classList.add("highlightArea")}}sb=new WeakMap;class lz extends RI{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class hz extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var nb;class PI extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),_(this,nb,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=Ht.INK}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=ga(t.rect),s=this.svgFactory.create(e,i,!0);for(const r of t.inkLists){let a=[];for(const l of r){const c=l.x-t.rect[0],h=t.rect[3]-l.y;a.push(`${c},${h}`)}a=a.join(" ");const o=this.svgFactory.createElement(this.svgElementName);u(this,nb).push(o),o.setAttribute("points",a),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),!t.popupRef&&this.hasPopupData&&this._createPopup(),s.append(o)}return this.container.append(s),this.container}getElementsToTriggerPopup(){return u(this,nb)}addHighlightArea(){this.container.classList.add("highlightArea")}}nb=new WeakMap;class cz extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class dz extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class uz extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class fz extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class LI extends ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var rb,ab,ux;class pz extends ze{constructor(t){var e;super(t,{isRenderable:!0}),_(this,ab),_(this,rb,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(e=this.linkService.eventBus)==null||e.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",C(this,ab,ux).bind(this)),T(this,rb,i);const{isMac:s}=ls.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(s?r.metaKey:r.ctrlKey)&&C(this,ab,ux).call(this)}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return u(this,rb)}addHighlightArea(){this.container.classList.add("highlightArea")}}rb=new WeakMap,ab=new WeakSet,ux=function(){var n;(n=this.downloadManager)==null||n.openOrDownloadData(this.content,this.filename)};var lv,tc,Gu,ZA,vT,hv,JA,bT;let gz=(bT=class{constructor({div:n,accessibilityManager:t,annotationCanvasMap:e,annotationEditorUIManager:i,page:s,viewport:r}){_(this,ZA),_(this,hv),_(this,lv,null),_(this,tc,null),_(this,Gu,new Map),this.div=n,T(this,lv,t),T(this,tc,e),this.page=s,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=i}async render(n){var t;const{annotations:e}=n,i=this.div;Ih(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:n.linkService,downloadManager:n.downloadManager,imageResourcesPath:n.imageResourcesPath||"",renderForms:n.renderForms!==!1,svgFactory:new nk,annotationStorage:n.annotationStorage||new hk,enableScripting:n.enableScripting===!0,hasJSActions:n.hasJSActions,fieldObjects:n.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const o=a.annotationType===Fe.POPUP;if(o){const h=s.get(a.id);if(!h)continue;r.elements=h}else{const{width:h,height:f}=ga(a.rect);if(h<=0||f<=0)continue}r.data=a;const l=KU.create(r);if(!l.isRenderable)continue;if(!o&&a.popupRef){const h=s.get(a.popupRef);h?h.push(l):s.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),C(this,ZA,vT).call(this,c,a.id),l.annotationEditorType>0&&(u(this,Gu).set(l.data.id,l),(t=this._annotationEditorUIManager)==null||t.renderAnnotationElement(l))}C(this,hv,JA).call(this)}update({viewport:n}){const t=this.div;this.viewport=n,Ih(t,{rotation:n.rotation}),C(this,hv,JA).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(u(this,Gu).values())}getEditableAnnotation(n){return u(this,Gu).get(n)}},lv=new WeakMap,tc=new WeakMap,Gu=new WeakMap,ZA=new WeakSet,vT=function(n,t){var e;const i=n.firstChild||n;i.id=`${SM}${t}`,this.div.append(n),(e=u(this,lv))==null||e.moveElementInDOM(this.div,n,i,!1)},hv=new WeakSet,JA=function(){if(!u(this,tc))return;const n=this.div;for(const[t,e]of u(this,tc)){const i=n.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;e.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(e):s.classList.contains("annotationContent")?s.after(e):s.before(e):i.append(e)}u(this,tc).clear()},bT);const ob=/\r\n?|\n/g;var lb,hb,cb,db,ub,Ln,Ws,fb,Hs,Sp,fx,MI,px,II,gx,DI,kp,My,Cp,Iy,Hf,pb,mx,FI,Dy,vx,bx,OI;const wn=class oi extends le{constructor(t){super({...t,name:"freeTextEditor"}),_(this,fx),_(this,px),_(this,gx),_(this,kp),_(this,Hf),_(this,mx),_(this,bx),_(this,lb,this.editorDivBlur.bind(this)),_(this,hb,this.editorDivFocus.bind(this)),_(this,cb,this.editorDivInput.bind(this)),_(this,db,this.editorDivKeydown.bind(this)),_(this,ub,this.editorDivPaste.bind(this)),_(this,Ln,void 0),_(this,Ws,""),_(this,fb,`${this.id}-editor`),_(this,Hs,void 0),_(this,Sp,null),T(this,Ln,t.color||oi._defaultColor||le._defaultLineColor),T(this,Hs,t.fontSize||oi._defaultFontSize)}static get _keyboardManager(){const t=oi.prototype,e=r=>r.isEmpty(),i=$p.TRANSLATE_SMALL,s=$p.TRANSLATE_BIG;return Ut(this,"_keyboardManager",new Lm([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static initialize(t,e){le.initialize(t,e,{strings:["pdfjs-free-text-default-content"]});const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Ct.FREETEXT_SIZE:oi._defaultFontSize=e;break;case Ct.FREETEXT_COLOR:oi._defaultColor=e;break}}updateParams(t,e){switch(t){case Ct.FREETEXT_SIZE:C(this,fx,MI).call(this,e);break;case Ct.FREETEXT_COLOR:C(this,px,II).call(this,e);break}}static get defaultPropertiesToUpdate(){return[[Ct.FREETEXT_SIZE,oi._defaultFontSize],[Ct.FREETEXT_COLOR,oi._defaultColor||le._defaultLineColor]]}get propertiesToUpdate(){return[[Ct.FREETEXT_SIZE,u(this,Hs)],[Ct.FREETEXT_COLOR,u(this,Ln)]]}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-oi._internalPadding*t,-(oi._internalPadding+u(this,Hs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(Ht.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",u(this,db)),this.editorDiv.addEventListener("focus",u(this,hb)),this.editorDiv.addEventListener("blur",u(this,lb)),this.editorDiv.addEventListener("input",u(this,cb)),this.editorDiv.addEventListener("paste",u(this,ub)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,fb)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",u(this,db)),this.editorDiv.removeEventListener("focus",u(this,hb)),this.editorDiv.removeEventListener("blur",u(this,lb)),this.editorDiv.removeEventListener("input",u(this,cb)),this.editorDiv.removeEventListener("paste",u(this,ub)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var t;this.width||(this.enableEditMode(),this.editorDiv.focus(),(t=this._initialOptions)!=null&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=u(this,Ws),e=T(this,Ws,C(this,gx,DI).call(this).trimEnd());if(t===e)return;const i=s=>{if(T(this,Ws,s),!s){this.remove();return}C(this,Hf,pb).call(this),this._uiManager.rebuild(this),C(this,kp,My).call(this)};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),C(this,kp,My).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){oi._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,fb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),le._l10nPromise.get("pdfjs-free-text-default-content").then(s=>{var r;return(r=this.editorDiv)==null?void 0:r.setAttribute("default-content",s)}),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${u(this,Hs)}px * var(--scale-factor))`,i.color=u(this,Ln),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),cy(this,this.div,["dblclick","keydown"]),this.width){const[s,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=u(this,Sp);let[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);const[c,h]=this.pageDimensions,[f,p]=this.pageTranslation;let g,m;switch(this.rotation){case 0:g=t+(a[0]-f)/c,m=e+this.height-(a[1]-p)/h;break;case 90:g=t+(a[0]-f)/c,m=e-(a[1]-p)/h,[o,l]=[l,-o];break;case 180:g=t-this.width+(a[0]-f)/c,m=e-(a[1]-p)/h,[o,l]=[-o,-l];break;case 270:g=t+(a[0]-f-this.height*h)/c,m=e+(a[1]-p-this.width*c)/h,[o,l]=[-l,o];break}this.setAt(g*s,m*r,o,l)}else this.setAt(t*s,e*r,this.width*s,this.height*r);C(this,Hf,pb).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var e,i,s;const r=t.clipboardData||window.clipboardData,{types:a}=r;if(a.length===1&&a[0]==="text/plain")return;t.preventDefault();const o=C(e=oi,Dy,vx).call(e,r.getData("text")||"").replaceAll(ob,`
`);if(!o)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!o.includes(`
`)){c.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:h,startOffset:f}=c,p=[],g=[];if(h.nodeType===Node.TEXT_NODE){const y=h.parentElement;if(g.push(h.nodeValue.slice(f).replaceAll(ob,"")),y!==this.editorDiv){let w=p;for(const x of this.editorDiv.childNodes){if(x===y){w=g;continue}w.push(C(i=oi,Cp,Iy).call(i,x))}}p.push(h.nodeValue.slice(0,f).replaceAll(ob,""))}else if(h===this.editorDiv){let y=p,w=0;for(const x of this.editorDiv.childNodes)w++===f&&(y=g),y.push(C(s=oi,Cp,Iy).call(s,x))}T(this,Ws,`${p.join(`
`)}${o}${g.join(`
`)}`),C(this,Hf,pb).call(this);const m=new Range;let b=p.reduce((y,w)=>y+w.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const w=y.nodeValue.length;if(b<=w){m.setStart(y,b),m.setEnd(y,b);break}b-=w}l.removeAllRanges(),l.addRange(m)}get contentDiv(){return this.editorDiv}static deserialize(t,e,i){var s;let r=null;if(t instanceof TI){const{data:{defaultAppearanceData:{fontSize:o,fontColor:l},rect:c,rotation:h,id:f},textContent:p,textPosition:g,parent:{page:{pageNumber:m}}}=t;if(!p||p.length===0)return null;r=t={annotationType:Ht.FREETEXT,color:Array.from(l),fontSize:o,value:p.join(`
`),position:g,pageIndex:m-1,rect:c.slice(0),rotation:h,id:f,deleted:!1}}const a=super.deserialize(t,e,i);return T(a,Hs,t.fontSize),T(a,Ln,ft.makeHexColor(...t.color)),T(a,Ws,C(s=oi,Dy,vx).call(s,t.value)),a.annotationElementId=t.id||null,T(a,Sp,r),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const e=oi._internalPadding*this.parentScale,i=this.getRect(e,e),s=le._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:u(this,Ln)),r={annotationType:Ht.FREETEXT,color:s,fontSize:u(this,Hs),value:C(this,mx,FI).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?r:this.annotationElementId&&!C(this,bx,OI).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:i}=e;i.fontSize=`calc(${u(this,Hs)}px * var(--scale-factor))`,i.color=u(this,Ln),e.replaceChildren();for(const r of u(this,Ws).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),e.append(a)}const s=oi._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(s,s),popupContent:u(this,Ws)}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};lb=new WeakMap,hb=new WeakMap,cb=new WeakMap,db=new WeakMap,ub=new WeakMap,Ln=new WeakMap,Ws=new WeakMap,fb=new WeakMap,Hs=new WeakMap,Sp=new WeakMap,fx=new WeakSet,MI=function(n){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-u(this,Hs))*this.parentScale),T(this,Hs,i),C(this,kp,My).call(this)},e=u(this,Hs);this.addCommands({cmd:t.bind(this,n),undo:t.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},px=new WeakSet,II=function(n){const t=i=>{T(this,Ln,this.editorDiv.style.color=i)},e=u(this,Ln);this.addCommands({cmd:t.bind(this,n),undo:t.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},gx=new WeakSet,DI=function(){var n;const t=[];this.editorDiv.normalize();for(const e of this.editorDiv.childNodes)t.push(C(n=wn,Cp,Iy).call(n,e));return t.join(`
`)},kp=new WeakSet,My=function(){const[n,t]=this.parentDimensions;let e;if(this.isAttachedToDOM)e=this.div.getBoundingClientRect();else{const{currentLayer:i,div:s}=this,r=s.style.display,a=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),e=s.getBoundingClientRect(),s.remove(),s.style.display=r,s.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=e.width/n,this.height=e.height/t):(this.width=e.height/n,this.height=e.width/t),this.fixAndSetPosition()},Cp=new WeakSet,Iy=function(n){return(n.nodeType===Node.TEXT_NODE?n.nodeValue:n.innerText).replaceAll(ob,"")},Hf=new WeakSet,pb=function(){if(this.editorDiv.replaceChildren(),!!u(this,Ws))for(const n of u(this,Ws).split(`
`)){const t=document.createElement("div");t.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(t)}},mx=new WeakSet,FI=function(){return u(this,Ws).replaceAll(" "," ")},Dy=new WeakSet,vx=function(n){return n.replaceAll(" "," ")},bx=new WeakSet,OI=function(n){const{value:t,fontSize:e,color:i,pageIndex:s}=u(this,Sp);return this._hasBeenMoved||n.value!==t||n.fontSize!==e||n.color.some((r,a)=>r!==i[a])||n.pageIndex!==s},_(wn,Cp),_(wn,Dy),Lt(wn,"_freeTextDefaultContent",""),Lt(wn,"_internalPadding",0),Lt(wn,"_defaultColor",null),Lt(wn,"_defaultFontSize",10),Lt(wn,"_type","freetext"),Lt(wn,"_editorType",Ht.FREETEXT);let mz=wn;var Fy,Jo,An,yx,NI,$f,cv,wx,jI,Ax,BI,gb,_x;class Ex{constructor(t,e=0,i=0,s=!0){_(this,yx),_(this,$f),_(this,wx),_(this,Ax),_(this,gb),_(this,Fy,void 0),_(this,Jo,[]),_(this,An,[]);let r=1/0,a=-1/0,o=1/0,l=-1/0;const c=10**-4;for(const{x:y,y:w,width:x,height:R}of t){const I=Math.floor((y-e)/c)*c,D=Math.ceil((y+x+e)/c)*c,F=Math.floor((w-e)/c)*c,O=Math.ceil((w+R+e)/c)*c,L=[I,F,O,!0],M=[D,F,O,!1];u(this,Jo).push(L,M),r=Math.min(r,I),a=Math.max(a,D),o=Math.min(o,F),l=Math.max(l,O)}const h=a-r+2*i,f=l-o+2*i,p=r-i,g=o-i,m=u(this,Jo).at(s?-1:-2),b=[m[0],m[2]];for(const y of u(this,Jo)){const[w,x,R]=y;y[0]=(w-p)/h,y[1]=(x-g)/f,y[2]=(R-g)/f}T(this,Fy,{x:p,y:g,width:h,height:f,lastPoint:b})}getOutlines(){u(this,Jo).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of u(this,Jo))e[3]?(t.push(...C(this,gb,_x).call(this,e)),C(this,wx,jI).call(this,e)):(C(this,Ax,BI).call(this,e),t.push(...C(this,gb,_x).call(this,e)));return C(this,yx,NI).call(this,t)}}Fy=new WeakMap,Jo=new WeakMap,An=new WeakMap,yx=new WeakSet,NI=function(n){const t=[],e=new Set;for(const r of n){const[a,o,l]=r;t.push([a,o,r],[a,l,r])}t.sort((r,a)=>r[1]-a[1]||r[0]-a[0]);for(let r=0,a=t.length;r<a;r+=2){const o=t[r][2],l=t[r+1][2];o.push(l),l.push(o),e.add(o),e.add(l)}const i=[];let s;for(;e.size>0;){const r=e.values().next().value;let[a,o,l,c,h]=r;e.delete(r);let f=a,p=o;for(s=[a,l],i.push(s);;){let g;if(e.has(c))g=c;else if(e.has(h))g=h;else break;e.delete(g),[a,o,l,c,h]=g,f!==a&&(s.push(f,p,a,p===o?o:l),f=a),p=p===o?l:o}s.push(f,p)}return new vz(i,u(this,Fy))},$f=new WeakSet,cv=function(n){const t=u(this,An);let e=0,i=t.length-1;for(;e<=i;){const s=e+i>>1,r=t[s][0];if(r===n)return s;r<n?e=s+1:i=s-1}return i+1},wx=new WeakSet,jI=function([,n,t]){const e=C(this,$f,cv).call(this,n);u(this,An).splice(e,0,[n,t])},Ax=new WeakSet,BI=function([,n,t]){const e=C(this,$f,cv).call(this,n);for(let i=e;i<u(this,An).length;i++){const[s,r]=u(this,An)[i];if(s!==n)break;if(s===n&&r===t){u(this,An).splice(i,1);return}}for(let i=e-1;i>=0;i--){const[s,r]=u(this,An)[i];if(s!==n)break;if(s===n&&r===t){u(this,An).splice(i,1);return}}},gb=new WeakSet,_x=function(n){const[t,e,i]=n,s=[[t,e,i]],r=C(this,$f,cv).call(this,i);for(let a=0;a<r;a++){const[o,l]=u(this,An)[a];for(let c=0,h=s.length;c<h;c++){const[,f,p]=s[c];if(!(l<=f||p<=o)){if(f>=o){if(p>l)s[c][1]=l;else{if(h===1)return[];s.splice(c,1),c--,h--}continue}s[c][2]=o,p>l&&s.push([t,l,p])}}}return s};class WI{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(t,e){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof Tx}}var mb,Uf;class vz extends WI{constructor(t,e){super(),_(this,mb,void 0),_(this,Uf,void 0),T(this,Uf,t),T(this,mb,e)}toSVGPath(){const t=[];for(const e of u(this,Uf)){let[i,s]=e;t.push(`M${i} ${s}`);for(let r=2;r<e.length;r+=2){const a=e[r],o=e[r+1];a===i?(t.push(`V${o}`),s=o):o===s&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,e,i,s],r){const a=[],o=i-t,l=s-e;for(const c of u(this,Uf)){const h=new Array(c.length);for(let f=0;f<c.length;f+=2)h[f]=t+c[f]*o,h[f+1]=s-c[f+1]*l;a.push(h)}return a}get box(){return u(this,mb)}}mb=new WeakMap,Uf=new WeakMap;var Er,Ma,zf,Vf,yr,Bt,pd,gd,vb,bb,Gf,qf,tl,yb,t1,xx,wb,Sx;const Lc=class kx{constructor({x:t,y:e},i,s,r,a,o=0){_(this,wb),_(this,Er,void 0),_(this,Ma,[]),_(this,zf,void 0),_(this,Vf,void 0),_(this,yr,[]),_(this,Bt,new Float64Array(18)),_(this,pd,void 0),_(this,gd,void 0),_(this,vb,void 0),_(this,bb,void 0),_(this,Gf,void 0),_(this,qf,void 0),_(this,tl,[]),T(this,Er,i),T(this,qf,r*s),T(this,Vf,a),u(this,Bt).set([NaN,NaN,NaN,NaN,t,e],6),T(this,zf,o),T(this,bb,u(kx,yb)*s),T(this,vb,u(kx,xx)*s),T(this,Gf,s),u(this,tl).push(t,e)}get free(){return!0}isEmpty(){return isNaN(u(this,Bt)[8])}add({x:t,y:e}){var i;T(this,pd,t),T(this,gd,e);const[s,r,a,o]=u(this,Er);let[l,c,h,f]=u(this,Bt).subarray(8,12);const p=t-h,g=e-f,m=Math.hypot(p,g);if(m<u(this,vb))return!1;const b=m-u(this,bb),y=b/m,w=y*p,x=y*g;let R=l,I=c;l=h,c=f,h+=w,f+=x,(i=u(this,tl))==null||i.push(t,e);const D=-x/b,F=w/b,O=D*u(this,qf),L=F*u(this,qf);return u(this,Bt).set(u(this,Bt).subarray(2,8),0),u(this,Bt).set([h+O,f+L],4),u(this,Bt).set(u(this,Bt).subarray(14,18),12),u(this,Bt).set([h-O,f-L],16),isNaN(u(this,Bt)[6])?(u(this,yr).length===0&&(u(this,Bt).set([l+O,c+L],2),u(this,yr).push(NaN,NaN,NaN,NaN,(l+O-s)/a,(c+L-r)/o),u(this,Bt).set([l-O,c-L],14),u(this,Ma).push(NaN,NaN,NaN,NaN,(l-O-s)/a,(c-L-r)/o)),u(this,Bt).set([R,I,l,c,h,f],6),!this.isEmpty()):(u(this,Bt).set([R,I,l,c,h,f],6),Math.abs(Math.atan2(I-c,R-l)-Math.atan2(x,w))<Math.PI/2?([l,c,h,f]=u(this,Bt).subarray(2,6),u(this,yr).push(NaN,NaN,NaN,NaN,((l+h)/2-s)/a,((c+f)/2-r)/o),[l,c,R,I]=u(this,Bt).subarray(14,18),u(this,Ma).push(NaN,NaN,NaN,NaN,((R+l)/2-s)/a,((I+c)/2-r)/o),!0):([R,I,l,c,h,f]=u(this,Bt).subarray(0,6),u(this,yr).push(((R+5*l)/6-s)/a,((I+5*c)/6-r)/o,((5*l+h)/6-s)/a,((5*c+f)/6-r)/o,((l+h)/2-s)/a,((c+f)/2-r)/o),[h,f,l,c,R,I]=u(this,Bt).subarray(12,18),u(this,Ma).push(((R+5*l)/6-s)/a,((I+5*c)/6-r)/o,((5*l+h)/6-s)/a,((5*c+f)/6-r)/o,((l+h)/2-s)/a,((c+f)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=u(this,yr),e=u(this,Ma),i=u(this,Bt).subarray(4,6),s=u(this,Bt).subarray(16,18),[r,a,o,l]=u(this,Er),[c,h,f,p]=C(this,wb,Sx).call(this);if(isNaN(u(this,Bt)[6])&&!this.isEmpty())return`M${(u(this,Bt)[2]-r)/o} ${(u(this,Bt)[3]-a)/l} L${(u(this,Bt)[4]-r)/o} ${(u(this,Bt)[5]-a)/l} L${c} ${h} L${f} ${p} L${(u(this,Bt)[16]-r)/o} ${(u(this,Bt)[17]-a)/l} L${(u(this,Bt)[14]-r)/o} ${(u(this,Bt)[15]-a)/l} Z`;const g=[];g.push(`M${t[4]} ${t[5]}`);for(let m=6;m<t.length;m+=6)isNaN(t[m])?g.push(`L${t[m+4]} ${t[m+5]}`):g.push(`C${t[m]} ${t[m+1]} ${t[m+2]} ${t[m+3]} ${t[m+4]} ${t[m+5]}`);g.push(`L${(i[0]-r)/o} ${(i[1]-a)/l} L${c} ${h} L${f} ${p} L${(s[0]-r)/o} ${(s[1]-a)/l}`);for(let m=e.length-6;m>=6;m-=6)isNaN(e[m])?g.push(`L${e[m+4]} ${e[m+5]}`):g.push(`C${e[m]} ${e[m+1]} ${e[m+2]} ${e[m+3]} ${e[m+4]} ${e[m+5]}`);return g.push(`L${e[4]} ${e[5]} Z`),g.join(" ")}getOutlines(){var t;const e=u(this,yr),i=u(this,Ma),s=u(this,Bt),r=s.subarray(4,6),a=s.subarray(16,18),[o,l,c,h]=u(this,Er),f=new Float64Array((((t=u(this,tl))==null?void 0:t.length)??0)+2);for(let x=0,R=f.length-2;x<R;x+=2)f[x]=(u(this,tl)[x]-o)/c,f[x+1]=(u(this,tl)[x+1]-l)/h;f[f.length-2]=(u(this,pd)-o)/c,f[f.length-1]=(u(this,gd)-l)/h;const[p,g,m,b]=C(this,wb,Sx).call(this);if(isNaN(s[6])&&!this.isEmpty()){const x=new Float64Array(36);return x.set([NaN,NaN,NaN,NaN,(s[2]-o)/c,(s[3]-l)/h,NaN,NaN,NaN,NaN,(s[4]-o)/c,(s[5]-l)/h,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,m,b,NaN,NaN,NaN,NaN,(s[16]-o)/c,(s[17]-l)/h,NaN,NaN,NaN,NaN,(s[14]-o)/c,(s[15]-l)/h],0),new Tx(x,f,u(this,Er),u(this,Gf),u(this,zf),u(this,Vf))}const y=new Float64Array(u(this,yr).length+24+u(this,Ma).length);let w=e.length;for(let x=0;x<w;x+=2){if(isNaN(e[x])){y[x]=y[x+1]=NaN;continue}y[x]=e[x],y[x+1]=e[x+1]}y.set([NaN,NaN,NaN,NaN,(r[0]-o)/c,(r[1]-l)/h,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,m,b,NaN,NaN,NaN,NaN,(a[0]-o)/c,(a[1]-l)/h],w),w+=24;for(let x=i.length-6;x>=6;x-=6)for(let R=0;R<6;R+=2){if(isNaN(i[x+R])){y[w]=y[w+1]=NaN,w+=2;continue}y[w]=i[x+R],y[w+1]=i[x+R+1],w+=2}return y.set([NaN,NaN,NaN,NaN,i[4],i[5]],w),new Tx(y,f,u(this,Er),u(this,Gf),u(this,zf),u(this,Vf))}};Er=new WeakMap,Ma=new WeakMap,zf=new WeakMap,Vf=new WeakMap,yr=new WeakMap,Bt=new WeakMap,pd=new WeakMap,gd=new WeakMap,vb=new WeakMap,bb=new WeakMap,Gf=new WeakMap,qf=new WeakMap,tl=new WeakMap,yb=new WeakMap,t1=new WeakMap,xx=new WeakMap,wb=new WeakSet,Sx=function(){const n=u(this,Bt).subarray(4,6),t=u(this,Bt).subarray(16,18),[e,i,s,r]=u(this,Er);return[(u(this,pd)+(n[0]-t[0])/2-e)/s,(u(this,gd)+(n[1]-t[1])/2-i)/r,(u(this,pd)+(t[0]-n[0])/2-e)/s,(u(this,gd)+(t[1]-n[1])/2-i)/r]},_(Lc,yb,8),_(Lc,t1,2),_(Lc,xx,u(Lc,yb)+u(Lc,t1));let HI=Lc;var Xf,Qc,Qa,Ab,Ls,_b,Le,Mc,Yf,Ic,Kf,Cx,$I;class Tx extends WI{constructor(t,e,i,s,r,a){super(),_(this,Mc),_(this,Ic),_(this,Cx),_(this,Xf,void 0),_(this,Qc,null),_(this,Qa,void 0),_(this,Ab,void 0),_(this,Ls,void 0),_(this,_b,void 0),_(this,Le,void 0),T(this,Le,t),T(this,Ls,e),T(this,Xf,i),T(this,_b,s),T(this,Qa,r),T(this,Ab,a),C(this,Cx,$I).call(this,a);const{x:o,y:l,width:c,height:h}=u(this,Qc);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-o)/c,t[f+1]=(t[f+1]-l)/h;for(let f=0,p=e.length;f<p;f+=2)e[f]=(e[f]-o)/c,e[f+1]=(e[f+1]-l)/h}toSVGPath(){const t=[`M${u(this,Le)[4]} ${u(this,Le)[5]}`];for(let e=6,i=u(this,Le).length;e<i;e+=6){if(isNaN(u(this,Le)[e])){t.push(`L${u(this,Le)[e+4]} ${u(this,Le)[e+5]}`);continue}t.push(`C${u(this,Le)[e]} ${u(this,Le)[e+1]} ${u(this,Le)[e+2]} ${u(this,Le)[e+3]} ${u(this,Le)[e+4]} ${u(this,Le)[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,s],r){const a=i-t,o=s-e;let l,c;switch(r){case 0:l=C(this,Mc,Yf).call(this,u(this,Le),t,s,a,-o),c=C(this,Mc,Yf).call(this,u(this,Ls),t,s,a,-o);break;case 90:l=C(this,Ic,Kf).call(this,u(this,Le),t,e,a,o),c=C(this,Ic,Kf).call(this,u(this,Ls),t,e,a,o);break;case 180:l=C(this,Mc,Yf).call(this,u(this,Le),i,e,-a,o),c=C(this,Mc,Yf).call(this,u(this,Ls),i,e,-a,o);break;case 270:l=C(this,Ic,Kf).call(this,u(this,Le),i,s,-a,-o),c=C(this,Ic,Kf).call(this,u(this,Ls),i,s,-a,-o);break}return{outline:Array.from(l),points:[Array.from(c)]}}get box(){return u(this,Qc)}getNewOutline(t,e){const{x:i,y:s,width:r,height:a}=u(this,Qc),[o,l,c,h]=u(this,Xf),f=r*c,p=a*h,g=i*c+o,m=s*h+l,b=new HI({x:u(this,Ls)[0]*f+g,y:u(this,Ls)[1]*p+m},u(this,Xf),u(this,_b),t,u(this,Ab),e??u(this,Qa));for(let y=2;y<u(this,Ls).length;y+=2)b.add({x:u(this,Ls)[y]*f+g,y:u(this,Ls)[y+1]*p+m});return b.getOutlines()}}Xf=new WeakMap,Qc=new WeakMap,Qa=new WeakMap,Ab=new WeakMap,Ls=new WeakMap,_b=new WeakMap,Le=new WeakMap,Mc=new WeakSet,Yf=function(n,t,e,i,s){const r=new Float64Array(n.length);for(let a=0,o=n.length;a<o;a+=2)r[a]=t+n[a]*i,r[a+1]=e+n[a+1]*s;return r},Ic=new WeakSet,Kf=function(n,t,e,i,s){const r=new Float64Array(n.length);for(let a=0,o=n.length;a<o;a+=2)r[a]=t+n[a+1]*i,r[a+1]=e+n[a]*s;return r},Cx=new WeakSet,$I=function(n){const t=u(this,Le);let e=t[4],i=t[5],s=e,r=i,a=e,o=i,l=e,c=i;const h=n?Math.max:Math.min;for(let b=6,y=t.length;b<y;b+=6){if(isNaN(t[b]))s=Math.min(s,t[b+4]),r=Math.min(r,t[b+5]),a=Math.max(a,t[b+4]),o=Math.max(o,t[b+5]),c<t[b+5]?(l=t[b+4],c=t[b+5]):c===t[b+5]&&(l=h(l,t[b+4]));else{const w=ft.bezierBoundingBox(e,i,...t.slice(b,b+6));s=Math.min(s,w[0]),r=Math.min(r,w[1]),a=Math.max(a,w[2]),o=Math.max(o,w[3]),c<w[3]?(l=w[2],c=w[3]):c===w[3]&&(l=h(l,w[2]))}e=t[b+4],i=t[b+5]}const f=s-u(this,Qa),p=r-u(this,Qa),g=a-s+2*u(this,Qa),m=o-r+2*u(this,Qa);T(this,Qc,{x:f,y:p,width:g,height:m,lastPoint:[l,c]})};var Oy,Ny,Sn,Dc,Tp,Ze,jy,Qf,Eb,By,fl,Rp,Wy,Rx,Hy,Px,Lx,UI,Ia,el,Mx,zI,xr,Ha;const VI=class il{constructor({editor:t=null,uiManager:e=null}){_(this,Wy),_(this,Hy),_(this,Lx),_(this,Ia),_(this,Mx),_(this,xr),_(this,Oy,C(this,Lx,UI).bind(this)),_(this,Ny,C(this,Mx,zI).bind(this)),_(this,Sn,null),_(this,Dc,null),_(this,Tp,void 0),_(this,Ze,null),_(this,jy,!1),_(this,Qf,!1),_(this,Eb,null),_(this,By,void 0),_(this,fl,null),_(this,Rp,void 0);var i;t?(T(this,Qf,!1),T(this,Rp,Ct.HIGHLIGHT_COLOR),T(this,Eb,t)):(T(this,Qf,!0),T(this,Rp,Ct.HIGHLIGHT_DEFAULT_COLOR)),T(this,fl,(t==null?void 0:t._uiManager)||e),T(this,By,u(this,fl)._eventBus),T(this,Tp,(t==null?void 0:t.color)||((i=u(this,fl))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return Ut(this,"_keyboardManager",new Lm([[["Escape","mac+Escape"],il.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],il.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],il.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],il.prototype._moveToPrevious],[["Home","mac+Home"],il.prototype._moveToBeginning],[["End","mac+End"],il.prototype._moveToEnd]]))}renderButton(){const t=T(this,Sn,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0),t.addEventListener("click",C(this,Ia,el).bind(this)),t.addEventListener("keydown",u(this,Oy));const e=T(this,Dc,document.createElement("span"));return e.className="swatch",e.setAttribute("aria-hidden",!0),e.style.backgroundColor=u(this,Tp),t.append(e),t}renderMainDropdown(){const t=T(this,Ze,C(this,Wy,Rx).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===u(this,Sn)){C(this,Ia,el).call(this,t);return}const e=t.target.getAttribute("data-color");e&&C(this,Hy,Px).call(this,e,t)}_moveToNext(t){var e,i;if(!u(this,xr,Ha)){C(this,Ia,el).call(this,t);return}if(t.target===u(this,Sn)){(e=u(this,Ze).firstChild)==null||e.focus();return}(i=t.target.nextSibling)==null||i.focus()}_moveToPrevious(t){var e,i;if(t.target===((e=u(this,Ze))==null?void 0:e.firstChild)||t.target===u(this,Sn)){u(this,xr,Ha)&&this._hideDropdownFromKeyboard();return}u(this,xr,Ha)||C(this,Ia,el).call(this,t),(i=t.target.previousSibling)==null||i.focus()}_moveToBeginning(t){var e;if(!u(this,xr,Ha)){C(this,Ia,el).call(this,t);return}(e=u(this,Ze).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!u(this,xr,Ha)){C(this,Ia,el).call(this,t);return}(e=u(this,Ze).lastChild)==null||e.focus()}hideDropdown(){var t;(t=u(this,Ze))==null||t.classList.add("hidden"),window.removeEventListener("pointerdown",u(this,Ny))}_hideDropdownFromKeyboard(){var t;if(!u(this,Qf)){if(!u(this,xr,Ha)){(t=u(this,Eb))==null||t.unselect();return}this.hideDropdown(),u(this,Sn).focus({preventScroll:!0,focusVisible:u(this,jy)})}}updateColor(t){if(u(this,Dc)&&(u(this,Dc).style.backgroundColor=t),!u(this,Ze))return;const e=u(this,fl).highlightColors.values();for(const i of u(this,Ze).children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=u(this,Sn))==null||t.remove(),T(this,Sn,null),T(this,Dc,null),(e=u(this,Ze))==null||e.remove(),T(this,Ze,null)}};Oy=new WeakMap,Ny=new WeakMap,Sn=new WeakMap,Dc=new WeakMap,Tp=new WeakMap,Ze=new WeakMap,jy=new WeakMap,Qf=new WeakMap,Eb=new WeakMap,By=new WeakMap,fl=new WeakMap,Rp=new WeakMap,Wy=new WeakSet,Rx=function(){const n=document.createElement("div");n.addEventListener("contextmenu",os),n.className="dropdown",n.role="listbox",n.setAttribute("aria-multiselectable",!1),n.setAttribute("aria-orientation","vertical"),n.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[t,e]of u(this,fl).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",e),i.title=t,i.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${t}`);const s=document.createElement("span");i.append(s),s.className="swatch",s.style.backgroundColor=e,i.setAttribute("aria-selected",e===u(this,Tp)),i.addEventListener("click",C(this,Hy,Px).bind(this,e)),n.append(i)}return n.addEventListener("keydown",u(this,Oy)),n},Hy=new WeakSet,Px=function(n,t){t.stopPropagation(),u(this,By).dispatch("switchannotationeditorparams",{source:this,type:u(this,Rp),value:n})},Lx=new WeakSet,UI=function(n){VI._keyboardManager.exec(this,n)},Ia=new WeakSet,el=function(n){if(u(this,xr,Ha)){this.hideDropdown();return}if(T(this,jy,n.detail===0),window.addEventListener("pointerdown",u(this,Ny)),u(this,Ze)){u(this,Ze).classList.remove("hidden");return}const t=T(this,Ze,C(this,Wy,Rx).call(this));u(this,Sn).append(t)},Mx=new WeakSet,zI=function(n){var t;(t=u(this,Ze))!=null&&t.contains(n.target)||this.hideDropdown()},xr=new WeakSet,Ha=function(){return u(this,Ze)&&!u(this,Ze).classList.contains("hidden")};let GI=VI;var Pp,$y,El,Zc,Lp,Ys,Uy,zy,md,kn,Zi,$s,Ix,Mp,Jc,Je,Zf,sa,xb,Sb,Dx,Vy,Fx,Ox,qI,Nx,XI,jx,yT,kb,Bx,Fc,Jf,xl,vd,Wx,YI,tp,Cb,td,Ip,Hx,KI,$x,QI,Ux,ZI,zx,JI;const Ai=class _i extends le{constructor(t){super({...t,name:"highlightEditor"}),_(this,Sb),_(this,Vy),_(this,Ox),_(this,Nx),_(this,jx),_(this,kb),_(this,Fc),_(this,Wx),_(this,tp),_(this,td),_(this,Hx),_(this,$x),_(this,Pp,null),_(this,$y,0),_(this,El,void 0),_(this,Zc,null),_(this,Lp,null),_(this,Ys,null),_(this,Uy,null),_(this,zy,0),_(this,md,null),_(this,kn,null),_(this,Zi,null),_(this,$s,!1),_(this,Ix,C(this,Wx,YI).bind(this)),_(this,Mp,null),_(this,Jc,void 0),_(this,Je,null),_(this,Zf,""),_(this,sa,void 0),_(this,xb,""),this.color=t.color||_i._defaultColor,T(this,sa,t.thickness||_i._defaultThickness),T(this,Jc,t.opacity||_i._defaultOpacity),T(this,El,t.boxes||null),T(this,xb,t.methodOfCreation||""),T(this,Zf,t.text||""),this._isDraggable=!1,t.highlightId>-1?(T(this,$s,!0),C(this,Vy,Fx).call(this,t),C(this,Fc,Jf).call(this)):(T(this,Pp,t.anchorNode),T(this,$y,t.anchorOffset),T(this,Uy,t.focusNode),T(this,zy,t.focusOffset),C(this,Sb,Dx).call(this),C(this,Fc,Jf).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=_i.prototype;return Ut(this,"_keyboardManager",new Lm([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:u(this,$s)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:u(this,sa),methodOfCreation:u(this,xb)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,e){var i;le.initialize(t,e),_i._defaultColor||(_i._defaultColor=((i=e.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,e){switch(t){case Ct.HIGHLIGHT_DEFAULT_COLOR:_i._defaultColor=e;break;case Ct.HIGHLIGHT_THICKNESS:_i._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return u(this,Mp)}updateParams(t,e){switch(t){case Ct.HIGHLIGHT_COLOR:C(this,Ox,qI).call(this,e);break;case Ct.HIGHLIGHT_THICKNESS:C(this,Nx,XI).call(this,e);break}}static get defaultPropertiesToUpdate(){return[[Ct.HIGHLIGHT_DEFAULT_COLOR,_i._defaultColor],[Ct.HIGHLIGHT_THICKNESS,_i._defaultThickness]]}get propertiesToUpdate(){return[[Ct.HIGHLIGHT_COLOR,this.color||_i._defaultColor],[Ct.HIGHLIGHT_THICKNESS,u(this,sa)||_i._defaultThickness],[Ct.HIGHLIGHT_FREE,u(this,$s)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(T(this,Lp,new GI({editor:this})),t.addColorPicker(u(this,Lp))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(C(this,td,Ip).call(this))}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,C(this,td,Ip).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){C(this,kb,Bx).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,Fc,Jf).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var e;let i=!1;this.parent&&!t?C(this,kb,Bx).call(this):t&&(C(this,Fc,Jf).call(this,t),i=!this.parent&&((e=this.div)==null?void 0:e.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var e,i,s;const{drawLayer:r}=this.parent;let a;u(this,$s)?(t=(t-this.rotation+360)%360,a=C(e=_i,xl,vd).call(e,u(this,kn).box,t)):a=C(i=_i,xl,vd).call(i,this,t),r.rotate(u(this,Zi),t),r.rotate(u(this,Je),t),r.updateBox(u(this,Zi),a),r.updateBox(u(this,Je),C(s=_i,xl,vd).call(s,u(this,Ys).box,t))}render(){if(this.div)return this.div;const t=super.render();u(this,Zf)&&(t.setAttribute("aria-label",u(this,Zf)),t.setAttribute("role","mark")),u(this,$s)?t.classList.add("free"):this.div.addEventListener("keydown",u(this,Ix));const e=T(this,md,document.createElement("div"));t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=u(this,Zc);const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),cy(this,u(this,md),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.parent.drawLayer.addClass(u(this,Je),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(u(this,Je),"hovered")}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:C(this,tp,Cb).call(this,!0);break;case 1:case 3:C(this,tp,Cb).call(this,!1);break}}select(){var t,e;super.select(),u(this,Je)&&((t=this.parent)==null||t.drawLayer.removeClass(u(this,Je),"hovered"),(e=this.parent)==null||e.drawLayer.addClass(u(this,Je),"selected"))}unselect(){var t;super.unselect(),u(this,Je)&&((t=this.parent)==null||t.drawLayer.removeClass(u(this,Je),"selected"),u(this,$s)||C(this,tp,Cb).call(this,!1))}get _mustFixPosition(){return!u(this,$s)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.show(u(this,Zi),t),this.parent.drawLayer.show(u(this,Je),t))}static startHighlighting(t,e,{target:i,x:s,y:r}){const{x:a,y:o,width:l,height:c}=i.getBoundingClientRect(),h=m=>{C(this,Ux,ZI).call(this,t,m)},f={capture:!0,passive:!1},p=m=>{m.preventDefault(),m.stopPropagation()},g=m=>{i.removeEventListener("pointermove",h),window.removeEventListener("blur",g),window.removeEventListener("pointerup",g),window.removeEventListener("pointerdown",p,f),window.removeEventListener("contextmenu",os),C(this,zx,JI).call(this,t,m)};window.addEventListener("blur",g),window.addEventListener("pointerup",g),window.addEventListener("pointerdown",p,f),window.addEventListener("contextmenu",os),i.addEventListener("pointermove",h),this._freeHighlight=new HI({x:s,y:r},[a,o,l,c],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(t,e,i){var s;const r=super.deserialize(t,e,i),{rect:[a,o,l,c],color:h,quadPoints:f}=t;r.color=ft.makeHexColor(...h),T(r,Jc,t.opacity);const[p,g]=r.pageDimensions;r.width=(l-a)/p,r.height=(c-o)/g;const m=T(r,El,[]);for(let b=0;b<f.length;b+=8)m.push({x:(f[4]-l)/p,y:(c-(1-f[b+5]))/g,width:(f[b+2]-f[b])/p,height:(f[b+5]-f[b+1])/g});return C(s=r,Sb,Dx).call(s),r}serialize(t=!1){if(this.isEmpty()||t)return null;const e=this.getRect(0,0),i=le._colorManager.convert(this.color);return{annotationType:Ht.HIGHLIGHT,color:i,opacity:u(this,Jc),thickness:u(this,sa),quadPoints:C(this,Hx,KI).call(this),outlines:C(this,$x,QI).call(this,e),pageIndex:this.pageIndex,rect:e,rotation:C(this,td,Ip).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};Pp=new WeakMap,$y=new WeakMap,El=new WeakMap,Zc=new WeakMap,Lp=new WeakMap,Ys=new WeakMap,Uy=new WeakMap,zy=new WeakMap,md=new WeakMap,kn=new WeakMap,Zi=new WeakMap,$s=new WeakMap,Ix=new WeakMap,Mp=new WeakMap,Jc=new WeakMap,Je=new WeakMap,Zf=new WeakMap,sa=new WeakMap,xb=new WeakMap,Sb=new WeakSet,Dx=function(){const n=new Ex(u(this,El),.001);T(this,kn,n.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=u(this,kn).box;const t=new Ex(u(this,El),.0025,.001,this._uiManager.direction==="ltr");T(this,Ys,t.getOutlines());const{lastPoint:e}=u(this,Ys).box;T(this,Mp,[(e[0]-this.x)/this.width,(e[1]-this.y)/this.height])},Vy=new WeakSet,Fx=function({highlightOutlines:n,highlightId:t,clipPathId:e}){var i,s;if(T(this,kn,n),T(this,Ys,n.getNewOutline(u(this,sa)/2+1.5,.0025)),t>=0)T(this,Zi,t),T(this,Zc,e),this.parent.drawLayer.finalizeLine(t,n),T(this,Je,this.parent.drawLayer.highlightOutline(u(this,Ys)));else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(u(this,Zi),n),this.parent.drawLayer.updateBox(u(this,Zi),C(i=Ai,xl,vd).call(i,u(this,kn).box,(h-this.rotation+360)%360)),this.parent.drawLayer.updateLine(u(this,Je),u(this,Ys)),this.parent.drawLayer.updateBox(u(this,Je),C(s=Ai,xl,vd).call(s,u(this,Ys).box,h))}const{x:r,y:a,width:o,height:l}=n.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=o,this.height=l;break;case 90:{const[h,f]=this.parentDimensions;this.x=a,this.y=1-r,this.width=o*f/h,this.height=l*h/f;break}case 180:this.x=1-r,this.y=1-a,this.width=o,this.height=l;break;case 270:{const[h,f]=this.parentDimensions;this.x=1-a,this.y=r,this.width=o*f/h,this.height=l*h/f;break}}const{lastPoint:c}=u(this,Ys).box;T(this,Mp,[(c[0]-r)/o,(c[1]-a)/l])},Ox=new WeakSet,qI=function(n){const t=i=>{var s,r;this.color=i,(s=this.parent)==null||s.drawLayer.changeColor(u(this,Zi),i),(r=u(this,Lp))==null||r.updateColor(i)},e=this.color;this.addCommands({cmd:t.bind(this,n),undo:t.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(n)},!0)},Nx=new WeakSet,XI=function(n){const t=u(this,sa),e=i=>{T(this,sa,i),C(this,jx,yT).call(this,i)};this.addCommands({cmd:e.bind(this,n),undo:e.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:n},!0)},jx=new WeakSet,yT=function(n){if(!u(this,$s))return;C(this,Vy,Fx).call(this,{highlightOutlines:u(this,kn).getNewOutline(n/2)}),this.fixAndSetPosition();const[t,e]=this.parentDimensions;this.setDims(this.width*t,this.height*e)},kb=new WeakSet,Bx=function(){u(this,Zi)===null||!this.parent||(this.parent.drawLayer.remove(u(this,Zi)),T(this,Zi,null),this.parent.drawLayer.remove(u(this,Je)),T(this,Je,null))},Fc=new WeakSet,Jf=function(n=this.parent){u(this,Zi)===null&&({id:Vs(this,Zi)._,clipPathId:Vs(this,Zc)._}=n.drawLayer.highlight(u(this,kn),this.color,u(this,Jc)),T(this,Je,n.drawLayer.highlightOutline(u(this,Ys))),u(this,md)&&(u(this,md).style.clipPath=u(this,Zc)))},xl=new WeakSet,vd=function({x:n,y:t,width:e,height:i},s){switch(s){case 90:return{x:1-t-i,y:n,width:i,height:e};case 180:return{x:1-n-e,y:1-t-i,width:e,height:i};case 270:return{x:t,y:1-n-e,width:i,height:e}}return{x:n,y:t,width:e,height:i}},Wx=new WeakSet,YI=function(n){Ai._keyboardManager.exec(this,n)},tp=new WeakSet,Cb=function(n){if(!u(this,Pp))return;const t=window.getSelection();n?t.setPosition(u(this,Pp),u(this,$y)):t.setPosition(u(this,Uy),u(this,zy))},td=new WeakSet,Ip=function(){return u(this,$s)?this.rotation:0},Hx=new WeakSet,KI=function(){if(u(this,$s))return null;const[n,t]=this.pageDimensions,e=u(this,El),i=new Array(e.length*8);let s=0;for(const{x:r,y:a,width:o,height:l}of e){const c=r*n,h=(1-a-l)*t;i[s]=i[s+4]=c,i[s+1]=i[s+3]=h,i[s+2]=i[s+6]=c+o*n,i[s+5]=i[s+7]=h+l*t,s+=8}return i},$x=new WeakSet,QI=function(n){return u(this,kn).serialize(n,C(this,td,Ip).call(this))},Ux=new WeakSet,ZI=function(n,t){this._freeHighlight.add(t)&&n.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},zx=new WeakSet,JI=function(n,t){this._freeHighlight.isEmpty()?n.drawLayer.removeFreeHighlight(this._freeHighlightId):n.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},_(Ai,xl),_(Ai,Ux),_(Ai,zx),Lt(Ai,"_defaultColor",null),Lt(Ai,"_defaultOpacity",1),Lt(Ai,"_defaultThickness",12),Lt(Ai,"_l10nPromise"),Lt(Ai,"_type","highlight"),Lt(Ai,"_editorType",Ht.HIGHLIGHT),Lt(Ai,"_freeHighlightId",-1),Lt(Ai,"_freeHighlight",null),Lt(Ai,"_freeHighlightClipId","");let wT=Ai;var ed,id,Tb,Rb,Pb,bd,na,Da,Js,Oc,sd,yd,nd,rd,sl,Vx,t2,Gx,e2,qx,i2,Xx,s2,Lb,e1,Yx,n2,Gy,Kx,Qx,AT,Zx,_T,Jx,ET,tS,xT,eS,ST,Za,pl,Mb,iS,Dp,qy,Fp,Xy,Sl,wd,Ib,sS,ep,dv,nS,r2,uv,i1,rS,a2,aS,o2,Yy,oS,ip,fv,Ad,Op;const Xi=class qs extends le{constructor(t){super({...t,name:"inkEditor"}),_(this,Vx),_(this,Gx),_(this,qx),_(this,Xx),_(this,Lb),_(this,Yx),_(this,Gy),_(this,Qx),_(this,Zx),_(this,Jx),_(this,tS),_(this,eS),_(this,Za),_(this,Mb),_(this,Dp),_(this,Fp),_(this,Sl),_(this,Ib),_(this,ep),_(this,aS),_(this,Yy),_(this,ip),_(this,Ad),_(this,ed,0),_(this,id,0),_(this,Tb,this.canvasPointermove.bind(this)),_(this,Rb,this.canvasPointerleave.bind(this)),_(this,Pb,this.canvasPointerup.bind(this)),_(this,bd,this.canvasPointerdown.bind(this)),_(this,na,null),_(this,Da,new Path2D),_(this,Js,!1),_(this,Oc,!1),_(this,sd,!1),_(this,yd,null),_(this,nd,0),_(this,rd,0),_(this,sl,null),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t,e){le.initialize(t,e)}static updateDefaultParams(t,e){switch(t){case Ct.INK_THICKNESS:qs._defaultThickness=e;break;case Ct.INK_COLOR:qs._defaultColor=e;break;case Ct.INK_OPACITY:qs._defaultOpacity=e/100;break}}updateParams(t,e){switch(t){case Ct.INK_THICKNESS:C(this,Vx,t2).call(this,e);break;case Ct.INK_COLOR:C(this,Gx,e2).call(this,e);break;case Ct.INK_OPACITY:C(this,qx,i2).call(this,e);break}}static get defaultPropertiesToUpdate(){return[[Ct.INK_THICKNESS,qs._defaultThickness],[Ct.INK_COLOR,qs._defaultColor||le._defaultLineColor],[Ct.INK_OPACITY,Math.round(qs._defaultOpacity*100)]]}get propertiesToUpdate(){return[[Ct.INK_THICKNESS,this.thickness||qs._defaultThickness],[Ct.INK_COLOR,this.color||qs._defaultColor||le._defaultLineColor],[Ct.INK_OPACITY,Math.round(100*(this.opacity??qs._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(C(this,Dp,qy).call(this),C(this,Fp,Xy).call(this)),this.isAttachedToDOM||(this.parent.add(this),C(this,Sl,wd).call(this)),C(this,Ad,Op).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,u(this,na)&&(clearTimeout(u(this,na)),T(this,na,null)),u(this,yd).disconnect(),T(this,yd,null),super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,e]=this.parentDimensions,i=this.width*t,s=this.height*e;this.setDimensions(i,s)}enableEditMode(){u(this,Js)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",u(this,bd)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",u(this,bd)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){u(this,Js)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),T(this,Js,!0),this.div.classList.add("disabled"),C(this,Ad,Op).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||u(this,Js)||(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),C(this,Yx,n2).call(this,t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),C(this,Gy,Kx).call(this,t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),C(this,Mb,iS).call(this,t)}canvasPointerleave(t){C(this,Mb,iS).call(this,t)}get isResizable(){return!this.isEmpty()&&u(this,Js)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,s,r,a]=C(this,Xx,s2).call(this);if(this.setAt(i,s,0,0),this.setDims(r,a),C(this,Dp,qy).call(this),this.width){const[o,l]=this.parentDimensions;this.setAspectRatio(this.width*o,this.height*l),this.setAt(t*o,e*l,this.width*o,this.height*l),T(this,sd,!0),C(this,Sl,wd).call(this),this.setDims(this.width*o,this.height*l),C(this,Za,pl).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return C(this,Fp,Xy).call(this),this.div}setDimensions(t,e){const i=Math.round(t),s=Math.round(e);if(u(this,nd)===i&&u(this,rd)===s)return;T(this,nd,i),T(this,rd,s),this.canvas.style.visibility="hidden";const[r,a]=this.parentDimensions;this.width=t/r,this.height=e/a,this.fixAndSetPosition(),u(this,Js)&&C(this,Ib,sS).call(this,t,e),C(this,Sl,wd).call(this),C(this,Za,pl).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(t,e,i){var s,r,a;if(t instanceof PI)return null;const o=super.deserialize(t,e,i);o.thickness=t.thickness,o.color=ft.makeHexColor(...t.color),o.opacity=t.opacity;const[l,c]=o.pageDimensions,h=o.width*l,f=o.height*c,p=o.parentScale,g=t.thickness/2;T(o,Js,!0),T(o,nd,Math.round(h)),T(o,rd,Math.round(f));const{paths:m,rect:b,rotation:y}=t;for(let{bezier:x}of m){x=C(s=qs,rS,a2).call(s,x,b,y);const R=[];o.paths.push(R);let I=p*(x[0]-g),D=p*(x[1]-g);for(let O=2,L=x.length;O<L;O+=6){const M=p*(x[O]-g),W=p*(x[O+1]-g),j=p*(x[O+2]-g),V=p*(x[O+3]-g),z=p*(x[O+4]-g),Y=p*(x[O+5]-g);R.push([[I,D],[M,W],[j,V],[z,Y]]),I=z,D=Y}const F=C(this,nS,r2).call(this,R);o.bezierPath2D.push(F)}const w=C(r=o,Yy,oS).call(r);return T(o,id,Math.max(le.MIN_SIZE,w[2]-w[0])),T(o,ed,Math.max(le.MIN_SIZE,w[3]-w[1])),C(a=o,Ib,sS).call(a,h,f),o}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),e=le._colorManager.convert(this.ctx.strokeStyle);return{annotationType:Ht.INK,color:e,thickness:this.thickness,opacity:this.opacity,paths:C(this,aS,o2).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ed=new WeakMap,id=new WeakMap,Tb=new WeakMap,Rb=new WeakMap,Pb=new WeakMap,bd=new WeakMap,na=new WeakMap,Da=new WeakMap,Js=new WeakMap,Oc=new WeakMap,sd=new WeakMap,yd=new WeakMap,nd=new WeakMap,rd=new WeakMap,sl=new WeakMap,Vx=new WeakSet,t2=function(n){const t=i=>{this.thickness=i,C(this,Ad,Op).call(this)},e=this.thickness;this.addCommands({cmd:t.bind(this,n),undo:t.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Gx=new WeakSet,e2=function(n){const t=i=>{this.color=i,C(this,Za,pl).call(this)},e=this.color;this.addCommands({cmd:t.bind(this,n),undo:t.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},qx=new WeakSet,i2=function(n){const t=i=>{this.opacity=i,C(this,Za,pl).call(this)};n/=100;const e=this.opacity;this.addCommands({cmd:t.bind(this,n),undo:t.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Xx=new WeakSet,s2=function(){const{parentRotation:n,parentDimensions:[t,e]}=this;switch(n){case 90:return[0,e,e,t];case 180:return[t,e,t,e];case 270:return[t,0,e,t];default:return[0,0,t,e]}},Lb=new WeakSet,e1=function(){const{ctx:n,color:t,opacity:e,thickness:i,parentScale:s,scaleFactor:r}=this;n.lineWidth=i*s/r,n.lineCap="round",n.lineJoin="round",n.miterLimit=10,n.strokeStyle=`${t}${I$(e)}`},Yx=new WeakSet,n2=function(n,t){this.canvas.addEventListener("contextmenu",os),this.canvas.addEventListener("pointerleave",u(this,Rb)),this.canvas.addEventListener("pointermove",u(this,Tb)),this.canvas.addEventListener("pointerup",u(this,Pb)),this.canvas.removeEventListener("pointerdown",u(this,bd)),this.isEditing=!0,u(this,sd)||(T(this,sd,!0),C(this,Sl,wd).call(this),this.thickness||(this.thickness=Xi._defaultThickness),this.color||(this.color=Xi._defaultColor||le._defaultLineColor),this.opacity??(this.opacity=Xi._defaultOpacity)),this.currentPath.push([n,t]),T(this,Oc,!1),C(this,Lb,e1).call(this),T(this,sl,()=>{C(this,Jx,ET).call(this),u(this,sl)&&window.requestAnimationFrame(u(this,sl))}),window.requestAnimationFrame(u(this,sl))},Gy=new WeakSet,Kx=function(n,t){const[e,i]=this.currentPath.at(-1);if(this.currentPath.length>1&&n===e&&t===i)return;const s=this.currentPath;let r=u(this,Da);if(s.push([n,t]),T(this,Oc,!0),s.length<=2){r.moveTo(...s[0]),r.lineTo(n,t);return}s.length===3&&(T(this,Da,r=new Path2D),r.moveTo(...s[0])),C(this,tS,xT).call(this,r,...s.at(-3),...s.at(-2),n,t)},Qx=new WeakSet,AT=function(){if(this.currentPath.length===0)return;const n=this.currentPath.at(-1);u(this,Da).lineTo(...n)},Zx=new WeakSet,_T=function(n,t){T(this,sl,null),n=Math.min(Math.max(n,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),C(this,Gy,Kx).call(this,n,t),C(this,Qx,AT).call(this);let e;if(this.currentPath.length!==1)e=C(this,eS,ST).call(this);else{const o=[n,t];e=[[o,o.slice(),o.slice(),o]]}const i=u(this,Da),s=this.currentPath;this.currentPath=[],T(this,Da,new Path2D);const r=()=>{this.allRawPaths.push(s),this.paths.push(e),this.bezierPath2D.push(i),this._uiManager.rebuild(this)},a=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(C(this,Dp,qy).call(this),C(this,Fp,Xy).call(this)),C(this,Ad,Op).call(this))};this.addCommands({cmd:r,undo:a,mustExec:!0})},Jx=new WeakSet,ET=function(){if(!u(this,Oc))return;T(this,Oc,!1);const n=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),e=t.map(r=>r[0]),i=t.map(r=>r[1]);Math.min(...e)-n,Math.max(...e)+n,Math.min(...i)-n,Math.max(...i)+n;const{ctx:s}=this;s.save(),s.clearRect(0,0,this.canvas.width,this.canvas.height);for(const r of this.bezierPath2D)s.stroke(r);s.stroke(u(this,Da)),s.restore()},tS=new WeakSet,xT=function(n,t,e,i,s,r,a){const o=(t+i)/2,l=(e+s)/2,c=(i+r)/2,h=(s+a)/2;n.bezierCurveTo(o+2*(i-o)/3,l+2*(s-l)/3,c+2*(i-c)/3,h+2*(s-h)/3,c,h)},eS=new WeakSet,ST=function(){const n=this.currentPath;if(n.length<=2)return[[n[0],n[0],n.at(-1),n.at(-1)]];const t=[];let e,[i,s]=n[0];for(e=1;e<n.length-2;e++){const[f,p]=n[e],[g,m]=n[e+1],b=(f+g)/2,y=(p+m)/2,w=[i+2*(f-i)/3,s+2*(p-s)/3],x=[b+2*(f-b)/3,y+2*(p-y)/3];t.push([[i,s],w,x,[b,y]]),[i,s]=[b,y]}const[r,a]=n[e],[o,l]=n[e+1],c=[i+2*(r-i)/3,s+2*(a-s)/3],h=[o+2*(r-o)/3,l+2*(a-l)/3];return t.push([[i,s],c,h,[o,l]]),t},Za=new WeakSet,pl=function(){if(this.isEmpty()){C(this,ep,dv).call(this);return}C(this,Lb,e1).call(this);const{canvas:n,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,n.width,n.height),C(this,ep,dv).call(this);for(const e of this.bezierPath2D)t.stroke(e)},Mb=new WeakSet,iS=function(n){this.canvas.removeEventListener("pointerleave",u(this,Rb)),this.canvas.removeEventListener("pointermove",u(this,Tb)),this.canvas.removeEventListener("pointerup",u(this,Pb)),this.canvas.addEventListener("pointerdown",u(this,bd)),u(this,na)&&clearTimeout(u(this,na)),T(this,na,setTimeout(()=>{T(this,na,null),this.canvas.removeEventListener("contextmenu",os)},10)),C(this,Zx,_T).call(this,n.offsetX,n.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Dp=new WeakSet,qy=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Fp=new WeakSet,Xy=function(){T(this,yd,new ResizeObserver(n=>{const t=n[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)})),u(this,yd).observe(this.div)},Sl=new WeakSet,wd=function(){if(!u(this,sd))return;const[n,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*n),this.canvas.height=Math.ceil(this.height*t),C(this,ep,dv).call(this)},Ib=new WeakSet,sS=function(n,t){const e=C(this,ip,fv).call(this),i=(n-e)/u(this,id),s=(t-e)/u(this,ed);this.scaleFactor=Math.min(i,s)},ep=new WeakSet,dv=function(){const n=C(this,ip,fv).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+n,this.translationY*this.scaleFactor+n)},nS=new WeakSet,r2=function(n){const t=new Path2D;for(let e=0,i=n.length;e<i;e++){const[s,r,a,o]=n[e];e===0&&t.moveTo(...s),t.bezierCurveTo(r[0],r[1],a[0],a[1],o[0],o[1])}return t},uv=new WeakSet,i1=function(n,t,e){const[i,s,r,a]=t;switch(e){case 0:for(let o=0,l=n.length;o<l;o+=2)n[o]+=i,n[o+1]=a-n[o+1];break;case 90:for(let o=0,l=n.length;o<l;o+=2){const c=n[o];n[o]=n[o+1]+i,n[o+1]=c+s}break;case 180:for(let o=0,l=n.length;o<l;o+=2)n[o]=r-n[o],n[o+1]+=s;break;case 270:for(let o=0,l=n.length;o<l;o+=2){const c=n[o];n[o]=r-n[o+1],n[o+1]=a-c}break;default:throw new Error("Invalid rotation")}return n},rS=new WeakSet,a2=function(n,t,e){const[i,s,r,a]=t;switch(e){case 0:for(let o=0,l=n.length;o<l;o+=2)n[o]-=i,n[o+1]=a-n[o+1];break;case 90:for(let o=0,l=n.length;o<l;o+=2){const c=n[o];n[o]=n[o+1]-s,n[o+1]=c-i}break;case 180:for(let o=0,l=n.length;o<l;o+=2)n[o]=r-n[o],n[o+1]-=s;break;case 270:for(let o=0,l=n.length;o<l;o+=2){const c=n[o];n[o]=a-n[o+1],n[o+1]=r-c}break;default:throw new Error("Invalid rotation")}return n},aS=new WeakSet,o2=function(n,t,e,i){var s,r;const a=[],o=this.thickness/2,l=n*t+o,c=n*e+o;for(const h of this.paths){const f=[],p=[];for(let g=0,m=h.length;g<m;g++){const[b,y,w,x]=h[g];if(b[0]===x[0]&&b[1]===x[1]&&m===1){const j=n*b[0]+l,V=n*b[1]+c;f.push(j,V),p.push(j,V);break}const R=n*b[0]+l,I=n*b[1]+c,D=n*y[0]+l,F=n*y[1]+c,O=n*w[0]+l,L=n*w[1]+c,M=n*x[0]+l,W=n*x[1]+c;g===0&&(f.push(R,I),p.push(R,I)),f.push(D,F,O,L,M,W),p.push(D,F),g===m-1&&p.push(M,W)}a.push({bezier:C(s=Xi,uv,i1).call(s,f,i,this.rotation),points:C(r=Xi,uv,i1).call(r,p,i,this.rotation)})}return a},Yy=new WeakSet,oS=function(){let n=1/0,t=-1/0,e=1/0,i=-1/0;for(const s of this.paths)for(const[r,a,o,l]of s){const c=ft.bezierBoundingBox(...r,...a,...o,...l);n=Math.min(n,c[0]),e=Math.min(e,c[1]),t=Math.max(t,c[2]),i=Math.max(i,c[3])}return[n,e,t,i]},ip=new WeakSet,fv=function(){return u(this,Js)?Math.ceil(this.thickness*this.parentScale):0},Ad=new WeakSet,Op=function(n=!1){if(this.isEmpty())return;if(!u(this,Js)){C(this,Za,pl).call(this);return}const t=C(this,Yy,oS).call(this),e=C(this,ip,fv).call(this);T(this,id,Math.max(le.MIN_SIZE,t[2]-t[0])),T(this,ed,Math.max(le.MIN_SIZE,t[3]-t[1]));const i=Math.ceil(e+u(this,id)*this.scaleFactor),s=Math.ceil(e+u(this,ed)*this.scaleFactor),[r,a]=this.parentDimensions;this.width=i/r,this.height=s/a,this.setAspectRatio(i,s);const o=this.translationX,l=this.translationY;this.translationX=-t[0],this.translationY=-t[1],C(this,Sl,wd).call(this),C(this,Za,pl).call(this),T(this,nd,i),T(this,rd,s),this.setDims(i,s);const c=n?e/this.scaleFactor/2:0;this.translate(o-this.translationX-c,l-this.translationY-c)},_(Xi,nS),_(Xi,uv),_(Xi,rS),Lt(Xi,"_defaultColor",null),Lt(Xi,"_defaultOpacity",1),Lt(Xi,"_defaultThickness",1),Lt(Xi,"_type","ink"),Lt(Xi,"_editorType",Ht.INK);let bz=Xi;var ki,Ti,gl,So,kl,sp,ra,_d,aa,Qn,Db,Nc,qu,jc,Xu,np,Fb,Ky,lS,hS,kT,cS,CT,Ob,s1,rp,Nb,dS,TT;const jb=class extends le{constructor(t){super({...t,name:"stampEditor"}),_(this,Nc),_(this,jc),_(this,np),_(this,Ky),_(this,hS),_(this,cS),_(this,Ob),_(this,rp),_(this,dS),_(this,ki,null),_(this,Ti,null),_(this,gl,null),_(this,So,null),_(this,kl,null),_(this,sp,""),_(this,ra,null),_(this,_d,null),_(this,aa,null),_(this,Qn,!1),_(this,Db,!1),T(this,So,t.bitmapUrl),T(this,kl,t.bitmapFile)}static initialize(t,e){le.initialize(t,e)}static get supportedTypes(){return Ut(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return Ut(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(Ht.STAMP,{bitmapFile:t.getAsFile()})}remove(){var t,e;u(this,Ti)&&(T(this,ki,null),this._uiManager.imageManager.deleteId(u(this,Ti)),(t=u(this,ra))==null||t.remove(),T(this,ra,null),(e=u(this,_d))==null||e.disconnect(),T(this,_d,null),u(this,aa)&&(clearTimeout(u(this,aa)),T(this,aa,null))),super.remove()}rebuild(){if(!this.parent){u(this,Ti)&&C(this,np,Fb).call(this);return}super.rebuild(),this.div!==null&&(u(this,Ti)&&u(this,ra)===null&&C(this,np,Fb).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(u(this,gl)||u(this,ki)||u(this,So)||u(this,kl)||u(this,Ti))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),u(this,ki)?C(this,Ky,lS).call(this):C(this,np,Fb).call(this),this.width){const[i,s]=this.parentDimensions;this.setAt(t*i,e*s,this.width*i,this.height*s)}return this.div}getImageForAltText(){return u(this,ra)}static deserialize(t,e,i){if(t instanceof LI)return null;const s=super.deserialize(t,e,i),{rect:r,bitmapUrl:a,bitmapId:o,isSvg:l,accessibilityData:c}=t;o&&i.imageManager.isValidId(o)?T(s,Ti,o):T(s,So,a),T(s,Qn,l);const[h,f]=s.pageDimensions;return s.width=(r[2]-r[0])/h,s.height=(r[3]-r[1])/f,c&&(s.altTextData=c),s}serialize(t=!1,e=null){if(this.isEmpty())return null;const i={annotationType:Ht.STAMP,bitmapId:u(this,Ti),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:u(this,Qn),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=C(this,rp,Nb).call(this,!0),i.accessibilityData=this.altTextData,i;const{decorative:s,altText:r}=this.altTextData;if(!s&&r&&(i.accessibilityData={type:"Figure",alt:r}),e===null)return i;e.stamps||(e.stamps=new Map);const a=u(this,Qn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(u(this,Ti)))e.stamps.set(u(this,Ti),{area:a,serialized:i}),i.bitmap=C(this,rp,Nb).call(this,!1);else if(u(this,Qn)){const o=e.stamps.get(u(this,Ti));a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=C(this,rp,Nb).call(this,!1))}return i}};ki=new WeakMap,Ti=new WeakMap,gl=new WeakMap,So=new WeakMap,kl=new WeakMap,sp=new WeakMap,ra=new WeakMap,_d=new WeakMap,aa=new WeakMap,Qn=new WeakMap,Db=new WeakMap,Nc=new WeakSet,qu=function(n,t=!1){if(!n){this.remove();return}T(this,ki,n.bitmap),t||(T(this,Ti,n.id),T(this,Qn,n.isSvg)),n.file&&T(this,sp,n.file.name),C(this,Ky,lS).call(this)},jc=new WeakSet,Xu=function(){T(this,gl,null),this._uiManager.enableWaiting(!1),u(this,ra)&&this.div.focus()},np=new WeakSet,Fb=function(){if(u(this,Ti)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(u(this,Ti)).then(t=>C(this,Nc,qu).call(this,t,!0)).finally(()=>C(this,jc,Xu).call(this));return}if(u(this,So)){const t=u(this,So);T(this,So,null),this._uiManager.enableWaiting(!0),T(this,gl,this._uiManager.imageManager.getFromUrl(t).then(e=>C(this,Nc,qu).call(this,e)).finally(()=>C(this,jc,Xu).call(this)));return}if(u(this,kl)){const t=u(this,kl);T(this,kl,null),this._uiManager.enableWaiting(!0),T(this,gl,this._uiManager.imageManager.getFromFile(t).then(e=>C(this,Nc,qu).call(this,e)).finally(()=>C(this,jc,Xu).call(this)));return}const n=document.createElement("input");n.type="file",n.accept=jb.supportedTypesStr,T(this,gl,new Promise(t=>{n.addEventListener("change",async()=>{if(!n.files||n.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(n.files[0]);C(this,Nc,qu).call(this,e)}t()}),n.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>C(this,jc,Xu).call(this))),n.click()},Ky=new WeakSet,lS=function(){const{div:n}=this;let{width:t,height:e}=u(this,ki);const[i,s]=this.pageDimensions,r=.75;if(this.width)t=this.width*i,e=this.height*s;else if(t>r*i||e>r*s){const c=Math.min(r*i/t,r*s/e);t*=c,e*=c}const[a,o]=this.parentDimensions;this.setDims(t*a/i,e*o/s),this._uiManager.enableWaiting(!1);const l=T(this,ra,document.createElement("canvas"));n.append(l),n.hidden=!1,C(this,Ob,s1).call(this,t,e),C(this,dS,TT).call(this),u(this,Db)||(this.parent.addUndoableEditor(this),T(this,Db,!0)),this._reportTelemetry({action:"inserted_image"}),u(this,sp)&&l.setAttribute("aria-label",u(this,sp))},hS=new WeakSet,kT=function(n,t){var e;const[i,s]=this.parentDimensions;this.width=n/i,this.height=t/s,this.setDims(n,t),(e=this._initialOptions)!=null&&e.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,u(this,aa)!==null&&clearTimeout(u(this,aa)),T(this,aa,setTimeout(()=>{T(this,aa,null),C(this,Ob,s1).call(this,n,t)},200))},cS=new WeakSet,CT=function(n,t){const{width:e,height:i}=u(this,ki);let s=e,r=i,a=u(this,ki);for(;s>2*n||r>2*t;){const o=s,l=r;s>2*n&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const c=new OffscreenCanvas(s,r);c.getContext("2d").drawImage(a,0,0,o,l,0,0,s,r),a=c.transferToImageBitmap()}return a},Ob=new WeakSet,s1=function(n,t){n=Math.ceil(n),t=Math.ceil(t);const e=u(this,ra);if(!e||e.width===n&&e.height===t)return;e.width=n,e.height=t;const i=u(this,Qn)?u(this,ki):C(this,cS,CT).call(this,n,t);if(this._uiManager.hasMLManager&&!this.hasAltText()){const r=new OffscreenCanvas(n,t).getContext("2d");r.drawImage(i,0,0,i.width,i.height,0,0,n,t),this._uiManager.mlGuess({service:"image-to-text",request:{data:r.getImageData(0,0,n,t).data,width:n,height:t,channels:4}}).then(a=>{const o=(a==null?void 0:a.output)||"";this.parent&&o&&!this.hasAltText()&&(this.altTextData={altText:o,decorative:!1})})}const s=e.getContext("2d");s.filter=this._uiManager.hcmFilter,s.drawImage(i,0,0,i.width,i.height,0,0,n,t)},rp=new WeakSet,Nb=function(n){if(n){if(u(this,Qn)){const e=this._uiManager.imageManager.getSvgUrl(u(this,Ti));if(e)return e}const t=document.createElement("canvas");return{width:t.width,height:t.height}=u(this,ki),t.getContext("2d").drawImage(u(this,ki),0,0),t.toDataURL()}if(u(this,Qn)){const[t,e]=this.pageDimensions,i=Math.round(this.width*t*ku.PDF_TO_CSS_UNITS),s=Math.round(this.height*e*ku.PDF_TO_CSS_UNITS),r=new OffscreenCanvas(i,s);return r.getContext("2d").drawImage(u(this,ki),0,0,u(this,ki).width,u(this,ki).height,0,0,i,s),r.transferToImageBitmap()}return structuredClone(u(this,ki))},dS=new WeakSet,TT=function(){T(this,_d,new ResizeObserver(n=>{const t=n[0].contentRect;t.width&&t.height&&C(this,hS,kT).call(this,t.width,t.height)})),u(this,_d).observe(this.div)},Lt(jb,"_type","stamp"),Lt(jb,"_editorType",Ht.STAMP);let yz=jb;var Bc,ap,wr,Wc,Fa,Oa,Na,Ms,nl,Np,op,es,At,Cl,uS,l2,Qy,fS,Bb,pS,Wb,gS,lp,Hb;const $b=class rl{constructor({uiManager:t,pageIndex:e,div:i,accessibilityManager:s,annotationLayer:r,drawLayer:a,textLayer:o,viewport:l,l10n:c}){_(this,uS),_(this,Qy),_(this,Bb),_(this,Wb),_(this,lp),_(this,Bc,void 0),_(this,ap,!1),_(this,wr,null),_(this,Wc,null),_(this,Fa,null),_(this,Oa,null),_(this,Na,null),_(this,Ms,new Map),_(this,nl,!1),_(this,Np,!1),_(this,op,!1),_(this,es,null),_(this,At,void 0);const h=[...u(rl,Cl).values()];if(!rl._initialized){rl._initialized=!0;for(const f of h)f.initialize(c,t)}t.registerEditorTypes(h),T(this,At,t),this.pageIndex=e,this.div=i,T(this,Bc,s),T(this,wr,r),this.viewport=l,T(this,es,o),this.drawLayer=a,u(this,At).addLayer(this)}get isEmpty(){return u(this,Ms).size===0}get isInvisible(){return this.isEmpty&&u(this,At).getMode()===Ht.NONE}updateToolbar(t){u(this,At).updateToolbar(t)}updateMode(t=u(this,At).getMode()){switch(C(this,lp,Hb).call(this),t){case Ht.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ht.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case Ht.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of u(rl,Cl).values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=u(this,es))==null?void 0:e.div)}addInkEditorIfNeeded(t){if(u(this,At).getMode()===Ht.INK){if(!t){for(const e of u(this,Ms).values())if(e.isEmpty()){e.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(t){u(this,At).setEditingState(t)}addCommands(t){u(this,At).addCommands(t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=u(this,wr))==null||e.div.classList.toggle("disabled",!t)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of u(this,Ms).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(u(this,At).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!u(this,wr))return;const e=u(this,wr).getEditableAnnotations();for(const i of e){if(i.hide(),u(this,At).isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){var t;T(this,op,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,i=new Map;for(const r of u(this,Ms).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else i.set(r.annotationElementId,r);(t=this.getEditableAnnotation(r.annotationElementId))==null||t.show(),r.remove()}if(u(this,wr)){const r=u(this,wr).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(u(this,At).isDeletedAnnotationElement(o))continue;let l=i.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(u(this,At).addChangedExistingAnnotation(l),l.renderAnnotationElement(a),l.show(!1)),a.show()}}C(this,lp,Hb).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of u(rl,Cl).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),T(this,op,!1)}getEditableAnnotation(t){var e;return((e=u(this,wr))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){u(this,At).getActive()!==t&&u(this,At).setActiveEditor(t)}enableTextSelection(){var t;this.div.tabIndex=-1,(t=u(this,es))!=null&&t.div&&!u(this,Oa)&&(T(this,Oa,C(this,uS,l2).bind(this)),u(this,es).div.addEventListener("pointerdown",u(this,Oa)),u(this,es).div.classList.add("highlighting"))}disableTextSelection(){var t;this.div.tabIndex=0,(t=u(this,es))!=null&&t.div&&u(this,Oa)&&(u(this,es).div.removeEventListener("pointerdown",u(this,Oa)),T(this,Oa,null),u(this,es).div.classList.remove("highlighting"))}enableClick(){u(this,Fa)||(T(this,Fa,this.pointerdown.bind(this)),T(this,Wc,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",u(this,Fa)),this.div.addEventListener("pointerup",u(this,Wc)))}disableClick(){u(this,Fa)&&(this.div.removeEventListener("pointerdown",u(this,Fa)),this.div.removeEventListener("pointerup",u(this,Wc)),T(this,Fa,null),T(this,Wc,null))}attach(t){u(this,Ms).set(t.id,t);const{annotationElementId:e}=t;e&&u(this,At).isDeletedAnnotationElement(e)&&u(this,At).removeDeletedAnnotationElement(t)}detach(t){var e;u(this,Ms).delete(t.id),(e=u(this,Bc))==null||e.removePointerInTextLayer(t.contentDiv),!u(this,op)&&t.annotationElementId&&u(this,At).addDeletedAnnotationElement(t)}remove(t){this.detach(t),u(this,At).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,u(this,Np)||this.addInkEditorIfNeeded(!1)}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(u(this,At).addDeletedAnnotationElement(t.annotationElementId),le.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),u(this,At).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),u(this,At).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var e;if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!u(this,Na)&&(t._focusEventsAllowed=!1,T(this,Na,setTimeout(()=>{T(this,Na,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),i.focus())},0))),t._structTreeParentId=(e=u(this,Bc))==null?void 0:e.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return u(this,At).getId()}canCreateNewEmptyEditor(){var t;return(t=u(this,Qy,fS))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){u(this,At).updateToolbar(t),u(this,At).updateMode(t);const{offsetX:i,offsetY:s}=C(this,Wb,gS).call(this),r=this.getNextId(),a=C(this,Bb,pS).call(this,{parent:this,id:r,x:i,y:s,uiManager:u(this,At),isCentered:!0,...e});a&&this.add(a)}deserialize(t){var e;return((e=u(rl,Cl).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,u(this,At)))||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),r=C(this,Bb,pS).call(this,{parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:u(this,At),isCentered:e,...i});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(C(this,Wb,gS).call(this),!0)}setSelected(t){u(this,At).setSelected(t)}toggleSelected(t){u(this,At).toggleSelected(t)}isSelected(t){return u(this,At).isSelected(t)}unselect(t){u(this,At).unselect(t)}pointerup(t){const{isMac:e}=ls.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&u(this,nl)){if(T(this,nl,!1),!u(this,ap)){T(this,ap,!0);return}if(u(this,At).getMode()===Ht.STAMP){u(this,At).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(u(this,At).getMode()===Ht.HIGHLIGHT&&this.enableTextSelection(),u(this,nl)){T(this,nl,!1);return}const{isMac:e}=ls.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;T(this,nl,!0);const i=u(this,At).getActive();T(this,ap,!i||i.isEmpty())}findNewParent(t,e,i){const s=u(this,At).findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){var t,e;((t=u(this,At).getActive())==null?void 0:t.parent)===this&&(u(this,At).commitOrRemove(),u(this,At).setActiveEditor(null)),u(this,Na)&&(clearTimeout(u(this,Na)),T(this,Na,null));for(const i of u(this,Ms).values())(e=u(this,Bc))==null||e.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,u(this,Ms).clear(),u(this,At).removeLayer(this)}render({viewport:t}){this.viewport=t,Ih(this.div,t);for(const e of u(this,At).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){u(this,At).commitOrRemove(),C(this,lp,Hb).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Ih(this.div,{rotation:i}),e!==i)for(const s of u(this,Ms).values())s.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return u(this,At).viewParameters.realScale}};Bc=new WeakMap,ap=new WeakMap,wr=new WeakMap,Wc=new WeakMap,Fa=new WeakMap,Oa=new WeakMap,Na=new WeakMap,Ms=new WeakMap,nl=new WeakMap,Np=new WeakMap,op=new WeakMap,es=new WeakMap,At=new WeakMap,Cl=new WeakMap,uS=new WeakSet,l2=function(n){if(u(this,At).unselectAll(),n.target===u(this,es).div){const{isMac:t}=ls.platform;if(n.button!==0||n.ctrlKey&&t)return;u(this,At).showAllEditors("highlight",!0,!0),u(this,es).div.classList.add("free"),wT.startHighlighting(this,u(this,At).direction==="ltr",n),u(this,es).div.addEventListener("pointerup",()=>{u(this,es).div.classList.remove("free")},{once:!0}),n.preventDefault()}},Qy=new WeakSet,fS=function(){return u($b,Cl).get(u(this,At).getMode())},Bb=new WeakSet,pS=function(n){const t=u(this,Qy,fS);return t?new t.prototype.constructor(n):null},Wb=new WeakSet,gS=function(){const{x:n,y:t,width:e,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,n),r=Math.max(0,t),a=Math.min(window.innerWidth,n+e),o=Math.min(window.innerHeight,t+i),l=(s+a)/2-n,c=(r+o)/2-t,[h,f]=this.viewport.rotation%180===0?[l,c]:[c,l];return{offsetX:h,offsetY:f}},lp=new WeakSet,Hb=function(){T(this,Np,!0);for(const n of u(this,Ms).values())n.isEmpty()&&n.remove();T(this,Np,!1)},Lt($b,"_initialized",!1),_($b,Cl,new Map([mz,bz,yz,wT].map(n=>[n._editorType,n])));let wz=$b;var Sr,Ub,Xe,al,zb,mS,Vb,vS,bS,h2;const Hc=class Xs{constructor({pageIndex:t}){_(this,Vb),_(this,bS),_(this,Sr,null),_(this,Ub,0),_(this,Xe,new Map),_(this,al,new Map),this.pageIndex=t}setParent(t){if(!u(this,Sr)){T(this,Sr,t);return}if(u(this,Sr)!==t){if(u(this,Xe).size>0)for(const e of u(this,Xe).values())e.remove(),t.append(e);T(this,Sr,t)}}static get _svgFactory(){return Ut(this,"_svgFactory",new nk)}highlight(t,e,i,s=!1){const r=Vs(this,Ub)._++,a=C(this,Vb,vS).call(this,t.box);a.classList.add("highlight"),t.free&&a.classList.add("free");const o=Xs._svgFactory.createElement("defs");a.append(o);const l=Xs._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${r}`;l.setAttribute("id",c),l.setAttribute("d",t.toSVGPath()),s&&u(this,al).set(r,l);const h=C(this,bS,h2).call(this,o,c),f=Xs._svgFactory.createElement("use");return a.append(f),a.setAttribute("fill",e),a.setAttribute("fill-opacity",i),f.setAttribute("href",`#${c}`),u(this,Xe).set(r,a),{id:r,clipPathId:`url(#${h})`}}highlightOutline(t){const e=Vs(this,Ub)._++,i=C(this,Vb,vS).call(this,t.box);i.classList.add("highlightOutline");const s=Xs._svgFactory.createElement("defs");i.append(s);const r=Xs._svgFactory.createElement("path");s.append(r);const a=`path_p${this.pageIndex}_${e}`;r.setAttribute("id",a),r.setAttribute("d",t.toSVGPath()),r.setAttribute("vector-effect","non-scaling-stroke");let o;if(t.free){i.classList.add("free");const h=Xs._svgFactory.createElement("mask");s.append(h),o=`mask_p${this.pageIndex}_${e}`,h.setAttribute("id",o),h.setAttribute("maskUnits","objectBoundingBox");const f=Xs._svgFactory.createElement("rect");h.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=Xs._svgFactory.createElement("use");h.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const l=Xs._svgFactory.createElement("use");i.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return i.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),u(this,Xe).set(e,i),e}finalizeLine(t,e){const i=u(this,al).get(t);u(this,al).delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){u(this,Xe).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}removeFreeHighlight(t){this.remove(t),u(this,al).delete(t)}updatePath(t,e){u(this,al).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var i;C(i=Xs,zb,mS).call(i,u(this,Xe).get(t),e)}show(t,e){u(this,Xe).get(t).classList.toggle("hidden",!e)}rotate(t,e){u(this,Xe).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){u(this,Xe).get(t).setAttribute("fill",e)}changeOpacity(t,e){u(this,Xe).get(t).setAttribute("fill-opacity",e)}addClass(t,e){u(this,Xe).get(t).classList.add(e)}removeClass(t,e){u(this,Xe).get(t).classList.remove(e)}remove(t){u(this,Sr)!==null&&(u(this,Xe).get(t).remove(),u(this,Xe).delete(t))}destroy(){T(this,Sr,null);for(const t of u(this,Xe).values())t.remove();u(this,Xe).clear()}};Sr=new WeakMap,Ub=new WeakMap,Xe=new WeakMap,al=new WeakMap,zb=new WeakSet,mS=function(n,{x:t=0,y:e=0,width:i=1,height:s=1}={}){const{style:r}=n;r.top=`${100*e}%`,r.left=`${100*t}%`,r.width=`${100*i}%`,r.height=`${100*s}%`},Vb=new WeakSet,vS=function(n){var t;const e=Hc._svgFactory.create(1,1,!0);return u(this,Sr).append(e),e.setAttribute("aria-hidden",!0),C(t=Hc,zb,mS).call(t,e,n),e},bS=new WeakSet,h2=function(n,t){const e=Hc._svgFactory.createElement("clipPath");n.append(e);const i=`clip_${t}`;e.setAttribute("id",i),e.setAttribute("clipPathUnits","objectBoundingBox");const s=Hc._svgFactory.createElement("use");return e.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i},_(Hc,zb);let Az=Hc;var _z=xt.AbortException,Ez=xt.AnnotationEditorLayer,xz=xt.AnnotationEditorParamsType,Sz=xt.AnnotationEditorType,kz=xt.AnnotationEditorUIManager,c2=xt.AnnotationLayer,d2=xt.AnnotationMode,Cz=xt.CMapCompressionType,Tz=xt.ColorPicker,Rz=xt.DOMSVGFactory,Pz=xt.DrawLayer,Lz=xt.FeatureTest,uk=xt.GlobalWorkerOptions,Mz=xt.ImageKind,Iz=xt.InvalidPDFException,Dz=xt.MissingPDFException,Fz=xt.OPS,Oz=xt.Outliner,Nz=xt.PDFDataRangeTransport,jz=xt.PDFDateString,Bz=xt.PDFWorker,Wz=xt.PasswordResponses,Hz=xt.PermissionFlag,$z=xt.PixelsPerInch,Uz=xt.RenderingCancelledException,u2=xt.TextLayer,zz=xt.UnexpectedResponseException,Vz=xt.Util,Gz=xt.VerbosityLevel,qz=xt.XfaLayer,Xz=xt.build,Yz=xt.createValidAbsoluteUrl,Kz=xt.fetchData,f2=xt.getDocument,Qz=xt.getFilenameFromUrl,Zz=xt.getPdfFilenameFromUrl,Jz=xt.getXfaPageViewport,tV=xt.isDataScheme,eV=xt.isPdfFile,iV=xt.noContextMenu,sV=xt.normalizeUnicode,nV=xt.renderTextLayer,rV=xt.setLayerDimensions,aV=xt.shadow,oV=xt.updateTextLayer,p2=xt.version;const lV=Object.freeze(Object.defineProperty({__proto__:null,AbortException:_z,AnnotationEditorLayer:Ez,AnnotationEditorParamsType:xz,AnnotationEditorType:Sz,AnnotationEditorUIManager:kz,AnnotationLayer:c2,AnnotationMode:d2,CMapCompressionType:Cz,ColorPicker:Tz,DOMSVGFactory:Rz,DrawLayer:Pz,FeatureTest:Lz,GlobalWorkerOptions:uk,ImageKind:Mz,InvalidPDFException:Iz,MissingPDFException:Dz,OPS:Fz,Outliner:Oz,PDFDataRangeTransport:Nz,PDFDateString:jz,PDFWorker:Bz,PasswordResponses:Wz,PermissionFlag:Hz,PixelsPerInch:$z,RenderingCancelledException:Uz,TextLayer:u2,UnexpectedResponseException:zz,Util:Vz,VerbosityLevel:Gz,XfaLayer:qz,build:Xz,createValidAbsoluteUrl:Yz,fetchData:Kz,getDocument:f2,getFilenameFromUrl:Qz,getPdfFilenameFromUrl:Zz,getXfaPageViewport:Jz,isDataScheme:tV,isPdfFile:eV,noContextMenu:iV,normalizeUnicode:sV,renderTextLayer:nV,setLayerDimensions:rV,shadow:aV,updateTextLayer:oV,version:p2},Symbol.toStringTag,{value:"Module"}));var qe=function(n,t,e){for(var i=0,s=t.length,r;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))},hV=["onCopy","onCut","onPaste"],cV=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],dV=["onFocus","onBlur"],uV=["onInput","onInvalid","onReset","onSubmit"],fV=["onLoad","onError"],pV=["onKeyDown","onKeyPress","onKeyUp"],gV=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mV=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],vV=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],bV=["onSelect"],yV=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],wV=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],AV=["onScroll"],_V=["onWheel"],EV=["onAnimationStart","onAnimationEnd","onAnimationIteration"],xV=["onTransitionEnd"],SV=["onToggle"],kV=["onChange"],CV=qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe(qe([],hV,!0),cV,!0),dV,!0),uV,!0),fV,!0),pV,!0),gV,!0),mV,!0),vV,!0),bV,!0),yV,!0),wV,!0),AV,!0),_V,!0),EV,!0),xV,!0),kV,!0),SV);function g2(n,t){var e={};return CV.forEach(function(i){var s=n[i];s&&(t?e[i]=function(r){return s(r,t(i))}:e[i]=s)}),e}function Dm(n){var t=!1,e=new Promise(function(i,s){n.then(function(r){return!t&&i(r)}).catch(function(r){return!t&&s(r)})});return{promise:e,cancel:function(){t=!0}}}function m2(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n))for(t=0;t<n.length;t++)n[t]&&(e=m2(n[t]))&&(i&&(i+=" "),i+=e);else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function eA(){for(var n,t,e=0,i="";e<arguments.length;)(n=arguments[e++])&&(t=m2(n))&&(i&&(i+=" "),i+=t);return i}var TV=Tt.env.NODE_ENV==="production",n1="Invariant failed";function oe(n,t){if(!n){if(TV)throw new Error(n1);var e=typeof t=="function"?t():t,i=e?"".concat(n1,": ").concat(e):n1;throw new Error(i)}}var RV=Tt.env.NODE_ENV!=="production",v2=function(){};if(RV){var PV=function(n,t){var e=arguments.length;t=new Array(e>1?e-1:0);for(var i=1;i<e;i++)t[i-1]=arguments[i];var s=0,r="Warning: "+n.replace(/%s/g,function(){return t[s++]});typeof console<"u"&&console.error(r);try{throw new Error(r)}catch{}};v2=function(n,t,e){var i=arguments.length;e=new Array(i>2?i-2:0);for(var s=2;s<i;s++)e[s-2]=arguments[s];if(t===void 0)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");n||PV.apply(null,[t].concat(e))}}var LV=v2;const Mi=eL(LV);var RT=Object.prototype.hasOwnProperty;function PT(n,t,e){for(e of n.keys())if(Ed(e,t))return e}function Ed(n,t){var e,i,s;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((i=n.length)===t.length)for(;i--&&Ed(n[i],t[i]););return i===-1}if(e===Set){if(n.size!==t.size)return!1;for(i of n)if(s=i,s&&typeof s=="object"&&(s=PT(t,s),!s)||!t.has(s))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(i of n)if(s=i[0],s&&typeof s=="object"&&(s=PT(t,s),!s)||!Ed(i[1],t.get(s)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((i=n.byteLength)===t.byteLength)for(;i--&&n.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(n)){if((i=n.byteLength)===t.byteLength)for(;i--&&n[i]===t[i];);return i===-1}if(!e||typeof n=="object"){i=0;for(e in n)if(RT.call(n,e)&&++i&&!RT.call(t,e)||!(e in t)||!Ed(n[e],t[e]))return!1;return Object.keys(t).length===i}}return n!==n&&t!==t}const b2=U.createContext(null);function xd({children:n,type:t}){return N.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:n})}const MV="noopener noreferrer nofollow";class IV{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return oe(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(t){oe(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{oe(this.pdfDocument,"PDF document not loaded."),oe(t,"Destination is not specified."),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{oe(Array.isArray(e),`"${e}" is not a valid destination array.`);const i=e[0];new Promise(s=>{oe(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(r=>{s(r)}).catch(()=>{oe(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?s(i):oe(!1,`"${i}" is not a valid destination reference.`)}).then(s=>{const r=s+1;oe(this.pdfViewer,"PDF viewer is not initialized."),oe(r>=1&&r<=this.pagesCount,`"${r}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:s,pageNumber:r})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;oe(this.pdfViewer,"PDF viewer is not initialized."),oe(t>=1&&t<=this.pagesCount,`"${t}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||MV,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const LT={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},iA=typeof document<"u",y2=iA&&window.location.protocol==="file:";function DV(n){return typeof n<"u"}function Bo(n){return DV(n)&&n!==null}function FV(n){return typeof n=="string"}function OV(n){return n instanceof ArrayBuffer}function NV(n){return oe(iA,"isBlob can only be used in a browser environment"),n instanceof Blob}function yS(n){return FV(n)&&/^data:/.test(n)}function MT(n){oe(yS(n),"Invalid data URI.");const[t="",e=""]=n.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function jV(){return iA&&window.devicePixelRatio||1}const w2="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function IT(){Mi(!y2,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${w2}`)}function BV(){Mi(!y2,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${w2}`)}function Fh(n){n&&n.cancel&&n.cancel()}function wS(n,t){return Object.defineProperty(n,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function WV(n){return n.name==="RenderingCancelledException"}function HV(n){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=s=>{if(!s.target)return e(new Error("Error while reading a file."));const{error:r}=s.target;if(!r)return e(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(n)})}function $V(n,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function Cu(){return U.useReducer($V,{value:void 0,error:void 0})}var UV=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(a){a(r)})}return new(e||(e=Promise))(function(r,a){function o(h){try{c(i.next(h))}catch(f){a(f)}}function l(h){try{c(i.throw(h))}catch(f){a(f)}}function c(h){h.done?r(h.value):s(h.value).then(o,l)}c((i=i.apply(n,[])).next())})},DT=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]]);return e};const{PDFDataRangeTransport:zV}=lV,VV=(n,t)=>{switch(t){case LT.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");n(e);break}case LT.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");n(e);break}}};function FT(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const GV=U.forwardRef(function(n,t){var{children:e,className:i,error:s="Failed to load PDF file.",externalLinkRel:r,externalLinkTarget:a,file:o,inputRef:l,imageResourcesPath:c,loading:h="Loading PDF…",noData:f="No PDF file specified.",onItemClick:p,onLoadError:g,onLoadProgress:m,onLoadSuccess:b,onPassword:y=VV,onSourceError:w,onSourceSuccess:x,options:R,renderMode:I,rotate:D}=n,F=DT(n,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[O,L]=Cu(),{value:M,error:W}=O,[j,V]=Cu(),{value:z,error:Y}=j,K=U.useRef(new IV),G=U.useRef([]),H=U.useRef(void 0),Q=U.useRef(void 0);o&&o!==H.current&&FT(o)&&(Mi(!Ed(o,H.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),H.current=o),R&&R!==Q.current&&(Mi(!Ed(R,Q.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),Q.current=R);const Z=U.useRef({scrollPageIntoView:dt=>{const{dest:et,pageNumber:Rt,pageIndex:Xt=Rt-1}=dt;if(p){p({dest:et,pageIndex:Xt,pageNumber:Rt});return}const pe=G.current[Xt];if(pe){pe.scrollIntoView();return}Mi(!1,`An internal link leading to page ${Rt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});U.useImperativeHandle(t,()=>({linkService:K,pages:G,viewer:Z}),[]);function yt(){x&&x()}function bt(){W&&(Mi(!1,W.toString()),w&&w(W))}function X(){L({type:"RESET"})}U.useEffect(X,[o,L]);const nt=U.useCallback(()=>UV(this,void 0,void 0,function*(){if(!o)return null;if(typeof o=="string")return yS(o)?{data:MT(o)}:(IT(),{url:o});if(o instanceof zV)return{range:o};if(OV(o))return{data:o};if(iA&&NV(o))return{data:yield HV(o)};if(oe(typeof o=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),oe(FT(o),"Invalid parameter object: need either .data, .range or .url"),"url"in o&&typeof o.url=="string"){if(yS(o.url)){const{url:dt}=o,et=DT(o,["url"]),Rt=MT(dt);return Object.assign({data:Rt},et)}IT()}return o}),[o]);U.useEffect(()=>{const dt=Dm(nt());return dt.promise.then(et=>{L({type:"RESOLVE",value:et})}).catch(et=>{L({type:"REJECT",error:et})}),()=>{Fh(dt)}},[nt,L]),U.useEffect(()=>{if(!(typeof M>"u")){if(M===!1){bt();return}yt()}},[M]);function ht(){z&&(b&&b(z),G.current=new Array(z.numPages),K.current.setDocument(z))}function lt(){Y&&(Mi(!1,Y.toString()),g&&g(Y))}function ct(){V({type:"RESET"})}U.useEffect(ct,[V,M]);function st(){if(!M)return;const dt=Object.assign(Object.assign({},M),R),et=f2(dt);m&&(et.onProgress=m),y&&(et.onPassword=y);const Rt=et;return Rt.promise.then(Xt=>{V({type:"RESOLVE",value:Xt})}).catch(Xt=>{Rt.destroyed||V({type:"REJECT",error:Xt})}),()=>{Rt.destroy()}}U.useEffect(st,[R,V,M]),U.useEffect(()=>{if(!(typeof z>"u")){if(z===!1){lt();return}ht()}},[z]);function vt(){K.current.setViewer(Z.current),K.current.setExternalLinkRel(r),K.current.setExternalLinkTarget(a)}U.useEffect(vt,[r,a]);function tt(dt,et){G.current[dt]=et}function it(dt){delete G.current[dt]}const wt=U.useMemo(()=>({imageResourcesPath:c,linkService:K.current,onItemClick:p,pdf:z,registerPage:tt,renderMode:I,rotate:D,unregisterPage:it}),[c,p,z,I,D]),St=U.useMemo(()=>g2(F,()=>z),[F,z]);function rt(){return N.jsx(b2.Provider,{value:wt,children:e})}function mt(){return o?z==null?N.jsx(xd,{type:"loading",children:typeof h=="function"?h():h}):z===!1?N.jsx(xd,{type:"error",children:typeof s=="function"?s():s}):rt():N.jsx(xd,{type:"no-data",children:typeof f=="function"?f():f})}return N.jsx("div",Object.assign({className:eA("react-pdf__Document",i),ref:l,style:{"--scale-factor":"1"}},St,{children:mt()}))});function A2(){return U.useContext(b2)}function _2(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(s){e.forEach(function(r){typeof r=="function"?r(s):r&&(r.current=s)})}}const E2=U.createContext(null),x2={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},qV=/^H(\d+)$/;function XV(n){return n in x2}function sA(n){return"children"in n}function S2(n){return sA(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function YV(n){const t={};if(sA(n)){const{role:e}=n,i=e.match(qV);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(XV(e)){const s=x2[e];s&&(t.role=s)}}return t}function k2(n){const t={};if(sA(n)){if(n.alt!==void 0&&(t["aria-label"]=n.alt),n.lang!==void 0&&(t.lang=n.lang),S2(n)){const[e]=n.children;if(e){const i=k2(e);return Object.assign(Object.assign({},t),i)}}}else"id"in n&&(t["aria-owns"]=n.id);return t}function KV(n){return n?Object.assign(Object.assign({},YV(n)),k2(n)):null}function C2({className:n,node:t}){const e=U.useMemo(()=>KV(t),[t]),i=U.useMemo(()=>!sA(t)||S2(t)?null:t.children.map((s,r)=>N.jsx(C2,{node:s},r)),[t]);return N.jsx("span",Object.assign({className:n},e,{children:i}))}function nA(){return U.useContext(E2)}function QV(){const n=nA();oe(n,"Unable to find Page context.");const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=n,[i,s]=Cu(),{value:r,error:a}=i,{customTextRenderer:o,page:l}=n;function c(){r&&e&&e(r)}function h(){a&&(Mi(!1,a.toString()),t&&t(a))}function f(){s({type:"RESET"})}U.useEffect(f,[s,l]);function p(){if(o||!l)return;const g=Dm(l.getStructTree()),m=g;return g.promise.then(b=>{s({type:"RESOLVE",value:b})}).catch(b=>{s({type:"REJECT",error:b})}),()=>Fh(m)}return U.useEffect(p,[o,l,s]),U.useEffect(()=>{if(r!==void 0){if(r===!1){h();return}c()}},[r]),r?N.jsx(C2,{className:"react-pdf__Page__structTree structTree",node:r}):null}const OT=d2;function ZV(n){const t=nA();oe(t,"Unable to find Page context.");const e=Object.assign(Object.assign({},t),n),{_className:i,canvasBackground:s,devicePixelRatio:r=jV(),onRenderError:a,onRenderSuccess:o,page:l,renderForms:c,renderTextLayer:h,rotate:f,scale:p}=e,{canvasRef:g}=n;oe(l,"Attempted to render page canvas, but no page was specified.");const m=U.useRef(null);function b(){l&&o&&o(wS(l,p))}function y(D){WV(D)||(Mi(!1,D.toString()),a&&a(D))}const w=U.useMemo(()=>l.getViewport({scale:p*r,rotation:f}),[r,l,f,p]),x=U.useMemo(()=>l.getViewport({scale:p,rotation:f}),[l,f,p]);function R(){if(!l)return;l.cleanup();const{current:D}=m;if(!D)return;D.width=w.width,D.height=w.height,D.style.width=`${Math.floor(x.width)}px`,D.style.height=`${Math.floor(x.height)}px`,D.style.visibility="hidden";const F={annotationMode:c?OT.ENABLE_FORMS:OT.ENABLE,canvasContext:D.getContext("2d",{alpha:!1}),viewport:w};s&&(F.background=s);const O=l.render(F),L=O;return O.promise.then(()=>{D.style.visibility="",b()}).catch(y),()=>Fh(L)}U.useEffect(R,[s,m,r,l,c,w,x]);const I=U.useCallback(()=>{const{current:D}=m;D&&(D.width=0,D.height=0)},[m]);return U.useEffect(()=>I,[I]),N.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:_2(g,m),style:{display:"block",userSelect:"none"},children:h?N.jsx(QV,{}):null})}function JV(n){return"str"in n}function t8(){const n=nA();oe(n,"Unable to find Page context.");const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:s,onRenderTextLayerSuccess:r,page:a,pageIndex:o,pageNumber:l,rotate:c,scale:h}=n;oe(a,"Attempted to load page text content, but no page was specified.");const[f,p]=Cu(),{value:g,error:m}=f,b=U.useRef(null),y=U.useRef(void 0);Mi(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function w(){g&&i&&i(g)}function x(){m&&(Mi(!1,m.toString()),e&&e(m))}function R(){p({type:"RESET"})}U.useEffect(R,[a,p]);function I(){if(!a)return;const j=Dm(a.getTextContent()),V=j;return j.promise.then(z=>{p({type:"RESOLVE",value:z})}).catch(z=>{p({type:"REJECT",error:z})}),()=>Fh(V)}U.useEffect(I,[a,p]),U.useEffect(()=>{if(g!==void 0){if(g===!1){x();return}w()}},[g]);const D=U.useCallback(()=>{r&&r()},[r]),F=U.useCallback(j=>{Mi(!1,j.toString()),s&&s(j)},[s]);function O(){const j=y.current;j&&j.classList.add("active")}function L(){const j=y.current;j&&j.classList.remove("active")}const M=U.useMemo(()=>a.getViewport({scale:h,rotation:c}),[a,c,h]);function W(){if(!a||!g)return;const{current:j}=b;if(!j)return;j.innerHTML="";const V=a.streamTextContent({includeMarkedContent:!0}),z={container:j,textContentSource:V,viewport:M},Y=new u2(z),K=Y;return Y.render().then(()=>{const G=document.createElement("div");G.className="endOfContent",j.append(G),y.current=G;const H=j.querySelectorAll('[role="presentation"]');if(t){let Q=0;g.items.forEach((Z,yt)=>{if(!JV(Z))return;const bt=H[Q];if(!bt)return;const X=t(Object.assign({pageIndex:o,pageNumber:l,itemIndex:yt},Z));bt.innerHTML=X,Q+=Z.str&&Z.hasEOL?2:1})}D()}).catch(F),()=>Fh(K)}return U.useLayoutEffect(W,[t,F,D,a,o,l,g,M]),N.jsx("div",{className:eA("react-pdf__Page__textContent","textLayer"),onMouseUp:L,onMouseDown:O,ref:b})}function e8(){const n=A2(),t=nA();oe(t,"Unable to find Page context.");const e=Object.assign(Object.assign({},n),t),{imageResourcesPath:i,linkService:s,onGetAnnotationsError:r,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:l,page:c,pdf:h,renderForms:f,rotate:p,scale:g=1}=e;oe(h,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),oe(c,"Attempted to load page annotations, but no page was specified."),oe(s,"Attempted to load page annotations, but no linkService was specified.");const[m,b]=Cu(),{value:y,error:w}=m,x=U.useRef(null);Mi(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function R(){y&&a&&a(y)}function I(){w&&(Mi(!1,w.toString()),r&&r(w))}function D(){b({type:"RESET"})}U.useEffect(D,[b,c]);function F(){if(!c)return;const j=Dm(c.getAnnotations()),V=j;return j.promise.then(z=>{b({type:"RESOLVE",value:z})}).catch(z=>{b({type:"REJECT",error:z})}),()=>{Fh(V)}}U.useEffect(F,[b,c,f]),U.useEffect(()=>{if(y!==void 0){if(y===!1){I();return}R()}},[y]);function O(){l&&l()}function L(j){Mi(!1,`${j}`),o&&o(j)}const M=U.useMemo(()=>c.getViewport({scale:g,rotation:p}),[c,p,g]);function W(){if(!h||!c||!s||!y)return;const{current:j}=x;if(!j)return;const V=M.clone({dontFlip:!0}),z={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:j,l10n:null,page:c,viewport:V},Y={annotations:y,annotationStorage:h.annotationStorage,div:j,imageResourcesPath:i,linkService:s,page:c,renderForms:f,viewport:V};j.innerHTML="";try{new c2(z).render(Y),O()}catch(K){L(K)}return()=>{}}return U.useEffect(W,[y,i,s,c,f,M]),N.jsx("div",{className:eA("react-pdf__Page__annotations","annotationLayer"),ref:x})}var i8=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]]);return e};const NT=1;function s8(n){const t=A2(),e=Object.assign(Object.assign({},t),n),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:r,canvasRef:a,children:o,className:l,customRenderer:c,customTextRenderer:h,devicePixelRatio:f,error:p="Failed to load the page.",height:g,inputRef:m,loading:b="Loading page…",noData:y="No page specified.",onGetAnnotationsError:w,onGetAnnotationsSuccess:x,onGetStructTreeError:R,onGetStructTreeSuccess:I,onGetTextError:D,onGetTextSuccess:F,onLoadError:O,onLoadSuccess:L,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:W,onRenderError:j,onRenderSuccess:V,onRenderTextLayerError:z,onRenderTextLayerSuccess:Y,pageIndex:K,pageNumber:G,pdf:H,registerPage:Q,renderAnnotationLayer:Z=!0,renderForms:yt=!1,renderMode:bt="canvas",renderTextLayer:X=!0,rotate:nt,scale:ht=NT,unregisterPage:lt,width:ct}=e,st=i8(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[vt,tt]=Cu(),{value:it,error:wt}=vt,St=U.useRef(null);oe(H,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const rt=Bo(G)?G-1:K??null,mt=G??(Bo(K)?K+1:null),dt=nt??(it?it.rotate:null),et=U.useMemo(()=>{if(!it)return null;let v=1;const A=ht??NT;if(ct||g){const E=it.getViewport({scale:1,rotation:dt});ct?v=ct/E.width:g&&(v=g/E.height)}return A*v},[g,it,dt,ht,ct]);function Rt(){return()=>{Bo(rt)&&s&&lt&&lt(rt)}}U.useEffect(Rt,[s,H,rt,lt]);function Xt(){if(L){if(!it||!et)return;L(wS(it,et))}if(s&&Q){if(!Bo(rt)||!St.current)return;Q(rt,St.current)}}function pe(){wt&&(Mi(!1,wt.toString()),O&&O(wt))}function Ce(){tt({type:"RESET"})}U.useEffect(Ce,[tt,H,rt]);function se(){if(!H||!mt)return;const v=Dm(H.getPage(mt)),A=v;return v.promise.then(E=>{tt({type:"RESOLVE",value:E})}).catch(E=>{tt({type:"REJECT",error:E})}),()=>Fh(A)}U.useEffect(se,[tt,H,rt,mt,Q]),U.useEffect(()=>{if(it!==void 0){if(it===!1){pe();return}Xt()}},[it,et]);const Vt=U.useMemo(()=>it&&Bo(rt)&&mt&&Bo(dt)&&Bo(et)?{_className:i,canvasBackground:r,customTextRenderer:h,devicePixelRatio:f,onGetAnnotationsError:w,onGetAnnotationsSuccess:x,onGetStructTreeError:R,onGetStructTreeSuccess:I,onGetTextError:D,onGetTextSuccess:F,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:W,onRenderError:j,onRenderSuccess:V,onRenderTextLayerError:z,onRenderTextLayerSuccess:Y,page:it,pageIndex:rt,pageNumber:mt,renderForms:yt,renderTextLayer:X,rotate:dt,scale:et}:null,[i,r,h,f,w,x,R,I,D,F,M,W,j,V,z,Y,it,rt,mt,yt,X,dt,et]),Gt=U.useMemo(()=>g2(st,()=>it&&(et?wS(it,et):void 0)),[st,it,et]),ge=`${rt}@${et}/${dt}`;function _t(){switch(bt){case"custom":return oe(c,'renderMode was set to "custom", but no customRenderer was passed.'),N.jsx(c,{},`${ge}_custom`);case"none":return null;case"canvas":default:return N.jsx(ZV,{canvasRef:a},`${ge}_canvas`)}}function ei(){return X?N.jsx(t8,{},`${ge}_text`):null}function Ae(){return Z?N.jsx(e8,{},`${ge}_annotations`):null}function ve(){return N.jsxs(E2.Provider,{value:Vt,children:[_t(),ei(),Ae(),o]})}function ii(){return mt?H===null||it===void 0||it===null?N.jsx(xd,{type:"loading",children:typeof b=="function"?b():b}):H===!1||it===!1?N.jsx(xd,{type:"error",children:typeof p=="function"?p():p}):ve():N.jsx(xd,{type:"no-data",children:typeof y=="function"?y():y})}return N.jsx("div",Object.assign({className:eA(i,l),"data-page-number":mt,ref:_2(m,St),style:{"--scale-factor":`${et}`,backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Gt,{children:ii()}))}BV();uk.workerSrc="pdf.worker.mjs";const T2="SET_ZOOM_LEVEL",r1=n=>({type:T2,value:n}),R2="SET_PDF_PAGINATED",n8=n=>({type:R2,value:n}),P2="SET_NUM_PAGES",jT=n=>({type:P2,value:n}),L2="SET_CURRENT_PAGE",BT=n=>({type:L2,value:n}),Ja={defaultZoomLevel:1,zoomLevel:1,zoomJump:.1,paginated:!0,numPages:0,currentPage:1},r8=(n=Ja,t)=>{switch(t.type){case T2:{const{value:e}=t;return{...n,zoomLevel:e}}case R2:{const{value:e}=t;return{...n,paginated:e}}case P2:{const{value:e}=t;return{...n,numPages:e}}case L2:{const{value:e}=t;return{...n,currentPage:e}}default:return n}},Pu=U.createContext({state:Ja,dispatch:()=>null}),a8=({children:n,mainState:t})=>{var e,i,s,r,a,o,l;const[c,h]=U.useReducer(r8,{...Ja,defaultZoomLevel:((i=(e=t.config)==null?void 0:e.pdfZoom)==null?void 0:i.defaultZoom)??Ja.defaultZoomLevel,zoomLevel:((r=(s=t.config)==null?void 0:s.pdfZoom)==null?void 0:r.defaultZoom)??Ja.zoomLevel,zoomJump:((o=(a=t.config)==null?void 0:a.pdfZoom)==null?void 0:o.zoomJump)??Ja.zoomJump,paginated:(l=t.config)!=null&&l.pdfVerticalScrollByDefault?!1:Ja.paginated,mainState:t});return N.jsx(Pu.Provider,{value:{state:c,dispatch:h},children:n})},M2=({pageNum:n})=>{const{state:{mainState:t,paginated:e,zoomLevel:i,numPages:s,currentPage:r}}=U.useContext(Pu),{t:a}=Uh(),o=(t==null?void 0:t.rendererRect)||null,l=n??r;return N.jsxs(o8,{id:"pdf-page-wrapper",$lastPage:l>=s,children:[!e&&N.jsx(l8,{id:"pdf-page-info",children:a("pdfPluginPageNumber",{currentPage:l,allPagesCount:s})}),N.jsx(s8,{pageNumber:l||r,scale:i,height:((o==null?void 0:o.height)??100)-100,width:((o==null?void 0:o.width)??100)-100,loading:a("pdfPluginLoading")})]})},o8=It.div`
  margin: ${n=>n.$lastPage?"20px 0":void 0};
`,l8=It.div`
  padding: 0 0 10px 10px;
  color: ${n=>n.theme.textTertiary};
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`,h8=()=>{const{state:{numPages:n}}=U.useContext(Pu),t=[];for(let e=0;e<n;e++)t.push(N.jsx(M2,{pageNum:e+1},e+1));return N.jsx(N.Fragment,{children:t})},c8=()=>{const{state:{mainState:n,paginated:t},dispatch:e}=U.useContext(Pu),{t:i}=Uh(),s=(n==null?void 0:n.currentDocument)||null;return U.useEffect(()=>{e(jT(Ja.numPages))},[s]),!s||s.fileData===void 0?null:N.jsx(d8,{file:s.fileData,onLoadSuccess:({numPages:r})=>e(jT(r)),loading:N.jsx("span",{children:i("pdfPluginLoading")}),children:t?N.jsx(M2,{}):N.jsx(h8,{})})},d8=It(GV)`
  display: flex;
  flex-direction: column;
  margin: 0 auto;
`,u8=n=>N.jsx(I2,{...n,reverse:!0}),f8=n=>N.jsx(I2,{...n}),I2=n=>{const{color:t,size:e,reverse:i}=n;return N.jsx("svg",{width:e||"100%",height:e||"100%",style:{transform:`${i?"rotate(180deg)":""}`},viewBox:"0 0 12 12",version:"1.1",children:N.jsx("g",{id:"Icons",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:N.jsx("g",{id:"Rounded",transform:"translate(-548.000000, -1000.000000)",children:N.jsx("g",{id:"AV",transform:"translate(100.000000, 852.000000)",children:N.jsx("g",{id:"-Round-/-AV-/-skip_next",transform:"translate(442.000000, 142.000000)",children:N.jsxs("g",{children:[N.jsx("rect",{id:"Rectangle-Copy-52",x:"0",y:"0",width:"24",height:"24"}),N.jsx("path",{d:"M7.58,16.89 L13.35,12.82 C13.91,12.42 13.91,11.58 13.35,11.19 L7.58,7.11 C6.91,6.65 6,7.12 6,7.93 L6,16.07 C6,16.88 6.91,17.35 7.58,16.89 Z M16,7 L16,17 C16,17.55 16.45,18 17,18 C17.55,18 18,17.55 18,17 L18,7 C18,6.45 17.55,6 17,6 C16.45,6 16,6.45 16,7 Z",id:"icon_color",fill:t||"#aaa"})]})})})})})})},p8=n=>{const{color:t,size:e,reverse:i}=n;return N.jsxs("svg",{width:e||"100%",height:e||"100%",style:{transform:`${i?"rotate(180deg)":""}`},id:"Layer_1",viewBox:"0 0 24 24",children:[N.jsx("path",{d:"M20.57,9.43A8,8,0,0,0,5.26,10,5,5,0,1,0,5,20h5V18H5a3,3,0,0,1,0-6,3.1,3.1,0,0,1,.79.12l1.12.31.14-1.15a6,6,0,0,1,11.74-.82l.15.54.54.16A3.46,3.46,0,0,1,22,14.5,3.5,3.5,0,0,1,18.5,18H16v2h2.5A5.48,5.48,0,0,0,20.57,9.43Z",fill:t||"#aaa"}),N.jsx("polygon",{points:"12 11 12 15.59 10.71 14.29 9.29 15.71 13 19.41 16.71 15.71 15.29 14.29 14 15.59 14 11 12 11",fill:t||"#aaa"})]})},g8=n=>N.jsx(D2,{...n}),m8=n=>N.jsx(D2,{...n,reverse:!0}),D2=n=>{const{color:t,size:e,reverse:i}=n;return N.jsx("svg",{width:e||"100%",height:e||"100%",viewBox:"0 0 32 32",version:"1.1",children:N.jsx("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:N.jsx("g",{id:"search-plus-icon",fill:t||"#aaa",children:N.jsx("path",{id:"search-plus",d:i?"M 13 13 L 16 13 L 19 13 L 19 16 L 16 16 L 13 16 L 10 16 L 10 13 Z M 19.4271 21.4271 C 18.0372 22.4175 16.3367 23 14.5 23 C 9.8056 23 6 19.1944 6 14.5 C 6 9.8056 9.8056 6 14.5 6 C 19.1944 6 23 9.8056 23 14.5 C 23 16.3367 22.4175 18.0372 21.4271 19.4271 L 27.0119 25.0119 C 27.5621 25.5621 27.5575 26.4425 27.0117 26.9883 L 26.9883 27.0117 C 26.4439 27.5561 25.5576 27.5576 25.0119 27.0119 L 19.4271 21.4271 L 19.4271 21.4271 L 19.4271 21.4271 Z M 14.5 21 C 18.0899 21 21 18.0899 21 14.5 C 21 10.9101 18.0899 8 14.5 8 C 10.9101 8 8 10.9101 8 14.5 C 8 18.0899 10.9101 21 14.5 21 L 14.5 21 Z":"M 13 13 L 13 10 L 16 10 L 16 13 L 19 13 L 19 16 L 16 16 L 16 19 L 13 19 L 13 16 L 10 16 L 10 13 Z M 19.4271 21.4271 C 18.0372 22.4175 16.3367 23 14.5 23 C 9.8056 23 6 19.1944 6 14.5 C 6 9.8056 9.8056 6 14.5 6 C 19.1944 6 23 9.8056 23 14.5 C 23 16.3367 22.4175 18.0372 21.4271 19.4271 L 27.0119 25.0119 C 27.5621 25.5621 27.5575 26.4425 27.0117 26.9883 L 26.9883 27.0117 C 26.4439 27.5561 25.5576 27.5576 25.0119 27.0119 L 19.4271 21.4271 L 19.4271 21.4271 L 19.4271 21.4271 Z M 14.5 21 C 18.0899 21 21 18.0899 21 14.5 C 21 10.9101 18.0899 8 14.5 8 C 10.9101 8 8 10.9101 8 14.5 C 8 18.0899 10.9101 21 14.5 21 L 14.5 21 Z"})})})})},v8=n=>{const{color:t,size:e}=n;return N.jsx("svg",{width:e||"100%",height:e||"100%",viewBox:"0 0 24 24",children:N.jsx("path",{fill:t||"#aaa",d:"M9.29,13.29,4,18.59V17a1,1,0,0,0-2,0v4a1,1,0,0,0,.08.38,1,1,0,0,0,.54.54A1,1,0,0,0,3,22H7a1,1,0,0,0,0-2H5.41l5.3-5.29a1,1,0,0,0-1.42-1.42ZM5.41,4H7A1,1,0,0,0,7,2H3a1,1,0,0,0-.38.08,1,1,0,0,0-.54.54A1,1,0,0,0,2,3V7A1,1,0,0,0,4,7V5.41l5.29,5.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42ZM21,16a1,1,0,0,0-1,1v1.59l-5.29-5.3a1,1,0,0,0-1.42,1.42L18.59,20H17a1,1,0,0,0,0,2h4a1,1,0,0,0,.38-.08,1,1,0,0,0,.54-.54A1,1,0,0,0,22,21V17A1,1,0,0,0,21,16Zm.92-13.38a1,1,0,0,0-.54-.54A1,1,0,0,0,21,2H17a1,1,0,0,0,0,2h1.59l-5.3,5.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L20,5.41V7a1,1,0,0,0,2,0V3A1,1,0,0,0,21.92,2.62Z"})})},b8=n=>{const{color:t,size:e,reverse:i}=n;return N.jsx("svg",{width:e||"100%",height:e||"100%",style:{transform:`${i?"rotate(90deg)":""}`},version:"1.1",id:"Scroll_1",viewBox:"0 0 297 297",xmlSpace:"preserve",children:N.jsx("path",{fill:t||"#aaa",d:`M206.004,200.723h-31.231V96.277h31.231c0.005,0,0.014,0,0.019,0c5.289,0,9.575-4.287,9.575-9.574
  c0-2.342-0.841-4.488-2.236-6.151L156.168,3.851C154.36,1.428,151.515,0,148.492,0c-3.023,0-5.868,1.428-7.675,3.851L83.302,80.98
  c-2.166,2.902-2.507,6.779-0.883,10.017c1.624,3.236,4.936,5.28,8.559,5.28h31.231v104.445H90.978c-3.623,0-6.934,2.044-8.559,5.28
  c-1.624,3.237-1.283,7.114,0.883,10.017l57.513,77.129c1.808,2.424,4.652,3.852,7.675,3.852c3.023,0,5.868-1.428,7.676-3.852
  l57.514-77.129c2.164-2.902,2.507-6.779,0.883-10.017C212.938,202.767,209.627,200.723,206.004,200.723z`})})},y8=()=>{const{state:{currentPage:n,numPages:t},dispatch:e}=U.useContext(Pu),{t:i}=Uh();return N.jsxs(w8,{id:"pdf-pagination",children:[N.jsx(F2,{id:"pdf-pagination-prev",onClick:()=>e(BT(n-1)),disabled:n===1,children:N.jsx(u8,{color:"#000",size:"50%"})}),N.jsx(_8,{id:"pdf-pagination-info",children:i("pdfPluginPageNumber",{currentPage:n,allPagesCount:t})}),N.jsx(A8,{id:"pdf-pagination-next",onClick:()=>e(BT(n+1)),disabled:n>=t,children:N.jsx(f8,{color:"#000",size:"50%"})})]})},w8=It.div`
  display: flex;
  align-items: center;
`,F2=It(Ww)`
  width: 30px;
  height: 30px;
  margin: 0 5px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`,A8=It(F2)`
  margin: 0 20px 0 5px;
`,_8=It.div`
  color: ${n=>n.theme.textPrimary};
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`,E8=()=>{const{t:n}=Uh(),{state:{mainState:t,paginated:e,zoomLevel:i,numPages:s,zoomJump:r,defaultZoomLevel:a},dispatch:o}=U.useContext(Pu),l=(t==null?void 0:t.currentDocument)||null;return N.jsxs(x8,{id:"pdf-controls",children:[e&&s>1&&N.jsx(y8,{}),(l==null?void 0:l.fileData)&&N.jsx(S8,{id:"pdf-download",href:l==null?void 0:l.fileData,download:(l==null?void 0:l.fileName)||(l==null?void 0:l.uri),title:n("downloadButtonLabel"),children:N.jsx(p8,{color:"#000",size:"75%"})}),N.jsx(pv,{id:"pdf-zoom-out",onMouseDown:()=>o(r1(i-r)),children:N.jsx(m8,{color:"#000",size:"80%"})}),N.jsx(pv,{id:"pdf-zoom-in",onMouseDown:()=>o(r1(i+r)),children:N.jsx(g8,{color:"#000",size:"80%"})}),N.jsx(pv,{id:"pdf-zoom-reset",onMouseDown:()=>o(r1(a)),disabled:i===a,children:N.jsx(v8,{color:"#000",size:"70%"})}),s>1&&N.jsx(pv,{id:"pdf-toggle-pagination",onMouseDown:()=>o(n8(!e)),children:N.jsx(b8,{color:"#000",size:"70%",reverse:e})})]})},x8=It.div`
  display: flex;
  position: sticky;
  top: 0;
  left: 0;
  z-index: 1;
  justify-content: flex-end;
  padding: 8px;
  background-color: ${n=>n.theme.tertiary};
  box-shadow: 0px 2px 3px #00000033;

  @media (max-width: 768px) {
    padding: 6px;
  }
`,pv=It(Ww)`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`,S8=It(gM)`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`;uk.workerSrc=new URL(`https://unpkg.com/pdfjs-dist@${p2}/build/pdf.worker.min.mjs`).toString();const fk=({mainState:n})=>N.jsx(a8,{mainState:n,children:N.jsxs(k8,{id:"pdf-renderer","data-testid":"pdf-renderer",children:[N.jsx(E8,{}),N.jsx(c8,{})]})});fk.fileTypes=["pdf","application/pdf"];fk.weight=0;const k8=It.div`
  display: flex;
  flex-direction: column;
  flex: 1;

  /* width */
  &::-webkit-scrollbar {
    ${n=>n.theme.disableThemeScrollbar?"":"width: 10px"};
  }
  /* Track */
  &::-webkit-scrollbar-track {
    /* background: ${n=>n.theme.secondary}; */
  }
  /* Handle */
  &::-webkit-scrollbar-thumb {
    background: ${n=>n.theme.tertiary};
  }
  /* Handle on hover */
  &::-webkit-scrollbar-thumb:hover {
    background: ${n=>n.theme.primary};
  }
`,C8=It(pa)`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  height: 100%;
  background-color: white;
  background-image: linear-gradient(45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(-45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, #e0e0e0 75%),
    linear-gradient(-45deg, transparent 75%, #e0e0e0 75%);
  background-size: 20px 20px;
  background-position:
    0 0,
    0 10px,
    10px -10px,
    -10px 0px;
`,pk=n=>N.jsx(C8,{...n});pk.fileTypes=["png","image/png"];pk.weight=0;let la,xs,Zy=[];const T8=()=>{var n=ss(2,0);if(n===18761)xs=!0;else if(n===19789)xs=!1;else throw TypeError("Invalid byte order value.");return xs},R8=()=>{if(ss(2,2)!==42)throw RangeError("You forgot your towel!");return!0},P8=n=>{var t={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},e;return n in t?e=t[n]:e="Tag"+n,e},L8=n=>{var t={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"},e;return n in t&&(e=t[n]),e},M8=n=>{var t;return["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(n)!==-1?t=1:["SHORT","SSHORT"].indexOf(n)!==-1?t=2:["LONG","SLONG","FLOAT"].indexOf(n)!==-1?t=4:["RATIONAL","SRATIONAL","DOUBLE"].indexOf(n)!==-1&&(t=8),t},I8=(n,t,e)=>{e=e||0;var i=Math.floor(e/8),s=t+i,r=e+n,a=32-n;if(r<=0)throw RangeError("No bits requested");if(r<=8)var o=24+e,l=la.getUint8(s,xs);else if(r<=16)var o=16+e,l=la.getUint16(s,xs);else if(r<=32)var o=e,l=la.getUint32(s,xs);else throw RangeError("Too many bits requested");var c={bits:l<<o>>>a,byteOffset:s+Math.floor(r/8),bitOffset:r%8};return c},ss=(n,t)=>{if(n<=0)throw RangeError("No bytes requested");if(n<=1)return la.getUint8(t,xs);if(n<=2)return la.getUint16(t,xs);if(n<=3)return la.getUint32(t,xs)>>>8;if(n<=4)return la.getUint32(t,xs);throw RangeError("Too many bytes requested")},D8=(n,t,e,i)=>{var s=[],r=M8(t),a=r*e;if(a<=4){if(xs===!1)var o=i>>>(4-r)*8;else var o=i;s.push(o)}else for(var l=0;l<e;l++){var c=r*l;if(r>=8)if(["RATIONAL","SRATIONAL"].indexOf(t)!==-1)s.push(ss(4,i+c)),s.push(ss(4,i+c+4));else throw TypeError("Can't handle this field type or size");else s.push(ss(r,i+c))}return t==="ASCII"&&s.forEach(function(h,f,p){p[f]=String.fromCharCode(h)}),s},Wo=(n,t)=>{var e=Math.pow(2,8-t);return Math.floor(n*e+(e-1))},WT=(n,t,e,i)=>(typeof i>"u"&&(i=1),"rgba("+n+", "+t+", "+e+", "+i+")"),O2=n=>{for(var t=ss(2,n),e=[],i=n+2,s=0;s<t;i+=12,s++){var r=ss(2,i),a=ss(2,i+2),o=ss(4,i+4),l=ss(4,i+8),c=P8(r),h=L8(a),f=D8(c,h,o,l);e[c]={type:h,values:f}}Zy.push(e);var p=ss(4,i);return p===0?Zy:O2(p)},F8=(n,t)=>{let e=t||document.createElement("canvas");if(n&&(la=new DataView(n),xs=T8(),!!R8())){var i=ss(4,4);Zy=O2(i);var s=Zy[0],r=s.ImageWidth.values[0],a=s.ImageLength.values[0];e.width=r,e.height=a;var o=[],l=s.Compression?s.Compression.values[0]:1,c=s.SamplesPerPixel.values[0],h=[],f=0,p=!1;if(s.BitsPerSample.values.forEach(function(ge,_t,ei){h[_t]={bitsPerSample:ge,hasBytesPerSample:!1,bytesPerSample:void 0},ge%8===0&&(h[_t].hasBytesPerSample=!0,h[_t].bytesPerSample=ge/8),f+=ge},void 0),f%8===0){p=!0;var g=f/8}var m=s.StripOffsets.values,b=m.length;if(s.StripByteCounts)var y=s.StripByteCounts.values;else if(b===1)var y=[Math.ceil(r*a*f/8)];else throw Error("Cannot recover from missing StripByteCounts");for(var w=0;w<b;w++){var x=m[w];o[w]=[];for(var R=y[w],I=0,D=0,F=1,O=!0,L=[],M=0,W=0,j=0;I<R;I+=F)switch(l){case 1:for(var V=0,L=[];V<c;V++)if(h[V].hasBytesPerSample){var z=h[V].bytesPerSample*V;L.push(ss(h[V].bytesPerSample,x+I+z))}else{var Y=I8(h[V].bitsPerSample,x+I,D);throw L.push(Y.bits),I=Y.byteOffset-x,D=Y.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}if(o[w].push(L),p)F=g;else throw F=0,RangeError("Cannot handle sub-byte bits per pixel");break;case 2:break;case 3:break;case 4:break;case 5:break;case 6:break;case 7:break;case 32773:if(O){O=!1;var K=1,G=1,H=la.getInt8(x+I,xs);H>=0&&H<=127?K=H+1:H>=-127&&H<=-1?G=-H+1:O=!0}else{for(var Q=ss(1,x+I),V=0;V<G;V++){if(h[W].hasBytesPerSample)j=j<<8*M|Q,M++,M===h[W].bytesPerSample&&(L.push(j),j=M=0,W++);else throw RangeError("Cannot handle sub-byte bits per sample");W===c&&(o[w].push(L),L=[],W=0)}K--,K===0&&(O=!0)}F=1;break}}if(e.getContext){var Z=e.getContext("2d");if(Z.fillStyle=WT(255,255,255,0),s.RowsPerStrip)var yt=s.RowsPerStrip.values[0];else var yt=a;var bt=o.length,X=a%yt,nt=X===0?yt:X,ht=yt,lt=0,ct=s.PhotometricInterpretation.values[0],st=[],vt=0;if(s.ExtraSamples&&(st=s.ExtraSamples.values,vt=st.length),s.ColorMap)var tt=s.ColorMap.values,it=Math.pow(2,h[0].bitsPerSample);for(var w=0;w<bt;w++){w+1===bt&&(ht=nt);for(var wt=o[w].length,St=lt*w,rt=0,mt=0;mt<wt;rt++)for(var dt=0;dt<r;dt++,mt++){var et=o[w][mt],Rt=0,Xt=0,pe=0,Ce=1;if(vt>0){for(var se=0;se<vt;se++)if(st[se]===1||st[se]===2){Ce=et[3+se]/256;break}}switch(ct){case 0:if(h[0].hasBytesPerSample)var Vt=Math.pow(16,h[0].bytesPerSample*2);et.forEach(function(_t,ei,Ae){Ae[ei]=Vt-_t});case 1:Rt=Xt=pe=Wo(et[0],h[0].bitsPerSample);break;case 2:Rt=Wo(et[0],h[0].bitsPerSample),Xt=Wo(et[1],h[1].bitsPerSample),pe=Wo(et[2],h[2].bitsPerSample);break;case 3:if(tt===void 0)throw Error("Palette image missing color map");var Gt=et[0];Rt=Wo(tt[Gt],16),Xt=Wo(tt[it+Gt],16),pe=Wo(tt[2*it+Gt],16);break;case 4:throw RangeError("Not Yet Implemented: Transparency mask");case 5:throw RangeError("Not Yet Implemented: CMYK");case 6:throw RangeError("Not Yet Implemented: YCbCr");case 8:throw RangeError("Not Yet Implemented: CIELab");default:throw RangeError("Unknown Photometric Interpretation:",ct)}Z.fillStyle=WT(Rt,Xt,pe,Ce),Z.fillRect(dt,St+rt,1,1)}lt=ht}}return e}},rA=n=>{const{mainState:{currentDocument:t}}=n,{t:e}=Uh(),[i,s]=U.useState(!1),[r,a]=U.useState(!1);return U.useEffect(()=>{if(!t||i)return;const o=document.getElementById("tiff-img");try{o&&F8(t.fileData,o),s(!0)}catch{a(!0)}},[t,i]),r?N.jsx(pa,{...n,children:N.jsx("div",{children:e("brokenFile")})}):N.jsx(pa,{...n,children:N.jsx(O8,{id:"tiff-img"})})};rA.fileTypes=["tif","tiff","image/tif","image/tiff"];rA.weight=0;rA.fileLoader=A6;const O8=It.canvas`
  max-width: 95%;
  max-height: 95%;
`,aA=({mainState:{currentDocument:n}})=>N.jsx(N8,{id:"txt-renderer",children:n==null?void 0:n.fileData});aA.fileTypes=["txt","text/plain"];aA.weight=0;aA.fileLoader=wM;const N8=It.div`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 30px;
`;var N2={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(n,t){(function(e,i){n.exports=i()})(df,function e(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},s=!i.document&&!!i.postMessage,r=i.IS_PAPA_WORKER||!1,a={},o=0,l={parse:function(L,M){var W=(M=M||{}).dynamicTyping||!1;if(O(W)&&(M.dynamicTypingFunction=W,W={}),M.dynamicTyping=W,M.transform=!!O(M.transform)&&M.transform,M.worker&&l.WORKERS_SUPPORTED){var j=function(){if(!l.WORKERS_SUPPORTED)return!1;var z=(K=i.URL||i.webkitURL||null,G=e.toString(),l.BLOB_URL||(l.BLOB_URL=K.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",G,")();"],{type:"text/javascript"})))),Y=new i.Worker(z),K,G;return Y.onmessage=x,Y.id=o++,a[Y.id]=Y}();return j.userStep=M.step,j.userChunk=M.chunk,j.userComplete=M.complete,j.userError=M.error,M.step=O(M.step),M.chunk=O(M.chunk),M.complete=O(M.complete),M.error=O(M.error),delete M.worker,void j.postMessage({input:L,config:M,workerId:j.id})}var V=null;return l.NODE_STREAM_INPUT,typeof L=="string"?(L=function(z){return z.charCodeAt(0)===65279?z.slice(1):z}(L),V=M.download?new f(M):new g(M)):L.readable===!0&&O(L.read)&&O(L.on)?V=new m(M):(i.File&&L instanceof File||L instanceof Object)&&(V=new p(M)),V.stream(L)},unparse:function(L,M){var W=!1,j=!0,V=",",z=`\r
`,Y='"',K=Y+Y,G=!1,H=null,Q=!1;(function(){if(typeof M=="object"){if(typeof M.delimiter!="string"||l.BAD_DELIMITERS.filter(function(X){return M.delimiter.indexOf(X)!==-1}).length||(V=M.delimiter),(typeof M.quotes=="boolean"||typeof M.quotes=="function"||Array.isArray(M.quotes))&&(W=M.quotes),typeof M.skipEmptyLines!="boolean"&&typeof M.skipEmptyLines!="string"||(G=M.skipEmptyLines),typeof M.newline=="string"&&(z=M.newline),typeof M.quoteChar=="string"&&(Y=M.quoteChar),typeof M.header=="boolean"&&(j=M.header),Array.isArray(M.columns)){if(M.columns.length===0)throw new Error("Option columns is empty");H=M.columns}M.escapeChar!==void 0&&(K=M.escapeChar+Y),(typeof M.escapeFormulae=="boolean"||M.escapeFormulae instanceof RegExp)&&(Q=M.escapeFormulae instanceof RegExp?M.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Z=new RegExp(y(Y),"g");if(typeof L=="string"&&(L=JSON.parse(L)),Array.isArray(L)){if(!L.length||Array.isArray(L[0]))return yt(null,L,G);if(typeof L[0]=="object")return yt(H||Object.keys(L[0]),L,G)}else if(typeof L=="object")return typeof L.data=="string"&&(L.data=JSON.parse(L.data)),Array.isArray(L.data)&&(L.fields||(L.fields=L.meta&&L.meta.fields||H),L.fields||(L.fields=Array.isArray(L.data[0])?L.fields:typeof L.data[0]=="object"?Object.keys(L.data[0]):[]),Array.isArray(L.data[0])||typeof L.data[0]=="object"||(L.data=[L.data])),yt(L.fields||[],L.data||[],G);throw new Error("Unable to serialize unrecognized input");function yt(X,nt,ht){var lt="";typeof X=="string"&&(X=JSON.parse(X)),typeof nt=="string"&&(nt=JSON.parse(nt));var ct=Array.isArray(X)&&0<X.length,st=!Array.isArray(nt[0]);if(ct&&j){for(var vt=0;vt<X.length;vt++)0<vt&&(lt+=V),lt+=bt(X[vt],vt);0<nt.length&&(lt+=z)}for(var tt=0;tt<nt.length;tt++){var it=ct?X.length:nt[tt].length,wt=!1,St=ct?Object.keys(nt[tt]).length===0:nt[tt].length===0;if(ht&&!ct&&(wt=ht==="greedy"?nt[tt].join("").trim()==="":nt[tt].length===1&&nt[tt][0].length===0),ht==="greedy"&&ct){for(var rt=[],mt=0;mt<it;mt++){var dt=st?X[mt]:mt;rt.push(nt[tt][dt])}wt=rt.join("").trim()===""}if(!wt){for(var et=0;et<it;et++){0<et&&!St&&(lt+=V);var Rt=ct&&st?X[et]:et;lt+=bt(nt[tt][Rt],et)}tt<nt.length-1&&(!ht||0<it&&!St)&&(lt+=z)}}return lt}function bt(X,nt){if(X==null)return"";if(X.constructor===Date)return JSON.stringify(X).slice(1,25);var ht=!1;Q&&typeof X=="string"&&Q.test(X)&&(X="'"+X,ht=!0);var lt=X.toString().replace(Z,K);return(ht=ht||W===!0||typeof W=="function"&&W(X,nt)||Array.isArray(W)&&W[nt]||function(ct,st){for(var vt=0;vt<st.length;vt++)if(-1<ct.indexOf(st[vt]))return!0;return!1}(lt,l.BAD_DELIMITERS)||-1<lt.indexOf(V)||lt.charAt(0)===" "||lt.charAt(lt.length-1)===" ")?Y+lt+Y:lt}}};if(l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!s&&!!i.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=w,l.ParserHandle=b,l.NetworkStreamer=f,l.FileStreamer=p,l.StringStreamer=g,l.ReadableStreamStreamer=m,i.jQuery){var c=i.jQuery;c.fn.parse=function(L){var M=L.config||{},W=[];return this.each(function(z){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var Y=0;Y<this.files.length;Y++)W.push({file:this.files[Y],inputElem:this,instanceConfig:c.extend({},M)})}),j(),this;function j(){if(W.length!==0){var z,Y,K,G,H=W[0];if(O(L.before)){var Q=L.before(H.file,H.inputElem);if(typeof Q=="object"){if(Q.action==="abort")return z="AbortError",Y=H.file,K=H.inputElem,G=Q.reason,void(O(L.error)&&L.error({name:z},Y,K,G));if(Q.action==="skip")return void V();typeof Q.config=="object"&&(H.instanceConfig=c.extend(H.instanceConfig,Q.config))}else if(Q==="skip")return void V()}var Z=H.instanceConfig.complete;H.instanceConfig.complete=function(yt){O(Z)&&Z(yt,H.file,H.inputElem),V()},l.parse(H.file,H.instanceConfig)}else O(L.complete)&&L.complete()}function V(){W.splice(0,1),j()}}}function h(L){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(M){var W=D(M);W.chunkSize=parseInt(W.chunkSize),M.step||M.chunk||(W.chunkSize=null),this._handle=new b(W),(this._handle.streamer=this)._config=W}).call(this,L),this.parseChunk=function(M,W){if(this.isFirstChunk&&O(this._config.beforeFirstChunk)){var j=this._config.beforeFirstChunk(M);j!==void 0&&(M=j)}this.isFirstChunk=!1,this._halted=!1;var V=this._partialLine+M;this._partialLine="";var z=this._handle.parse(V,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Y=z.meta.cursor;this._finished||(this._partialLine=V.substring(Y-this._baseIndex),this._baseIndex=Y),z&&z.data&&(this._rowCount+=z.data.length);var K=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)i.postMessage({results:z,workerId:l.WORKER_ID,finished:K});else if(O(this._config.chunk)&&!W){if(this._config.chunk(z,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);z=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(z.data),this._completeResults.errors=this._completeResults.errors.concat(z.errors),this._completeResults.meta=z.meta),this._completed||!K||!O(this._config.complete)||z&&z.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),K||z&&z.meta.paused||this._nextChunk(),z}this._halted=!0},this._sendError=function(M){O(this._config.error)?this._config.error(M):r&&this._config.error&&i.postMessage({workerId:l.WORKER_ID,error:M,finished:!1})}}function f(L){var M;(L=L||{}).chunkSize||(L.chunkSize=l.RemoteChunkSize),h.call(this,L),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(W){this._input=W,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(M=new XMLHttpRequest,this._config.withCredentials&&(M.withCredentials=this._config.withCredentials),s||(M.onload=F(this._chunkLoaded,this),M.onerror=F(this._chunkError,this)),M.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var W=this._config.downloadRequestHeaders;for(var j in W)M.setRequestHeader(j,W[j])}if(this._config.chunkSize){var V=this._start+this._config.chunkSize-1;M.setRequestHeader("Range","bytes="+this._start+"-"+V)}try{M.send(this._config.downloadRequestBody)}catch(z){this._chunkError(z.message)}s&&M.status===0&&this._chunkError()}},this._chunkLoaded=function(){M.readyState===4&&(M.status<200||400<=M.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:M.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(W){var j=W.getResponseHeader("Content-Range");return j===null?-1:parseInt(j.substring(j.lastIndexOf("/")+1))}(M),this.parseChunk(M.responseText)))},this._chunkError=function(W){var j=M.statusText||W;this._sendError(new Error(j))}}function p(L){var M,W;(L=L||{}).chunkSize||(L.chunkSize=l.LocalChunkSize),h.call(this,L);var j=typeof FileReader<"u";this.stream=function(V){this._input=V,W=V.slice||V.webkitSlice||V.mozSlice,j?((M=new FileReader).onload=F(this._chunkLoaded,this),M.onerror=F(this._chunkError,this)):M=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var V=this._input;if(this._config.chunkSize){var z=Math.min(this._start+this._config.chunkSize,this._input.size);V=W.call(V,this._start,z)}var Y=M.readAsText(V,this._config.encoding);j||this._chunkLoaded({target:{result:Y}})},this._chunkLoaded=function(V){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(V.target.result)},this._chunkError=function(){this._sendError(M.error)}}function g(L){var M;h.call(this,L=L||{}),this.stream=function(W){return M=W,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var W,j=this._config.chunkSize;return j?(W=M.substring(0,j),M=M.substring(j)):(W=M,M=""),this._finished=!M,this.parseChunk(W)}}}function m(L){h.call(this,L=L||{});var M=[],W=!0,j=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(V){this._input=V,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){j&&M.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),M.length?this.parseChunk(M.shift()):W=!0},this._streamData=F(function(V){try{M.push(typeof V=="string"?V:V.toString(this._config.encoding)),W&&(W=!1,this._checkIsFinished(),this.parseChunk(M.shift()))}catch(z){this._streamError(z)}},this),this._streamError=F(function(V){this._streamCleanUp(),this._sendError(V)},this),this._streamEnd=F(function(){this._streamCleanUp(),j=!0,this._streamData("")},this),this._streamCleanUp=F(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function b(L){var M,W,j,V=Math.pow(2,53),z=-V,Y=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,K=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,G=this,H=0,Q=0,Z=!1,yt=!1,bt=[],X={data:[],errors:[],meta:{}};if(O(L.step)){var nt=L.step;L.step=function(tt){if(X=tt,ct())lt();else{if(lt(),X.data.length===0)return;H+=tt.data.length,L.preview&&H>L.preview?W.abort():(X.data=X.data[0],nt(X,G))}}}function ht(tt){return L.skipEmptyLines==="greedy"?tt.join("").trim()==="":tt.length===1&&tt[0].length===0}function lt(){return X&&j&&(vt("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),j=!1),L.skipEmptyLines&&(X.data=X.data.filter(function(tt){return!ht(tt)})),ct()&&function(){if(!X)return;function tt(wt,St){O(L.transformHeader)&&(wt=L.transformHeader(wt,St)),bt.push(wt)}if(Array.isArray(X.data[0])){for(var it=0;ct()&&it<X.data.length;it++)X.data[it].forEach(tt);X.data.splice(0,1)}else X.data.forEach(tt)}(),function(){if(!X||!L.header&&!L.dynamicTyping&&!L.transform)return X;function tt(wt,St){var rt,mt=L.header?{}:[];for(rt=0;rt<wt.length;rt++){var dt=rt,et=wt[rt];L.header&&(dt=rt>=bt.length?"__parsed_extra":bt[rt]),L.transform&&(et=L.transform(et,dt)),et=st(dt,et),dt==="__parsed_extra"?(mt[dt]=mt[dt]||[],mt[dt].push(et)):mt[dt]=et}return L.header&&(rt>bt.length?vt("FieldMismatch","TooManyFields","Too many fields: expected "+bt.length+" fields but parsed "+rt,Q+St):rt<bt.length&&vt("FieldMismatch","TooFewFields","Too few fields: expected "+bt.length+" fields but parsed "+rt,Q+St)),mt}var it=1;return!X.data.length||Array.isArray(X.data[0])?(X.data=X.data.map(tt),it=X.data.length):X.data=tt(X.data,0),L.header&&X.meta&&(X.meta.fields=bt),Q+=it,X}()}function ct(){return L.header&&bt.length===0}function st(tt,it){return wt=tt,L.dynamicTypingFunction&&L.dynamicTyping[wt]===void 0&&(L.dynamicTyping[wt]=L.dynamicTypingFunction(wt)),(L.dynamicTyping[wt]||L.dynamicTyping)===!0?it==="true"||it==="TRUE"||it!=="false"&&it!=="FALSE"&&(function(St){if(Y.test(St)){var rt=parseFloat(St);if(z<rt&&rt<V)return!0}return!1}(it)?parseFloat(it):K.test(it)?new Date(it):it===""?null:it):it;var wt}function vt(tt,it,wt,St){var rt={type:tt,code:it,message:wt};St!==void 0&&(rt.row=St),X.errors.push(rt)}this.parse=function(tt,it,wt){var St=L.quoteChar||'"';if(L.newline||(L.newline=function(dt,et){dt=dt.substring(0,1048576);var Rt=new RegExp(y(et)+"([^]*?)"+y(et),"gm"),Xt=(dt=dt.replace(Rt,"")).split("\r"),pe=dt.split(`
`),Ce=1<pe.length&&pe[0].length<Xt[0].length;if(Xt.length===1||Ce)return`
`;for(var se=0,Vt=0;Vt<Xt.length;Vt++)Xt[Vt][0]===`
`&&se++;return se>=Xt.length/2?`\r
`:"\r"}(tt,St)),j=!1,L.delimiter)O(L.delimiter)&&(L.delimiter=L.delimiter(tt),X.meta.delimiter=L.delimiter);else{var rt=function(dt,et,Rt,Xt,pe){var Ce,se,Vt,Gt;pe=pe||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var ge=0;ge<pe.length;ge++){var _t=pe[ge],ei=0,Ae=0,ve=0;Vt=void 0;for(var ii=new w({comments:Xt,delimiter:_t,newline:et,preview:10}).parse(dt),v=0;v<ii.data.length;v++)if(Rt&&ht(ii.data[v]))ve++;else{var A=ii.data[v].length;Ae+=A,Vt!==void 0?0<A&&(ei+=Math.abs(A-Vt),Vt=A):Vt=A}0<ii.data.length&&(Ae/=ii.data.length-ve),(se===void 0||ei<=se)&&(Gt===void 0||Gt<Ae)&&1.99<Ae&&(se=ei,Ce=_t,Gt=Ae)}return{successful:!!(L.delimiter=Ce),bestDelimiter:Ce}}(tt,L.newline,L.skipEmptyLines,L.comments,L.delimitersToGuess);rt.successful?L.delimiter=rt.bestDelimiter:(j=!0,L.delimiter=l.DefaultDelimiter),X.meta.delimiter=L.delimiter}var mt=D(L);return L.preview&&L.header&&mt.preview++,M=tt,W=new w(mt),X=W.parse(M,it,wt),lt(),Z?{meta:{paused:!0}}:X||{meta:{paused:!1}}},this.paused=function(){return Z},this.pause=function(){Z=!0,W.abort(),M=O(L.chunk)?"":M.substring(W.getCharIndex())},this.resume=function(){G.streamer._halted?(Z=!1,G.streamer.parseChunk(M,!0)):setTimeout(G.resume,3)},this.aborted=function(){return yt},this.abort=function(){yt=!0,W.abort(),X.meta.aborted=!0,O(L.complete)&&L.complete(X),M=""}}function y(L){return L.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(L){var M,W=(L=L||{}).delimiter,j=L.newline,V=L.comments,z=L.step,Y=L.preview,K=L.fastMode,G=M=L.quoteChar===void 0||L.quoteChar===null?'"':L.quoteChar;if(L.escapeChar!==void 0&&(G=L.escapeChar),(typeof W!="string"||-1<l.BAD_DELIMITERS.indexOf(W))&&(W=","),V===W)throw new Error("Comment character same as delimiter");V===!0?V="#":(typeof V!="string"||-1<l.BAD_DELIMITERS.indexOf(V))&&(V=!1),j!==`
`&&j!=="\r"&&j!==`\r
`&&(j=`
`);var H=0,Q=!1;this.parse=function(Z,yt,bt){if(typeof Z!="string")throw new Error("Input must be a string");var X=Z.length,nt=W.length,ht=j.length,lt=V.length,ct=O(z),st=[],vt=[],tt=[],it=H=0;if(!Z)return E();if(L.header&&!yt){var wt=Z.split(j)[0].split(W),St=[],rt={},mt=!1;for(var dt in wt){var et=wt[dt];O(L.transformHeader)&&(et=L.transformHeader(et,dt));var Rt=et,Xt=rt[et]||0;for(0<Xt&&(mt=!0,Rt=et+"_"+Xt),rt[et]=Xt+1;St.includes(Rt);)Rt=Rt+"_"+Xt;St.push(Rt)}if(mt){var pe=Z.split(j);pe[0]=St.join(W),Z=pe.join(j)}}if(K||K!==!1&&Z.indexOf(M)===-1){for(var Ce=Z.split(j),se=0;se<Ce.length;se++){if(tt=Ce[se],H+=tt.length,se!==Ce.length-1)H+=j.length;else if(bt)return E();if(!V||tt.substring(0,lt)!==V){if(ct){if(st=[],ve(tt.split(W)),B(),Q)return E()}else ve(tt.split(W));if(Y&&Y<=se)return st=st.slice(0,Y),E(!0)}}return E()}for(var Vt=Z.indexOf(W,H),Gt=Z.indexOf(j,H),ge=new RegExp(y(G)+y(M),"g"),_t=Z.indexOf(M,H);;)if(Z[H]!==M)if(V&&tt.length===0&&Z.substring(H,H+lt)===V){if(Gt===-1)return E();H=Gt+ht,Gt=Z.indexOf(j,H),Vt=Z.indexOf(W,H)}else if(Vt!==-1&&(Vt<Gt||Gt===-1))tt.push(Z.substring(H,Vt)),H=Vt+nt,Vt=Z.indexOf(W,H);else{if(Gt===-1)break;if(tt.push(Z.substring(H,Gt)),A(Gt+ht),ct&&(B(),Q))return E();if(Y&&st.length>=Y)return E(!0)}else for(_t=H,H++;;){if((_t=Z.indexOf(M,_t+1))===-1)return bt||vt.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:st.length,index:H}),v();if(_t===X-1)return v(Z.substring(H,_t).replace(ge,M));if(M!==G||Z[_t+1]!==G){if(M===G||_t===0||Z[_t-1]!==G){Vt!==-1&&Vt<_t+1&&(Vt=Z.indexOf(W,_t+1)),Gt!==-1&&Gt<_t+1&&(Gt=Z.indexOf(j,_t+1));var ei=ii(Gt===-1?Vt:Math.min(Vt,Gt));if(Z.substr(_t+1+ei,nt)===W){tt.push(Z.substring(H,_t).replace(ge,M)),Z[H=_t+1+ei+nt]!==M&&(_t=Z.indexOf(M,H)),Vt=Z.indexOf(W,H),Gt=Z.indexOf(j,H);break}var Ae=ii(Gt);if(Z.substring(_t+1+Ae,_t+1+Ae+ht)===j){if(tt.push(Z.substring(H,_t).replace(ge,M)),A(_t+1+Ae+ht),Vt=Z.indexOf(W,H),_t=Z.indexOf(M,H),ct&&(B(),Q))return E();if(Y&&st.length>=Y)return E(!0);break}vt.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:st.length,index:H}),_t++}}else _t++}return v();function ve($){st.push($),it=H}function ii($){var q=0;if($!==-1){var J=Z.substring(_t+1,$);J&&J.trim()===""&&(q=J.length)}return q}function v($){return bt||($===void 0&&($=Z.substring(H)),tt.push($),H=X,ve(tt),ct&&B()),E()}function A($){H=$,ve(tt),tt=[],Gt=Z.indexOf(j,H)}function E($){return{data:st,errors:vt,meta:{delimiter:W,linebreak:j,aborted:Q,truncated:!!$,cursor:it+(yt||0)}}}function B(){z(E()),st=[],vt=[]}},this.abort=function(){Q=!0},this.getCharIndex=function(){return H}}function x(L){var M=L.data,W=a[M.workerId],j=!1;if(M.error)W.userError(M.error,M.file);else if(M.results&&M.results.data){var V={abort:function(){j=!0,R(M.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:I,resume:I};if(O(W.userStep)){for(var z=0;z<M.results.data.length&&(W.userStep({data:M.results.data[z],errors:M.results.errors,meta:M.results.meta},V),!j);z++);delete M.results}else O(W.userChunk)&&(W.userChunk(M.results,V,M.file),delete M.results)}M.finished&&!j&&R(M.workerId,M.results)}function R(L,M){var W=a[L];O(W.userComplete)&&W.userComplete(M),W.terminate(),delete a[L]}function I(){throw new Error("Not implemented.")}function D(L){if(typeof L!="object"||L===null)return L;var M=Array.isArray(L)?[]:{};for(var W in L)M[W]=D(L[W]);return M}function F(L,M){return function(){L.apply(M,arguments)}}function O(L){return typeof L=="function"}return r&&(i.onmessage=function(L){var M=L.data;if(l.WORKER_ID===void 0&&M&&(l.WORKER_ID=M.workerId),typeof M.input=="string")i.postMessage({workerId:l.WORKER_ID,results:l.parse(M.input,M.config),finished:!0});else if(i.File&&M.input instanceof File||M.input instanceof Object){var W=l.parse(M.input,M.config);W&&i.postMessage({workerId:l.WORKER_ID,results:W,finished:!0})}}),(f.prototype=Object.create(h.prototype)).constructor=f,(p.prototype=Object.create(h.prototype)).constructor=p,(g.prototype=Object.create(g.prototype)).constructor=g,(m.prototype=Object.create(h.prototype)).constructor=m,l})})(N2);var j8=N2.exports;const B8=eL(j8),oA=({mainState:{currentDocument:n,config:t}})=>{const[e,i]=U.useState([]);return U.useEffect(()=>{var s;if(n!=null&&n.fileData){const r=B8.parse(n.fileData,{delimiter:(t==null?void 0:t.csvDelimiter)??","});!((s=r.errors)!=null&&s.length)&&r.data&&i(r.data)}},[n,t==null?void 0:t.csvDelimiter]),e.length?N.jsx(W8,{children:N.jsxs(H8,{children:[N.jsx("thead",{children:N.jsx("tr",{children:e[0].map(s=>N.jsx("th",{children:s},s))})}),N.jsx("tbody",{children:e.slice(1,e.length).map(s=>N.jsx("tr",{children:s.map(r=>N.jsx("td",{children:r},r))},s.join("")))})]})}):null};oA.fileTypes=["csv","text/csv"];oA.weight=0;oA.fileLoader=wM;const W8=It.div`
  width: 100%;
`,H8=It.table`
  width: 100%;
  text-align: left;

  th,
  td {
    padding: 5px 10px;

    &:empty {
      display: none;
    }
  }
`,gk=n=>N.jsx(pa,{...n});gk.fileTypes=["gif","image/gif"];gk.weight=0;const mk=({mainState:{currentDocument:n}})=>n?N.jsx($8,{id:"video-renderer",children:N.jsx(U8,{controls:!0,src:n.uri})}):null;mk.fileTypes=["video/mp4","video/quicktime","video/x-msvideo"];mk.weight=0;const $8=It.div`
  width: 100%;
`,U8=It.video`
  width: 100%;
  height: 100%;
  border: 0;
`,vk=n=>N.jsx(pa,{...n});vk.fileTypes=["webp","image/webp"];vk.weight=0;const j2=[JS,Hw,tk,$w,fk,pk,rA,aA,oA,gk,mk,vk],z8=U.forwardRef((n,t)=>{const{documents:e,theme:i}=n;if(!e)throw new Error("Please provide an array of documents to DocViewer!");return N.jsx(V4,{ref:t,pluginRenderers:j2,...n,children:N.jsx(RW,{theme:i?{...HC,...i}:HC,children:N.jsxs(G8,{id:"react-doc-viewer","data-testid":"react-doc-viewer",className:n.className,style:n.style,children:[N.jsx(y6,{}),N.jsx(C6,{})]})})})}),V8=U.memo(z8),G8=It.div`
  display: flex;
  flex-direction: column;
  background: #ffffff;
  width: 100%;
  height: 100%;
`;function q8({id:n}){return N.jsx(od,{height:"100vh",my:5,children:N.jsx(V8,{documents:[{uri:`https://academic-nexus-iqrauni.vercel.app/api/assessments/view-assessment-file/${n}`}],pluginRenderers:j2})})}function X8(){const{colorMode:n}=_S(),{id:t}=U2(),{showErrorToast:e,showSuccessToast:i}=z2(),[s,r]=U.useState(null),[a,o]=U.useState(!1),[l,c]=U.useState(!1),h=V2(y=>y.user),{loading:f,result:p,error:g}=X2(`/api/assessments/${t}`);return U.useEffect(()=>{p&&r(p)},[p]),N.jsxs(N.Fragment,{children:[N.jsx(gv,{alignItems:"center",gap:"5",mb:12,children:N.jsx(q2,{title:"View Assessment"})}),f?N.jsx(mv,{}):g?N.jsx(Ek,{textColor:"red.400",fontSize:"xl",children:g}):N.jsxs(N.Fragment,{children:[N.jsxs(gv,{alignItems:"center",children:[N.jsx(od,{rounded:"full",bg:"purple.500",w:"20px",h:"20px"}),N.jsx(Q2,{bg:"purple.500",w:"20px",h:"5px",mr:4}),N.jsx(Ek,{color:"purple.500",children:s==null?void 0:s.title})]}),N.jsxs(gv,{alignItems:"center",gap:3,mt:5,children:[N.jsx(xk,{src:s==null?void 0:s.author.profilePicture,w:"35px",h:"35px",rounded:"full",objectFit:"cover"}),N.jsx(ec,{children:s==null?void 0:s.author.fullname})]}),N.jsxs(ec,{mt:4,mb:4,children:["Posted on:","  ",N.jsx(ec,{ml:"1",as:"span",textColor:n==="dark"?"gray.400":"gray.600",children:new Date(s==null?void 0:s.createdAt).toDateString().slice(4)})," "]}),N.jsxs(ec,{mt:4,mb:4,children:["Average votes:","  ",N.jsx(ec,{ml:"1",as:"span",color:(s==null?void 0:s.upvotes.length)-(s==null?void 0:s.downvotes.length)>0?"green":(s==null?void 0:s.upvotes.length)-(s==null?void 0:s.downvotes.length)<0?"red":"gray",children:(s==null?void 0:s.upvotes.length)-(s==null?void 0:s.downvotes.length)})]}),N.jsxs(od,{mb:12,children:[N.jsx($c,{leftIcon:N.jsx(ON,{}),colorScheme:"green",onClick:m,children:a?N.jsx(mv,{size:"sm"}):"Upvote"}),N.jsx($c,{leftIcon:N.jsx(FN,{}),colorScheme:"red",mx:3,onClick:b,children:l?N.jsx(mv,{size:"sm"}):"Downvote"}),N.jsx(G2,{id:s==null?void 0:s._id,fileName:`${s==null?void 0:s.title}.${s==null?void 0:s.fileExtension}`})]}),(s==null?void 0:s.fileExtension)==="pdf"?N.jsx(DN,{id:s==null?void 0:s._id}):(s==null?void 0:s.fileExtension)==="docx"?N.jsx(q8,{id:s==null?void 0:s._id}):N.jsx(xk,{src:`https://academic-nexus-iqrauni.vercel.app/api/assessments/view-assessment/${s==null?void 0:s._id}`,w:"full",objectFit:"cover",rounded:"lg",h:"full"})]})]});async function m(){if(!h){e("Please login to upvote this assessment");return}if(s.upvotes.includes(h._id)){e("You have already upvoted this assessment");return}o(!0);const{error:y,data:w}=await Y2(t);y?e(y):(i("You upvoted this assessment"),r({...s,upvotes:w.upvotes,downvotes:w.downvotes}),o(!1))}async function b(){if(!h){e("Please login to downvote this assessment");return}if(s.downvotes.includes(h._id)){e("You have already downvoted this assessment");return}c(!0);const{data:y,error:w}=await K2(t);w?e(w):r({...s,upvotes:y.upvotes,downvotes:y.downvotes}),c(!1)}}const cG=Object.freeze(Object.defineProperty({__proto__:null,default:X8},Symbol.toStringTag,{value:"Module"}));export{z_ as A,eL as J,cG as V,Tt as c,aG as q,df as r,rG as z};
