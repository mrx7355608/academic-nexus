import{G as p,q as D,r as l,j as e,B as i,v as u,A as k,w as S,x as z,I as B,T as x,J as O,S as I}from"./index-BUANxag7.js";import{u as E,M as H,a as R,b as A,c as F,d as L,e as T,f as q}from"./chunk-4FCEGNGT-39qLjW4Y.js";function P(s){return p({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"},child:[]}]})(s)}function G(s){return p({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},child:[]}]})(s)}function U({id:s,fileName:m}){const{colorMode:w}=D(),{isOpen:j,onClose:n,onOpen:f}=E(),[g,d]=l.useState(!1),[v,y]=l.useState(""),[c,h]=l.useState("");return e.jsxs(e.Fragment,{children:[e.jsx(i,{type:"button",px:2,size:"sm",variant:"ghost",textDecor:"underline",color:w==="light"?"gray.700":"gray.300",leftIcon:e.jsx(G,{size:20,style:{marginRight:"-4px"}}),onClick:f,children:"Download"}),e.jsxs(H,{closeOnOverlayClick:!1,isOpen:j,onClose:n,size:"lg",children:[e.jsx(R,{}),e.jsxs(A,{children:[e.jsx(F,{children:"Download file"}),e.jsx(L,{}),e.jsxs(T,{pb:6,onSubmit:a=>a.preventDefault(),children:[e.jsx(u,{mb:4,mt:3,width:"full",children:e.jsxs(k,{status:"info",borderRadius:"md",boxShadow:"md",w:"full",children:[e.jsx(S,{}),e.jsx(u,{children:e.jsx(z,{children:"You only have 3 attempts, after that you will have to wait for some time to be able to try again"})})]})}),e.jsx(B,{type:"password",autocomplete:"new-password",name:"password",placeholder:"Password",onChange:a=>y(a.target.value),isInvalid:!!c}),e.jsx(x,{size:"xs",color:"red.400",mt:1,children:c})]}),e.jsx(q,{children:e.jsxs(O,{children:[e.jsx(i,{onClick:()=>b(s,m),colorScheme:"purple",children:g?e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"xs"}),e.jsx(x,{size:"sm",ml:2,children:"Downloading"})]}):"Download"}),e.jsx(i,{onClick:n,children:"Close"})]})})]})]})]});function b(a,C){d(!0);const M=`https://academic-nexus-iqrauni.vercel.app/api/assessments/download-file/${a}`;fetch(M,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:v})}).then(async o=>{if(o.ok)return o.blob();const r=await o.json();throw new Error(r.error)}).then(o=>{const r=window.URL.createObjectURL(new Blob([o])),t=document.createElement("a");t.href=r,t.download=C,document.body.appendChild(t),t.click(),t.parentNode.removeChild(t),n(),h("")}).catch(o=>h(o.message)).finally(()=>d(!1))}}export{U as D,P as H};
